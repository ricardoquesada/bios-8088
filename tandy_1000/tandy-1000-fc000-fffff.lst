F000:C000 ;
F000:C000 ; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
F000:C000 ; º	  This file is generated by The	Interactive Disassembler (IDA)	      º
F000:C000 ; º	  Copyright (c)	2010 by	Hex-Rays SA, <support@hex-rays.com>	      º
F000:C000 ; º			   Licensed to:	Freeware version		      º
F000:C000 ; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
F000:C000 ;
F000:C000 ; Input MD5	: BEB50E3A5831F2661B91B2E52C94B3EA
F000:C000
F000:C000 ; File Name	: Z:\Users\riq\progs\bios-8088\tandy_1000\bios-fc000-fffff.bin
F000:C000 ; Format	: Binary file
F000:C000 ; Base Address: F000h	Range: FC000h -	100000h	Loaded length: 4000h
F000:C000
F000:C000		  .8086
F000:C000		  .model flat
F000:C000
F000:C000 ; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
F000:C000
F000:C000 ; Segment type: Pure code
F000:C000 F000		  segment byte public 'CODE'
F000:C000		  ;org 0C000h
F000:C000		  db  21h ; !
F000:C001 aBiosRomVersion db 'BIOS ROM version 01.00.00',0Dh,0Ah      ; DATA XREF: reset+2D9o
F000:C001		  db 'Copyright 1984 Tandy Corp.',0Dh,0Ah
F000:C001		  db 'and Phoenix Compatibility Corp.',0Dh,0Ah
F000:C001		  db 'All rights reserved.',0Dh,0Ah,'$'
F000:C070 int_1f_charset_128_255 db  1Eh, 33h,3	dup( 60h), 33h,	1Eh, 0Ch, 66h,	 0,4 dup( 66h),	3Bh,   0, 0Ch, 18h, 3Ch
F000:C070							      ;	DATA XREF: F000:FF21o
F000:C070		  db  66h, 7Eh,	60h, 3Ch,   0, 3Ch,0C3h, 3Ch,	6, 3Eh,	66h, 3Fh,   0, 66h,   0, 3Ch,	6
F000:C070		  db  3Eh, 66h,	3Fh,   0, 30h, 18h, 3Ch,   6, 3Eh, 66h,	3Fh,   0, 18h,	 0, 3Ch,   6, 3Eh
F000:C070		  db  66h, 3Fh,3 dup(	0), 3Ch, 66h, 60h, 66h,	3Ch, 18h, 3Ch,0C3h, 3Ch, 66h, 7Eh, 60h
F000:C070		  db  3Ch,   0,	66h,   0, 3Ch, 66h, 7Eh, 60h, 3Ch,   0,	30h, 18h, 3Ch, 66h, 7Eh, 60h, 3Ch
F000:C070		  db	0, 66h,	  0, 38h,3 dup(	18h), 3Ch,   0,	38h,0C6h, 38h,3	dup( 18h), 3Ch,	  0, 30h
F000:C070		  db  18h, 38h,3 dup( 18h), 3Ch,   0, 63h, 1Ch,	36h, 63h, 7Fh,2	dup( 63h),   0,2 dup( 1Ch)
F000:C070		  db  3Eh, 63h,	7Fh,2 dup( 63h),   0,	6, 0Ch,	7Fh, 31h, 3Ch, 31h, 7Fh,3 dup(	 0), 7Eh
F000:C070		  db  1Bh, 7Eh,0D8h, 7Eh,   0, 3Fh, 6Ch,0CCh,0FFh,2 dup(0CCh),0CFh,   0, 3Ch,0C3h, 3Ch
F000:C070		  db 3 dup( 66h), 3Ch,	 0, 66h,   0, 3Ch,3 dup( 66h), 3Ch,   0, 30h, 18h, 3Ch,3 dup( 66h)
F000:C070		  db  3Ch,   0,	3Ch,0C3h,4 dup(	66h), 3Bh,   0,	30h, 18h,4 dup(	66h), 3Bh,   0,	66h,   0
F000:C070		  db 3 dup( 66h), 3Eh,	 6, 7Ch, 63h, 3Eh,4 dup( 63h), 3Eh,   0, 36h,5 dup( 63h), 3Eh
F000:C070		  db	0,2 dup( 0Ch), 3Fh,2 dup( 60h),	3Fh,2 dup( 0Ch), 1Ch, 36h, 32h,	78h, 30h, 73h
F000:C070		  db  7Eh,   0,2 dup( 66h), 3Ch, 7Eh, 18h, 7Eh,2 dup( 18h),0F8h,2 dup(0CCh),0FAh,0C6h
F000:C070		  db 0CFh,0C6h,0C7h, 0Eh,2 dup(	18h), 3Ch,3 dup( 18h), 70h, 0Ch, 18h, 3Ch,   6,	3Eh, 66h
F000:C070		  db  3Fh,   0,	18h, 30h, 38h,3	dup( 18h), 3Ch,	  0, 0Ch, 18h, 3Ch,3 dup( 66h),	3Ch,   0
F000:C070		  db  0Ch, 18h,4 dup( 66h), 3Bh,   0, 3Bh, 6Fh,	  0, 6Eh,3 dup(	33h),	0, 76h,0DEh, 73h
F000:C070		  db  7Bh, 6Fh,	67h, 63h,   0, 3Ch,   6, 3Eh, 66h, 3Bh,	  0,0FFh,   0, 3Ch,3 dup( 66h)
F000:C070		  db  3Ch,   0,0FFh,2 dup(   0), 18h,	0, 18h,	30h, 60h, 66h, 3Ch,3 dup(   0),	7Eh,2 dup( 60h)
F000:C070		  db 5 dup(   0), 7Eh,2	dup(   6),2 dup(   0),0C3h,0C6h,0CCh,0DEh, 33h,	66h,0CCh, 0Fh
F000:C070		  db 0C3h,0C6h,0CCh,0D8h, 37h, 6Fh,0CFh,   3,	0, 18h,	  0,2 dup( 18h),2 dup( 3Ch), 18h
F000:C070		  db	0, 33h,	66h,0CCh, 66h, 33h,3 dup(   0),0CCh, 66h, 33h, 66h,0CCh,2 dup(	 0), 22h
F000:C070		  db  88h, 22h,	88h, 22h, 88h, 22h, 88h, 55h,0AAh, 55h,0AAh, 55h,0AAh, 55h,0AAh,0DBh, 77h
F000:C070		  db 0DBh,0EEh,0DBh, 77h,0DBh,0EEh,0Ch dup( 18h),0F8h,5	dup( 18h),0F8h,	18h,0F8h,3 dup(	18h)
F000:C070		  db 4 dup( 36h),0F6h,3	dup( 36h),4 dup(   0),0FEh,3 dup( 36h),2 dup(	0),0F8h, 18h,0F8h
F000:C070		  db 3 dup( 18h),2 dup(	36h),0F6h,   6,0F6h,0Bh	dup( 36h),2 dup(   0),0FEh,   6,0F6h,5 dup( 36h)
F000:C070		  db 0F6h,   6,0FEh,3 dup(   0),4 dup( 36h),0FEh,3 dup(	  0),2 dup( 18h),0F8h, 18h,0F8h
F000:C070		  db 7 dup(   0),0F8h,7	dup( 18h), 1Fh,3 dup(	0),4 dup( 18h),0FFh,7 dup(   0),0FFh,7 dup( 18h)
F000:C070		  db  1Fh,3 dup( 18h),4	dup(   0),0FFh,3 dup(	0),4 dup( 18h),0FFh,5 dup( 18h), 1Fh, 18h
F000:C070		  db  1Fh,3 dup( 18h),4	dup( 36h), 37h,5 dup( 36h), 37h, 30h, 3Fh,5 dup(   0), 3Fh, 30h
F000:C070		  db  37h,5 dup( 36h),0F7h,   0,0FFh,5 dup(   0),0FFh,	 0,0F7h,5 dup( 36h), 37h, 30h
F000:C070		  db  37h,3 dup( 36h),2	dup(   0),0FFh,	  0,0FFh,3 dup(	  0),2 dup( 36h),0F7h,	 0,0F7h
F000:C070		  db 3 dup( 36h),2 dup(	18h),0FFh,   0,0FFh,3 dup(   0),4 dup( 36h),0FFh,5 dup(	  0),0FFh
F000:C070		  db	0,0FFh,3 dup( 18h),4 dup(   0),0FFh,7 dup( 36h), 3Fh,3 dup(   0),2 dup(	18h), 1Fh
F000:C070		  db  18h, 1Fh,5 dup(	0), 1Fh, 18h, 1Fh,3 dup( 18h),4	dup(   0), 3Fh,7 dup( 36h),0FFh
F000:C070		  db 3 dup( 36h),2 dup(	18h),0FFh, 18h,0FFh,7 dup( 18h),0F8h,7 dup(   0), 1Fh,3	dup( 18h)
F000:C070		  db 8 dup(0FFh),4 dup(	  0),4 dup(0FFh),8 dup(0F0h),8 dup( 0Fh),4 dup(0FFh),6 dup(   0)
F000:C070		  db  3Bh, 6Eh,	64h, 6Eh, 3Bh,	 0, 3Ch,2 dup( 66h), 7Ch,2 dup(	63h), 6Eh, 60h,	7Fh, 33h
F000:C070		  db  31h,3 dup( 30h), 78h,3 dup(   0),	7Fh,3 dup( 36h), 33h,	0, 7Eh,	66h, 30h, 18h
F000:C070		  db  30h, 66h,	7Eh,3 dup(   0), 3Fh,3 dup( 66h), 3Ch,3	dup(   0),4 dup( 33h), 3Eh, 60h
F000:C070		  db 2 dup(   0), 7Eh, 98h,3 dup( 18h),	  0, 7Eh, 18h, 3Ch,2 dup( 66h),	3Ch, 18h, 7Eh
F000:C070		  db  1Ch, 36h,	63h, 7Fh, 63h, 36h, 1Ch,   0, 3Ch, 66h,3 dup(0C3h), 66h,0E7h,	0, 0Eh
F000:C070		  db  18h, 0Ch,	3Eh,2 dup( 66h), 3Ch,3 dup(   0), 7Eh,2	dup(0DBh), 7Eh,3 dup(	0),   3
F000:C070		  db  3Eh, 67h,	6Bh, 73h, 3Eh, 60h, 1Ch, 30h, 60h, 7Ch,	60h, 30h, 1Ch,	 0, 3Ch,6 dup( 66h)
F000:C070		  db 2 dup(   0), 7Eh,	 0, 7Eh,   0, 7Eh,3 dup(   0), 18h, 7Eh, 18h,	0, 7Eh,2 dup(	0)
F000:C070		  db  30h, 18h,	0Ch, 18h, 30h, 7Eh,2 dup(   0),	0Ch, 18h, 30h, 18h, 0Ch, 7Eh,2 dup(   0)
F000:C070		  db	7,0Ch dup( 0Ch),2 dup( 6Ch), 38h,2 dup(	18h),	0, 7Eh,	  0,2 dup( 18h),2 dup(	 0)
F000:C070		  db  3Bh, 6Eh,	  0, 3Bh, 6Eh,2	dup(   0), 1Ch,2 dup( 36h), 1Ch,5 dup(	 0),2 dup( 1Ch)
F000:C070		  db 8 dup(   0),2 dup(	18h),3 dup(   0), 0Fh,3	dup( 0Ch),0ECh,	6Ch, 3Ch, 1Ch, 3Ch,4 dup( 36h)
F000:C070		  db 3 dup(   0), 38h, 0Ch, 18h, 30h, 3Ch,5 dup(   0),4	dup( 3Ch),0Ah dup(   0)
F000:C470 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C470 ; START OF FUNCTION CHUNK FOR	reset
F000:C470
F000:C470 test_system:						      ;	CODE XREF: reset+25j
F000:C470		  cli
F000:C471		  mov	  al, 0Ah
F000:C473		  out	  0A0h,	al			      ;	PIC 2  same as 0020 for	PIC 1
F000:C475		  mov	  al, 3
F000:C477		  mov	  dx, 3F2h
F000:C47A		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:C47A							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:C47A							      ;	2:   0=reset diskette controller; 1=enable controller
F000:C47A							      ;	3:   1=enable diskette DMA and interrupts
F000:C47A							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:C47A							      ;
F000:C47B		  mov	  al, 24h ; '$'
F000:C47D		  mov	  dx, 3D8h
F000:C480		  out	  dx, al
F000:C481		  mov	  dx, 3DBh
F000:C484		  out	  dx, al			      ;	Video: light pen latch reset.
F000:C484							      ;	Any OUT	clears the latch.
F000:C485		  mov	  al, 0
F000:C487		  mov	  dx, 3DAh
F000:C48A		  out	  dx, al			      ;	Video: bits 0-1	control
F000:C48A							      ;	Feature	Control	outputs	FC0 and	FC1
F000:C48B		  add	  dx, 4
F000:C48E		  out	  dx, al
F000:C48F		  mov	  dx, 3D9h
F000:C492		  out	  dx, al
F000:C493		  mov	  al, 3
F000:C495		  mov	  dx, 3DAh
F000:C498		  out	  dx, al			      ;	Video: bits 0-1	control
F000:C498							      ;	Feature	Control	outputs	FC0 and	FC1
F000:C499		  xor	  al, al
F000:C49B		  mov	  dx, 3DEh
F000:C49E		  out	  dx, al
F000:C49F		  mov	  al, 2
F000:C4A1		  mov	  dx, 3DAh
F000:C4A4		  out	  dx, al			      ;	Video: bits 0-1	control
F000:C4A4							      ;	Feature	Control	outputs	FC0 and	FC1
F000:C4A5		  mov	  al, 0
F000:C4A7		  mov	  dx, 3DEh
F000:C4AA		  out	  dx, al
F000:C4AB		  mov	  al, 1
F000:C4AD		  mov	  dx, 3DAh
F000:C4B0		  out	  dx, al			      ;	Video: bits 0-1	control
F000:C4B0							      ;	Feature	Control	outputs	FC0 and	FC1
F000:C4B1		  mov	  al, 0FFh
F000:C4B3		  mov	  dx, 3DEh
F000:C4B6		  out	  dx, al
F000:C4B7		  mov	  bl, 10h
F000:C4B9		  mov	  dx, 3DAh
F000:C4BC		  xor	  al, al
F000:C4BE
F000:C4BE l20:							      ;	CODE XREF: reset-1B8Ej
F000:C4BE		  mov	  al, bl
F000:C4C0		  out	  dx, al			      ;	Video: bits 0-1	control
F000:C4C0							      ;	Feature	Control	outputs	FC0 and	FC1
F000:C4C1		  add	  dx, 4
F000:C4C4		  out	  dx, al
F000:C4C5		  sub	  dx, 4
F000:C4C8		  inc	  bl
F000:C4CA		  cmp	  bl, 20h ; ' '
F000:C4CD		  jnz	  short	l20
F000:C4CF		  xor	  al, al
F000:C4D1		  out	  dx, al			      ;	Video: bits 0-1	control
F000:C4D1							      ;	Feature	Control	outputs	FC0 and	FC1
F000:C4D2		  mov	  al, 3Fh ; '?'
F000:C4D4		  mov	  dx, 3DFh
F000:C4D7		  out	  dx, al
F000:C4D8		  mov	  al, 0FFh
F000:C4DA		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
F000:C4DA							      ;	channel	0 base address
F000:C4DA							      ;	(also sets current address)
F000:C4DC		  mov	  al, 0BFh ; '¿'
F000:C4DE		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
F000:C4DE							      ;	channel	0 base address
F000:C4DE							      ;	(also sets current address)
F000:C4E0		  mov	  al, 0DFh ; 'ß'
F000:C4E2		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
F000:C4E2							      ;	channel	0 base address
F000:C4E2							      ;	(also sets current address)
F000:C4E4		  mov	  al, 9Fh ; 'Ÿ'
F000:C4E6		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
F000:C4E6							      ;	channel	0 base address
F000:C4E6							      ;	(also sets current address)
F000:C4E8		  mov	  cx, 10h
F000:C4EB		  mov	  dx, 3D4h
F000:C4EE		  mov	  bx, offset crt_idx_and_value
F000:C4F1
F000:C4F1 l21:							      ;	CODE XREF: reset-1B5Dj
F000:C4F1		  mov	  al, cs:[bx]
F000:C4F4		  out	  dx, al			      ;	Video: CRT cntrlr addr
F000:C4F4							      ;	horizontal total
F000:C4F5		  inc	  dx
F000:C4F6		  inc	  bx
F000:C4F7		  mov	  al, cs:[bx]
F000:C4FA		  out	  dx, al			      ;	Video: CRT controller internal registers
F000:C4FB		  dec	  dx
F000:C4FC		  inc	  bx
F000:C4FD		  dec	  cx
F000:C4FE		  jnz	  short	l21
F000:C500		  jmp	  short	l22
F000:C500 ; END	OF FUNCTION CHUNK FOR reset
F000:C500 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C502		  db  90h ; 
F000:C503 crt_idx_and_value dw 3800h, 2801h, 2D02h, 0A03h, 1F04h, 605h,	1906h, 1C07h, 208h, 709h, 60Ah,	70Bh, 0Ch
F000:C503							      ;	DATA XREF: reset-1B6Do
F000:C503		  dw 0Dh, 0Eh, 0Fh
F000:C523 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C523 ; START OF FUNCTION CHUNK FOR	reset
F000:C523
F000:C523 l22:							      ;	CODE XREF: reset-1B5Bj
F000:C523		  mov	  dx, 3D8h
F000:C526		  mov	  al, 2Ch ; ','
F000:C528		  out	  dx, al
F000:C529		  mov	  ax, 0B800h
F000:C52C		  mov	  es, ax			      ;	es = 0xb800
F000:C52E		  cld
F000:C52F		  mov	  di, 0
F000:C532		  mov	  cx, 3E8h
F000:C535		  mov	  ax, 720h
F000:C538		  rep stosw
F000:C53A		  mov	  ax, 0BBE8h
F000:C53D		  mov	  ds, ax			      ;	ds = 0xbbe8
F000:C53F		  mov	  bp, ds:pbbe80.shadow_keyb_status_flags_1
F000:C543		  mov	  si, ds:pbbe80.shadow_POST_reset_flag
F000:C547		  mov	  ax, 0
F000:C54A
F000:C54A l23:							      ;	CODE XREF: reset-1AD3j
F000:C54A		  mov	  di, 0
F000:C54D
F000:C54D l24:							      ;	CODE XREF: reset-1AFCj
F000:C54D		  mov	  [di],	ax
F000:C54F		  add	  di, 2
F000:C552		  not	  ax
F000:C554		  mov	  [di],	ax
F000:C556		  add	  di, 2
F000:C559		  not	  ax
F000:C55B		  cmp	  di, 180h
F000:C55F		  jb	  short	l24
F000:C561		  mov	  cx, 118h
F000:C564
F000:C564 delay1:						      ;	CODE XREF: reset:delay1j
F000:C564		  loop	  delay1
F000:C566		  mov	  di, 0
F000:C569
F000:C569 l25:							      ;	CODE XREF: reset-1AD8j
F000:C569		  mov	  dx, [di]
F000:C56B		  cmp	  ax, dx
F000:C56D		  jnz	  short	l26
F000:C56F		  add	  di, 2
F000:C572		  not	  ax
F000:C574		  mov	  dx, [di]
F000:C576		  cmp	  ax, dx
F000:C578		  jnz	  short	l26
F000:C57A		  add	  di, 2
F000:C57D		  not	  ax
F000:C57F		  cmp	  di, 180h
F000:C583		  jb	  short	l25
F000:C585		  add	  ax, 5555h
F000:C588		  jnb	  short	l23
F000:C58A		  mov	  ds:pbbe80.shadow_POST_reset_flag, si
F000:C58E		  mov	  ds:pbbe80.shadow_keyb_status_flags_1,	bp
F000:C592		  jmp	  l43
F000:C595 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C595
F000:C595 l26:							      ;	CODE XREF: reset-1AEEj
F000:C595							      ;	reset-1AE3j
F000:C595		  mov	  ss, ax
F000:C597		  mov	  sp, dx
F000:C599		  mov	  ax, di
F000:C59B		  mov	  ds, ax
F000:C59D		  mov	  si, offset aVidAddrBaseBbe	      ;	"Vid Addr:   Base:    BBE8h  Off: xxxxh"
F000:C5A0		  mov	  di, 370h
F000:C5A3		  mov	  ax, 0B800h
F000:C5A6		  mov	  es, ax
F000:C5A8		  mov	  ah, 7
F000:C5AA
F000:C5AA l27:							      ;	CODE XREF: reset-1AA3j
F000:C5AA		  mov	  al, cs:[si]
F000:C5AD		  or	  al, al
F000:C5AF		  jz	  short	l28
F000:C5B1		  mov	  es:[di], ax
F000:C5B4		  add	  di, 2
F000:C5B7		  inc	  si
F000:C5B8		  jmp	  short	l27
F000:C5BA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C5BA
F000:C5BA l28:							      ;	CODE XREF: reset-1AACj
F000:C5BA		  sub	  di, 0Ah
F000:C5BD		  mov	  ax, ds
F000:C5BF		  mov	  dx, ax
F000:C5C1		  mov	  al, ah
F000:C5C3		  mov	  cl, al
F000:C5C5		  shr	  al, 1
F000:C5C7		  shr	  al, 1
F000:C5C9		  shr	  al, 1
F000:C5CB		  shr	  al, 1
F000:C5CD		  and	  al, 0Fh
F000:C5CF		  add	  al, 30h ; '0'
F000:C5D1		  cmp	  al, 3Ah ; ':'
F000:C5D3		  js	  short	l29
F000:C5D5		  add	  al, 7
F000:C5D7
F000:C5D7 l29:							      ;	CODE XREF: reset-1A88j
F000:C5D7		  mov	  ch, al
F000:C5D9		  mov	  al, cl
F000:C5DB		  and	  al, 0Fh
F000:C5DD		  add	  al, 30h ; '0'
F000:C5DF		  cmp	  al, 3Ah ; ':'
F000:C5E1		  js	  short	l30
F000:C5E3		  add	  al, 7
F000:C5E5
F000:C5E5 l30:							      ;	CODE XREF: reset-1A7Aj
F000:C5E5		  mov	  ah, ch
F000:C5E7		  mov	  bp, ax
F000:C5E9		  mov	  al, ah
F000:C5EB		  mov	  ah, 7
F000:C5ED		  mov	  es:[di], ax
F000:C5F0		  add	  di, 2
F000:C5F3		  mov	  ax, bp
F000:C5F5		  mov	  ah, 7
F000:C5F7		  mov	  es:[di], ax
F000:C5FA		  add	  di, 2
F000:C5FD		  mov	  ax, dx
F000:C5FF		  mov	  cl, al
F000:C601		  shr	  al, 1
F000:C603		  shr	  al, 1
F000:C605		  shr	  al, 1
F000:C607		  shr	  al, 1
F000:C609		  and	  al, 0Fh
F000:C60B		  add	  al, 30h ; '0'
F000:C60D		  cmp	  al, 3Ah ; ':'
F000:C60F		  js	  short	l31
F000:C611		  add	  al, 7
F000:C613
F000:C613 l31:							      ;	CODE XREF: reset-1A4Cj
F000:C613		  mov	  ch, al
F000:C615		  mov	  al, cl
F000:C617		  and	  al, 0Fh
F000:C619		  add	  al, 30h ; '0'
F000:C61B		  cmp	  al, 3Ah ; ':'
F000:C61D		  js	  short	l32
F000:C61F		  add	  al, 7
F000:C621
F000:C621 l32:							      ;	CODE XREF: reset-1A3Ej
F000:C621		  mov	  ah, ch
F000:C623		  mov	  bp, ax
F000:C625		  mov	  al, ah
F000:C627		  mov	  ah, 7
F000:C629		  mov	  es:[di], ax
F000:C62C		  add	  di, 2
F000:C62F		  mov	  ax, bp
F000:C631		  mov	  ah, 7
F000:C633		  mov	  es:[di], ax
F000:C636		  add	  di, 2
F000:C639		  mov	  si, offset aDataFaultWritt	      ;	"Data Fault: Written: xxxxh Read: xxxxh"
F000:C63C		  mov	  di, 3C0h
F000:C63F		  mov	  ah, 7
F000:C641
F000:C641 l33:							      ;	CODE XREF: reset-1A0Cj
F000:C641		  mov	  al, cs:[si]
F000:C644		  or	  al, al
F000:C646		  jz	  short	l34
F000:C648		  mov	  es:[di], ax
F000:C64B		  add	  di, 2
F000:C64E		  inc	  si
F000:C64F		  jmp	  short	l33
F000:C651 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C651
F000:C651 l34:							      ;	CODE XREF: reset-1A15j
F000:C651		  sub	  di, 22h ; '"'
F000:C654		  mov	  ax, ss
F000:C656		  mov	  dx, ax
F000:C658		  mov	  al, ah
F000:C65A		  mov	  cl, al
F000:C65C		  shr	  al, 1
F000:C65E		  shr	  al, 1
F000:C660		  shr	  al, 1
F000:C662		  shr	  al, 1
F000:C664		  and	  al, 0Fh
F000:C666		  add	  al, 30h ; '0'
F000:C668		  cmp	  al, 3Ah ; ':'
F000:C66A		  js	  short	l35
F000:C66C		  add	  al, 7
F000:C66E
F000:C66E l35:							      ;	CODE XREF: reset-19F1j
F000:C66E		  mov	  ch, al
F000:C670		  mov	  al, cl
F000:C672		  and	  al, 0Fh
F000:C674		  add	  al, 30h ; '0'
F000:C676		  cmp	  al, 3Ah ; ':'
F000:C678		  js	  short	l36
F000:C67A		  add	  al, 7
F000:C67C
F000:C67C l36:							      ;	CODE XREF: reset-19E3j
F000:C67C		  mov	  ah, ch
F000:C67E		  mov	  bp, ax
F000:C680		  mov	  al, ah
F000:C682		  mov	  ah, 7
F000:C684		  mov	  es:[di], ax
F000:C687		  add	  di, 2
F000:C68A		  mov	  ax, bp
F000:C68C		  mov	  ah, 7
F000:C68E		  mov	  es:[di], ax
F000:C691		  add	  di, 2
F000:C694		  mov	  ax, dx
F000:C696		  mov	  cl, al
F000:C698		  shr	  al, 1
F000:C69A		  shr	  al, 1
F000:C69C		  shr	  al, 1
F000:C69E		  shr	  al, 1
F000:C6A0		  and	  al, 0Fh
F000:C6A2		  add	  al, 30h ; '0'
F000:C6A4		  cmp	  al, 3Ah ; ':'
F000:C6A6		  js	  short	l37
F000:C6A8		  add	  al, 7
F000:C6AA
F000:C6AA l37:							      ;	CODE XREF: reset-19B5j
F000:C6AA		  mov	  ch, al
F000:C6AC		  mov	  al, cl
F000:C6AE		  and	  al, 0Fh
F000:C6B0		  add	  al, 30h ; '0'
F000:C6B2		  cmp	  al, 3Ah ; ':'
F000:C6B4		  js	  short	l38
F000:C6B6		  add	  al, 7
F000:C6B8
F000:C6B8 l38:							      ;	CODE XREF: reset-19A7j
F000:C6B8		  mov	  ah, ch
F000:C6BA		  mov	  bp, ax
F000:C6BC		  mov	  al, ah
F000:C6BE		  mov	  ah, 7
F000:C6C0		  mov	  es:[di], ax
F000:C6C3		  add	  di, 2
F000:C6C6		  mov	  ax, bp
F000:C6C8		  mov	  ah, 7
F000:C6CA		  mov	  es:[di], ax
F000:C6CD		  add	  di, 2
F000:C6D0		  add	  di, 10h
F000:C6D3		  mov	  ax, sp
F000:C6D5		  mov	  dx, ax
F000:C6D7		  mov	  al, ah
F000:C6D9		  mov	  cl, al
F000:C6DB		  shr	  al, 1
F000:C6DD		  shr	  al, 1
F000:C6DF		  shr	  al, 1
F000:C6E1		  shr	  al, 1
F000:C6E3		  and	  al, 0Fh
F000:C6E5		  add	  al, 30h ; '0'
F000:C6E7		  cmp	  al, 3Ah ; ':'
F000:C6E9		  js	  short	l39
F000:C6EB		  add	  al, 7
F000:C6ED
F000:C6ED l39:							      ;	CODE XREF: reset-1972j
F000:C6ED		  mov	  ch, al
F000:C6EF		  mov	  al, cl
F000:C6F1		  and	  al, 0Fh
F000:C6F3		  add	  al, 30h ; '0'
F000:C6F5		  cmp	  al, 3Ah ; ':'
F000:C6F7		  js	  short	l40
F000:C6F9		  add	  al, 7
F000:C6FB
F000:C6FB l40:							      ;	CODE XREF: reset-1964j
F000:C6FB		  mov	  ah, ch
F000:C6FD		  mov	  bp, ax
F000:C6FF		  mov	  al, ah
F000:C701		  mov	  ah, 7
F000:C703		  mov	  es:[di], ax
F000:C706		  add	  di, 2
F000:C709		  mov	  ax, bp
F000:C70B		  mov	  ah, 7
F000:C70D		  mov	  es:[di], ax
F000:C710		  add	  di, 2
F000:C713		  mov	  ax, dx
F000:C715		  mov	  cl, al
F000:C717		  shr	  al, 1
F000:C719		  shr	  al, 1
F000:C71B		  shr	  al, 1
F000:C71D		  shr	  al, 1
F000:C71F		  and	  al, 0Fh
F000:C721		  add	  al, 30h ; '0'
F000:C723		  cmp	  al, 3Ah ; ':'
F000:C725		  js	  short	l41
F000:C727		  add	  al, 7
F000:C729
F000:C729 l41:							      ;	CODE XREF: reset-1936j
F000:C729		  mov	  ch, al
F000:C72B		  mov	  al, cl
F000:C72D		  and	  al, 0Fh
F000:C72F		  add	  al, 30h ; '0'
F000:C731		  cmp	  al, 3Ah ; ':'
F000:C733		  js	  short	l42
F000:C735		  add	  al, 7
F000:C737
F000:C737 l42:							      ;	CODE XREF: reset-1928j
F000:C737		  mov	  ah, ch
F000:C739		  mov	  bp, ax
F000:C73B		  mov	  al, ah
F000:C73D		  mov	  ah, 7
F000:C73F		  mov	  es:[di], ax
F000:C742		  add	  di, 2
F000:C745		  mov	  ax, bp
F000:C747		  mov	  ah, 7
F000:C749		  mov	  es:[di], ax
F000:C74C		  add	  di, 2
F000:C74F
F000:C74F halt0:						      ;	CODE XREF: reset:halt0j
F000:C74F		  jmp	  short	halt0
F000:C74F ; END	OF FUNCTION CHUNK FOR reset
F000:C74F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C751 aVidAddrBaseBbe db 'Vid Addr:   Base:    BBE8h  Off: xxxxh',0
F000:C751							      ;	DATA XREF: reset-1ABEo
F000:C778 aDataFaultWritt db 'Data Fault: Written: xxxxh Read: xxxxh',0
F000:C778							      ;	DATA XREF: reset-1A22o
F000:C79F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C79F ; START OF FUNCTION CHUNK FOR	reset
F000:C79F
F000:C79F l43:							      ;	CODE XREF: reset-1AC9j
F000:C79F		  mov	  ax, 0BBF0h
F000:C7A2		  mov	  ss, ax			      ;	ss = 0xbbf0
F000:C7A4		  mov	  sp, 0F0h ; 'ğ'
F000:C7A7		  xor	  al, al
F000:C7A9		  out	  81h, al			      ;	DMA page register 74LS612:
F000:C7A9							      ;	Channel	2 (diskette DMA)  (address bits	16-23)
F000:C7AB		  out	  82h, al			      ;	DMA page register 74LS612:
F000:C7AB							      ;	Channel	3 (hard	disk DMA) (address bits	16-23)
F000:C7AD		  out	  83h, al			      ;	DMA page register 74LS612:
F000:C7AD							      ;	Channel	1 (address bits	16-23)
F000:C7AF		  out	  0Dh, al			      ;	DMA controller,	8237A-5.
F000:C7AF							      ;	master clear.
F000:C7AF							      ;	Any OUT	clears the ctrlr (must be re-initialized)
F000:C7B1		  mov	  cx, 2
F000:C7B4
F000:C7B4 l44:							      ;	CODE XREF: reset:l44j
F000:C7B4		  loop	  l44
F000:C7B6		  mov	  al, 24h ; '$'
F000:C7B8		  out	  8, al				      ;	DMA 8237A-5. cmd reg bits:
F000:C7B8							      ;	0: enable mem-to-mem DMA
F000:C7B8							      ;	1: enable Ch0 address hold
F000:C7B8							      ;	2: disable controller
F000:C7B8							      ;	3: compressed timing mode
F000:C7B8							      ;	4: enable rotating priority
F000:C7B8							      ;	5: extended write mode;	0=late write
F000:C7B8							      ;	6: DRQ sensing - active	high
F000:C7B8							      ;	7: DACK	sensing	- active high
F000:C7BA		  mov	  dx, 0
F000:C7BD		  mov	  ah, 0
F000:C7BF		  mov	  cx, 1
F000:C7C2
F000:C7C2 l45:							      ;	CODE XREF: reset-1886j
F000:C7C2		  mov	  al, cl
F000:C7C4		  out	  dx, al
F000:C7C5		  mov	  al, ah
F000:C7C7		  out	  dx, al
F000:C7C8		  nop
F000:C7C9		  in	  al, dx
F000:C7CA		  cmp	  al, cl
F000:C7CC		  jnz	  short	l47
F000:C7CE		  in	  al, dx
F000:C7CF		  cmp	  al, 0
F000:C7D1		  jnz	  short	l47
F000:C7D3		  rcl	  cl, 1
F000:C7D5		  jnb	  short	l45
F000:C7D7		  mov	  dx, 0
F000:C7DA		  xor	  al, al
F000:C7DC
F000:C7DC l46:							      ;	CODE XREF: reset-1879j
F000:C7DC		  out	  dx, al
F000:C7DD		  out	  dx, al
F000:C7DE		  inc	  dx
F000:C7DF		  cmp	  dx, 8
F000:C7E2		  jnz	  short	l46
F000:C7E4		  mov	  dx, 0Bh
F000:C7E7		  mov	  al, 58h ; 'X'
F000:C7E9		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
F000:C7E9							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
F000:C7E9							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
F000:C7E9							      ;	4: 1=enable auto-initialization
F000:C7E9							      ;	5: 1=address increment;	0=address decrement
F000:C7E9							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
F000:C7EA		  mov	  al, 49h ; 'I'
F000:C7EC		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
F000:C7EC							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
F000:C7EC							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
F000:C7EC							      ;	4: 1=enable auto-initialization
F000:C7EC							      ;	5: 1=address increment;	0=address decrement
F000:C7EC							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
F000:C7ED		  mov	  al, 4Ah ; 'J'
F000:C7EF		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
F000:C7EF							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
F000:C7EF							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
F000:C7EF							      ;	4: 1=enable auto-initialization
F000:C7EF							      ;	5: 1=address increment;	0=address decrement
F000:C7EF							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
F000:C7F0		  mov	  al, 4Bh ; 'K'
F000:C7F2		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
F000:C7F2							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
F000:C7F2							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
F000:C7F2							      ;	4: 1=enable auto-initialization
F000:C7F2							      ;	5: 1=address increment;	0=address decrement
F000:C7F2							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
F000:C7F3		  mov	  al, 0Eh
F000:C7F5		  out	  0Fh, al			      ;	DMA controller,	8237A-5.
F000:C7F5							      ;	master clear. Clear or mask any	or
F000:C7F5							      ;	all of the channels. Bits:
F000:C7F5							      ;	0: 1=mask channel 0; 0=enable
F000:C7F5							      ;	1: 1=mask channel 1;
F000:C7F5							      ;	2: 1=mask channel 2;
F000:C7F5							      ;	3: 1=mask channel 3;
F000:C7F7		  mov	  al, 0FFh
F000:C7F9		  out	  1, al				      ;	DMA controller,	8237A-5.
F000:C7F9							      ;	channel	0 base address and word	count
F000:C7FB		  mov	  al, 20h ; ' '
F000:C7FD		  out	  8, al				      ;	DMA 8237A-5. cmd reg bits:
F000:C7FD							      ;	0: enable mem-to-mem DMA
F000:C7FD							      ;	1: enable Ch0 address hold
F000:C7FD							      ;	2: disable controller
F000:C7FD							      ;	3: compressed timing mode
F000:C7FD							      ;	4: enable rotating priority
F000:C7FD							      ;	5: extended write mode;	0=late write
F000:C7FD							      ;	6: DRQ sensing - active	high
F000:C7FD							      ;	7: DACK	sensing	- active high
F000:C7FF
F000:C7FF l47:							      ;	CODE XREF: reset-188Fj
F000:C7FF							      ;	reset-188Aj
F000:C7FF		  mov	  ch, 0
F000:C801
F000:C801 l48:							      ;	CODE XREF: reset-182Cj
F000:C801							      ;	reset-180Dj
F000:C801		  mov	  al, 98h ; '˜'
F000:C803		  out	  63h, al			      ;	PC/XT PPI Command/Mode Register.
F000:C803							      ;	Selects	which PPI ports	are input or output.
F000:C803							      ;	BIOS sets to 99H (Ports	A and C	are input, B is	output).
F000:C805		  nop
F000:C806		  mov	  al, 0C0h ; 'À'
F000:C808		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:C808							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:C808							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:C808							      ;	3: 1=read high switches
F000:C808							      ;	4: 0=enable RAM	parity checking
F000:C808							      ;	5: 0=enable I/O	channel	check
F000:C808							      ;	6: 0=hold keyboard clock low
F000:C808							      ;	7: 0=enable kbrd
F000:C80A		  mov	  cl, 1
F000:C80C
F000:C80C l49:							      ;	CODE XREF: reset-1831j
F000:C80C		  mov	  al, 90h ; ''
F000:C80E		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C810		  mov	  al, cl
F000:C812		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C814		  mov	  al, 80h ; '€'
F000:C816		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C818		  mov	  al, 90h ; ''
F000:C81A		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C81C		  nop
F000:C81D		  in	  al, 42h			      ;	Timer 8253-5 (AT: 8254.2).
F000:C81F		  cmp	  ch, 1
F000:C822		  jz	  short	l50
F000:C824		  cmp	  al, cl
F000:C826		  jnz	  short	l51
F000:C828
F000:C828 l50:							      ;	CODE XREF: reset-1839j
F000:C828		  rcl	  cl, 1
F000:C82A		  jnb	  short	l49
F000:C82C		  cmp	  ch, 1
F000:C82F		  jz	  short	l48
F000:C831		  jmp	  short	l54
F000:C831 ; END	OF FUNCTION CHUNK FOR reset
F000:C833 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C833		  nop
F000:C834 ; START OF FUNCTION CHUNK FOR	reset
F000:C834
F000:C834 l51:							      ;	CODE XREF: reset-1835j
F000:C834		  mov	  si, offset aFaultyWriteRea	      ;	"Faulty	write &	read of	8253 Chan 2 Reg"
F000:C837		  mov	  di, 3C0h
F000:C83A		  mov	  ah, 7
F000:C83C
F000:C83C l52:							      ;	CODE XREF: reset-1811j
F000:C83C		  mov	  al, cs:[si]
F000:C83F		  or	  al, al
F000:C841		  jz	  short	l53
F000:C843		  mov	  es:[di], ax
F000:C846		  add	  di, 2
F000:C849		  inc	  si
F000:C84A		  jmp	  short	l52
F000:C84C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C84C
F000:C84C l53:							      ;	CODE XREF: reset-181Aj
F000:C84C		  mov	  ch, 1
F000:C84E		  jmp	  short	l48
F000:C84E ; END	OF FUNCTION CHUNK FOR reset
F000:C84E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C850 aFaultyWriteRea db 'Faulty write & read of 8253 Chan 2 Reg',0
F000:C850							      ;	DATA XREF: reset:l51o
F000:C877 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C877 ; START OF FUNCTION CHUNK FOR	reset
F000:C877
F000:C877 l54:							      ;	CODE XREF: reset-182Aj
F000:C877		  mov	  al, 74h ; 't'
F000:C879		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C87B		  mov	  al, 12h
F000:C87D		  out	  41h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C87F		  mov	  al, 0
F000:C881		  out	  41h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C883		  mov	  al, 30h ; '0'
F000:C885		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C887		  mov	  al, 0
F000:C889		  out	  40h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C88B		  out	  40h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C88D		  mov	  al, 0B0h ; '°'
F000:C88F		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C891		  mov	  al, 0
F000:C893		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C895		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:C897		  mov	  ax, 0
F000:C89A		  mov	  es, ax
F000:C89C		  xor	  si, si
F000:C89E
F000:C89E l55:							      ;	CODE XREF: reset-1790j
F000:C89E		  mov	  ax, es:[si]
F000:C8A1		  not	  ax
F000:C8A3		  mov	  es:[si], ax
F000:C8A6		  mov	  cx, 118h
F000:C8A9
F000:C8A9 l56:							      ;	CODE XREF: reset:l56j
F000:C8A9		  loop	  l56
F000:C8AB		  cmp	  ax, es:[si]
F000:C8AE		  jnz	  short	l60
F000:C8B0		  not	  ax
F000:C8B2		  mov	  es:[si], ax
F000:C8B5		  mov	  cx, 118h
F000:C8B8
F000:C8B8 l57:							      ;	CODE XREF: reset:l57j
F000:C8B8		  loop	  l57
F000:C8BA		  cmp	  ax, es:[si]
F000:C8BD		  jnz	  short	l60
F000:C8BF
F000:C8BF l58:							      ;	CODE XREF: reset-1773j
F000:C8BF		  mov	  ax, es
F000:C8C1		  add	  ax, 1000h
F000:C8C4		  cmp	  ax, 8000h
F000:C8C7		  jz	  short	l59
F000:C8C9		  mov	  es, ax
F000:C8CB		  jmp	  short	l55
F000:C8CD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C8CD
F000:C8CD l59:							      ;	CODE XREF: reset-1794j
F000:C8CD		  mov	  es, ax
F000:C8CF		  jmp	  short	l63
F000:C8CF ; END	OF FUNCTION CHUNK FOR reset
F000:C8D1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C8D1		  nop
F000:C8D2 ; START OF FUNCTION CHUNK FOR	reset
F000:C8D2
F000:C8D2 l60:							      ;	CODE XREF: reset-17ADj
F000:C8D2							      ;	reset-179Ej
F000:C8D2		  xor	  ax, es:[si]
F000:C8D5		  mov	  bl, 0
F000:C8D7		  mov	  cx, 11h
F000:C8DA
F000:C8DA l61:							      ;	CODE XREF: reset-177Cj
F000:C8DA							      ;	reset-1778j
F000:C8DA		  dec	  cx
F000:C8DB		  jcxz	  short	l62
F000:C8DD		  rcl	  ax, 1
F000:C8DF		  jnb	  short	l61
F000:C8E1		  inc	  bl
F000:C8E3		  jmp	  short	l61
F000:C8E5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C8E5
F000:C8E5 l62:							      ;	CODE XREF: reset-1780j
F000:C8E5		  cmp	  bl, 0
F000:C8E8		  jb	  short	l58
F000:C8EA
F000:C8EA l63:							      ;	CODE XREF: reset-178Cj
F000:C8EA		  mov	  dx, es
F000:C8EC		  mov	  al, dh
F000:C8EE		  mov	  cl, 4
F000:C8F0		  shr	  al, cl
F000:C8F2		  out	  0A0h,	al			      ;	PIC 2  same as 0020 for	PIC 1
F000:C8F4		  mov	  ds:pbbe80.field_D, al
F000:C8F7		  mov	  ds:pbbe80.field_B, dx
F000:C8FB		  mov	  ax, 0B800h
F000:C8FE		  mov	  es, ax
F000:C900		  mov	  si, offset aMemorySizeNone	      ;	"MEMORY	SIZE =	None  "
F000:C903		  mov	  di, 4
F000:C906		  mov	  ah, 7
F000:C908
F000:C908 l64:							      ;	CODE XREF: reset-1745j
F000:C908		  mov	  al, cs:[si]
F000:C90B		  or	  al, al
F000:C90D		  jz	  short	l65
F000:C90F		  mov	  es:[di], ax
F000:C912		  add	  di, 2
F000:C915		  inc	  si
F000:C916		  jmp	  short	l64
F000:C918 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C918
F000:C918 l65:							      ;	CODE XREF: reset-174Ej
F000:C918		  mov	  al, ds:pbbe80.field_D
F000:C91B		  mov	  cx, 4
F000:C91E		  mul	  cl
F000:C920		  xor	  ah, ah
F000:C922		  mov	  si, ax
F000:C924		  mov	  ah, 7
F000:C926		  mov	  bx, offset a128k192k256k320k384k448k512k57 ; "128K192K256K320K384K448K512K576K640K704"...
F000:C929		  mov	  di, 22h ; '"'
F000:C92C
F000:C92C l66:							      ;	CODE XREF: reset-1725j
F000:C92C		  mov	  al, cs:[bx+si]
F000:C92F		  mov	  es:[di], ax
F000:C932		  add	  di, 2
F000:C935		  inc	  si
F000:C936		  loop	  l66
F000:C938		  jmp	  short	l67
F000:C938 ; END	OF FUNCTION CHUNK FOR reset
F000:C93A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C93A		  nop
F000:C93A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C93B aMemorySizeNone db 'MEMORY SIZE =  None  ',0                ; DATA XREF: reset-175Bo
F000:C951 a128k192k256k320k384k448k512k57 db '128K192K256K320K384K448K512K576K640K704K768K832K896K960K'
F000:C951							      ;	DATA XREF: reset-1735o
F000:C989 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C989 ; START OF FUNCTION CHUNK FOR	reset
F000:C989
F000:C989 l67:							      ;	CODE XREF: reset-1723j
F000:C989							      ;	reset:l71j
F000:C989		  mov	  al, 98h ; '˜'
F000:C98B		  out	  63h, al			      ;	PC/XT PPI Command/Mode Register.
F000:C98B							      ;	Selects	which PPI ports	are input or output.
F000:C98B							      ;	BIOS sets to 99H (Ports	A and C	are input, B is	output).
F000:C98D		  mov	  dx, 61h ; 'a'
F000:C990		  mov	  cl, 1
F000:C992
F000:C992 l68:							      ;	CODE XREF: reset-16BEj
F000:C992		  mov	  al, cl
F000:C994		  out	  dx, al			      ;	PC/XT PPI port B bits:
F000:C994							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:C994							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:C994							      ;	3: 1=read high switches
F000:C994							      ;	4: 0=enable RAM	parity checking
F000:C994							      ;	5: 0=enable I/O	channel	check
F000:C994							      ;	6: 0=hold keyboard clock low
F000:C994							      ;	7: 0=enable kbrd
F000:C995		  nop
F000:C996		  in	  al, dx			      ;	PC/XT PPI port B bits:
F000:C996							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:C996							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:C996							      ;	3: 1=read high switches
F000:C996							      ;	4: 0=enable RAM	parity checking
F000:C996							      ;	5: 0=enable I/O	channel	check
F000:C996							      ;	6: 0=hold keyboard clock low
F000:C996							      ;	7: 0=enable kbrd
F000:C997		  cmp	  al, cl
F000:C999		  jnz	  short	l69
F000:C99B		  rcl	  cl, 1
F000:C99D		  jnb	  short	l68
F000:C99F		  jmp	  short	l72
F000:C99F ; END	OF FUNCTION CHUNK FOR reset
F000:C99F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C9A1		  db  90h ; 
F000:C9A2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C9A2 ; START OF FUNCTION CHUNK FOR	reset
F000:C9A2
F000:C9A2 l69:							      ;	CODE XREF: reset-16C2j
F000:C9A2		  mov	  si, offset aFaultyWriteR_0	      ;	"Faulty	write &	read of	8255 PPI Chan B"
F000:C9A5		  mov	  di, 3C0h
F000:C9A8		  mov	  ah, 7
F000:C9AA
F000:C9AA l70:							      ;	CODE XREF: reset-16A3j
F000:C9AA		  mov	  al, cs:[si]
F000:C9AD		  or	  al, al
F000:C9AF		  jz	  short	l71
F000:C9B1		  mov	  es:[di], ax
F000:C9B4		  add	  di, 2
F000:C9B7		  inc	  si
F000:C9B8		  jmp	  short	l70
F000:C9BA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C9BA
F000:C9BA l71:							      ;	CODE XREF: reset-16ACj
F000:C9BA		  jmp	  short	l67
F000:C9BA ; END	OF FUNCTION CHUNK FOR reset
F000:C9BA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C9BC aFaultyWriteR_0 db 'Faulty write & read of 8255 PPI Chan B',0
F000:C9BC							      ;	DATA XREF: reset:l69o
F000:C9E3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:C9E3 ; START OF FUNCTION CHUNK FOR	reset
F000:C9E3
F000:C9E3 l72:							      ;	CODE XREF: reset-16BCj
F000:C9E3		  mov	  dx, 63h ; 'c'
F000:C9E6		  mov	  al, 98h ; '˜'
F000:C9E8		  out	  dx, al			      ;	PC/XT PPI Command/Mode Register.
F000:C9E8							      ;	Selects	which PPI ports	are input or output.
F000:C9E8							      ;	BIOS sets to 99H (Ports	A and C	are input, B is	output).
F000:C9E9		  mov	  dx, 61h ; 'a'
F000:C9EC		  mov	  al, 88h ; 'ˆ'
F000:C9EE		  out	  dx, al			      ;	PC/XT PPI port B bits:
F000:C9EE							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:C9EE							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:C9EE							      ;	3: 1=read high switches
F000:C9EE							      ;	4: 0=enable RAM	parity checking
F000:C9EE							      ;	5: 0=enable I/O	channel	check
F000:C9EE							      ;	6: 0=hold keyboard clock low
F000:C9EE							      ;	7: 0=enable kbrd
F000:C9EF		  mov	  al, 8
F000:C9F1		  out	  dx, al			      ;	PC/XT PPI port B bits:
F000:C9F1							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:C9F1							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:C9F1							      ;	3: 1=read high switches
F000:C9F1							      ;	4: 0=enable RAM	parity checking
F000:C9F1							      ;	5: 0=enable I/O	channel	check
F000:C9F1							      ;	6: 0=hold keyboard clock low
F000:C9F1							      ;	7: 0=enable kbrd
F000:C9F2		  mov	  dx, 62h ; 'b'
F000:C9F5		  mov	  al, 0
F000:C9F7		  out	  dx, al			      ;	PC/XT PPI port C. Bits:
F000:C9F7							      ;	0-3: values of DIP switches
F000:C9F7							      ;	5: 1=Timer 2 channel out
F000:C9F7							      ;	6: 1=I/O channel check
F000:C9F7							      ;	7: 1=RAM parity	check error occurred.
F000:C9F8		  mov	  al, 13h
F000:C9FA		  out	  20h, al			      ;	Interrupt controller, 8259A.
F000:C9FC		  mov	  al, 8
F000:C9FE		  mov	  dx, 21h ; '!'
F000:CA01		  out	  dx, al			      ;	Interrupt controller, 8259A.
F000:CA02		  mov	  al, 1
F000:CA04		  out	  dx, al			      ;	Interrupt controller, 8259A.
F000:CA05		  mov	  al, 0FFh
F000:CA07		  out	  dx, al			      ;	Interrupt controller, 8259A.
F000:CA08		  mov	  cl, al
F000:CA0A		  mov	  al, 40h ; '@'
F000:CA0C		  out	  20h, al			      ;	Interrupt controller, 8259A.
F000:CA0E		  in	  al, dx			      ;	Interrupt controller, 8259A.
F000:CA0F		  cmp	  al, cl
F000:CA11		  jnz	  short	l75
F000:CA13		  mov	  cl, 1
F000:CA15
F000:CA15 l73:							      ;	CODE XREF: reset-163Cj
F000:CA15		  mov	  al, cl
F000:CA17		  out	  dx, al			      ;	Interrupt controller, 8259A.
F000:CA18		  in	  al, dx			      ;	Interrupt controller, 8259A.
F000:CA19		  cmp	  al, cl
F000:CA1B		  jnz	  short	l75
F000:CA1D		  rcl	  cl, 1
F000:CA1F		  jnb	  short	l73
F000:CA21		  mov	  al, 0FDh ; 'ı'
F000:CA23		  out	  dx, al			      ;	Interrupt controller, 8259A.
F000:CA24		  mov	  cl, al
F000:CA26		  in	  al, dx			      ;	Interrupt controller, 8259A.
F000:CA27		  cmp	  al, cl
F000:CA29		  jnz	  short	l75
F000:CA2B		  mov	  cx, 8
F000:CA2E
F000:CA2E l74:							      ;	CODE XREF: reset-1629j
F000:CA2E		  mov	  al, 20h ; ' '
F000:CA30		  out	  20h, al			      ;	Interrupt controller, 8259A.
F000:CA32		  loop	  l74
F000:CA34		  jmp	  short	l77
F000:CA34 ; END	OF FUNCTION CHUNK FOR reset
F000:CA34 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CA36		  db  90h ; 
F000:CA37 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CA37 ; START OF FUNCTION CHUNK FOR	reset
F000:CA37
F000:CA37 l75:							      ;	CODE XREF: reset-164Aj
F000:CA37							      ;	reset-1640j
F000:CA37							      ;	reset-1632j
F000:CA37		  mov	  si, offset aFaultyWriteR_1	      ;	"Faulty	write &	read of	8259 Mask Reg"
F000:CA3A		  mov	  di, 3C0h
F000:CA3D		  mov	  ah, 7
F000:CA3F
F000:CA3F l76:							      ;	CODE XREF: reset-160Ej
F000:CA3F		  mov	  al, cs:[si]
F000:CA42		  or	  al, al
F000:CA44		  jz	  short	halt1
F000:CA46		  mov	  es:[di], ax
F000:CA49		  add	  di, 2
F000:CA4C		  inc	  si
F000:CA4D		  jmp	  short	l76
F000:CA4D ; END	OF FUNCTION CHUNK FOR reset
F000:CA4D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CA4F aFaultyWriteR_1 db 'Faulty write & read of 8259 Mask Reg',0 ; DATA XREF: reset:l75o
F000:CA74 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CA74 ; START OF FUNCTION CHUNK FOR	reset
F000:CA74
F000:CA74 halt1:						      ;	CODE XREF: reset-1617j
F000:CA74							      ;	reset:halt1j
F000:CA74		  jmp	  short	halt1
F000:CA76 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CA76
F000:CA76 l77:							      ;	CODE XREF: reset-1627j
F000:CA76		  xor	  cx, cx
F000:CA78
F000:CA78 delay2:						      ;	CODE XREF: reset:delay2j
F000:CA78		  loop	  delay2
F000:CA7A		  mov	  cx, 11h
F000:CA7D
F000:CA7D l78:							      ;	CODE XREF: reset-15C9j
F000:CA7D		  xchg	  bx, cx
F000:CA7F		  mov	  al, 88h ; 'ˆ'
F000:CA81		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:CA81							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:CA81							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:CA81							      ;	3: 1=read high switches
F000:CA81							      ;	4: 0=enable RAM	parity checking
F000:CA81							      ;	5: 0=enable I/O	channel	check
F000:CA81							      ;	6: 0=hold keyboard clock low
F000:CA81							      ;	7: 0=enable kbrd
F000:CA83		  mov	  al, 20h ; ' '
F000:CA85		  out	  20h, al			      ;	Interrupt controller, 8259A.
F000:CA87		  mov	  al, 8
F000:CA89		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:CA89							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:CA89							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:CA89							      ;	3: 1=read high switches
F000:CA89							      ;	4: 0=enable RAM	parity checking
F000:CA89							      ;	5: 0=enable I/O	channel	check
F000:CA89							      ;	6: 0=hold keyboard clock low
F000:CA89							      ;	7: 0=enable kbrd
F000:CA8B		  mov	  cx, 0A9h ; '©'
F000:CA8E
F000:CA8E delay3:						      ;	CODE XREF: reset:delay3j
F000:CA8E		  loop	  delay3
F000:CA90		  xchg	  bx, cx
F000:CA92		  loop	  l78
F000:CA94		  mov	  ax, 1
F000:CA97		  mov	  ds:pbbe80.field_10, ax
F000:CA9A		  xor	  ax, ax
F000:CA9C		  mov	  ds:pbbe80.field_E, ax
F000:CA9F		  mov	  cx, 5A5Ah
F000:CAA2		  mov	  bp, 0
F000:CAA5
F000:CAA5 l79:							      ;	CODE XREF: reset-158Cj
F000:CAA5		  mov	  bx, 0FFFEh
F000:CAA8
F000:CAA8 l80:							      ;	CODE XREF: reset-1587j
F000:CAA8		  mov	  es, bp
F000:CAAA		  mov	  si, 0FFFEh
F000:CAAD
F000:CAAD l81:							      ;	CODE XREF: reset-15A1j
F000:CAAD		  mov	  ax, bx
F000:CAAF		  xor	  ax, cx
F000:CAB1		  xor	  ax, bp
F000:CAB3		  mov	  es:[bx], ax
F000:CAB6		  dec	  bx
F000:CAB7		  dec	  bx
F000:CAB8		  cmp	  bx, si
F000:CABA		  jnz	  short	l81
F000:CABC		  mov	  ax, bp
F000:CABE		  add	  ax, 1000h
F000:CAC1		  mov	  bp, ax
F000:CAC3		  mov	  ax, ds:pbbe80.field_B
F000:CAC6		  add	  ax, 1000h
F000:CAC9		  cmp	  ax, bp
F000:CACB		  jz	  short	l82
F000:CACD		  jb	  short	l83
F000:CACF		  jmp	  short	l79
F000:CAD1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CAD1
F000:CAD1 l82:							      ;	CODE XREF: reset-1590j
F000:CAD1		  mov	  bx, 0BFFEh
F000:CAD4		  jmp	  short	l80
F000:CAD6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CAD6
F000:CAD6 l83:							      ;	CODE XREF: reset-158Ej
F000:CAD6		  mov	  bp, 0
F000:CAD9
F000:CAD9 l84:							      ;	CODE XREF: reset-1554j
F000:CAD9		  mov	  bx, 0FFFEh
F000:CADC
F000:CADC l85:							      ;	CODE XREF: reset-154Fj
F000:CADC		  mov	  es, bp
F000:CADE
F000:CADE l86:							      ;	CODE XREF: reset-1566j
F000:CADE		  mov	  ax, bx
F000:CAE0		  xor	  ax, cx
F000:CAE2		  xor	  ax, bp
F000:CAE4		  mov	  si, ax
F000:CAE6		  mov	  di, es:[bx]
F000:CAE9		  cmp	  si, di
F000:CAEB		  jz	  short	l87
F000:CAED		  call	  sub_FCB8E
F000:CAF0
F000:CAF0 l87:							      ;	CODE XREF: reset-1570j
F000:CAF0		  dec	  bx
F000:CAF1		  dec	  bx
F000:CAF2		  cmp	  bx, 0FFFEh
F000:CAF5		  jnz	  short	l86
F000:CAF7		  add	  bp, 1000h
F000:CAFB		  mov	  ax, ds:pbbe80.field_B
F000:CAFE		  add	  ax, 1000h
F000:CB01		  cmp	  ax, bp
F000:CB03		  jz	  short	l88
F000:CB05		  jb	  short	l89
F000:CB07		  jmp	  short	l84
F000:CB09 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CB09
F000:CB09 l88:							      ;	CODE XREF: reset-1558j
F000:CB09		  mov	  bx, 0BFFEh
F000:CB0C		  jmp	  short	l85
F000:CB0E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CB0E
F000:CB0E l89:							      ;	CODE XREF: reset-1556j
F000:CB0E		  cld
F000:CB0F		  mov	  bp, 0
F000:CB12
F000:CB12 l90:							      ;	CODE XREF: reset-152Dj
F000:CB12		  mov	  cx, 8000h
F000:CB15
F000:CB15 l91:							      ;	CODE XREF: reset-1528j
F000:CB15		  mov	  es, bp
F000:CB17		  mov	  di, 0
F000:CB1A		  xor	  ax, ax
F000:CB1C		  rep stosw
F000:CB1E		  add	  bp, 1000h
F000:CB22		  mov	  ax, ds:pbbe80.field_B
F000:CB25		  add	  ax, 1000h
F000:CB28		  cmp	  ax, bp
F000:CB2A		  jz	  short	l92
F000:CB2C		  jb	  short	l93
F000:CB2E		  jmp	  short	l90
F000:CB30 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CB30
F000:CB30 l92:							      ;	CODE XREF: reset-1531j
F000:CB30		  mov	  cx, 5FFEh
F000:CB33		  jmp	  short	l91
F000:CB35 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CB35
F000:CB35 l93:							      ;	CODE XREF: reset-152Fj
F000:CB35		  mov	  ax, 0BBE8h
F000:CB38		  mov	  ds, ax			      ;	ds = 0xbbe8
F000:CB3A		  mov	  ax, ds:pbbe80.field_10
F000:CB3D		  cmp	  ax, 1
F000:CB40		  jnz	  short	halt
F000:CB42		  jmp	  _reset_cont
F000:CB45 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CB45
F000:CB45 halt:							      ;	CODE XREF: reset-151Bj
F000:CB45							      ;	reset:haltj
F000:CB45		  jmp	  short	halt
F000:CB45 ; END	OF FUNCTION CHUNK FOR reset
F000:CB45 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CB47 aMemoryErrorInf db 'Memory Error Information:               Written  Read    Base   Offset',0
F000:CB47							      ;	DATA XREF: sub_FCB8E+Ao
F000:CB8E
F000:CB8E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:CB8E
F000:CB8E
F000:CB8E sub_FCB8E	  proc near				      ;	CODE XREF: reset-156Ep
F000:CB8E		  mov	  ds:pbbe80.field_10, si
F000:CB92		  mov	  si, di
F000:CB94		  push	  si
F000:CB95		  mov	  di, 14Ah
F000:CB98		  mov	  si, offset aMemoryErrorInf	      ;	"Memory	Error Information:		"...
F000:CB9B		  call	  print_asciiz
F000:CB9E		  pop	  si
F000:CB9F		  mov	  ax, ds:pbbe80.field_E
F000:CBA2		  cmp	  al, 0Fh
F000:CBA4		  jz	  short	l0
F000:CBA6		  inc	  ax
F000:CBA7		  mov	  ds:pbbe80.field_E, ax
F000:CBAA
F000:CBAA l0:							      ;	CODE XREF: sub_FCB8E+16j
F000:CBAA		  mov	  ax, ds:pbbe80.field_E
F000:CBAD		  mov	  ah, 50h ; 'P'
F000:CBAF		  mul	  ah
F000:CBB1		  mov	  di, 1ECh
F000:CBB4		  add	  di, ax
F000:CBB6		  mov	  ax, ds:pbbe80.field_10
F000:CBB9		  call	  sub_FCBD9
F000:CBBC		  add	  di, 8
F000:CBBF		  mov	  ax, si
F000:CBC1		  call	  sub_FCBD9
F000:CBC4		  add	  di, 8
F000:CBC7		  mov	  ax, bp
F000:CBC9		  call	  sub_FCBD9
F000:CBCC		  add	  di, 8
F000:CBCF		  mov	  ax, bx
F000:CBD1		  call	  sub_FCBD9
F000:CBD4		  mov	  si, ds:pbbe80.field_10
F000:CBD8		  retn
F000:CBD8 sub_FCB8E	  endp
F000:CBD8
F000:CBD9
F000:CBD9 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:CBD9
F000:CBD9
F000:CBD9 sub_FCBD9	  proc near				      ;	CODE XREF: sub_FCB8E+2Bp
F000:CBD9							      ;	sub_FCB8E+33p
F000:CBD9							      ;	sub_FCB8E+3Bp
F000:CBD9							      ;	sub_FCB8E+43p
F000:CBD9		  mov	  dx, ax
F000:CBDB		  mov	  ax, 0B800h
F000:CBDE		  mov	  es, ax			      ;	es = 0xb800
F000:CBE0		  mov	  al, dh
F000:CBE2		  shr	  al, 1
F000:CBE4		  shr	  al, 1
F000:CBE6		  shr	  al, 1
F000:CBE8		  shr	  al, 1
F000:CBEA		  and	  al, 0Fh
F000:CBEC		  add	  al, 30h ; '0'
F000:CBEE		  cmp	  al, 3Ah ; ':'
F000:CBF0		  js	  short	l0
F000:CBF2		  add	  al, 7
F000:CBF4
F000:CBF4 l0:							      ;	CODE XREF: sub_FCBD9+17j
F000:CBF4		  mov	  ah, 7
F000:CBF6		  mov	  es:[di], ax
F000:CBF9		  inc	  di
F000:CBFA		  inc	  di
F000:CBFB		  mov	  al, dh
F000:CBFD		  and	  al, 0Fh
F000:CBFF		  add	  al, 30h ; '0'
F000:CC01		  cmp	  al, 3Ah ; ':'
F000:CC03		  js	  short	l1
F000:CC05		  add	  al, 7
F000:CC07
F000:CC07 l1:							      ;	CODE XREF: sub_FCBD9+2Aj
F000:CC07		  mov	  es:[di], ax
F000:CC0A		  inc	  di
F000:CC0B		  inc	  di
F000:CC0C		  mov	  al, dl
F000:CC0E		  shr	  al, 1
F000:CC10		  shr	  al, 1
F000:CC12		  shr	  al, 1
F000:CC14		  shr	  al, 1
F000:CC16		  and	  al, 0Fh
F000:CC18		  add	  al, 30h ; '0'
F000:CC1A		  cmp	  al, 3Ah ; ':'
F000:CC1C		  js	  short	l2
F000:CC1E		  add	  al, 7
F000:CC20
F000:CC20 l2:							      ;	CODE XREF: sub_FCBD9+43j
F000:CC20		  mov	  es:[di], ax
F000:CC23		  inc	  di
F000:CC24		  inc	  di
F000:CC25		  mov	  al, dl
F000:CC27		  and	  al, 0Fh
F000:CC29		  add	  al, 30h ; '0'
F000:CC2B		  cmp	  al, 3Ah ; ':'
F000:CC2D		  js	  short	l3
F000:CC2F		  add	  al, 7
F000:CC31
F000:CC31 l3:							      ;	CODE XREF: sub_FCBD9+54j
F000:CC31		  mov	  es:[di], ax
F000:CC34		  inc	  di
F000:CC35		  inc	  di
F000:CC36		  mov	  ax, bp
F000:CC38		  mov	  es, ax
F000:CC3A		  retn
F000:CC3A sub_FCBD9	  endp
F000:CC3A
F000:CC3B
F000:CC3B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:CC3B
F000:CC3B ; print asciiz
F000:CC3B ;
F000:CC3B ; input:
F000:CC3B ;	    cs:si -> asciiz
F000:CC3B ;	0xb800:di -> destination
F000:CC3B
F000:CC3B print_asciiz	  proc near				      ;	CODE XREF: sub_FCB8E+Dp
F000:CC3B		  mov	  ax, 0B800h
F000:CC3E		  mov	  es, ax			      ;	es = 0xb800
F000:CC40		  mov	  ah, 7
F000:CC42
F000:CC42 loop:							      ;	CODE XREF: print_asciiz+14j
F000:CC42		  mov	  al, cs:[si]
F000:CC45		  or	  al, al
F000:CC47		  jz	  short	exit
F000:CC49		  mov	  es:[di], ax
F000:CC4C		  inc	  di
F000:CC4D		  inc	  di
F000:CC4E		  inc	  si
F000:CC4F		  jmp	  short	loop
F000:CC51 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CC51
F000:CC51 exit:							      ;	CODE XREF: print_asciiz+Cj
F000:CC51		  mov	  ax, bp
F000:CC53		  mov	  es, ax
F000:CC55		  retn
F000:CC55 print_asciiz	  endp
F000:CC55
F000:CC56 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CC56 ; START OF FUNCTION CHUNK FOR	reset
F000:CC56
F000:CC56 _reset_cont:						      ;	CODE XREF: reset-1519j
F000:CC56		  jmp	  reset_cont
F000:CC56 ; END	OF FUNCTION CHUNK FOR reset
F000:CC59
F000:CC59 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:CC59
F000:CC59
F000:CC59 int_13	  proc far				      ;	DATA XREF: F000:FF09o
F000:CC59
F000:CC59 ; FUNCTION CHUNK AT F000:CFB4	SIZE 00000076 BYTES
F000:CC59 ; FUNCTION CHUNK AT F000:D02B	SIZE 00000025 BYTES
F000:CC59 ; FUNCTION CHUNK AT F000:D051	SIZE 0000000A BYTES
F000:CC59 ; FUNCTION CHUNK AT F000:D05C	SIZE 0000000C BYTES
F000:CC59 ; FUNCTION CHUNK AT F000:D069	SIZE 0000000E BYTES
F000:CC59 ; FUNCTION CHUNK AT F000:D078	SIZE 00000074 BYTES
F000:CC59
F000:CC59		  call	  int_push_regs
F000:CC5C		  mov	  di, 0Ch
F000:CC5F		  nop
F000:CC60		  call	  check_valid_subfunction
F000:CC63		  jb	  short	error
F000:CC65		  push	  bx
F000:CC66		  mov	  bx, ds:p400.installed_hardware
F000:CC6A		  test	  bx, 100h			      ;	dma present ?
F000:CC6E		  pop	  bx
F000:CC6F		  jz	  short	no_dma
F000:CC71		  jmp	  word ptr cs:int_13_jmp_tbl_dma[di]
F000:CC76 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CC76
F000:CC76 no_dma:						      ;	CODE XREF: int_13+16j
F000:CC76		  jmp	  word ptr cs:int_13_jmp_tbl[di]
F000:CC76 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CC7B int_13_jmp_tbl:					      ;	DATA XREF: int_13:no_dmar
F000:CC7B		  dw offset int_13_00
F000:CC7D		  dw offset int_13_01
F000:CC7F		  dw offset int_13_02
F000:CC81		  dw offset int_13_03
F000:CC83		  dw offset int_13_04
F000:CC85		  dw offset int_13_05
F000:CC87 int_13_jmp_tbl_dma:					      ;	DATA XREF: int_13+18r
F000:CC87		  dw offset int_13_00
F000:CC89		  dw offset int_13_01
F000:CC8B		  dw offset int_13_02_dma
F000:CC8D		  dw offset int_13_03_dma
F000:CC8F		  dw offset int_13_04_dma
F000:CC91		  dw offset int_13_05_dma
F000:CC93 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CC93
F000:CC93 error:						      ;	CODE XREF: int_13+Aj
F000:CC93		  mov	  byte ptr ds:p400.diskette_last_status, 1
F000:CC98		  jmp	  exit
F000:CC9B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CC9B
F000:CC9B int_13_00:						      ;	CODE XREF: int_13+18j
F000:CC9B							      ;	int_13:no_dmaj
F000:CC9B							      ;	DATA XREF: int_13:int_13_jmp_tblo
F000:CC9B							      ;	int_13:int_13_jmp_tbl_dmao
F000:CC9B		  mov	  byte ptr ds:p400.diskette_last_status, 0
F000:CCA0		  and	  byte ptr ds:p400.diskette_recalibrate_status,	70h ; 'p'
F000:CCA5		  cli
F000:CCA6		  mov	  dl, ds:p400.diskette_motor_status
F000:CCAA		  mov	  al, 3
F000:CCAC		  test	  dl, 8
F000:CCAF		  jnz	  short	l0
F000:CCB1		  mov	  al, 2
F000:CCB3		  test	  dl, 4
F000:CCB6		  jnz	  short	l0
F000:CCB8		  mov	  al, 1
F000:CCBA		  test	  dl, 2
F000:CCBD		  jnz	  short	l0
F000:CCBF		  xor	  al, al
F000:CCC1
F000:CCC1 l0:							      ;	CODE XREF: int_13+56j
F000:CCC1							      ;	int_13+5Dj
F000:CCC1							      ;	int_13+64j
F000:CCC1		  mov	  cl, 4
F000:CCC3		  shl	  dl, cl
F000:CCC5		  and	  dl, 0F0h
F000:CCC8		  or	  al, dl
F000:CCCA		  or	  al, 8
F000:CCCC		  mov	  dx, 3F2h
F000:CCCF		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:CCCF							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:CCCF							      ;	2:   0=reset diskette controller; 1=enable controller
F000:CCCF							      ;	3:   1=enable diskette DMA and interrupts
F000:CCCF							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:CCCF							      ;
F000:CCD0		  or	  al, 4
F000:CCD2		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:CCD2							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:CCD2							      ;	2:   0=reset diskette controller; 1=enable controller
F000:CCD2							      ;	3:   1=enable diskette DMA and interrupts
F000:CCD2							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:CCD2							      ;
F000:CCD3		  sti
F000:CCD4		  call	  diskette_wait_until_op_finished
F000:CCD7		  call	  sub_FD360
F000:CCDA		  jb	  short	l4
F000:CCDC		  test	  ah, 8
F000:CCDF		  jz	  short	l1
F000:CCE1		  or	  byte ptr ds:p400.diskette_last_status, 20h
F000:CCE6		  jmp	  short	l4
F000:CCE8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CCE8
F000:CCE8 l1:							      ;	CODE XREF: int_13+86j
F000:CCE8		  mov	  al, 3
F000:CCEA		  call	  sub_FD1EB
F000:CCED		  jb	  short	l4
F000:CCEF		  xor	  bx, bx
F000:CCF1		  mov	  cx, 2
F000:CCF4		  mov	  ax, ds:p400.installed_hardware
F000:CCF7		  test	  ax, 100h			      ;	dma present?
F000:CCFA		  jz	  short	l2			      ;	no, jump
F000:CCFC		  call	  sub_FD3F7
F000:CCFF		  jmp	  short	l3
F000:CCFF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD01		  db  90h ; 
F000:CD02 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD02
F000:CD02 l2:							      ;	CODE XREF: int_13+A1j
F000:CD02		  call	  sub_FD3CA
F000:CD05
F000:CD05 l3:							      ;	CODE XREF: int_13+A6j
F000:CD05		  jb	  short	l4
F000:CD07		  xor	  ax, ax
F000:CD09		  mov	  ds:p400.diskette_last_status,	al
F000:CD0C		  clc
F000:CD0D		  jmp	  exit
F000:CD10 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD10
F000:CD10 l4:							      ;	CODE XREF: int_13+81j
F000:CD10							      ;	int_13+8Dj
F000:CD10							      ;	int_13+94j
F000:CD10							      ;	int_13:l3j
F000:CD10		  xor	  al, al
F000:CD12		  mov	  ah, ds:p400.diskette_last_status
F000:CD16		  stc
F000:CD17		  jmp	  exit
F000:CD1A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD1A
F000:CD1A int_13_01:						      ;	CODE XREF: int_13+18j
F000:CD1A							      ;	int_13:no_dmaj
F000:CD1A							      ;	DATA XREF: int_13+24o
F000:CD1A							      ;	int_13+30o
F000:CD1A		  mov	  ah, ds:p400.diskette_last_status
F000:CD1E		  mov	  al, ah
F000:CD20		  cmp	  ah, 0
F000:CD23		  jz	  short	l5
F000:CD25		  stc
F000:CD26		  jmp	  exit
F000:CD29 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD29
F000:CD29 l5:							      ;	CODE XREF: int_13+CAj
F000:CD29		  clc
F000:CD2A		  jmp	  exit
F000:CD2D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD2D
F000:CD2D int_13_02:						      ;	CODE XREF: int_13:no_dmaj
F000:CD2D							      ;	DATA XREF: int_13+26o
F000:CD2D		  mov	  ah, 46h ; 'F'
F000:CD2F		  call	  diskette_no_dma_functions
F000:CD32		  mov	  al, 0E6h ; 'æ'
F000:CD34		  jmp	  short	l6
F000:CD36 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD36
F000:CD36 int_13_03:						      ;	CODE XREF: int_13:no_dmaj
F000:CD36							      ;	DATA XREF: int_13+28o
F000:CD36		  mov	  ah, 4Ah ; 'J'
F000:CD38		  call	  diskette_no_dma_functions
F000:CD3B		  mov	  al, 0C5h ; 'Å'
F000:CD3D		  jmp	  short	l6
F000:CD3F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD3F
F000:CD3F int_13_04:						      ;	CODE XREF: int_13:no_dmaj
F000:CD3F							      ;	DATA XREF: int_13+2Ao
F000:CD3F		  mov	  ah, 42h ; 'B'
F000:CD41		  call	  diskette_no_dma_functions
F000:CD44		  mov	  al, 0E6h ; 'æ'
F000:CD46
F000:CD46 l6:							      ;	CODE XREF: int_13+DBj
F000:CD46							      ;	int_13+E4j
F000:CD46		  jnb	  short	l7
F000:CD48		  jmp	  short	l11
F000:CD48 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD4A		  db  90h ; 
F000:CD4B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD4B
F000:CD4B l7:							      ;	CODE XREF: int_13:l6j
F000:CD4B		  push	  cx
F000:CD4C		  cmp	  dl, 4
F000:CD4F		  jb	  short	l9
F000:CD51		  mov	  byte ptr ds:p400.diskette_last_status, 1
F000:CD56
F000:CD56 l8:							      ;	CODE XREF: int_13+10Bj
F000:CD56							      ;	int_13+110j
F000:CD56							      ;	int_13+121j
F000:CD56							      ;	int_13+128j
F000:CD56		  jmp	  short	l10
F000:CD56 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD58		  db  90h ; 
F000:CD59 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CD59
F000:CD59 l9:							      ;	CODE XREF: int_13+F6j
F000:CD59		  mov	  byte ptr ds:p400.diskette_last_status, 0
F000:CD5E		  call	  get_diskette_params
F000:CD61		  call	  sub_FD297
F000:CD64		  jb	  short	l8
F000:CD66		  call	  sub_FD1EB
F000:CD69		  jb	  short	l8
F000:CD6B		  mov	  al, dl
F000:CD6D		  and	  al, 3
F000:CD6F		  push	  dx
F000:CD70		  shl	  dh, 1
F000:CD72		  shl	  dh, 1
F000:CD74		  or	  al, dh
F000:CD76		  pop	  dx
F000:CD77		  call	  sub_FD1EB
F000:CD7A		  jb	  short	l8
F000:CD7C		  mov	  al, ch
F000:CD7E		  call	  sub_FD1EB
F000:CD81		  jb	  short	l8
F000:CD83		  mov	  al, dh
F000:CD85		  call	  sub_FD1EB
F000:CD88		  jb	  short	l10
F000:CD8A		  mov	  al, cl
F000:CD8C		  call	  sub_FD1EB
F000:CD8F		  jb	  short	l10
F000:CD91		  mov	  bx, 3
F000:CD94		  mov	  cx, 4
F000:CD97		  call	  sub_FD3CA
F000:CD9A		  jb	  short	l10
F000:CD9C		  call	  diskette_wait_until_op_finished
F000:CD9F		  jb	  short	l10
F000:CDA1		  mov	  cx, 7
F000:CDA4		  call	  sub_FD243
F000:CDA7		  jb	  short	l10
F000:CDA9		  pop	  cx
F000:CDAA		  test	  ah, 0C0h
F000:CDAD		  jz	  short	l11
F000:CDAF		  call	  sub_FD387
F000:CDB2		  jmp	  short	l11
F000:CDB4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDB4
F000:CDB4 l10:							      ;	CODE XREF: int_13:l8j
F000:CDB4							      ;	int_13+12Fj
F000:CDB4							      ;	int_13+136j
F000:CDB4							      ;	int_13+141j
F000:CDB4							      ;	int_13+146j
F000:CDB4							      ;	int_13+14Ej
F000:CDB4		  pop	  cx
F000:CDB5
F000:CDB5 l11:							      ;	CODE XREF: int_13+EFj
F000:CDB5							      ;	int_13+154j
F000:CDB5							      ;	int_13+159j
F000:CDB5		  xor	  al, al
F000:CDB7		  mov	  ah, ds:p400.diskette_last_status
F000:CDBB		  cmp	  ah, 0
F000:CDBE		  jz	  short	l12
F000:CDC0		  stc
F000:CDC1		  jmp	  exit
F000:CDC4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDC4
F000:CDC4 l12:							      ;	CODE XREF: int_13+165j
F000:CDC4		  clc
F000:CDC5		  jmp	  exit
F000:CDC8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDC8
F000:CDC8 int_13_02_dma:					      ;	CODE XREF: int_13+18j
F000:CDC8							      ;	int_13:no_dmaj
F000:CDC8							      ;	DATA XREF: int_13+32o
F000:CDC8		  push	  cx
F000:CDC9		  push	  ax
F000:CDCA		  call	  diskette_dma_functions
F000:CDCD		  push	  ax
F000:CDCE		  mov	  al, 0E6h ; 'æ'
F000:CDD0		  jmp	  short	l13
F000:CDD0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDD2		  db  90h ; 
F000:CDD3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDD3
F000:CDD3 int_13_03_dma:					      ;	CODE XREF: int_13+18j
F000:CDD3							      ;	int_13:no_dmaj
F000:CDD3							      ;	DATA XREF: int_13+34o
F000:CDD3		  push	  cx
F000:CDD4		  push	  ax
F000:CDD5		  call	  diskette_dma_functions
F000:CDD8		  push	  ax
F000:CDD9		  mov	  al, 0C5h ; 'Å'
F000:CDDB		  jmp	  short	l13
F000:CDDB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDDD		  db  90h ; 
F000:CDDE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDDE
F000:CDDE int_13_04_dma:					      ;	CODE XREF: int_13+18j
F000:CDDE							      ;	int_13:no_dmaj
F000:CDDE							      ;	DATA XREF: int_13+36o
F000:CDDE		  push	  cx
F000:CDDF		  push	  ax
F000:CDE0		  call	  diskette_dma_functions
F000:CDE3		  push	  ax
F000:CDE4		  mov	  al, 0E6h ; 'æ'
F000:CDE6
F000:CDE6 l13:							      ;	CODE XREF: int_13+177j
F000:CDE6							      ;	int_13+182j
F000:CDE6		  jnb	  short	l14
F000:CDE8		  jmp	  l38
F000:CDEB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDEB
F000:CDEB l14:							      ;	CODE XREF: int_13:l13j
F000:CDEB		  push	  es
F000:CDEC		  push	  bx
F000:CDED		  cmp	  dl, 4
F000:CDF0		  jb	  short	l16
F000:CDF2		  mov	  byte ptr ds:p400.diskette_last_status, 1
F000:CDF7		  jmp	  short	l15
F000:CDF7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDF9		  db  90h ; 
F000:CDFA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDFA
F000:CDFA l15:							      ;	CODE XREF: int_13+19Ej
F000:CDFA							      ;	int_13+1AFj
F000:CDFA							      ;	int_13+1B4j
F000:CDFA							      ;	int_13+1C5j
F000:CDFA							      ;	int_13+1CCj
F000:CDFA							      ;	int_13+1D3j ...
F000:CDFA		  jmp	  l37
F000:CDFD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CDFD
F000:CDFD l16:							      ;	CODE XREF: int_13+197j
F000:CDFD		  mov	  byte ptr ds:p400.diskette_last_status, 0
F000:CE02		  call	  get_diskette_params
F000:CE05		  call	  sub_FD297
F000:CE08		  jb	  short	l15
F000:CE0A		  call	  sub_FD1EB
F000:CE0D		  jb	  short	l15
F000:CE0F		  mov	  al, dl
F000:CE11		  and	  al, 3
F000:CE13		  push	  dx
F000:CE14		  shl	  dh, 1
F000:CE16		  shl	  dh, 1
F000:CE18		  or	  al, dh
F000:CE1A		  pop	  dx
F000:CE1B		  call	  sub_FD1EB
F000:CE1E		  jb	  short	l15
F000:CE20		  mov	  al, ch
F000:CE22		  call	  sub_FD1EB
F000:CE25		  jb	  short	l15
F000:CE27		  mov	  al, dh
F000:CE29		  call	  sub_FD1EB
F000:CE2C		  jb	  short	l15
F000:CE2E		  mov	  al, cl
F000:CE30		  call	  sub_FD1EB
F000:CE33		  jb	  short	l15
F000:CE35		  mov	  bx, 3
F000:CE38		  mov	  cx, 4
F000:CE3B		  call	  sub_FD3DC
F000:CE3E		  jb	  short	l15
F000:CE40		  mov	  al, ds:p400.diskette_motor_status
F000:CE43		  mov	  cl, 4
F000:CE45		  shl	  al, cl
F000:CE47		  or	  al, 4Ch
F000:CE49		  or	  al, dl
F000:CE4B		  mov	  dl, al
F000:CE4D		  pop	  bx
F000:CE4E		  pop	  es
F000:CE4F		  pop	  cx
F000:CE50		  pop	  ax
F000:CE51		  push	  dx
F000:CE52		  mov	  di, bx
F000:CE54		  mov	  si, bx
F000:CE56		  mov	  bh, 20h ; ' '
F000:CE58		  cmp	  ah, 4
F000:CE5B		  jnz	  short	l17
F000:CE5D		  jmp	  short	l27
F000:CE5D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE5F		  db  90h ; 
F000:CE60 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE60
F000:CE60 l17:							      ;	CODE XREF: int_13+202j
F000:CE60		  cmp	  ah, 3
F000:CE63		  jz	  short	l22
F000:CE65		  mov	  al, dh
F000:CE67		  mov	  dx, 3F5h
F000:CE6A		  cli
F000:CE6B		  out	  dx, al			      ;	Floppy:	FDC command/data register.
F000:CE6C		  mov	  dx, 3F4h
F000:CE6F		  mov	  ah, 80h ; '€'
F000:CE71		  jmp	  short	l19
F000:CE71 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE73		  db  90h ; 
F000:CE74 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE74
F000:CE74 l18:							      ;	CODE XREF: int_13+22Bj
F000:CE74		  loop	  l20
F000:CE76		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:CE7B		  jmp	  l35
F000:CE7E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE7E
F000:CE7E l19:							      ;	CODE XREF: int_13+218j
F000:CE7E							      ;	int_13+236j
F000:CE7E		  push	  cx
F000:CE7F		  xor	  cx, cx
F000:CE81
F000:CE81 l20:							      ;	CODE XREF: int_13:l18j
F000:CE81		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:CE81							      ;	0-3: diskette busy
F000:CE81							      ;	4: 1=cntrlr busy
F000:CE81							      ;	5: 1=non-DMA mode
F000:CE81							      ;	6: Data	dir: 1=cntrlr to CPU
F000:CE81							      ;	7: 1=OK	to snd/rcv cmd or data
F000:CE82		  test	  al, ah
F000:CE84		  jz	  short	l18
F000:CE86		  test	  al, bh
F000:CE88		  jz	  short	l21
F000:CE8A		  inc	  dx
F000:CE8B		  in	  al, dx			      ;	Floppy:	FDC command/data register.
F000:CE8C		  stosb
F000:CE8D		  pop	  cx
F000:CE8E		  dec	  dx
F000:CE8F		  loop	  l19
F000:CE91		  jmp	  short	l34
F000:CE91 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE93		  db  90h ; 
F000:CE94 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE94
F000:CE94 l21:							      ;	CODE XREF: int_13+22Fj
F000:CE94		  pop	  cx
F000:CE95		  jmp	  short	l34
F000:CE95 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE97		  db  90h ; 
F000:CE98 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CE98
F000:CE98 l22:							      ;	CODE XREF: int_13+20Aj
F000:CE98		  mov	  al, dh
F000:CE9A		  mov	  dx, 3F5h
F000:CE9D		  cli
F000:CE9E		  out	  dx, al			      ;	Floppy:	FDC command/data register.
F000:CE9F		  dec	  dx
F000:CEA0		  mov	  ah, 80h ; '€'
F000:CEA2		  jmp	  short	l24
F000:CEA2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEA4		  db  90h ; 
F000:CEA5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEA5
F000:CEA5 l23:							      ;	CODE XREF: int_13+25Cj
F000:CEA5		  loop	  l25
F000:CEA7		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:CEAC		  jmp	  short	l35
F000:CEAC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEAE		  db  90h ; 
F000:CEAF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEAF
F000:CEAF l24:							      ;	CODE XREF: int_13+249j
F000:CEAF							      ;	int_13+268j
F000:CEAF		  push	  cx
F000:CEB0		  xor	  cx, cx
F000:CEB2
F000:CEB2 l25:							      ;	CODE XREF: int_13:l23j
F000:CEB2		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:CEB2							      ;	0-3: diskette busy
F000:CEB2							      ;	4: 1=cntrlr busy
F000:CEB2							      ;	5: 1=non-DMA mode
F000:CEB2							      ;	6: Data	dir: 1=cntrlr to CPU
F000:CEB2							      ;	7: 1=OK	to snd/rcv cmd or data
F000:CEB3		  test	  al, ah
F000:CEB5		  jz	  short	l23
F000:CEB7		  test	  al, bh
F000:CEB9		  jz	  short	l26
F000:CEBB		  lods	  byte ptr es:[si]
F000:CEBD		  inc	  dx
F000:CEBE		  out	  dx, al			      ;	Floppy:	FDC command/data register.
F000:CEBF		  pop	  cx
F000:CEC0		  dec	  dx
F000:CEC1		  loop	  l24
F000:CEC3		  jmp	  short	l34
F000:CEC3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEC5		  db  90h ; 
F000:CEC6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEC6
F000:CEC6 l26:							      ;	CODE XREF: int_13+260j
F000:CEC6		  pop	  cx
F000:CEC7		  jmp	  short	l34
F000:CEC7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEC9		  db  90h ; 
F000:CECA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CECA
F000:CECA l27:							      ;	CODE XREF: int_13+204j
F000:CECA		  mov	  al, dh
F000:CECC		  mov	  dx, 3F5h
F000:CECF		  cli
F000:CED0		  out	  dx, al			      ;	Floppy:	FDC command/data register.
F000:CED1		  mov	  ah, 80h ; '€'
F000:CED3		  dec	  dx
F000:CED4		  push	  cx
F000:CED5		  xor	  cx, cx
F000:CED7
F000:CED7 l28:							      ;	CODE XREF: int_13+283j
F000:CED7		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:CED7							      ;	0-3: diskette busy
F000:CED7							      ;	4: 1=cntrlr busy
F000:CED7							      ;	5: 1=non-DMA mode
F000:CED7							      ;	6: Data	dir: 1=cntrlr to CPU
F000:CED7							      ;	7: 1=OK	to snd/rcv cmd or data
F000:CED8		  test	  al, 80h
F000:CEDA		  jnz	  short	l29
F000:CEDC		  loop	  l28
F000:CEDE		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:CEE3		  jmp	  short	l35
F000:CEE3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEE5		  db  90h ; 
F000:CEE6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEE6
F000:CEE6 l29:							      ;	CODE XREF: int_13+281j
F000:CEE6		  test	  al, 20h
F000:CEE8		  jnz	  short	l32
F000:CEEA		  jmp	  short	l33
F000:CEEA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEEC		  db  90h ; 
F000:CEED ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEED
F000:CEED l30:							      ;	CODE XREF: int_13+2AAj
F000:CEED		  push	  cx
F000:CEEE		  xor	  cx, cx
F000:CEF0
F000:CEF0 l31:							      ;	CODE XREF: int_13+29Cj
F000:CEF0		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:CEF0							      ;	0-3: diskette busy
F000:CEF0							      ;	4: 1=cntrlr busy
F000:CEF0							      ;	5: 1=non-DMA mode
F000:CEF0							      ;	6: Data	dir: 1=cntrlr to CPU
F000:CEF0							      ;	7: 1=OK	to snd/rcv cmd or data
F000:CEF1		  test	  al, 80h
F000:CEF3		  jnz	  short	l32
F000:CEF5		  loop	  l31
F000:CEF7		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:CEFC		  jmp	  short	l35
F000:CEFC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEFE		  db  90h ; 
F000:CEFF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CEFF
F000:CEFF l32:							      ;	CODE XREF: int_13+28Fj
F000:CEFF							      ;	int_13+29Aj
F000:CEFF		  inc	  dx
F000:CF00		  in	  al, dx			      ;	Floppy:	FDC command/data register.
F000:CF01		  pop	  cx
F000:CF02		  dec	  dx
F000:CF03		  loop	  l30
F000:CF05		  jmp	  short	l34
F000:CF05 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF07		  db  90h ; 
F000:CF08 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF08
F000:CF08 l33:							      ;	CODE XREF: int_13+291j
F000:CF08		  pop	  cx
F000:CF09
F000:CF09 l34:							      ;	CODE XREF: int_13+238j
F000:CF09							      ;	int_13+23Cj
F000:CF09							      ;	int_13+26Aj
F000:CF09							      ;	int_13+26Ej
F000:CF09							      ;	int_13+2ACj
F000:CF09		  pop	  ax
F000:CF0A		  mov	  dx, 3F2h
F000:CF0D		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:CF0D							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:CF0D							      ;	2:   0=reset diskette controller; 1=enable controller
F000:CF0D							      ;	3:   1=enable diskette DMA and interrupts
F000:CF0D							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:CF0D							      ;
F000:CF0E		  and	  al, 0BFh
F000:CF10		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:CF10							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:CF10							      ;	2:   0=reset diskette controller; 1=enable controller
F000:CF10							      ;	3:   1=enable diskette DMA and interrupts
F000:CF10							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:CF10							      ;
F000:CF11		  sti
F000:CF12		  call	  diskette_wait_until_ready
F000:CF15		  jb	  short	l36
F000:CF17		  mov	  cx, 7
F000:CF1A		  call	  sub_FD243
F000:CF1D		  jb	  short	l36
F000:CF1F		  pop	  cx
F000:CF20		  test	  ah, 0C0h
F000:CF23		  jz	  short	l39
F000:CF25		  call	  sub_FD387
F000:CF28		  jmp	  short	l39
F000:CF28 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF2A		  db  90h ; 
F000:CF2B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF2B
F000:CF2B l35:							      ;	CODE XREF: int_13+222j
F000:CF2B							      ;	int_13+253j
F000:CF2B							      ;	int_13+28Aj
F000:CF2B							      ;	int_13+2A3j
F000:CF2B		  pop	  cx
F000:CF2C		  pop	  dx
F000:CF2D
F000:CF2D l36:							      ;	CODE XREF: int_13+2BCj
F000:CF2D							      ;	int_13+2C4j
F000:CF2D		  pop	  cx
F000:CF2E		  jmp	  short	l39
F000:CF2E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF30		  db  90h ; 
F000:CF31 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF31
F000:CF31 l37:							      ;	CODE XREF: int_13:l15j
F000:CF31		  pop	  bx
F000:CF32		  pop	  es
F000:CF33		  pop	  ax
F000:CF34		  pop	  ax
F000:CF35		  pop	  cx
F000:CF36		  jmp	  short	l39
F000:CF36 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF38		  db  90h ; 
F000:CF39 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF39
F000:CF39 l38:							      ;	CODE XREF: int_13+18Fj
F000:CF39		  pop	  ax
F000:CF3A		  pop	  ax
F000:CF3B		  pop	  cx
F000:CF3C
F000:CF3C l39:							      ;	CODE XREF: int_13+2CAj
F000:CF3C							      ;	int_13+2CFj
F000:CF3C							      ;	int_13+2D5j
F000:CF3C							      ;	int_13+2DDj
F000:CF3C		  xor	  al, al
F000:CF3E		  mov	  ah, ds:p400.diskette_last_status
F000:CF42		  cmp	  ah, 0
F000:CF45		  jz	  short	ok
F000:CF47		  stc
F000:CF48		  jmp	  exit
F000:CF4B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF4B
F000:CF4B ok:							      ;	CODE XREF: int_13+2ECj
F000:CF4B		  clc
F000:CF4C		  jmp	  exit
F000:CF4C int_13	  endp
F000:CF4C
F000:CF4F
F000:CF4F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:CF4F
F000:CF4F ; Attributes:	bp-based frame
F000:CF4F
F000:CF4F diskette_dma_functions proc near			      ;	CODE XREF: int_13+171p
F000:CF4F							      ;	int_13+17Cp
F000:CF4F							      ;	int_13+187p
F000:CF4F							      ;	int_13+36Dp
F000:CF4F		  push	  cx
F000:CF50		  push	  dx
F000:CF51		  push	  es
F000:CF52		  push	  bx
F000:CF53		  push	  ax
F000:CF54		  mov	  al, 6
F000:CF56		  out	  0Fh, al			      ;	DMA controller,	8237A-5.
F000:CF56							      ;	master clear. Clear or mask any	or
F000:CF56							      ;	all of the channels. Bits:
F000:CF56							      ;	0: 1=mask channel 0; 0=enable
F000:CF56							      ;	1: 1=mask channel 1;
F000:CF56							      ;	2: 1=mask channel 2;
F000:CF56							      ;	3: 1=mask channel 3;
F000:CF58		  mov	  bp, sp
F000:CF5A		  call	  get_diskette_params
F000:CF5D		  mov	  cl, es:[si+3]
F000:CF61		  mov	  dx, 80h ; '€'
F000:CF64		  shl	  dx, cl
F000:CF66		  mov	  ax, [bp+0]
F000:CF69		  xor	  ah, ah
F000:CF6B		  mul	  dx
F000:CF6D		  cmp	  dx, 0
F000:CF70		  jnz	  short	loc_FCFA8
F000:CF72		  mov	  dx, bx
F000:CF74		  add	  bx, ax
F000:CF76		  jb	  short	loc_FCF7C
F000:CF78		  clc
F000:CF79		  jmp	  short	loc_FCFAE
F000:CF79 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF7B		  db  90h ; 
F000:CF7C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CF7C
F000:CF7C loc_FCF7C:						      ;	CODE XREF: diskette_dma_functions+27j
F000:CF7C		  mov	  bx, dx
F000:CF7E		  and	  bx, 0Fh
F000:CF82		  add	  bx, ax
F000:CF84		  jb	  short	loc_FCFAE
F000:CF86		  pop	  cx
F000:CF87		  pop	  cx
F000:CF88		  pop	  es
F000:CF89		  mov	  bx, dx
F000:CF8B		  mov	  cl, 4
F000:CF8D		  shr	  bx, cl
F000:CF8F		  mov	  cx, es
F000:CF91		  add	  cx, bx
F000:CF93		  jb	  short	loc_FCFA1
F000:CF95		  mov	  es, cx
F000:CF97		  mov	  bx, dx
F000:CF99		  and	  bx, 0Fh
F000:CF9D		  clc
F000:CF9E
F000:CF9E loc_FCF9E:						      ;	CODE XREF: diskette_dma_functions+57j
F000:CF9E		  pop	  dx
F000:CF9F		  pop	  cx
F000:CFA0		  retn
F000:CFA1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CFA1
F000:CFA1 loc_FCFA1:						      ;	CODE XREF: diskette_dma_functions+44j
F000:CFA1		  mov	  byte ptr ds:p400.diskette_last_status, 9
F000:CFA6		  jmp	  short	loc_FCF9E
F000:CFA8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CFA8
F000:CFA8 loc_FCFA8:						      ;	CODE XREF: diskette_dma_functions+21j
F000:CFA8		  stc
F000:CFA9		  mov	  byte ptr ds:p400.diskette_last_status, 9
F000:CFAE
F000:CFAE loc_FCFAE:						      ;	CODE XREF: diskette_dma_functions+2Aj
F000:CFAE							      ;	diskette_dma_functions+35j
F000:CFAE		  pop	  bx
F000:CFAF		  pop	  bx
F000:CFB0		  pop	  es
F000:CFB1		  pop	  dx
F000:CFB2		  pop	  cx
F000:CFB3		  retn
F000:CFB3 diskette_dma_functions endp
F000:CFB3
F000:CFB4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CFB4 ; START OF FUNCTION CHUNK FOR	int_13
F000:CFB4
F000:CFB4 int_13_05_dma:					      ;	CODE XREF: int_13+18j
F000:CFB4							      ;	int_13:no_dmaj
F000:CFB4							      ;	DATA XREF: int_13+38o
F000:CFB4		  cmp	  dl, 4
F000:CFB7		  jb	  short	l40
F000:CFB9		  mov	  byte ptr ds:p400.diskette_last_status, 1
F000:CFBE		  jmp	  l46
F000:CFC1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CFC1
F000:CFC1 l40:							      ;	CODE XREF: int_13+35Ej
F000:CFC1		  mov	  byte ptr ds:p400.diskette_last_status, 0
F000:CFC6		  call	  diskette_dma_functions
F000:CFC9		  push	  ax
F000:CFCA		  push	  es
F000:CFCB		  push	  bx
F000:CFCC		  jnb	  short	l42
F000:CFCE
F000:CFCE l41:							      ;	CODE XREF: int_13+37Ej
F000:CFCE							      ;	int_13+385j
F000:CFCE		  jmp	  l47
F000:CFD1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:CFD1
F000:CFD1 l42:							      ;	CODE XREF: int_13+373j
F000:CFD1		  call	  get_diskette_params
F000:CFD4		  call	  sub_FD297
F000:CFD7		  jb	  short	l41
F000:CFD9		  mov	  al, 4Dh ; 'M'
F000:CFDB		  call	  sub_FD1EB
F000:CFDE		  jb	  short	l41
F000:CFE0		  mov	  al, dl
F000:CFE2		  and	  al, 3
F000:CFE4		  shl	  dh, 1
F000:CFE6		  shl	  dh, 1
F000:CFE8		  or	  al, dh
F000:CFEA		  call	  sub_FD1EB
F000:CFED		  jb	  short	l47
F000:CFEF		  mov	  bx, 3
F000:CFF2		  mov	  cx, 2
F000:CFF5		  call	  sub_FD3CA
F000:CFF8		  jb	  short	l47
F000:CFFA		  dec	  bx
F000:CFFB		  mov	  dl, es:[bx+si]
F000:CFFE		  cli
F000:CFFF		  mov	  bx, 7
F000:D002		  call	  sub_FD3DC
F000:D005		  jb	  short	l47
F000:D007		  pop	  bx
F000:D008		  pop	  es
F000:D009		  pop	  cx
F000:D00A		  mov	  al, 4
F000:D00C		  mul	  dl
F000:D00E		  mov	  cx, ax
F000:D010		  mov	  al, dh
F000:D012		  mov	  ah, 80h ; '€'
F000:D014		  mov	  dx, 3F5h
F000:D017		  out	  dx, al			      ;	Floppy:	FDC command/data register.
F000:D018
F000:D018 l43:							      ;	CODE XREF: int_13+3D9j
F000:D018		  push	  cx
F000:D019		  xor	  cx, cx
F000:D01B		  dec	  dx
F000:D01C
F000:D01C l44:							      ;	CODE XREF: int_13+3C8j
F000:D01C		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D01C							      ;	0-3: diskette busy
F000:D01C							      ;	4: 1=cntrlr busy
F000:D01C							      ;	5: 1=non-DMA mode
F000:D01C							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D01C							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D01D		  test	  al, ah
F000:D01F		  jnz	  short	l45
F000:D021		  loop	  l44
F000:D023		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:D028		  jmp	  short	l48
F000:D028 ; END	OF FUNCTION CHUNK FOR int_13
F000:D028 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D02A		  db  90h ; 
F000:D02B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D02B ; START OF FUNCTION CHUNK FOR	int_13
F000:D02B
F000:D02B l45:							      ;	CODE XREF: int_13+3C6j
F000:D02B		  mov	  al, es:[bx]
F000:D02E		  inc	  dx
F000:D02F		  out	  dx, al			      ;	Floppy:	FDC command/data register.
F000:D030		  inc	  bx
F000:D031		  pop	  cx
F000:D032		  loop	  l43
F000:D034		  call	  diskette_wait_until_ready
F000:D037		  mov	  cx, 7
F000:D03A		  call	  sub_FD243
F000:D03D		  jb	  short	l49
F000:D03F		  test	  ah, 0C0h
F000:D042		  jz	  short	exit_ok
F000:D044		  call	  sub_FD387
F000:D047		  jmp	  short	l49
F000:D049 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D049
F000:D049 l46:							      ;	CODE XREF: int_13+365j
F000:D049		  mov	  ah, ds:p400.diskette_last_status
F000:D04D		  clc
F000:D04E		  jmp	  short	exit
F000:D04E ; END	OF FUNCTION CHUNK FOR int_13
F000:D04E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D050		  db  90h ; 
F000:D051 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D051 ; START OF FUNCTION CHUNK FOR	int_13
F000:D051
F000:D051 l47:							      ;	CODE XREF: int_13:l41j
F000:D051							      ;	int_13+394j
F000:D051							      ;	int_13+39Fj
F000:D051							      ;	int_13+3ACj
F000:D051		  pop	  bx
F000:D052		  pop	  es
F000:D053
F000:D053 l48:							      ;	CODE XREF: int_13+3CFj
F000:D053		  pop	  ax
F000:D054
F000:D054 l49:							      ;	CODE XREF: int_13+3E4j
F000:D054							      ;	int_13+3EEj
F000:D054		  mov	  ah, ds:p400.diskette_last_status
F000:D058		  stc
F000:D059		  jmp	  short	exit
F000:D059 ; END	OF FUNCTION CHUNK FOR int_13
F000:D059 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D05B		  db  90h ; 
F000:D05C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D05C ; START OF FUNCTION CHUNK FOR	int_13
F000:D05C
F000:D05C int_13_05:						      ;	CODE XREF: int_13:no_dmaj
F000:D05C							      ;	DATA XREF: int_13+2Co
F000:D05C		  cmp	  dl, 4
F000:D05F		  jb	  short	l50
F000:D061		  mov	  byte ptr ds:p400.diskette_last_status, 1
F000:D066		  jmp	  short	exit_ok
F000:D066 ; END	OF FUNCTION CHUNK FOR int_13
F000:D066 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D068		  db  90h ; 
F000:D069 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D069 ; START OF FUNCTION CHUNK FOR	int_13
F000:D069
F000:D069 l50:							      ;	CODE XREF: int_13+406j
F000:D069		  mov	  byte ptr ds:p400.diskette_last_status, 0
F000:D06E		  mov	  ah, 4Ah ; 'J'
F000:D070		  call	  diskette_no_dma_functions
F000:D073		  jnb	  short	l51
F000:D075		  jmp	  short	exit_error
F000:D075 ; END	OF FUNCTION CHUNK FOR int_13
F000:D075 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D077		  db  90h ; 
F000:D078 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D078 ; START OF FUNCTION CHUNK FOR	int_13
F000:D078
F000:D078 l51:							      ;	CODE XREF: int_13+41Aj
F000:D078		  call	  get_diskette_params
F000:D07B		  call	  sub_FD297
F000:D07E		  jb	  short	exit_error
F000:D080		  mov	  al, 4Dh ; 'M'
F000:D082		  call	  sub_FD1EB
F000:D085		  jb	  short	exit_error
F000:D087		  mov	  al, dl
F000:D089		  and	  al, 3
F000:D08B		  shl	  dh, 1
F000:D08D		  shl	  dh, 1
F000:D08F		  or	  al, dh
F000:D091		  call	  sub_FD1EB
F000:D094		  jb	  short	exit_error
F000:D096		  mov	  bx, 3
F000:D099		  mov	  cx, 2
F000:D09C		  call	  sub_FD3CA
F000:D09F		  jb	  short	exit_error
F000:D0A1		  mov	  bx, 7
F000:D0A4		  call	  sub_FD3CA
F000:D0A7		  jb	  short	exit_error
F000:D0A9		  call	  diskette_wait_until_op_finished
F000:D0AC		  jb	  short	exit_error
F000:D0AE		  mov	  cx, 7
F000:D0B1		  call	  sub_FD243
F000:D0B4		  jb	  short	exit_error
F000:D0B6		  test	  ah, 0C0h
F000:D0B9		  jz	  short	exit_ok
F000:D0BB		  call	  sub_FD387
F000:D0BE		  jmp	  short	exit_error
F000:D0C0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D0C0
F000:D0C0 exit_ok:						      ;	CODE XREF: int_13+3E9j
F000:D0C0							      ;	int_13+40Dj
F000:D0C0							      ;	int_13+460j
F000:D0C0		  mov	  ah, ds:p400.diskette_last_status
F000:D0C4		  clc
F000:D0C5		  jmp	  short	exit
F000:D0C7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D0C7
F000:D0C7 exit_error:						      ;	CODE XREF: int_13+41Cj
F000:D0C7							      ;	int_13+425j
F000:D0C7							      ;	int_13+42Cj
F000:D0C7							      ;	int_13+43Bj
F000:D0C7							      ;	int_13+446j
F000:D0C7							      ;	int_13+44Ej ...
F000:D0C7		  mov	  ah, ds:p400.diskette_last_status
F000:D0CB		  stc
F000:D0CC
F000:D0CC exit:							      ;	CODE XREF: int_13+3Fj
F000:D0CC							      ;	int_13+B4j
F000:D0CC							      ;	int_13+BEj
F000:D0CC							      ;	int_13+CDj
F000:D0CC							      ;	int_13+D1j
F000:D0CC							      ;	int_13+168j ...
F000:D0CC		  pushf
F000:D0CD		  push	  ax
F000:D0CE		  call	  get_diskette_params
F000:D0D1		  mov	  al, es:[si+2]
F000:D0D5		  cli
F000:D0D6		  mov	  ds:p400.diskette_motor_off_timeout, al
F000:D0D9		  sti
F000:D0DA		  pop	  ax
F000:D0DB		  and	  byte ptr ds:p400.diskette_recalibrate_status,	7Fh
F000:D0E0		  popf
F000:D0E1		  pop	  es
F000:D0E2		  pop	  ds
F000:D0E3		  pop	  bp
F000:D0E4		  pop	  di
F000:D0E5		  pop	  si
F000:D0E6		  pop	  dx
F000:D0E7		  pop	  cx
F000:D0E8		  pop	  bx
F000:D0E9		  retf	  2
F000:D0E9 ; END	OF FUNCTION CHUNK FOR int_13
F000:D0EC
F000:D0EC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D0EC
F000:D0EC ; this interrupt is generated	by the floppy disk controller on
F000:D0EC ; completion of an operation
F000:D0EC
F000:D0EC int_0e	  proc far				      ;	DATA XREF: F000:FEFFo
F000:D0EC		  push	  ax
F000:D0ED		  push	  dx
F000:D0EE		  push	  ds
F000:D0EF		  mov	  ax, 40h ; '@'
F000:D0F2		  mov	  ds, ax			      ;	ds = 0x40
F000:D0F4		  or	  byte ptr ds:p400.diskette_recalibrate_status,	80h ; signal that interrupt was	triggered
F000:D0F9		  mov	  al, 20h ; ' '
F000:D0FB		  mov	  dx, 20h ; ' '
F000:D0FE		  out	  dx, al			      ;	Interrupt controller, 8259A.
F000:D0FF		  pop	  ds
F000:D100		  pop	  dx
F000:D101		  pop	  ax
F000:D102		  iret
F000:D102 int_0e	  endp
F000:D102
F000:D103
F000:D103 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D103
F000:D103
F000:D103 diskette_wait_until_op_finished proc near		      ;	CODE XREF: int_13+7Bp
F000:D103							      ;	int_13+143p
F000:D103							      ;	int_13+450p
F000:D103							      ;	sub_FD297+67p
F000:D103							      ;	sub_FD297+97p
F000:D103		  push	  cx
F000:D104		  mov	  cx, 2
F000:D107		  xor	  bx, bx
F000:D109
F000:D109 l0:							      ;	CODE XREF: diskette_wait_until_op_finished+11j
F000:D109							      ;	diskette_wait_until_op_finished+13j
F000:D109		  test	  byte ptr ds:p400.diskette_recalibrate_status,	80h ; interrupt	triggered?
F000:D10E		  jnz	  short	ok			      ;	yes, exit
F000:D110		  dec	  bx
F000:D111		  cmp	  bx, 0
F000:D114		  jnz	  short	l0
F000:D116		  loop	  l0
F000:D118		  or	  byte ptr ds:p400.diskette_last_status, 80h ; timeout
F000:D11D		  stc
F000:D11E		  jmp	  short	exit
F000:D120 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D120
F000:D120 ok:							      ;	CODE XREF: diskette_wait_until_op_finished+Bj
F000:D120		  and	  byte ptr ds:p400.diskette_recalibrate_status,	7Fh ; mask off "interrupt triggered"
F000:D125		  clc
F000:D126
F000:D126 exit:							      ;	CODE XREF: diskette_wait_until_op_finished+1Bj
F000:D126		  pop	  cx
F000:D127		  retn
F000:D127 diskette_wait_until_op_finished endp
F000:D127
F000:D128
F000:D128 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D128
F000:D128
F000:D128 diskette_wait_until_ready proc near			      ;	CODE XREF: int_13+2B9p
F000:D128							      ;	int_13+3DBp
F000:D128		  push	  dx
F000:D129		  push	  ax
F000:D12A		  push	  cx
F000:D12B		  mov	  cx, 2
F000:D12E		  xor	  bx, bx
F000:D130		  mov	  dx, 3F4h
F000:D133
F000:D133 l0:							      ;	CODE XREF: diskette_wait_until_ready+14j
F000:D133							      ;	diskette_wait_until_ready+16j
F000:D133							      ;	diskette_wait_until_ready+28j
F000:D133		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D133							      ;	0-3: diskette busy
F000:D133							      ;	4: 1=cntrlr busy
F000:D133							      ;	5: 1=non-DMA mode
F000:D133							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D133							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D134		  test	  al, 80h
F000:D136		  jnz	  short	l1
F000:D138		  dec	  bx
F000:D139		  cmp	  bx, 0
F000:D13C		  jnz	  short	l0			      ;	wait until Ok to snd/rcv cmd/data
F000:D13E		  loop	  l0
F000:D140		  or	  byte ptr ds:p400.diskette_last_status, 80h ; timeout flag
F000:D145		  stc
F000:D146		  jmp	  short	exit
F000:D146 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D148		  db  90h ; 
F000:D149 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D149
F000:D149 l1:							      ;	CODE XREF: diskette_wait_until_ready+Ej
F000:D149		  test	  al, 20h ; ' '
F000:D14B		  jz	  short	ok
F000:D14D		  inc	  dx
F000:D14E		  in	  al, dx			      ;	Floppy:	FDC command/data register.
F000:D14F		  dec	  dx
F000:D150		  jmp	  short	l0
F000:D152 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D152
F000:D152 ok:							      ;	CODE XREF: diskette_wait_until_ready+23j
F000:D152		  and	  byte ptr ds:p400.diskette_recalibrate_status,	7Fh ; mask off "interrupt triggered"
F000:D157		  clc
F000:D158
F000:D158 exit:							      ;	CODE XREF: diskette_wait_until_ready+1Ej
F000:D158		  pop	  cx
F000:D159		  pop	  ax
F000:D15A		  pop	  dx
F000:D15B		  retn
F000:D15B diskette_wait_until_ready endp
F000:D15B
F000:D15C
F000:D15C ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D15C
F000:D15C ; Attributes:	bp-based frame
F000:D15C
F000:D15C diskette_no_dma_functions proc near			      ;	CODE XREF: int_13+D6p
F000:D15C							      ;	int_13+DFp
F000:D15C							      ;	int_13+E8p
F000:D15C							      ;	int_13+417p
F000:D15C		  push	  cx
F000:D15D		  push	  dx
F000:D15E		  push	  es
F000:D15F		  push	  bx
F000:D160		  push	  ax
F000:D161		  mov	  bp, sp
F000:D163		  call	  get_diskette_params
F000:D166		  mov	  cl, es:[si+3]
F000:D16A		  mov	  dx, 80h ; '€'
F000:D16D		  shl	  dx, cl
F000:D16F		  mov	  ax, [bp+0]
F000:D172		  xor	  ah, ah
F000:D174		  mul	  dx
F000:D176		  cmp	  dx, 0
F000:D179		  jnz	  short	l2
F000:D17B		  pop	  cx
F000:D17C		  pop	  bx
F000:D17D		  pop	  es
F000:D17E		  push	  es
F000:D17F		  push	  bx
F000:D180		  push	  cx
F000:D181		  mov	  dx, ax
F000:D183		  mov	  ax, es
F000:D185		  mov	  cl, 4
F000:D187		  shl	  ax, cl
F000:D189		  add	  bx, ax
F000:D18B		  mov	  ax, dx
F000:D18D		  dec	  dx
F000:D18E		  add	  bx, dx
F000:D190		  jb	  short	l2
F000:D192		  dec	  ax
F000:D193		  cli
F000:D194		  mov	  dx, 0Ch
F000:D197		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:D197							      ;	clear byte pointer flip-flop.
F000:D198		  mov	  dx, 5
F000:D19B		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:D19B							      ;	channel	2 base address and word	count
F000:D19C		  xchg	  ah, al
F000:D19E		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:D19E							      ;	channel	2 base address and word	count
F000:D19F		  pop	  ax
F000:D1A0		  xchg	  ah, al
F000:D1A2		  mov	  dx, 0Bh
F000:D1A5		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
F000:D1A5							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
F000:D1A5							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
F000:D1A5							      ;	4: 1=enable auto-initialization
F000:D1A5							      ;	5: 1=address increment;	0=address decrement
F000:D1A5							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
F000:D1A6		  pop	  bx
F000:D1A7		  pop	  es
F000:D1A8		  mov	  ax, es
F000:D1AA		  mov	  cl, 4
F000:D1AC		  shl	  ax, cl
F000:D1AE		  add	  ax, bx
F000:D1B0		  mov	  bx, 0
F000:D1B3		  jnb	  short	l0
F000:D1B5		  mov	  bx, 1
F000:D1B8
F000:D1B8 l0:							      ;	CODE XREF: diskette_no_dma_functions+57j
F000:D1B8		  mov	  dx, 4
F000:D1BB		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:D1BB							      ;	channel	2 base address
F000:D1BB							      ;	(also sets current address)
F000:D1BC		  xchg	  ah, al
F000:D1BE		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:D1BE							      ;	channel	2 base address
F000:D1BE							      ;	(also sets current address)
F000:D1BF		  mov	  ax, es
F000:D1C1		  and	  ax, 0F000h
F000:D1C4		  mov	  cl, 0Ch
F000:D1C6		  shr	  ax, cl
F000:D1C8		  cmp	  bx, 0
F000:D1CB		  jz	  short	l1
F000:D1CD		  inc	  al
F000:D1CF
F000:D1CF l1:							      ;	CODE XREF: diskette_no_dma_functions+6Fj
F000:D1CF		  mov	  dx, 81h ; ''
F000:D1D2		  out	  dx, al			      ;	DMA page register 74LS612:
F000:D1D2							      ;	Channel	2 (diskette DMA)  (address bits	16-23)
F000:D1D3		  sti
F000:D1D4		  mov	  dx, 0Ah
F000:D1D7		  mov	  al, 2
F000:D1D9		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:D1D9							      ;	single mask bit	register
F000:D1D9							      ;	0-1: select channel (00=0; 01=1; 10=2; 11=3)
F000:D1D9							      ;	2: 1=set mask for channel; 0=clear mask	(enable)
F000:D1DA		  jmp	  short	ok
F000:D1DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D1DC
F000:D1DC l2:							      ;	CODE XREF: diskette_no_dma_functions+1Dj
F000:D1DC							      ;	diskette_no_dma_functions+34j
F000:D1DC		  stc
F000:D1DD		  mov	  byte ptr ds:p400.diskette_last_status, 9
F000:D1E2		  pop	  ax
F000:D1E3		  pop	  bx
F000:D1E4		  pop	  es
F000:D1E5		  jmp	  short	exit
F000:D1E7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D1E7
F000:D1E7 ok:							      ;	CODE XREF: diskette_no_dma_functions+7Ej
F000:D1E7		  clc
F000:D1E8
F000:D1E8 exit:							      ;	CODE XREF: diskette_no_dma_functions+89j
F000:D1E8		  pop	  dx
F000:D1E9		  pop	  cx
F000:D1EA		  retn
F000:D1EA diskette_no_dma_functions endp
F000:D1EA
F000:D1EB
F000:D1EB ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D1EB
F000:D1EB
F000:D1EB sub_FD1EB	  proc near				      ;	CODE XREF: int_13+91p
F000:D1EB							      ;	int_13+10Dp
F000:D1EB							      ;	int_13+11Ep
F000:D1EB							      ;	int_13+125p
F000:D1EB							      ;	int_13+12Cp
F000:D1EB							      ;	int_13+133p ...
F000:D1EB		  push	  cx
F000:D1EC		  push	  dx
F000:D1ED		  mov	  ah, al
F000:D1EF		  mov	  dx, 3F4h
F000:D1F2		  xor	  cx, cx
F000:D1F4
F000:D1F4 l0:							      ;	CODE XREF: sub_FD1EB+Ej
F000:D1F4		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D1F4							      ;	0-3: diskette busy
F000:D1F4							      ;	4: 1=cntrlr busy
F000:D1F4							      ;	5: 1=non-DMA mode
F000:D1F4							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D1F4							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D1F5		  test	  al, 80h
F000:D1F7		  jnz	  short	l1
F000:D1F9		  loop	  l0
F000:D1FB		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:D200		  jmp	  short	exit_error
F000:D202 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D202
F000:D202 l1:							      ;	CODE XREF: sub_FD1EB+Cj
F000:D202		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D202							      ;	0-3: diskette busy
F000:D202							      ;	4: 1=cntrlr busy
F000:D202							      ;	5: 1=non-DMA mode
F000:D202							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D202							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D203		  test	  al, 40h
F000:D205		  jz	  short	l2
F000:D207		  or	  byte ptr ds:p400.diskette_last_status, 20h
F000:D20C		  jmp	  short	exit_error
F000:D20E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D20E
F000:D20E l2:							      ;	CODE XREF: sub_FD1EB+1Aj
F000:D20E		  mov	  dx, 3F5h
F000:D211		  mov	  al, ah
F000:D213		  out	  dx, al			      ;	Floppy:	FDC command/data register.
F000:D214		  clc
F000:D215		  jmp	  short	exit
F000:D217 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D217
F000:D217 exit_error:						      ;	CODE XREF: sub_FD1EB+15j
F000:D217							      ;	sub_FD1EB+21j
F000:D217		  stc
F000:D218
F000:D218 exit:							      ;	CODE XREF: sub_FD1EB+2Aj
F000:D218		  pop	  dx
F000:D219		  pop	  cx
F000:D21A		  retn
F000:D21A sub_FD1EB	  endp
F000:D21A
F000:D21B
F000:D21B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D21B
F000:D21B
F000:D21B sub_FD21B	  proc near				      ;	CODE XREF: sub_FD3DC+11p
F000:D21B		  push	  cx
F000:D21C		  push	  dx
F000:D21D		  mov	  dx, 3F4h
F000:D220		  xor	  cx, cx
F000:D222
F000:D222 l0:							      ;	CODE XREF: sub_FD21B+Cj
F000:D222		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D222							      ;	0-3: diskette busy
F000:D222							      ;	4: 1=cntrlr busy
F000:D222							      ;	5: 1=non-DMA mode
F000:D222							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D222							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D223		  test	  al, 80h
F000:D225		  jnz	  short	l1
F000:D227		  loop	  l0
F000:D229		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:D22E		  jmp	  short	error
F000:D230 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D230
F000:D230 l1:							      ;	CODE XREF: sub_FD21B+Aj
F000:D230		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D230							      ;	0-3: diskette busy
F000:D230							      ;	4: 1=cntrlr busy
F000:D230							      ;	5: 1=non-DMA mode
F000:D230							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D230							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D231		  test	  al, 40h
F000:D233		  jz	  short	ok
F000:D235		  or	  byte ptr ds:p400.diskette_last_status, 20h
F000:D23A		  jmp	  short	error
F000:D23C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D23C
F000:D23C ok:							      ;	CODE XREF: sub_FD21B+18j
F000:D23C		  clc
F000:D23D		  jmp	  short	exit
F000:D23F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D23F
F000:D23F error:						      ;	CODE XREF: sub_FD21B+13j
F000:D23F							      ;	sub_FD21B+1Fj
F000:D23F		  stc
F000:D240
F000:D240 exit:							      ;	CODE XREF: sub_FD21B+22j
F000:D240		  pop	  dx
F000:D241		  pop	  cx
F000:D242		  retn
F000:D242 sub_FD21B	  endp
F000:D242
F000:D243
F000:D243 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D243
F000:D243
F000:D243 sub_FD243	  proc near				      ;	CODE XREF: int_13+14Bp
F000:D243							      ;	int_13+2C1p
F000:D243							      ;	int_13+3E1p
F000:D243							      ;	int_13+458p
F000:D243							      ;	sub_FD360+13p
F000:D243		  push	  dx
F000:D244		  push	  es
F000:D245		  mov	  ax, ds
F000:D247		  mov	  es, ax
F000:D249		  lea	  di, ds:p400.diskette_command_bytes
F000:D24D		  mov	  dx, 3F4h
F000:D250		  xor	  bx, bx
F000:D252
F000:D252 l0:							      ;	CODE XREF: sub_FD243+15j
F000:D252		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D252							      ;	0-3: diskette busy
F000:D252							      ;	4: 1=cntrlr busy
F000:D252							      ;	5: 1=non-DMA mode
F000:D252							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D252							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D253		  test	  al, 80h
F000:D255		  jnz	  short	l1
F000:D257		  dec	  bx
F000:D258		  jnz	  short	l0
F000:D25A		  or	  byte ptr ds:p400.diskette_last_status, 80h
F000:D25F		  jmp	  short	error
F000:D261 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D261
F000:D261 l1:							      ;	CODE XREF: sub_FD243+12j
F000:D261		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D261							      ;	0-3: diskette busy
F000:D261							      ;	4: 1=cntrlr busy
F000:D261							      ;	5: 1=non-DMA mode
F000:D261							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D261							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D262		  test	  al, 40h
F000:D264		  jnz	  short	l2
F000:D266		  or	  byte ptr ds:p400.diskette_last_status, 20h
F000:D26B		  jmp	  short	error
F000:D26D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D26D
F000:D26D l2:							      ;	CODE XREF: sub_FD243+21j
F000:D26D							      ;	sub_FD243+3Ej
F000:D26D		  mov	  dx, 3F5h
F000:D270		  in	  al, dx			      ;	Floppy:	FDC command/data register.
F000:D271		  stosb
F000:D272		  push	  cx
F000:D273		  mov	  cx, 8
F000:D276
F000:D276 l3:							      ;	CODE XREF: sub_FD243:l3j
F000:D276		  loop	  l3				      ;	delay
F000:D278		  pop	  cx
F000:D279		  mov	  dx, 3F4h
F000:D27C		  in	  al, dx			      ;	Floppy:	main status reg	bits:
F000:D27C							      ;	0-3: diskette busy
F000:D27C							      ;	4: 1=cntrlr busy
F000:D27C							      ;	5: 1=non-DMA mode
F000:D27C							      ;	6: Data	dir: 1=cntrlr to CPU
F000:D27C							      ;	7: 1=OK	to snd/rcv cmd or data
F000:D27D		  test	  al, 10h
F000:D27F		  jz	  short	l4
F000:D281		  loop	  l2
F000:D283		  or	  byte ptr ds:p400.diskette_last_status, 20h
F000:D288		  jmp	  short	error
F000:D28A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D28A
F000:D28A l4:							      ;	CODE XREF: sub_FD243+3Cj
F000:D28A		  lea	  di, ds:p400.diskette_command_bytes
F000:D28E		  mov	  ah, [di]
F000:D290		  clc
F000:D291		  jmp	  short	exit
F000:D293 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D293
F000:D293 error:						      ;	CODE XREF: sub_FD243+1Cj
F000:D293							      ;	sub_FD243+28j
F000:D293							      ;	sub_FD243+45j
F000:D293		  stc
F000:D294
F000:D294 exit:							      ;	CODE XREF: sub_FD243+4Ej
F000:D294		  pop	  es
F000:D295		  pop	  dx
F000:D296		  retn
F000:D296 sub_FD243	  endp
F000:D296
F000:D297
F000:D297 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D297
F000:D297
F000:D297 sub_FD297	  proc near				      ;	CODE XREF: int_13+108p
F000:D297							      ;	int_13+1ACp
F000:D297							      ;	int_13+37Bp
F000:D297							      ;	int_13+422p
F000:D297		  push	  ax
F000:D298		  push	  cx
F000:D299		  push	  dx
F000:D29A		  mov	  al, 1
F000:D29C		  mov	  cl, dl
F000:D29E		  shl	  al, cl
F000:D2A0		  mov	  ah, al
F000:D2A2		  cli
F000:D2A3		  test	  ds:p400.diskette_motor_status, ah
F000:D2A7		  jnz	  short	l1
F000:D2A9		  mov	  cl, 4
F000:D2AB		  shl	  al, cl
F000:D2AD		  or	  al, 0Ch
F000:D2AF		  or	  al, dl
F000:D2B1		  mov	  dx, 3F2h
F000:D2B4		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:D2B4							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:D2B4							      ;	2:   0=reset diskette controller; 1=enable controller
F000:D2B4							      ;	3:   1=enable diskette DMA and interrupts
F000:D2B4							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:D2B4							      ;
F000:D2B5		  and	  byte ptr ds:p400.diskette_motor_status, 0F0h
F000:D2BA		  or	  ds:p400.diskette_motor_status, ah
F000:D2BE		  mov	  al, es:[si+0Ah]
F000:D2C2		  cmp	  al, 0
F000:D2C4		  jz	  short	l1
F000:D2C6		  xor	  cx, cx
F000:D2C8		  mov	  byte ptr ds:p400.diskette_motor_off_timeout, 0
F000:D2CD		  sti
F000:D2CE
F000:D2CE l0:							      ;	CODE XREF: sub_FD297:l0j
F000:D2CE							      ;	sub_FD297+3Dj
F000:D2CE		  loop	  l0
F000:D2D0		  dec	  al
F000:D2D2		  cmp	  al, 0
F000:D2D4		  jnz	  short	l0
F000:D2D6
F000:D2D6 l1:							      ;	CODE XREF: sub_FD297+10j
F000:D2D6							      ;	sub_FD297+2Dj
F000:D2D6		  mov	  byte ptr ds:p400.diskette_motor_off_timeout, 0FFh
F000:D2DB		  sti
F000:D2DC		  pop	  dx
F000:D2DD		  pop	  cx
F000:D2DE		  push	  cx
F000:D2DF		  push	  dx
F000:D2E0		  mov	  al, 1
F000:D2E2		  mov	  cl, dl
F000:D2E4		  shl	  al, cl
F000:D2E6		  mov	  cl, al
F000:D2E8		  test	  ds:p400.diskette_recalibrate_status, al
F000:D2EC		  jnz	  short	l2
F000:D2EE		  mov	  al, 7
F000:D2F0		  call	  sub_FD1EB
F000:D2F3		  jb	  short	exit_error
F000:D2F5		  mov	  al, dl
F000:D2F7		  and	  al, 3
F000:D2F9		  call	  sub_FD1EB
F000:D2FC		  jb	  short	exit_error
F000:D2FE		  call	  diskette_wait_until_op_finished
F000:D301		  jb	  short	exit_error
F000:D303		  call	  sub_FD360
F000:D306		  jb	  short	exit_error
F000:D308		  test	  ah, 0C0h
F000:D30B		  jnz	  short	exit_error
F000:D30D		  or	  ds:p400.diskette_recalibrate_status, cl
F000:D311
F000:D311 l2:							      ;	CODE XREF: sub_FD297+55j
F000:D311		  mov	  al, 0Fh
F000:D313		  call	  sub_FD1EB
F000:D316		  jb	  short	exit_error
F000:D318		  mov	  al, dl
F000:D31A		  and	  al, 3
F000:D31C		  shl	  dh, 1
F000:D31E		  shl	  dh, 1
F000:D320		  or	  al, dh
F000:D322		  call	  sub_FD1EB
F000:D325		  jb	  short	exit_error
F000:D327		  mov	  al, ch
F000:D329		  call	  sub_FD1EB
F000:D32C		  jb	  short	exit_error
F000:D32E		  call	  diskette_wait_until_op_finished
F000:D331		  jb	  short	exit_error
F000:D333		  call	  sub_FD360
F000:D336		  jb	  short	exit_error
F000:D338		  test	  ah, 0C0h
F000:D33B		  jnz	  short	exit_error
F000:D33D		  mov	  al, es:[si+9]
F000:D341		  cmp	  al, 0
F000:D343		  jz	  short	exit_ok
F000:D345
F000:D345 l3:							      ;	CODE XREF: sub_FD297+B7j
F000:D345		  mov	  cx, 221h
F000:D348
F000:D348 l4:							      ;	CODE XREF: sub_FD297:l4j
F000:D348		  loop	  l4				      ;	delay
F000:D34A		  dec	  al
F000:D34C		  cmp	  al, 0
F000:D34E		  jnz	  short	l3
F000:D350
F000:D350 exit_ok:						      ;	CODE XREF: sub_FD297+ACj
F000:D350		  clc
F000:D351		  jmp	  short	exit
F000:D353 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D353
F000:D353 exit_error:						      ;	CODE XREF: sub_FD297+5Cj
F000:D353							      ;	sub_FD297+65j
F000:D353							      ;	sub_FD297+6Aj
F000:D353							      ;	sub_FD297+6Fj
F000:D353							      ;	sub_FD297+74j
F000:D353							      ;	sub_FD297+7Fj ...
F000:D353		  or	  byte ptr ds:p400.diskette_last_status, 40h
F000:D358		  call	  sub_FD387
F000:D35B		  stc
F000:D35C
F000:D35C exit:							      ;	CODE XREF: sub_FD297+BAj
F000:D35C		  pop	  dx
F000:D35D		  pop	  cx
F000:D35E		  pop	  ax
F000:D35F		  retn
F000:D35F sub_FD297	  endp
F000:D35F
F000:D360
F000:D360 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D360
F000:D360
F000:D360 sub_FD360	  proc near				      ;	CODE XREF: int_13+7Ep
F000:D360							      ;	sub_FD297+6Cp
F000:D360							      ;	sub_FD297+9Cp
F000:D360		  push	  cx
F000:D361		  push	  si
F000:D362		  lea	  si, ds:p400.diskette_command_bytes
F000:D366		  mov	  ax, [si]
F000:D368		  push	  ax
F000:D369		  mov	  al, 8
F000:D36B		  call	  sub_FD1EB
F000:D36E		  jb	  short	error
F000:D370		  mov	  cx, 2
F000:D373		  call	  sub_FD243
F000:D376		  jb	  short	error
F000:D378		  mov	  ax, [si]
F000:D37A		  xchg	  ah, al
F000:D37C		  pop	  bx
F000:D37D		  mov	  [si],	bx
F000:D37F		  clc
F000:D380		  jmp	  short	exit
F000:D382 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D382
F000:D382 error:						      ;	CODE XREF: sub_FD360+Ej
F000:D382							      ;	sub_FD360+16j
F000:D382		  pop	  bx
F000:D383		  stc
F000:D384
F000:D384 exit:							      ;	CODE XREF: sub_FD360+20j
F000:D384		  pop	  si
F000:D385		  pop	  cx
F000:D386		  retn
F000:D386 sub_FD360	  endp
F000:D386
F000:D387
F000:D387 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D387
F000:D387
F000:D387 sub_FD387	  proc near				      ;	CODE XREF: int_13+156p
F000:D387							      ;	int_13+2CCp
F000:D387							      ;	int_13+3EBp
F000:D387							      ;	int_13+462p
F000:D387							      ;	sub_FD297+C1p
F000:D387		  lea	  si, ds:p400.diskette_command_bytes
F000:D38B		  mov	  al, [si+1]
F000:D38E		  or	  al, [si+2]
F000:D391		  mov	  cx, 8
F000:D394		  xor	  bx, bx
F000:D396		  and	  al, 0B7h
F000:D398
F000:D398 l0:							      ;	CODE XREF: sub_FD387+18j
F000:D398		  test	  al, 1
F000:D39A		  jnz	  short	l1
F000:D39C		  inc	  bx
F000:D39D		  ror	  al, 1
F000:D39F		  loop	  l0
F000:D3A1		  jmp	  short	exit
F000:D3A3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D3A3
F000:D3A3 l1:							      ;	CODE XREF: sub_FD387+13j
F000:D3A3		  mov	  al, cs:diskette_something[bx]
F000:D3A8		  or	  ds:p400.diskette_last_status,	al
F000:D3AC
F000:D3AC exit:							      ;	CODE XREF: sub_FD387+1Aj
F000:D3AC		  retn
F000:D3AC sub_FD387	  endp
F000:D3AC
F000:D3AC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D3AD diskette_something db	2				      ;	DATA XREF: sub_FD387:l1r
F000:D3AE		  db	3
F000:D3AF		  db	4
F000:D3B0		  db	0
F000:D3B1		  db	8
F000:D3B2		  db  10h
F000:D3B3		  db	0
F000:D3B4		  db	4
F000:D3B5
F000:D3B5 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D3B5
F000:D3B5 ; out:
F000:D3B5 ;    es:si ->	table for diskette parameters
F000:D3B5
F000:D3B5 get_diskette_params proc near				      ;	CODE XREF: int_13+105p
F000:D3B5							      ;	int_13+1A9p
F000:D3B5							      ;	diskette_dma_functions+Bp
F000:D3B5							      ;	int_13:l42p
F000:D3B5							      ;	int_13:l51p
F000:D3B5							      ;	int_13+475p ...
F000:D3B5		  push	  ax
F000:D3B6		  xor	  ax, ax
F000:D3B8		  mov	  es, ax			      ;	es = 0x00
F000:D3BA		  push	  bx
F000:D3BB		  mov	  bx, 78h ; 'x'                       ; int 0x1e (diskette parameters)
F000:D3BE		  mov	  si, es:[bx]
F000:D3C1		  mov	  ax, es:[bx+2]
F000:D3C5		  mov	  es, ax
F000:D3C7		  pop	  bx
F000:D3C8		  pop	  ax
F000:D3C9		  retn
F000:D3C9 get_diskette_params endp
F000:D3C9
F000:D3CA
F000:D3CA ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D3CA
F000:D3CA
F000:D3CA sub_FD3CA	  proc near				      ;	CODE XREF: int_13:l2p
F000:D3CA							      ;	int_13+13Ep
F000:D3CA							      ;	int_13+39Cp
F000:D3CA							      ;	int_13+443p
F000:D3CA							      ;	int_13+44Bp
F000:D3CA		  push	  cx
F000:D3CB		  call	  get_diskette_params
F000:D3CE
F000:D3CE l0:							      ;	CODE XREF: sub_FD3CA+Dj
F000:D3CE		  mov	  al, es:[bx+si]
F000:D3D1		  call	  sub_FD1EB
F000:D3D4		  jb	  short	l1
F000:D3D6		  inc	  bx
F000:D3D7		  loop	  l0
F000:D3D9		  clc
F000:D3DA
F000:D3DA l1:							      ;	CODE XREF: sub_FD3CA+Aj
F000:D3DA		  pop	  cx
F000:D3DB		  retn
F000:D3DB sub_FD3CA	  endp
F000:D3DB
F000:D3DC
F000:D3DC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D3DC
F000:D3DC
F000:D3DC sub_FD3DC	  proc near				      ;	CODE XREF: int_13+1E2p
F000:D3DC							      ;	int_13+3A9p
F000:D3DC		  push	  cx
F000:D3DD		  call	  get_diskette_params
F000:D3E0		  dec	  cx
F000:D3E1
F000:D3E1 l0:							      ;	CODE XREF: sub_FD3DC+Ej
F000:D3E1		  mov	  al, es:[bx+si]
F000:D3E4		  call	  sub_FD1EB
F000:D3E7		  jb	  short	l1
F000:D3E9		  inc	  bx
F000:D3EA		  loop	  l0
F000:D3EC		  clc
F000:D3ED		  call	  sub_FD21B
F000:D3F0		  jb	  short	l1
F000:D3F2		  mov	  dh, es:[bx+si]
F000:D3F5
F000:D3F5 l1:							      ;	CODE XREF: sub_FD3DC+Bj
F000:D3F5							      ;	sub_FD3DC+14j
F000:D3F5		  pop	  cx
F000:D3F6		  retn
F000:D3F6 sub_FD3DC	  endp
F000:D3F6
F000:D3F7
F000:D3F7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D3F7
F000:D3F7
F000:D3F7 sub_FD3F7	  proc near				      ;	CODE XREF: int_13+A3p
F000:D3F7		  push	  cx
F000:D3F8		  call	  get_diskette_params
F000:D3FB		  mov	  al, es:[bx+si]
F000:D3FE		  call	  sub_FD1EB
F000:D401		  jb	  short	exit
F000:D403		  inc	  bx
F000:D404		  mov	  al, es:[bx+si]
F000:D407		  or	  al, 1
F000:D409		  call	  sub_FD1EB
F000:D40C		  jb	  short	exit
F000:D40E		  clc
F000:D40F
F000:D40F exit:							      ;	CODE XREF: sub_FD3F7+Aj
F000:D40F							      ;	sub_FD3F7+15j
F000:D40F		  pop	  cx
F000:D410		  retn
F000:D410 sub_FD3F7	  endp
F000:D410
F000:D410 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D411 value_b000	  dw 0B000h				      ;	DATA XREF: scroll_up_or_down:scroll_graphics_up_or_downr
F000:D411							      ;	gfx_get_ascii_value_for_row_col+15r
F000:D411							      ;	gfx_print_char+CEr
F000:D411							      ;	gfx_print_char+127r
F000:D413 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D413 ; START OF FUNCTION CHUNK FOR	scroll_up_or_down
F000:D413
F000:D413 scroll_graphics_up_or_down:				      ;	CODE XREF: scroll_up_or_down+1Dj
F000:D413		  mov	  es, cs:value_b000		      ;	es = 0xb000
F000:D418		  cmp	  word ptr [bp+0], 0
F000:D41C		  jz	  short	loc_FD420
F000:D41E		  mov	  dh, ch
F000:D420
F000:D420 loc_FD420:						      ;	CODE XREF: scroll_up_or_down-20D1j
F000:D420		  inc	  dl
F000:D422		  push	  ax
F000:D423		  mov	  ax, ds:p400.crt_nr_cols
F000:D426		  mov	  ch, al
F000:D428		  pop	  ax
F000:D429		  cmp	  dl, ch
F000:D42B		  jnz	  short	loc_FD436
F000:D42D		  inc	  dh
F000:D42F		  xor	  dl, dl
F000:D431		  call	  multiply_dl_dh_by_8_bis
F000:D434		  jmp	  short	loc_FD447
F000:D436 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D436
F000:D436 loc_FD436:						      ;	CODE XREF: scroll_up_or_down-20C2j
F000:D436		  call	  multiply_dl_dh_by_8_bis
F000:D439		  add	  bx, 0F0h ; 'ğ'
F000:D43D		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D442		  jb	  short	loc_FD447
F000:D444		  sub	  bx, 50h ; 'P'
F000:D447
F000:D447 loc_FD447:						      ;	CODE XREF: scroll_up_or_down-20B9j
F000:D447							      ;	scroll_up_or_down-20ABj
F000:D447		  add	  bh, 20h ; ' '
F000:D44A		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D44F		  jb	  short	loc_FD454
F000:D451		  add	  bh, 40h ; '@'
F000:D454
F000:D454 loc_FD454:						      ;	CODE XREF: scroll_up_or_down-209Ej
F000:D454		  push	  bx
F000:D455		  mov	  bp, sp
F000:D457		  xor	  ch, ch
F000:D459		  cmp	  [bp+arg_scroll_direction], 0
F000:D45D		  jz	  short	loc_FD465
F000:D45F		  mov	  ch, [bp+arg_row_bottom]
F000:D462		  sub	  ch, [bp+arg_row_top]
F000:D465
F000:D465 loc_FD465:						      ;	CODE XREF: scroll_up_or_down-2090j
F000:D465		  mov	  dx, [bp+12h]
F000:D468		  add	  dh, ch
F000:D46A		  push	  cx
F000:D46B		  call	  multiply_dl_dh_by_8_bis
F000:D46E		  mov	  di, bx
F000:D470		  pop	  cx
F000:D471		  mov	  dh, [bp+arg_row_bottom]
F000:D474		  sub	  dh, [bp+arg_row_top]
F000:D477		  cmp	  dh, 0
F000:D47A		  jnz	  short	loc_FD47F
F000:D47C		  jmp	  loc_FD547
F000:D47F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D47F
F000:D47F loc_FD47F:						      ;	CODE XREF: scroll_up_or_down-2073j
F000:D47F		  mov	  dx, [bp+12h]
F000:D482		  add	  dh, ch
F000:D484		  cmp	  [bp+arg_scroll_direction], 0
F000:D488		  jnz	  short	loc_FD48E
F000:D48A		  add	  dh, al
F000:D48C		  jmp	  short	loc_FD490
F000:D48E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D48E
F000:D48E loc_FD48E:						      ;	CODE XREF: scroll_up_or_down-2065j
F000:D48E		  sub	  dh, al
F000:D490
F000:D490 loc_FD490:						      ;	CODE XREF: scroll_up_or_down-2061j
F000:D490		  call	  multiply_dl_dh_by_8_bis
F000:D493		  mov	  si, bx
F000:D495		  xor	  cx, cx
F000:D497		  cmp	  al, 0
F000:D499		  jnz	  short	loc_FD49E
F000:D49B		  jmp	  loc_FD547
F000:D49E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D49E
F000:D49E loc_FD49E:						      ;	CODE XREF: scroll_up_or_down-2054j
F000:D49E							      ;	scroll_up_or_down-1FAEj
F000:D49E		  push	  si
F000:D49F		  push	  di
F000:D4A0		  push	  ds
F000:D4A1		  xor	  bx, bx
F000:D4A3		  mov	  cl, ah
F000:D4A5		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:D4AA		  jz	  short	loc_FD4BE
F000:D4AC		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:D4B1		  jb	  short	loc_FD4BC
F000:D4B3		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:D4B8		  jnb	  short	loc_FD4BC
F000:D4BA		  shl	  cl, 1
F000:D4BC
F000:D4BC loc_FD4BC:						      ;	CODE XREF: scroll_up_or_down-203Cj
F000:D4BC							      ;	scroll_up_or_down-2035j
F000:D4BC		  shl	  cl, 1
F000:D4BE
F000:D4BE loc_FD4BE:						      ;	CODE XREF: scroll_up_or_down-2043j
F000:D4BE		  mov	  dh, ds:p400.crt_mode
F000:D4C2		  push	  ax
F000:D4C3		  mov	  ax, es
F000:D4C5		  mov	  ds, ax
F000:D4C7		  pop	  ax
F000:D4C8		  mov	  dl, 4
F000:D4CA		  cmp	  dh, 9
F000:D4CD		  jb	  short	loc_FD4D1
F000:D4CF		  mov	  dl, 2
F000:D4D1
F000:D4D1 loc_FD4D1:						      ;	CODE XREF: scroll_up_or_down-2020j
F000:D4D1							      ;	scroll_up_or_down-1FBBj
F000:D4D1		  mov	  si, [bp+var_2]
F000:D4D4		  mov	  di, [bp+var_4]
F000:D4D7		  add	  si, bx
F000:D4D9		  add	  di, bx
F000:D4DB		  push	  cx
F000:D4DC		  rep movsb
F000:D4DE		  pop	  cx
F000:D4DF		  mov	  si, [bp+var_2]
F000:D4E2		  mov	  di, [bp+var_4]
F000:D4E5		  add	  si, 2000h
F000:D4E9		  add	  di, 2000h
F000:D4ED		  add	  si, bx
F000:D4EF		  add	  di, bx
F000:D4F1		  push	  cx
F000:D4F2		  rep movsb
F000:D4F4		  pop	  cx
F000:D4F5		  cmp	  dh, 9
F000:D4F8		  jb	  short	loc_FD52D
F000:D4FA		  mov	  si, [bp+var_2]
F000:D4FD		  mov	  di, [bp+var_4]
F000:D500		  add	  si, 4000h
F000:D504		  add	  di, 4000h
F000:D508		  add	  si, bx
F000:D50A		  add	  di, bx
F000:D50C		  push	  cx
F000:D50D		  rep movsb
F000:D50F		  pop	  cx
F000:D510		  mov	  si, [bp+var_2]
F000:D513		  mov	  di, [bp+var_4]
F000:D516		  add	  si, 6000h
F000:D51A		  add	  di, 6000h
F000:D51E		  add	  si, bx
F000:D520		  add	  di, bx
F000:D522		  push	  cx
F000:D523		  rep movsb
F000:D525		  pop	  cx
F000:D526		  add	  bx, 0A0h ; ' '
F000:D52A		  jmp	  short	loc_FD530
F000:D52A ; END	OF FUNCTION CHUNK FOR scroll_up_or_down
F000:D52A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D52C		  db  90h ; 
F000:D52D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D52D ; START OF FUNCTION CHUNK FOR	scroll_up_or_down
F000:D52D
F000:D52D loc_FD52D:						      ;	CODE XREF: scroll_up_or_down-1FF5j
F000:D52D		  add	  bx, 50h ; 'P'
F000:D530
F000:D530 loc_FD530:						      ;	CODE XREF: scroll_up_or_down-1FC3j
F000:D530		  dec	  dl
F000:D532		  jnz	  short	loc_FD4D1
F000:D534		  pop	  ds
F000:D535		  cmp	  si, [bp+0]
F000:D538		  jz	  short	loc_FD542
F000:D53A		  pop	  di
F000:D53B		  pop	  si
F000:D53C		  call	  sub_FDB23
F000:D53F		  jmp	  loc_FD49E
F000:D542 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D542
F000:D542 loc_FD542:						      ;	CODE XREF: scroll_up_or_down-1FB5j
F000:D542		  pop	  di
F000:D543		  pop	  si
F000:D544		  call	  sub_FDB23
F000:D547
F000:D547 loc_FD547:						      ;	CODE XREF: scroll_up_or_down-2071j
F000:D547							      ;	scroll_up_or_down-2052j
F000:D547							      ;	scroll_up_or_down-1F2Bj
F000:D547		  push	  di
F000:D548		  mov	  al, [bp+arg_char_attrib]
F000:D54B		  xor	  bx, bx
F000:D54D		  mov	  cl, ah
F000:D54F		  mov	  dx, 4
F000:D552		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D557		  jb	  short	loc_FD55C
F000:D559		  mov	  dx, 2
F000:D55C
F000:D55C loc_FD55C:						      ;	CODE XREF: scroll_up_or_down-1F96j
F000:D55C		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:D561		  jz	  short	loc_FD575
F000:D563		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:D568		  jb	  short	loc_FD573
F000:D56A		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:D56F		  jnb	  short	loc_FD573
F000:D571		  shl	  cl, 1
F000:D573
F000:D573 loc_FD573:						      ;	CODE XREF: scroll_up_or_down-1F85j
F000:D573							      ;	scroll_up_or_down-1F7Ej
F000:D573		  shl	  cl, 1
F000:D575
F000:D575 loc_FD575:						      ;	CODE XREF: scroll_up_or_down-1F8Cj
F000:D575							      ;	scroll_up_or_down-1F36j
F000:D575		  mov	  di, [bp+var_2]
F000:D578		  add	  di, bx
F000:D57A		  push	  cx
F000:D57B		  rep stosb
F000:D57D		  pop	  cx
F000:D57E		  mov	  di, [bp+var_2]
F000:D581		  add	  di, 2000h
F000:D585		  add	  di, bx
F000:D587		  push	  cx
F000:D588		  rep stosb
F000:D58A		  pop	  cx
F000:D58B		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D590		  jb	  short	loc_FD5B3
F000:D592		  mov	  di, [bp+var_2]
F000:D595		  add	  di, 4000h
F000:D599		  add	  di, bx
F000:D59B		  push	  cx
F000:D59C		  rep stosb
F000:D59E		  pop	  cx
F000:D59F		  mov	  di, [bp+var_2]
F000:D5A2		  add	  di, 6000h
F000:D5A6		  add	  di, bx
F000:D5A8		  push	  cx
F000:D5A9		  rep stosb
F000:D5AB		  pop	  cx
F000:D5AC		  add	  bx, 0A0h ; ' '
F000:D5B0		  jmp	  short	loc_FD5B6
F000:D5B0 ; END	OF FUNCTION CHUNK FOR scroll_up_or_down
F000:D5B0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D5B2		  db  90h ; 
F000:D5B3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D5B3 ; START OF FUNCTION CHUNK FOR	scroll_up_or_down
F000:D5B3
F000:D5B3 loc_FD5B3:						      ;	CODE XREF: scroll_up_or_down-1F5Dj
F000:D5B3		  add	  bx, 50h ; 'P'
F000:D5B6
F000:D5B6 loc_FD5B6:						      ;	CODE XREF: scroll_up_or_down-1F3Dj
F000:D5B6		  dec	  dx
F000:D5B7		  jnz	  short	loc_FD575
F000:D5B9		  cmp	  di, [bp+0]
F000:D5BC		  jz	  short	loc_FD5C4
F000:D5BE		  pop	  di
F000:D5BF		  call	  sub_FDB23
F000:D5C2		  jmp	  short	loc_FD547
F000:D5C4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D5C4
F000:D5C4 loc_FD5C4:						      ;	CODE XREF: scroll_up_or_down-1F31j
F000:D5C4		  pop	  di
F000:D5C5		  pop	  bx
F000:D5C6		  retn
F000:D5C6 ; END	OF FUNCTION CHUNK FOR scroll_up_or_down
F000:D5C7
F000:D5C7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D5C7
F000:D5C7
F000:D5C7 gfx_get_ascii_value_for_row_col proc near		      ;	CODE XREF: int_10_08+Ap
F000:D5C7		  call	  multiply_dl_dh_by_8_bis
F000:D5CA		  sub	  sp, 0Ah
F000:D5CD		  mov	  bp, sp
F000:D5CF		  push	  bx
F000:D5D0		  xor	  bx, bx
F000:D5D2		  mov	  cx, 8
F000:D5D5		  xor	  dl, dl
F000:D5D7
F000:D5D7 l0:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col:l23j
F000:D5D7		  pop	  si
F000:D5D8		  push	  si
F000:D5D9		  add	  si, bx
F000:D5DB		  push	  es
F000:D5DC		  mov	  es, cs:value_b000
F000:D5E1		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:D5E6		  jnz	  short	l1
F000:D5E8		  jmp	  l17
F000:D5EB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D5EB
F000:D5EB l1:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+1Fj
F000:D5EB		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:D5F0		  jnz	  short	l2
F000:D5F2		  jmp	  l14
F000:D5F5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D5F5
F000:D5F5 l2:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+29j
F000:D5F5		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:D5FA		  jnb	  short	l7
F000:D5FC		  mov	  ax, es:[si]
F000:D5FF		  inc	  si
F000:D600		  inc	  si
F000:D601		  xchg	  ah, al
F000:D603		  push	  bx
F000:D604		  push	  cx
F000:D605		  mov	  cx, 8
F000:D608		  xor	  dh, dh
F000:D60A
F000:D60A l3:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col:l6j
F000:D60A		  xor	  bl, bl
F000:D60C		  shl	  dh, 1
F000:D60E		  shl	  ax, 1
F000:D610		  jnb	  short	l4
F000:D612		  or	  dl, 2
F000:D615		  mov	  bl, 1
F000:D617
F000:D617 l4:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+49j
F000:D617		  shl	  ax, 1
F000:D619		  jnb	  short	l5
F000:D61B		  or	  dl, 1
F000:D61E		  mov	  bl, 1
F000:D620
F000:D620 l5:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+52j
F000:D620		  cmp	  bl, 0
F000:D623		  jz	  short	l6
F000:D625		  or	  dh, 1
F000:D628
F000:D628 l6:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+5Cj
F000:D628		  loop	  l3
F000:D62A		  pop	  cx
F000:D62B		  pop	  bx
F000:D62C		  mov	  al, dh
F000:D62E		  jmp	  short	l18
F000:D630 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D630
F000:D630 l7:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+33j
F000:D630		  push	  bx
F000:D631		  push	  cx
F000:D632		  xor	  dh, dh
F000:D634		  mov	  cx, 2
F000:D637
F000:D637 l7_1:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+AEj
F000:D637		  push	  cx
F000:D638		  mov	  cx, 4
F000:D63B		  mov	  ax, es:[si]
F000:D63E		  inc	  si
F000:D63F		  inc	  si
F000:D640		  xchg	  ah, al
F000:D642
F000:D642 l8:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col:l13j
F000:D642		  xor	  bl, bl
F000:D644		  shl	  dh, 1
F000:D646		  shl	  ax, 1
F000:D648		  jnb	  short	l9
F000:D64A		  or	  dl, 8
F000:D64D		  mov	  bl, 1
F000:D64F
F000:D64F l9:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+81j
F000:D64F		  shl	  ax, 1
F000:D651		  jnb	  short	l10
F000:D653		  or	  dl, 4
F000:D656		  mov	  bl, 1
F000:D658
F000:D658 l10:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+8Aj
F000:D658		  shl	  ax, 1
F000:D65A		  jnb	  short	l11
F000:D65C		  or	  dl, 2
F000:D65F		  mov	  bl, 1
F000:D661
F000:D661 l11:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+93j
F000:D661		  shl	  ax, 1
F000:D663		  jnb	  short	l12
F000:D665		  or	  dl, 1
F000:D668		  mov	  bl, 1
F000:D66A
F000:D66A l12:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+9Cj
F000:D66A		  cmp	  bl, 0
F000:D66D		  jz	  short	l13
F000:D66F		  or	  dh, 1
F000:D672
F000:D672 l13:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+A6j
F000:D672		  loop	  l8
F000:D674		  pop	  cx
F000:D675		  loop	  l7_1
F000:D677		  pop	  cx
F000:D678		  pop	  bx
F000:D679		  mov	  al, dh
F000:D67B		  jmp	  short	l18
F000:D67D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D67D
F000:D67D l14:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+2Bj
F000:D67D		  mov	  al, es:[si]
F000:D680		  cmp	  al, 0
F000:D682		  jz	  short	l15
F000:D684		  or	  dl, 1
F000:D687
F000:D687 l15:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+BBj
F000:D687		  mov	  ah, es:[si]
F000:D68A		  cmp	  ah, 0
F000:D68D		  jz	  short	l16
F000:D68F		  or	  dl, 2
F000:D692
F000:D692 l16:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+C6j
F000:D692		  or	  al, ah
F000:D694		  jmp	  short	l18
F000:D694 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D696		  db  90h ; 
F000:D697 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D697
F000:D697 l17:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+21j
F000:D697		  mov	  al, es:[si]
F000:D69A		  inc	  si
F000:D69B		  cmp	  al, 0
F000:D69D		  jz	  short	l18
F000:D69F		  mov	  dl, 1
F000:D6A1
F000:D6A1 l18:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+67j
F000:D6A1							      ;	gfx_get_ascii_value_for_row_col+B4j
F000:D6A1							      ;	gfx_get_ascii_value_for_row_col+CDj
F000:D6A1							      ;	gfx_get_ascii_value_for_row_col+D6j
F000:D6A1		  pop	  es
F000:D6A2		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D6A7		  jb	  short	l19
F000:D6A9		  cmp	  cx, 5
F000:D6AC		  jnz	  short	l20
F000:D6AE		  sub	  bx, 5F60h
F000:D6B2		  jmp	  short	l22
F000:D6B2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D6B4		  db  90h ; 
F000:D6B5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D6B5
F000:D6B5 l19:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+E0j
F000:D6B5		  test	  cx, 1
F000:D6B9		  jnz	  short	l21
F000:D6BB
F000:D6BB l20:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+E5j
F000:D6BB		  add	  bh, 20h ; ' '
F000:D6BE		  jmp	  short	l22
F000:D6C0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D6C0
F000:D6C0 l21:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+F2j
F000:D6C0		  sub	  bx, 1FB0h
F000:D6C4
F000:D6C4 l22:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+EBj
F000:D6C4							      ;	gfx_get_ascii_value_for_row_col+F7j
F000:D6C4		  mov	  [bp+0], al
F000:D6C7		  inc	  bp
F000:D6C8		  loop	  l23
F000:D6CA		  jmp	  short	l24
F000:D6CA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D6CC		  db  90h ; 
F000:D6CD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D6CD
F000:D6CD l23:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+101j
F000:D6CD		  jmp	  l0
F000:D6D0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D6D0
F000:D6D0 l24:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+103j
F000:D6D0		  sub	  bp, 8
F000:D6D3		  mov	  [bp+8], dl
F000:D6D6		  xor	  ax, ax
F000:D6D8		  mov	  es, ax
F000:D6DA		  mov	  bx, 110h
F000:D6DD		  mov	  di, es:[bx]
F000:D6E0		  mov	  ax, es:[bx+2]
F000:D6E4		  mov	  es, ax
F000:D6E6		  xor	  cx, cx
F000:D6E8		  push	  ds
F000:D6E9		  mov	  ax, ss
F000:D6EB		  mov	  ds, ax
F000:D6ED		  xor	  ax, ax
F000:D6EF		  jmp	  short	l26
F000:D6F1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D6F1
F000:D6F1 l25:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+13Dj
F000:D6F1							      ;	gfx_get_ascii_value_for_row_col+142j
F000:D6F1		  inc	  ax
F000:D6F2		  cmp	  ax, 7Fh ; ''
F000:D6F5		  ja	  short	l28
F000:D6F7
F000:D6F7 l26:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+128j
F000:D6F7		  mov	  si, bp
F000:D6F9		  mov	  cx, 4
F000:D6FC		  repe cmpsw
F000:D6FE		  jz	  short	l27
F000:D700		  add	  di, cx
F000:D702		  add	  di, cx
F000:D704		  jmp	  short	l25
F000:D706 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D706
F000:D706 l27:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+137j
F000:D706		  cmp	  cx, 0
F000:D709		  jnz	  short	l25
F000:D70B		  jmp	  short	l33
F000:D70D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D70D
F000:D70D l28:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+12Ej
F000:D70D		  xor	  ax, ax
F000:D70F		  mov	  es, ax
F000:D711		  mov	  bx, 7Ch ; '|'
F000:D714		  mov	  di, es:[bx]
F000:D717		  mov	  ax, es:[bx+2]
F000:D71B		  mov	  es, ax
F000:D71D		  xor	  cx, cx
F000:D71F		  mov	  ax, ss
F000:D721		  mov	  ds, ax
F000:D723		  xor	  ax, ax
F000:D725		  jmp	  short	l30
F000:D727 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D727
F000:D727 l29:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+173j
F000:D727							      ;	gfx_get_ascii_value_for_row_col+178j
F000:D727		  inc	  ax
F000:D728		  cmp	  ax, 7Fh ; ''
F000:D72B		  ja	  short	l32
F000:D72D
F000:D72D l30:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+15Ej
F000:D72D		  mov	  si, bp
F000:D72F		  mov	  cx, 4
F000:D732		  repe cmpsw
F000:D734		  jz	  short	l31
F000:D736		  add	  di, cx
F000:D738		  add	  di, cx
F000:D73A		  jmp	  short	l29
F000:D73C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D73C
F000:D73C l31:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+16Dj
F000:D73C		  cmp	  cx, 0
F000:D73F		  jnz	  short	l29
F000:D741		  add	  ax, 80h ; '€'
F000:D744		  jmp	  short	l33
F000:D746 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D746
F000:D746 l32:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+164j
F000:D746		  pop	  ds
F000:D747		  xor	  ax, ax
F000:D749		  jmp	  short	l34
F000:D74B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D74B
F000:D74B l33:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+144j
F000:D74B							      ;	gfx_get_ascii_value_for_row_col+17Dj
F000:D74B		  pop	  ds
F000:D74C		  mov	  ah, [bp+8]
F000:D74F
F000:D74F l34:							      ;	CODE XREF: gfx_get_ascii_value_for_row_col+182j
F000:D74F		  add	  sp, 0Ah
F000:D752		  pop	  bx
F000:D753		  retn
F000:D753 gfx_get_ascii_value_for_row_col endp
F000:D753
F000:D754
F000:D754 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D754
F000:D754
F000:D754 gfx_print_char  proc near				      ;	CODE XREF: int_10_0a+12p
F000:D754
F000:D754 ; FUNCTION CHUNK AT F000:D91B	SIZE 00000003 BYTES
F000:D754
F000:D754		  mov	  bx, cx
F000:D756		  call	  multiply_dl_dh_by_8
F000:D759		  push	  cx
F000:D75A		  push	  dx
F000:D75B		  push	  bx
F000:D75C		  push	  ax
F000:D75D		  cmp	  al, 7Fh ; ''
F000:D75F		  jbe	  short	l0
F000:D761		  pop	  ax
F000:D762		  sub	  al, 80h ; '€'
F000:D764		  push	  ax
F000:D765		  xor	  ax, ax
F000:D767		  mov	  es, ax			      ;	es = 0
F000:D769		  mov	  bx, 7Ch ; '|'                       ; int 0x1f
F000:D76C		  mov	  si, es:[bx]			      ;	int 0x1f offset	(chatset 128-255)
F000:D76F		  mov	  ax, es:[bx+2]			      ;	int 0x1f segment
F000:D773		  mov	  es, ax
F000:D775		  jmp	  short	l1
F000:D777 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D777
F000:D777 l0:							      ;	CODE XREF: gfx_print_char+Bj
F000:D777		  xor	  ax, ax
F000:D779		  mov	  es, ax
F000:D77B		  mov	  bx, 110h			      ;	int 0x44
F000:D77E		  mov	  si, es:[bx]			      ;	int 0x44 offset	(charset 0-127)
F000:D781		  mov	  ax, es:[bx+2]			      ;	int 0x44 segment
F000:D785		  mov	  es, ax
F000:D787
F000:D787 l1:							      ;	CODE XREF: gfx_print_char+21j
F000:D787		  pop	  ax
F000:D788		  xor	  bh, bh
F000:D78A		  mov	  bl, al
F000:D78C		  shl	  bx, 1
F000:D78E		  shl	  bx, 1
F000:D790		  shl	  bx, 1
F000:D792		  add	  si, bx
F000:D794		  jmp	  short	l5
F000:D796 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D796
F000:D796 l2:							      ;	CODE XREF: gfx_print_char:l19j
F000:D796		  mov	  bp, cx
F000:D798		  pop	  dx
F000:D799		  pop	  cx
F000:D79A		  sub	  si, 8
F000:D79D		  mov	  bx, 0A0h ; ' '
F000:D7A0		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:D7A5		  jz	  short	l3
F000:D7A7		  mov	  bx, 140h
F000:D7AA		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D7AF		  jz	  short	l3
F000:D7B1		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:D7B6		  jb	  short	l3
F000:D7B8		  mov	  bx, 280h
F000:D7BB
F000:D7BB l3:							      ;	CODE XREF: gfx_print_char+51j
F000:D7BB							      ;	gfx_print_char+5Bj
F000:D7BB							      ;	gfx_print_char+62j
F000:D7BB		  add	  cx, 8
F000:D7BE		  cmp	  cx, bx
F000:D7C0		  jnz	  short	l4
F000:D7C2		  add	  dx, 8
F000:D7C5		  xor	  cx, cx
F000:D7C7		  cmp	  dx, 0C8h ; 'È'
F000:D7CB		  jnz	  short	l4
F000:D7CD		  retn
F000:D7CE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D7CE
F000:D7CE l4:							      ;	CODE XREF: gfx_print_char+6Cj
F000:D7CE							      ;	gfx_print_char+77j
F000:D7CE		  push	  cx
F000:D7CF		  push	  dx
F000:D7D0		  push	  bp
F000:D7D1
F000:D7D1 l5:							      ;	CODE XREF: gfx_print_char+40j
F000:D7D1		  call	  get_address_for_pixel
F000:D7D4		  mov	  di, bx
F000:D7D6		  push	  di
F000:D7D7		  mov	  bp, sp
F000:D7D9		  xor	  bx, bx
F000:D7DB		  mov	  cx, 8
F000:D7DE		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:D7E3		  jnz	  short	l6
F000:D7E5		  jmp	  l20
F000:D7E8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D7E8
F000:D7E8 l6:							      ;	CODE XREF: gfx_print_char+8Fj
F000:D7E8		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D7ED		  jnz	  short	l7
F000:D7EF		  jmp	  short	l20
F000:D7EF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D7F1		  db  90h ; 
F000:D7F2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D7F2
F000:D7F2 l7:							      ;	CODE XREF: gfx_print_char+99j
F000:D7F2		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:D7F7		  jnz	  short	l8
F000:D7F9		  jmp	  l20_0
F000:D7FC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D7FC
F000:D7FC l8:							      ;	CODE XREF: gfx_print_char+A3j
F000:D7FC							      ;	gfx_print_char:l17j
F000:D7FC		  mov	  dl, es:[si]
F000:D7FF		  inc	  si
F000:D800		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:D805		  jz	  short	l11
F000:D807		  push	  cx
F000:D808		  mov	  cx, 8
F000:D80B		  mov	  al, dl
F000:D80D		  xor	  dx, dx
F000:D80F
F000:D80F l9:							      ;	CODE XREF: gfx_print_char:l10j
F000:D80F		  shl	  dx, 1
F000:D811		  shl	  dx, 1
F000:D813		  shl	  al, 1
F000:D815		  jnb	  short	l10
F000:D817		  push	  ax
F000:D818		  and	  ah, 3
F000:D81B		  or	  dl, ah
F000:D81D		  pop	  ax
F000:D81E
F000:D81E l10:							      ;	CODE XREF: gfx_print_char+C1j
F000:D81E		  loop	  l9
F000:D820		  pop	  cx
F000:D821
F000:D821 l11:							      ;	CODE XREF: gfx_print_char+B1j
F000:D821		  push	  es
F000:D822		  mov	  es, cs:value_b000
F000:D827		  push	  ax
F000:D828		  xchg	  ax, dx
F000:D829		  mov	  di, [bp+0]
F000:D82C		  add	  di, bx
F000:D82E		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:D833		  jz	  short	l13
F000:D835		  xchg	  ah, al
F000:D837		  test	  dh, 80h
F000:D83A		  jz	  short	l12
F000:D83C		  xor	  es:[di], ax
F000:D83F		  inc	  di
F000:D840		  inc	  di
F000:D841		  jmp	  short	l15
F000:D843 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D843
F000:D843 l12:							      ;	CODE XREF: gfx_print_char+E6j
F000:D843		  stosw
F000:D844		  jmp	  short	l15
F000:D846 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D846
F000:D846 l13:							      ;	CODE XREF: gfx_print_char+DFj
F000:D846		  test	  dh, 80h
F000:D849		  jz	  short	l14
F000:D84B		  xor	  es:[di], al
F000:D84E		  inc	  di
F000:D84F		  jmp	  short	l15
F000:D851 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D851
F000:D851 l14:							      ;	CODE XREF: gfx_print_char+F5j
F000:D851		  stosb
F000:D852
F000:D852 l15:							      ;	CODE XREF: gfx_print_char+EDj
F000:D852							      ;	gfx_print_char+F0j
F000:D852							      ;	gfx_print_char+FBj
F000:D852		  pop	  ax
F000:D853		  pop	  es
F000:D854		  test	  cx, 1
F000:D858		  jnz	  short	l16
F000:D85A		  add	  bh, 20h ; ' '
F000:D85D		  jmp	  short	l17
F000:D85F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D85F
F000:D85F l16:							      ;	CODE XREF: gfx_print_char+104j
F000:D85F		  sub	  bx, 1FB0h
F000:D863
F000:D863 l17:							      ;	CODE XREF: gfx_print_char+109j
F000:D863		  loop	  l8
F000:D865
F000:D865 l18:							      ;	CODE XREF: gfx_print_char+198j
F000:D865		  pop	  di
F000:D866		  pop	  cx
F000:D867		  loop	  l19
F000:D869		  pop	  dx
F000:D86A		  pop	  cx
F000:D86B		  retn
F000:D86C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D86C
F000:D86C l19:							      ;	CODE XREF: gfx_print_char+113j
F000:D86C		  jmp	  l2
F000:D86F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D86F
F000:D86F l20:							      ;	CODE XREF: gfx_print_char+91j
F000:D86F							      ;	gfx_print_char+9Bj
F000:D86F							      ;	gfx_print_char:l20_0j
F000:D86F		  mov	  cx, 8
F000:D872
F000:D872 l21:							      ;	CODE XREF: gfx_print_char:l32j
F000:D872		  push	  cx
F000:D873		  mov	  dl, es:[si]
F000:D876		  inc	  si
F000:D877		  mov	  al, dl
F000:D879		  push	  es
F000:D87A		  push	  bx
F000:D87B		  mov	  es, cs:value_b000
F000:D880		  mov	  di, [bp+0]
F000:D883		  add	  di, bx
F000:D885		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:D88A		  jnz	  short	l26
F000:D88C		  xchg	  ax, dx
F000:D88D		  mov	  ah, al
F000:D88F		  test	  dh, 1
F000:D892		  jnz	  short	l22
F000:D894		  mov	  al, 0
F000:D896
F000:D896 l22:							      ;	CODE XREF: gfx_print_char+13Ej
F000:D896		  test	  dh, 2
F000:D899		  jnz	  short	l23
F000:D89B		  mov	  ah, 0
F000:D89D
F000:D89D l23:							      ;	CODE XREF: gfx_print_char+145j
F000:D89D		  test	  dh, 80h
F000:D8A0		  jz	  short	l24
F000:D8A2		  xor	  es:[di], ax
F000:D8A5		  inc	  di
F000:D8A6		  inc	  di
F000:D8A7		  jmp	  short	l25
F000:D8A7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8A9		  db  90h ; 
F000:D8AA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8AA
F000:D8AA l24:							      ;	CODE XREF: gfx_print_char+14Cj
F000:D8AA		  stosw
F000:D8AB
F000:D8AB l25:							      ;	CODE XREF: gfx_print_char+153j
F000:D8AB		  xchg	  ax, dx
F000:D8AC		  jmp	  short	l30
F000:D8AC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8AE		  db  90h ; 
F000:D8AF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8AF
F000:D8AF l26:							      ;	CODE XREF: gfx_print_char+136j
F000:D8AF		  call	  sub_FD900
F000:D8B2		  mov	  dx, bx
F000:D8B4		  call	  sub_FD900
F000:D8B7		  mov	  cx, 2
F000:D8BA
F000:D8BA l27:							      ;	CODE XREF: gfx_print_char+17Aj
F000:D8BA		  xchg	  ax, dx
F000:D8BB		  xchg	  ah, al
F000:D8BD		  test	  dh, 80h
F000:D8C0		  jz	  short	l28
F000:D8C2		  xor	  es:[di], ax
F000:D8C5		  inc	  di
F000:D8C6		  inc	  di
F000:D8C7		  jmp	  short	l29
F000:D8C7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8C9		  db  90h ; 
F000:D8CA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8CA
F000:D8CA l28:							      ;	CODE XREF: gfx_print_char+16Cj
F000:D8CA		  stosw
F000:D8CB
F000:D8CB l29:							      ;	CODE XREF: gfx_print_char+173j
F000:D8CB		  xchg	  ax, dx
F000:D8CC		  mov	  dx, bx
F000:D8CE		  loop	  l27
F000:D8D0
F000:D8D0 l30:							      ;	CODE XREF: gfx_print_char+158j
F000:D8D0		  pop	  bx
F000:D8D1		  pop	  es
F000:D8D2		  pop	  cx
F000:D8D3		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:D8D8		  jnz	  short	l33
F000:D8DA		  test	  cx, 1
F000:D8DE		  jnz	  short	l31
F000:D8E0		  add	  bh, 20h ; ' '
F000:D8E3		  jmp	  short	l32
F000:D8E3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8E5		  db  90h ; 
F000:D8E6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8E6
F000:D8E6 l31:							      ;	CODE XREF: gfx_print_char+18Aj
F000:D8E6		  sub	  bx, 1FB0h
F000:D8EA
F000:D8EA l32:							      ;	CODE XREF: gfx_print_char+18Fj
F000:D8EA							      ;	gfx_print_char:l35j
F000:D8EA		  loop	  l21
F000:D8EC		  jmp	  l18
F000:D8EF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8EF
F000:D8EF l33:							      ;	CODE XREF: gfx_print_char+184j
F000:D8EF		  cmp	  cx, 5
F000:D8F2		  jnz	  short	l34
F000:D8F4		  sub	  bx, 5F60h
F000:D8F8		  jmp	  short	l35
F000:D8F8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8FA		  db  90h ; 
F000:D8FB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D8FB
F000:D8FB l34:							      ;	CODE XREF: gfx_print_char+19Ej
F000:D8FB		  add	  bh, 20h ; ' '
F000:D8FE
F000:D8FE l35:							      ;	CODE XREF: gfx_print_char+1A4j
F000:D8FE		  jmp	  short	l32
F000:D8FE gfx_print_char  endp
F000:D8FE
F000:D900
F000:D900 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D900
F000:D900
F000:D900 sub_FD900	  proc near				      ;	CODE XREF: gfx_print_char:l26p
F000:D900							      ;	gfx_print_char+160p
F000:D900		  xor	  bx, bx
F000:D902		  mov	  cx, 4
F000:D905
F000:D905 l0:							      ;	CODE XREF: sub_FD900:l1j
F000:D905		  shl	  bx, 1
F000:D907		  shl	  bx, 1
F000:D909		  shl	  bx, 1
F000:D90B		  shl	  bx, 1
F000:D90D		  shl	  al, 1
F000:D90F		  jnb	  short	l1
F000:D911		  push	  ax
F000:D912		  and	  ah, 0Fh
F000:D915		  or	  bl, ah
F000:D917		  pop	  ax
F000:D918
F000:D918 l1:							      ;	CODE XREF: sub_FD900+Fj
F000:D918		  loop	  l0
F000:D91A		  retn
F000:D91A sub_FD900	  endp
F000:D91A
F000:D91B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D91B ; START OF FUNCTION CHUNK FOR	gfx_print_char
F000:D91B
F000:D91B l20_0:						      ;	CODE XREF: gfx_print_char+A5j
F000:D91B		  jmp	  l20
F000:D91B ; END	OF FUNCTION CHUNK FOR gfx_print_char
F000:D91E
F000:D91E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D91E
F000:D91E ;	Returns	a list of installed equipment on the system.
F000:D91E ;
F000:D91E ;	   On entry:	  No parameters
F000:D91E ;
F000:D91E ;	   Returns:	  AX	     Equipment code
F000:D91E ;
F000:D91E ;   --------------------------------------------------------------------------
F000:D91E ;
F000:D91E ;			       Equipment code (AX)
F000:D91E ;
F000:D91E ;   F	E D C B	A 9 8  7 6 5 4 3 2 1 0
F000:D91E ;   x	x . . .	. . .  . . . . . . . .	Number of printers installed
F000:D91E ;   .	. x . .	. . .  . . . . . . . .	Internal modem installed
F000:D91E ;   .	. . x .	. . .  . . . . . . . .	Game adapter installed?	(always	1 on PCJr)
F000:D91E ;   .	. . . x	x x .  . . . . . . . .	Number of RS-232 ports
F000:D91E ;   .	. . . .	. . x  . . . . . . . .	DMA present
F000:D91E ;   .	. . . .	. . .  x x . . . . . .	Number of diskettes - 1	(i.e. 0=1 disk)
F000:D91E ;   .	. . . .	. . .  . . x x . . . .	Initial	video mode (see	below)
F000:D91E ;   .	. . . .	. . .  . . . . x . . .	Reserved
F000:D91E ;   .	. . . .	. . .  . . . . . x . .	Reserved
F000:D91E ;   .	. . . .	. . .  . . . . . . x .	Math coprocessor installed?
F000:D91E ;   .	. . . .	. . .  . . . . . . . x	1=diskettes present; 0=no disks	present
F000:D91E ;
F000:D91E ;
F000:D91E ;			     Initial video mode
F000:D91E ;
F000:D91E ;			Value		      Meaning
F000:D91E ;			 00		      Reserved
F000:D91E ;			 01		      40 x 25 Color
F000:D91E ;			 10		      80 x 25 Color
F000:D91E ;			 11		      80 x 25 Monochrome
F000:D91E
F000:D91E int_11	  proc far				      ;	DATA XREF: F000:FF05o
F000:D91E		  push	  bx
F000:D91F		  push	  ds
F000:D920		  mov	  ax, 40h ; '@'
F000:D923		  mov	  ds, ax			      ;	ds = 0x40
F000:D925		  lea	  bx, ds:p400.installed_hardware
F000:D929		  mov	  ax, [bx]			      ;	`mov ax, ds:10h` perhaps?
F000:D92B		  pop	  ds
F000:D92C		  pop	  bx
F000:D92D		  iret
F000:D92D int_11	  endp
F000:D92D
F000:D92E
F000:D92E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D92E
F000:D92E ;	Reports	the number of contiguous 1K memory blocks in the system	(up to
F000:D92E ;	640K).
F000:D92E ;
F000:D92E ;	   On entry:	  No parameters
F000:D92E ;
F000:D92E ;	   Returns:	  AX	     Memory size (up to	640K)
F000:D92E
F000:D92E int_12	  proc far				      ;	DATA XREF: F000:FF07o
F000:D92E		  push	  bx
F000:D92F		  push	  ds
F000:D930		  mov	  ax, 40h ; '@'
F000:D933		  mov	  ds, ax			      ;	ds = 0x40
F000:D935		  lea	  bx, ds:p400.base_mem_kb	      ;	`mov ax, ds:1dh` perhaps?
F000:D939		  mov	  ax, [bx]
F000:D93B		  pop	  ds
F000:D93C		  pop	  bx
F000:D93D		  iret
F000:D93D int_12	  endp
F000:D93D
F000:D93E
F000:D93E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D93E
F000:D93E ; Attributes:	bp-based frame
F000:D93E
F000:D93E int_push_regs	  proc near				      ;	CODE XREF: int_13p
F000:D93E							      ;	int_14p
F000:D93E							      ;	int_09p
F000:D93E							      ;	int_17p
F000:D93E							      ;	int_10p
F000:D93E
F000:D93E arg_C		  = word ptr  0Eh
F000:D93E
F000:D93E		  sti
F000:D93F		  push	  cx
F000:D940		  push	  dx
F000:D941		  push	  si
F000:D942		  push	  di
F000:D943		  push	  bp
F000:D944		  push	  ds
F000:D945		  push	  es
F000:D946		  mov	  bp, sp
F000:D948		  push	  [bp+arg_C]
F000:D94B		  mov	  [bp+arg_C], bx
F000:D94E		  retn
F000:D94E int_push_regs	  endp ; sp = -10h
F000:D94E
F000:D94F
F000:D94F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D94F
F000:D94F
F000:D94F pop_regs_and_iret proc far				      ;	CODE XREF: int_14:exit1j
F000:D94F							      ;	int_09+197j
F000:D94F							      ;	int_17:exit1j
F000:D94F							      ;	int_10:errorj
F000:D94F							      ;	int_10_00+1Aj
F000:D94F							      ;	int_10_00+1C3j	...
F000:D94F		  pop	  es
F000:D950		  pop	  ds
F000:D951		  pop	  bp
F000:D952		  pop	  di
F000:D953		  pop	  si
F000:D954		  pop	  dx
F000:D955		  pop	  cx
F000:D956		  pop	  bx
F000:D957		  iret
F000:D957 pop_regs_and_iret endp ; sp =	 10h
F000:D957
F000:D958
F000:D958 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D958
F000:D958 ; check whether al is	between	0 and di
F000:D958 ; set	ds to 0x40
F000:D958
F000:D958 check_valid_subfunction proc near			      ;	CODE XREF: int_13+7p
F000:D958							      ;	int_14+7p
F000:D958							      ;	int_16+Bp
F000:D958							      ;	int_17+7p
F000:D958							      ;	int_10+8p
F000:D958		  push	  ax
F000:D959		  mov	  al, ah
F000:D95B		  xor	  ah, ah
F000:D95D		  shl	  ax, 1
F000:D95F		  cmp	  ax, di
F000:D961		  mov	  di, ax
F000:D963		  mov	  ax, 40h ; '@'
F000:D966		  mov	  ds, ax			      ;	ds = 0x40
F000:D968		  pop	  ax
F000:D969		  jnb	  short	error
F000:D96B		  clc
F000:D96C		  retn
F000:D96D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D96D
F000:D96D error:						      ;	CODE XREF: check_valid_subfunction+11j
F000:D96D		  stc
F000:D96E		  retn
F000:D96E check_valid_subfunction endp
F000:D96E
F000:D96F
F000:D96F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D96F
F000:D96F
F000:D96F get_screen_offset proc near				      ;	CODE XREF: scroll_up_or_down+2Ep
F000:D96F							      ;	scroll_up_or_down+4Fp
F000:D96F							      ;	scroll_up_or_down+79p
F000:D96F							      ;	int_10_08+11p
F000:D96F							      ;	int_10_0a+1Cp
F000:D96F		  push	  ax
F000:D970		  push	  dx
F000:D971		  push	  di
F000:D972		  mov	  ax, 0B000h
F000:D975		  cmp	  byte ptr ds:p400.crt_mode, 7
F000:D97A		  jnz	  short	l0
F000:D97C		  xor	  bh, bh
F000:D97E		  mov	  es, ax
F000:D980		  jmp	  short	l1
F000:D982 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D982
F000:D982 l0:							      ;	CODE XREF: get_screen_offset+Bj
F000:D982		  add	  ah, 8
F000:D985		  mov	  es, ax
F000:D987		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:D98C		  jl	  short	l1
F000:D98E		  xor	  bh, bh
F000:D990
F000:D990 l1:							      ;	CODE XREF: get_screen_offset+11j
F000:D990							      ;	get_screen_offset+1Dj
F000:D990		  cmp	  bl, 0
F000:D993		  jz	  short	l2
F000:D995		  mov	  bl, bh
F000:D997		  call	  get_cursor_row_cols_for_page
F000:D99A
F000:D99A l2:							      ;	CODE XREF: get_screen_offset+24j
F000:D99A		  xor	  di, di
F000:D99C		  cmp	  byte ptr ds:p400.crt_mode, 7
F000:D9A1		  jz	  short	l3
F000:D9A3		  push	  dx
F000:D9A4		  mov	  ax, ds:p400.crt_page_len
F000:D9A7		  mov	  bl, bh
F000:D9A9		  xor	  bh, bh
F000:D9AB		  mul	  bx
F000:D9AD		  add	  di, ax
F000:D9AF		  pop	  dx
F000:D9B0
F000:D9B0 l3:							      ;	CODE XREF: get_screen_offset+32j
F000:D9B0		  xor	  ah, ah
F000:D9B2		  mov	  al, dh
F000:D9B4		  mul	  byte ptr ds:p400.crt_nr_cols
F000:D9B8		  shl	  ax, 1
F000:D9BA		  xor	  dh, dh
F000:D9BC		  shl	  dx, 1
F000:D9BE		  add	  ax, dx
F000:D9C0		  mov	  bx, ax
F000:D9C2		  add	  bx, di
F000:D9C4		  pop	  di
F000:D9C5		  pop	  dx
F000:D9C6		  pop	  ax
F000:D9C7		  retn
F000:D9C7 get_screen_offset endp
F000:D9C7
F000:D9C8
F000:D9C8 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D9C8
F000:D9C8
F000:D9C8 multiply_dl_dh_by_8_bis proc near			      ;	CODE XREF: scroll_up_or_down-20BCp
F000:D9C8							      ;	scroll_up_or_down:loc_FD436p
F000:D9C8							      ;	scroll_up_or_down-2082p
F000:D9C8							      ;	scroll_up_or_down:loc_FD490p
F000:D9C8							      ;	gfx_get_ascii_value_for_row_colp
F000:D9C8		  call	  multiply_dl_dh_by_8
F000:D9C8 multiply_dl_dh_by_8_bis endp
F000:D9C8
F000:D9CB
F000:D9CB ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:D9CB
F000:D9CB
F000:D9CB get_address_for_pixel	proc near			      ;	CODE XREF: gfx_print_char:l5p
F000:D9CB							      ;	get_pixel_address_and_mask:l3p
F000:D9CB							      ;	get_pixel_address_and_mask+51p
F000:D9CB		  push	  ax
F000:D9CC		  push	  cx
F000:D9CD		  push	  dx
F000:D9CE		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:D9D3		  jnz	  short	do_video_not_8
F000:D9D5		  jmp	  short	do_video_mode_8
F000:D9D5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D9D7		  db  90h ; 
F000:D9D8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D9D8
F000:D9D8 do_video_not_8:					      ;	CODE XREF: get_address_for_pixel+8j
F000:D9D8		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:D9DD		  jnz	  short	loc_FD9E2
F000:D9DF		  jmp	  loc_FDA61
F000:D9E2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D9E2
F000:D9E2 loc_FD9E2:						      ;	CODE XREF: get_address_for_pixel+12j
F000:D9E2		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:D9E7		  jnz	  short	loc_FD9EC
F000:D9E9		  jmp	  loc_FDAA4
F000:D9EC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:D9EC
F000:D9EC loc_FD9EC:						      ;	CODE XREF: get_address_for_pixel+1Cj
F000:D9EC		  mov	  ax, 28h ; '('
F000:D9EF		  and	  dx, 0FFFEh
F000:D9F3		  mul	  dx
F000:D9F5		  shr	  cx, 1
F000:D9F7		  shr	  cx, 1
F000:D9F9		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:D9FE		  jnz	  short	loc_FDA02
F000:DA00		  shr	  cx, 1
F000:DA02
F000:DA02 loc_FDA02:						      ;	CODE XREF: get_address_for_pixel+33j
F000:DA02		  add	  ax, cx
F000:DA04		  add	  ah, 80h ; '€'
F000:DA07		  pop	  bx
F000:DA08		  test	  bx, 1
F000:DA0C		  jz	  short	loc_FDA11
F000:DA0E		  add	  ah, 20h ; ' '
F000:DA11
F000:DA11 loc_FDA11:						      ;	CODE XREF: get_address_for_pixel+41j
F000:DA11		  mov	  bx, ax
F000:DA13		  pop	  ax
F000:DA14		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:DA19		  jnz	  short	loc_FDA26
F000:DA1B		  mov	  cx, 8
F000:DA1E		  div	  cx
F000:DA20		  mov	  cl, 7
F000:DA22		  sub	  cl, dl
F000:DA24		  jmp	  short	loc_FDA31
F000:DA26 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DA26
F000:DA26 loc_FDA26:						      ;	CODE XREF: get_address_for_pixel+4Ej
F000:DA26		  mov	  cx, 4
F000:DA29		  div	  cx
F000:DA2B		  shl	  dx, 1
F000:DA2D		  mov	  cl, 6
F000:DA2F		  sub	  cl, dl
F000:DA31
F000:DA31 loc_FDA31:						      ;	CODE XREF: get_address_for_pixel+59j
F000:DA31							      ;	get_address_for_pixel:loc_FDA5Fj
F000:DA31							      ;	get_address_for_pixel:loc_FDAA2j
F000:DA31							      ;	get_address_for_pixel+11Bj
F000:DA31		  pop	  ax
F000:DA32		  retn
F000:DA33 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DA33
F000:DA33 do_video_mode_8:					      ;	CODE XREF: get_address_for_pixel+Aj
F000:DA33		  mov	  ax, 28h ; '('
F000:DA36		  and	  dx, 0FFFEh
F000:DA3A		  mul	  dx
F000:DA3C		  shr	  cx, 1
F000:DA3E		  add	  ax, cx
F000:DA40		  add	  ah, 80h ; '€'
F000:DA43		  pop	  bx
F000:DA44		  test	  bx, 1
F000:DA48		  jz	  short	loc_FDA4D
F000:DA4A		  add	  ah, 20h ; ' '
F000:DA4D
F000:DA4D loc_FDA4D:						      ;	CODE XREF: get_address_for_pixel+7Dj
F000:DA4D		  mov	  bx, ax
F000:DA4F		  pop	  ax
F000:DA50		  mov	  cx, 2
F000:DA53		  div	  cx
F000:DA55		  mov	  cx, 4
F000:DA58		  and	  dl, dl
F000:DA5A		  jz	  short	loc_FDA5F
F000:DA5C		  mov	  cx, 0
F000:DA5F
F000:DA5F loc_FDA5F:						      ;	CODE XREF: get_address_for_pixel+8Fj
F000:DA5F		  jmp	  short	loc_FDA31
F000:DA61 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DA61
F000:DA61 loc_FDA61:						      ;	CODE XREF: get_address_for_pixel+14j
F000:DA61		  mov	  ax, 50h ; 'P'
F000:DA64		  and	  dx, 0FFFCh
F000:DA68		  shr	  dx, 1
F000:DA6A		  mul	  dx
F000:DA6C		  shr	  cx, 1
F000:DA6E		  add	  ax, cx
F000:DA70		  add	  ah, 80h ; '€'
F000:DA73		  pop	  bx
F000:DA74		  and	  bx, 3
F000:DA78		  cmp	  bx, 3
F000:DA7B		  jb	  short	loc_FDA80
F000:DA7D		  add	  ah, 20h ; ' '
F000:DA80
F000:DA80 loc_FDA80:						      ;	CODE XREF: get_address_for_pixel+B0j
F000:DA80		  cmp	  bx, 2
F000:DA83		  jb	  short	loc_FDA88
F000:DA85		  add	  ah, 20h ; ' '
F000:DA88
F000:DA88 loc_FDA88:						      ;	CODE XREF: get_address_for_pixel+B8j
F000:DA88		  cmp	  bx, 1
F000:DA8B		  jb	  short	loc_FDA90
F000:DA8D		  add	  ah, 20h ; ' '
F000:DA90
F000:DA90 loc_FDA90:						      ;	CODE XREF: get_address_for_pixel+C0j
F000:DA90		  mov	  bx, ax
F000:DA92		  pop	  ax
F000:DA93		  mov	  cx, 2
F000:DA96		  div	  cx
F000:DA98		  mov	  cx, 4
F000:DA9B		  and	  dl, dl
F000:DA9D		  jz	  short	loc_FDAA2
F000:DA9F		  mov	  cx, 0
F000:DAA2
F000:DAA2 loc_FDAA2:						      ;	CODE XREF: get_address_for_pixel+D2j
F000:DAA2		  jmp	  short	loc_FDA31
F000:DAA4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DAA4
F000:DAA4 loc_FDAA4:						      ;	CODE XREF: get_address_for_pixel+1Ej
F000:DAA4		  mov	  ax, 50h ; 'P'
F000:DAA7		  and	  dx, 0FFFCh
F000:DAAB		  shr	  dx, 1
F000:DAAD		  mul	  dx
F000:DAAF		  shr	  cx, 1
F000:DAB1		  shr	  cx, 1
F000:DAB3		  and	  cx, 0FFFEh
F000:DAB7		  add	  ax, cx
F000:DAB9		  add	  ah, 80h ; '€'
F000:DABC		  pop	  bx
F000:DABD		  and	  bx, 3
F000:DAC1		  cmp	  bx, 3
F000:DAC4		  jb	  short	loc_FDAC9
F000:DAC6		  add	  ah, 20h ; ' '
F000:DAC9
F000:DAC9 loc_FDAC9:						      ;	CODE XREF: get_address_for_pixel+F9j
F000:DAC9		  cmp	  bx, 2
F000:DACC		  jb	  short	loc_FDAD1
F000:DACE		  add	  ah, 20h ; ' '
F000:DAD1
F000:DAD1 loc_FDAD1:						      ;	CODE XREF: get_address_for_pixel+101j
F000:DAD1		  cmp	  bx, 1
F000:DAD4		  jb	  short	loc_FDAD9
F000:DAD6		  add	  ah, 20h ; ' '
F000:DAD9
F000:DAD9 loc_FDAD9:						      ;	CODE XREF: get_address_for_pixel+109j
F000:DAD9		  mov	  bx, ax
F000:DADB		  pop	  ax
F000:DADC		  mov	  cx, 8
F000:DADF		  div	  cx
F000:DAE1		  mov	  cx, 7
F000:DAE4		  sub	  cx, dx
F000:DAE6		  jmp	  loc_FDA31
F000:DAE6 get_address_for_pixel	endp
F000:DAE6
F000:DAE9
F000:DAE9 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DAE9
F000:DAE9
F000:DAE9 multiply_dl_dh_by_8 proc near				      ;	CODE XREF: gfx_print_char+2p
F000:DAE9							      ;	multiply_dl_dh_by_8_bisp
F000:DAE9		  xor	  ch, ch
F000:DAEB		  mov	  cl, dl
F000:DAED		  shl	  cx, 1
F000:DAEF		  shl	  cx, 1
F000:DAF1		  shl	  cx, 1
F000:DAF3		  mov	  dl, dh
F000:DAF5		  xor	  dh, dh
F000:DAF7		  shl	  dx, 1
F000:DAF9		  shl	  dx, 1
F000:DAFB		  shl	  dx, 1
F000:DAFD		  retn
F000:DAFD multiply_dl_dh_by_8 endp
F000:DAFD
F000:DAFE
F000:DAFE ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DAFE
F000:DAFE ; get_rowcols_for_page
F000:DAFE ; in:
F000:DAFE ;   bx = page	number
F000:DAFE ; out:
F000:DAFE ;   dl = rows
F000:DAFE ;   dh = cols
F000:DAFE
F000:DAFE get_cursor_row_cols_for_page proc near		      ;	CODE XREF: get_screen_offset+28p
F000:DAFE							      ;	int_10_03+Bp
F000:DAFE							      ;	int_10_05+2Ep
F000:DAFE							      ;	int_10_08+7p
F000:DAFE							      ;	int_10_0a+Fp
F000:DAFE							      ;	int_10_0e+6p
F000:DAFE		  push	  bx
F000:DAFF		  xor	  bh, bh
F000:DB01		  shl	  bx, 1
F000:DB03		  mov	  dx, [bx+p400.cursor_row_col_in_pages]
F000:DB07		  pop	  bx
F000:DB08		  retn
F000:DB08 get_cursor_row_cols_for_page endp
F000:DB08
F000:DB09
F000:DB09 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DB09
F000:DB09
F000:DB09 add_or_sub_bytes_per_row proc	near			      ;	CODE XREF: scroll_up_or_down+99p
F000:DB09							      ;	scroll_up_or_down+A0p
F000:DB09							      ;	scroll_up_or_down+B7p
F000:DB09		  push	  dx
F000:DB0A		  mov	  dx, ds:p400.crt_nr_cols
F000:DB0E		  shl	  dx, 1
F000:DB10		  cmp	  word ptr [bp+4], 0
F000:DB14		  jnz	  short	l0
F000:DB16		  add	  si, dx
F000:DB18		  add	  di, dx
F000:DB1A		  jmp	  short	l1
F000:DB1A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DB1C		  db  90h ; 
F000:DB1D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DB1D
F000:DB1D l0:							      ;	CODE XREF: add_or_sub_bytes_per_row+Bj
F000:DB1D		  sub	  si, dx
F000:DB1F		  sub	  di, dx
F000:DB21
F000:DB21 l1:							      ;	CODE XREF: add_or_sub_bytes_per_row+11j
F000:DB21		  pop	  dx
F000:DB22		  retn
F000:DB22 add_or_sub_bytes_per_row endp
F000:DB22
F000:DB23
F000:DB23 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DB23
F000:DB23
F000:DB23 sub_FDB23	  proc near				      ;	CODE XREF: scroll_up_or_down-1FB1p
F000:DB23							      ;	scroll_up_or_down-1FA9p
F000:DB23							      ;	scroll_up_or_down-1F2Ep
F000:DB23		  push	  ax
F000:DB24		  mov	  ax, 140h
F000:DB27		  cmp	  word ptr [bp+4], 0
F000:DB2B		  jz	  short	l0
F000:DB2D		  neg	  ax
F000:DB2F
F000:DB2F l0:							      ;	CODE XREF: sub_FDB23+8j
F000:DB2F		  add	  si, ax
F000:DB31		  add	  di, ax
F000:DB33		  pop	  ax
F000:DB34		  retn
F000:DB34 sub_FDB23	  endp
F000:DB34
F000:DB35
F000:DB35 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DB35
F000:DB35
F000:DB35 disable_video_in_80x25_mode_orphan proc near
F000:DB35		  push	  ax
F000:DB36		  push	  dx
F000:DB37		  call	  is_not_80x25_mode_orphan
F000:DB3A		  jnb	  short	exit
F000:DB3C		  mov	  dx, 3DAh
F000:DB3F		  cli
F000:DB40
F000:DB40 wait_vertical_retrace:				      ;	CODE XREF: disable_video_in_80x25_mode_orphan+Ej
F000:DB40		  in	  al, dx			      ;	Video status bits:
F000:DB40							      ;	0: retrace.  1=display is in vert or horiz retrace.
F000:DB40							      ;	1: 1=light pen is triggered; 0=armed
F000:DB40							      ;	2: 1=light pen switch is open; 0=closed
F000:DB40							      ;	3: 1=vertical sync pulse is occurring.
F000:DB41		  test	  al, 8
F000:DB43		  jz	  short	wait_vertical_retrace
F000:DB45		  sti
F000:DB46		  mov	  dx, 3D8h
F000:DB49		  mov	  al, ds:p400.crt_mode_set
F000:DB4C		  and	  al, 110111b			      ;	disable	video
F000:DB4E		  out	  dx, al
F000:DB4F
F000:DB4F exit:							      ;	CODE XREF: disable_video_in_80x25_mode_orphan+5j
F000:DB4F		  pop	  dx
F000:DB50		  pop	  ax
F000:DB51		  retn
F000:DB51 disable_video_in_80x25_mode_orphan endp
F000:DB51
F000:DB52
F000:DB52 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DB52
F000:DB52
F000:DB52 enable_video_in_80x25_mode_orphan proc near
F000:DB52		  call	  is_not_80x25_mode_orphan
F000:DB55		  jnb	  short	exit
F000:DB57		  mov	  dx, 3D8h
F000:DB5A		  mov	  al, ds:p400.crt_mode_set
F000:DB5D		  out	  dx, al
F000:DB5E
F000:DB5E exit:							      ;	CODE XREF: enable_video_in_80x25_mode_orphan+3j
F000:DB5E		  retn
F000:DB5E enable_video_in_80x25_mode_orphan endp
F000:DB5E
F000:DB5F
F000:DB5F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DB5F
F000:DB5F
F000:DB5F play_bell_sound proc near				      ;	CODE XREF: reset:l5p
F000:DB5F							      ;	int_09+19p
F000:DB5F							      ;	put_char_in_keyb_buffer+1Ep
F000:DB5F							      ;	int_10_0e+Dp
F000:DB5F		  push	  ax
F000:DB60		  push	  bx
F000:DB61		  push	  cx
F000:DB62		  mov	  bx, 20h ; ' '
F000:DB65		  in	  al, 61h			      ;	PC/XT PPI port B bits:
F000:DB65							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:DB65							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:DB65							      ;	3: 1=read high switches
F000:DB65							      ;	4: 0=enable RAM	parity checking
F000:DB65							      ;	5: 0=enable I/O	channel	check
F000:DB65							      ;	6: 0=hold keyboard clock low
F000:DB65							      ;	7: 0=enable kbrd
F000:DB67		  push	  ax
F000:DB68
F000:DB68 l0:							      ;	CODE XREF: play_bell_sound+1Cj
F000:DB68		  and	  al, 11111100b
F000:DB6A		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:DB6A							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:DB6A							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:DB6A							      ;	3: 1=read high switches
F000:DB6A							      ;	4: 0=enable RAM	parity checking
F000:DB6A							      ;	5: 0=enable I/O	channel	check
F000:DB6A							      ;	6: 0=hold keyboard clock low
F000:DB6A							      ;	7: 0=enable kbrd
F000:DB6C		  mov	  cx, 120h
F000:DB6F
F000:DB6F l1:							      ;	CODE XREF: play_bell_sound:l1j
F000:DB6F		  loop	  l1
F000:DB71		  or	  al, 10b
F000:DB73		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:DB73							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:DB73							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:DB73							      ;	3: 1=read high switches
F000:DB73							      ;	4: 0=enable RAM	parity checking
F000:DB73							      ;	5: 0=enable I/O	channel	check
F000:DB73							      ;	6: 0=hold keyboard clock low
F000:DB73							      ;	7: 0=enable kbrd
F000:DB75		  mov	  cx, 120h
F000:DB78
F000:DB78 l2:							      ;	CODE XREF: play_bell_sound:l2j
F000:DB78		  loop	  l2
F000:DB7A		  dec	  bx
F000:DB7B		  jnz	  short	l0
F000:DB7D		  pop	  ax
F000:DB7E		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:DB7E							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:DB7E							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:DB7E							      ;	3: 1=read high switches
F000:DB7E							      ;	4: 0=enable RAM	parity checking
F000:DB7E							      ;	5: 0=enable I/O	channel	check
F000:DB7E							      ;	6: 0=hold keyboard clock low
F000:DB7E							      ;	7: 0=enable kbrd
F000:DB80		  pop	  cx
F000:DB81		  pop	  bx
F000:DB82		  pop	  ax
F000:DB83		  retn
F000:DB83 play_bell_sound endp
F000:DB83
F000:DB84
F000:DB84 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DB84
F000:DB84
F000:DB84 is_not_80x25_mode_orphan proc	near			      ;	CODE XREF: disable_video_in_80x25_mode_orphan+2p
F000:DB84							      ;	enable_video_in_80x25_mode_orphanp
F000:DB84		  cmp	  byte ptr ds:p400.crt_mode, 2
F000:DB89		  jl	  short	ok
F000:DB8B		  cmp	  byte ptr ds:p400.crt_mode, 3
F000:DB90		  jg	  short	ok
F000:DB92		  stc
F000:DB93		  retn
F000:DB94 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DB94
F000:DB94 ok:							      ;	CODE XREF: is_not_80x25_mode_orphan+5j
F000:DB94							      ;	is_not_80x25_mode_orphan+Cj
F000:DB94		  clc
F000:DB95		  retn
F000:DB95 is_not_80x25_mode_orphan endp
F000:DB95
F000:DB96
F000:DB96 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DB96
F000:DB96
F000:DB96 int_1a	  proc far				      ;	DATA XREF: F000:FF17o
F000:DB96		  push	  ds
F000:DB97		  mov	  ds, cs:value_0040		      ;	ds = 0x40
F000:DB9C		  cmp	  ah, 80h ; '€'
F000:DB9F		  jz	  short	setup_sound_multiplexer
F000:DBA1		  or	  ah, ah
F000:DBA3		  jz	  short	int_1a_00_read_system_timer
F000:DBA5		  dec	  ah
F000:DBA7		  jz	  short	int_1a_01_set_system_timer
F000:DBA9		  jmp	  short	exit
F000:DBAB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DBAB
F000:DBAB int_1a_00_read_system_timer:				      ;	CODE XREF: int_1a+Dj
F000:DBAB		  mov	  dx, ds:p400.timer_ticks_since_midnight
F000:DBAF		  mov	  cx, ds:p400.timer_ticks_since_midnight+2
F000:DBB3		  mov	  al, ds:p400.timer_overflow
F000:DBB6		  mov	  byte ptr ds:p400.timer_overflow, 0
F000:DBBB		  jmp	  short	exit
F000:DBBD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DBBD
F000:DBBD int_1a_01_set_system_timer:				      ;	CODE XREF: int_1a+11j
F000:DBBD		  mov	  byte ptr ds:p400.timer_overflow, 0
F000:DBC2		  mov	  ds:p400.timer_ticks_since_midnight, dx
F000:DBC6		  mov	  ds:p400.timer_ticks_since_midnight+2,	cx
F000:DBCA		  xor	  ah, ah
F000:DBCC
F000:DBCC exit:							      ;	CODE XREF: int_1a+13j
F000:DBCC							      ;	int_1a+25j
F000:DBCC							      ;	int_1a+4Bj
F000:DBCC		  pop	  ds
F000:DBCD		  iret
F000:DBCE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DBCE
F000:DBCE setup_sound_multiplexer:				      ;	CODE XREF: int_1a+9j
F000:DBCE		  push	  cx
F000:DBCF		  mov	  ah, al
F000:DBD1		  in	  al, 61h			      ;	PC/XT PPI port B bits:
F000:DBD1							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:DBD1							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:DBD1							      ;	3: 1=read high switches
F000:DBD1							      ;	4: 0=enable RAM	parity checking
F000:DBD1							      ;	5: 0=enable I/O	channel	check
F000:DBD1							      ;	6: 0=hold keyboard clock low
F000:DBD1							      ;	7: 0=enable kbrd
F000:DBD3		  and	  al, 9Fh
F000:DBD5		  and	  ah, 3
F000:DBD8		  mov	  cl, 5
F000:DBDA		  rol	  ah, cl
F000:DBDC		  or	  al, ah
F000:DBDE		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:DBDE							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:DBDE							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:DBDE							      ;	3: 1=read high switches
F000:DBDE							      ;	4: 0=enable RAM	parity checking
F000:DBDE							      ;	5: 0=enable I/O	channel	check
F000:DBDE							      ;	6: 0=hold keyboard clock low
F000:DBDE							      ;	7: 0=enable kbrd
F000:DBE0		  pop	  cx
F000:DBE1		  jmp	  short	exit
F000:DBE1 int_1a	  endp
F000:DBE1
F000:DBE3
F000:DBE3 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:DBE3
F000:DBE3 ; INT	08h (8)		     System Timer
F000:DBE3 ;
F000:DBE3 ;	This interrupt is a hardware interrupt (IRQ 0) activated by the	system
F000:DBE3 ;	timer 18.2 times per second (every 55 ms). The default handler does
F000:DBE3 ;	the following:
F000:DBE3 ;
F000:DBE3 ;	     .	 Keeps a count of the number of	timer ticks at memory location
F000:DBE3 ;		 0:46Ch	(System	Timer Counter--long integer). After 24 hours of
F000:DBE3 ;		 operation, a flag is set at memory location 0:470h to signal
F000:DBE3 ;		 this condition	and the	System Timer Counter (0:46Ch) is reset to
F000:DBE3 ;		 0.
F000:DBE3 ;
F000:DBE3 ;	     .	 Decrements the	Diskette Drive Motor Off Counter at memory
F000:DBE3 ;		 location 0:440h if it is not 0. When this location reaches 0,
F000:DBE3 ;		 the diskette drive motor is turned off	and the	Diskette Drive
F000:DBE3 ;		 Motor Status byte at memory location 0:43Fh is	updated	to
F000:DBE3 ;		 reflect that the motor	has been turned	off.
F000:DBE3 ;
F000:DBE3 ;	     .	 Generates INT 1Ch.
F000:DBE3 ;
F000:DBE3 ;	     .	 For the PC Convertible, generates INT 4Ah if an alarm interrupt
F000:DBE3 ;		 occurs.
F000:DBE3
F000:DBE3 int_08	  proc far				      ;	DATA XREF: F000:int_08_1f_tblo
F000:DBE3		  push	  ax
F000:DBE4		  push	  dx
F000:DBE5		  push	  ds
F000:DBE6		  xor	  dx, dx
F000:DBE8		  mov	  ds, cs:value_0040		      ;	ds = 0x40
F000:DBED		  inc	  word ptr ds:p400.timer_ticks_since_midnight
F000:DBF1		  jnz	  short	l0
F000:DBF3		  inc	  word ptr ds:p400.timer_ticks_since_midnight+2
F000:DBF7
F000:DBF7 l0:							      ;	CODE XREF: int_08+Ej
F000:DBF7		  cmp	  word ptr ds:p400.timer_ticks_since_midnight, 0B0h ; '°'
F000:DBFD		  jnz	  short	l1
F000:DBFF		  cmp	  word ptr ds:p400.timer_ticks_since_midnight+2, 18h
F000:DC04		  jnz	  short	l1
F000:DC06		  inc	  byte ptr ds:p400.timer_overflow
F000:DC0A		  mov	  ds:p400.timer_ticks_since_midnight, dx
F000:DC0E		  mov	  ds:p400.timer_ticks_since_midnight+2,	dx
F000:DC12
F000:DC12 l1:							      ;	CODE XREF: int_08+1Aj
F000:DC12							      ;	int_08+21j
F000:DC12		  dec	  byte ptr ds:p400.diskette_motor_off_timeout
F000:DC16		  jnz	  short	l2
F000:DC18		  mov	  dx, 3F2h			      ;	turn off diskette motor
F000:DC1B		  mov	  al, 1111b
F000:DC1D		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:DC1D							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:DC1D							      ;	2:   0=reset diskette controller; 1=enable controller
F000:DC1D							      ;	3:   1=enable diskette DMA and interrupts
F000:DC1D							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:DC1D							      ;
F000:DC1E		  and	  byte ptr ds:p400.diskette_motor_status, 0F0h
F000:DC23
F000:DC23 l2:							      ;	CODE XREF: int_08+33j
F000:DC23		  int	  1Ch				      ;	CLOCK TICK
F000:DC25		  mov	  al, 20h ; ' '
F000:DC27		  out	  20h, al			      ;	Interrupt controller, 8259A.
F000:DC29		  pop	  ds
F000:DC2A		  pop	  dx
F000:DC2B		  pop	  ax
F000:DC2C		  iret
F000:DC2C int_08	  endp
F000:DC2C
F000:DC2C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:DC2D		  dw 1E9h dup(0ADDEh)
F000:DFFF		  db 0FFh
F000:E000 int_1d_monitor  db 38h, 28h, 2Dh, 0Ah, 1Ch, 1, 19h, 1Ah, 2, 8, 6, 7, 4 dup(0); init_modes_0_1
F000:E000							      ;	DATA XREF: F000:FF1Do
F000:E000		  db 71h, 50h, 5Ah, 0Ah, 1Ch, 1, 19h, 1Ah, 2, 8, 6, 7, 4 dup(0); init_modes_2_3	; video	init param
F000:E000		  db 38h, 28h, 2Dh, 0Ah, 7Fh, 6, 64h, 70h, 2, 1, 6, 7, 4 dup(0); init_modes_4_5_6_8
F000:E000		  db 61h, 50h, 52h, 0Fh, 19h, 6, 2 dup(19h), 2,	0Dh, 0Bh, 0Ch, 4 dup(0); init_mode_7
F000:E000		  db 71h, 50h, 5Ah, 0Ah, 3Fh, 6, 32h, 38h, 2, 3, 6, 7, 4 dup(0); init_modes_9_a
F000:E050		  db 0Bh dup(0)
F000:E05B
F000:E05B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E05B
F000:E05B
F000:E05B reset		  proc near				      ;	CODE XREF: reset+2E1j
F000:E05B							      ;	F000:reset_entryJ
F000:E05B
F000:E05B ; FUNCTION CHUNK AT F000:C470	SIZE 00000092 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C523	SIZE 0000022E BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C79F	SIZE 00000094 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C834	SIZE 0000001C BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C877	SIZE 0000005A BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C8D2	SIZE 00000068 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C989	SIZE 00000018 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C9A2	SIZE 0000001A BYTES
F000:E05B ; FUNCTION CHUNK AT F000:C9E3	SIZE 00000053 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:CA37	SIZE 00000018 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:CA74	SIZE 000000D3 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:CC56	SIZE 00000003 BYTES
F000:E05B ; FUNCTION CHUNK AT F000:E083	SIZE 000002BC BYTES
F000:E05B
F000:E05B		  mov	  ax, 40h ; '@'
F000:E05E		  mov	  ds, ax			      ;	ds = 0x40
F000:E060		  mov	  ax, 0BBE8h
F000:E063		  mov	  es, ax			      ;	es = 0xbbe8
F000:E065		  xor	  ax, ax
F000:E067		  cmp	  word ptr ds:p400.POST_reset_flag, 1234h ; soft reset?
F000:E06D		  jnz	  short	l0			      ;	no, jump
F000:E06F		  mov	  ax, ds:p400.keyb_status_flags_1
F000:E072		  and	  ax, 6060h			      ;	filter out insert / caps
F000:E075
F000:E075 l0:							      ;	CODE XREF: reset+12j
F000:E075		  mov	  es:pbbe80.shadow_keyb_status_flags_1,	ax
F000:E079		  mov	  ax, ds:p400.POST_reset_flag
F000:E07C		  mov	  es:pbbe80.shadow_POST_reset_flag, ax
F000:E080		  jmp	  test_system
F000:E080 reset		  endp
F000:E080
F000:E083 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E083 ; START OF FUNCTION CHUNK FOR	reset
F000:E083
F000:E083 reset_cont:						      ;	CODE XREF: reset:_reset_contj
F000:E083		  mov	  ax, 40h ; '@'
F000:E086		  mov	  ds, ax			      ;	ds = 0x40
F000:E088		  mov	  ax, 0BBE8h
F000:E08B		  mov	  es, ax			      ;	es = 0xbbe8
F000:E08D		  cmp	  word ptr es:pbbe80.shadow_POST_reset_flag, 1234h
F000:E094		  jnz	  short	l1
F000:E096		  mov	  ax, es:pbbe80.shadow_keyb_status_flags_1
F000:E09A		  mov	  ds:p400.keyb_status_flags_1, ax
F000:E09D
F000:E09D l1:							      ;	CODE XREF: reset+39j
F000:E09D		  cli
F000:E09E		  cld
F000:E09F		  mov	  ax, 36h ; '6'
F000:E0A2		  mov	  dx, 43h ; 'C'
F000:E0A5		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0A6		  mov	  dx, 40h ; '@'
F000:E0A9		  mov	  al, 0
F000:E0AB		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0AC		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0AD		  mov	  al, 54h ; 'T'
F000:E0AF		  mov	  dx, 43h ; 'C'
F000:E0B2		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0B3		  mov	  al, 12h
F000:E0B5		  mov	  dx, 41h ; 'A'
F000:E0B8		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0B9		  mov	  al, 0B6h ; '¶'
F000:E0BB		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0BD		  xor	  al, al
F000:E0BF		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0C1		  mov	  al, 5
F000:E0C3		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
F000:E0C5 ; setup segment registers
F000:E0C5		  xor	  ax, ax
F000:E0C7		  mov	  es, ax			      ;	es = 0x00
F000:E0C9		  mov	  ax, 30h ; '0'
F000:E0CC		  mov	  ss, ax			      ;	ss = 0x30
F000:E0CE		  mov	  ax, 100h
F000:E0D1		  mov	  sp, ax			      ;	stack: (ss:sp) 0x30:0x100
F000:E0D3		  mov	  ax, cs
F000:E0D5		  mov	  ds, ax			      ;	ds = cs
F000:E0D7 ; setup interrupt vectors
F000:E0D7		  mov	  si, offset int_00_07_tbl
F000:E0DA		  xor	  di, di
F000:E0DC		  mov	  cx, 8
F000:E0DF		  call	  set_int_table
F000:E0E2		  mov	  si, offset int_08_1f_tbl
F000:E0E5		  mov	  di, 20h ; ' '
F000:E0E8		  mov	  cx, 18h
F000:E0EB		  call	  set_int_table
F000:E0EE		  mov	  si, offset int_44_tbl
F000:E0F1		  mov	  di, 110h
F000:E0F4		  mov	  cx, 1
F000:E0F7		  call	  set_int_table
F000:E0FA		  mov	  ax, 0BBE8h
F000:E0FD		  mov	  ds, ax			      ;	dx = 0xbbe8
F000:E0FF		  mov	  dx, ds:pbbe80.field_B
F000:E103		  mov	  cl, 6
F000:E105		  shr	  dx, cl
F000:E107		  add	  dx, 70h ; 'p'
F000:E10A		  mov	  ax, 40h ; '@'
F000:E10D		  mov	  ds, ax			      ;	ds = 0x40
F000:E10F		  mov	  ds:p400.base_mem_kb, dx
F000:E113		  add	  dx, 10h
F000:E116		  mov	  ds:p400.IO_channel_RAM_size, dx
F000:E11A		  mov	  al, 0FFh
F000:E11C		  out	  21h, al			      ;	Interrupt controller, 8259A.
F000:E11E		  in	  al, 61h			      ;	PC/XT PPI port B bits:
F000:E11E							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:E11E							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:E11E							      ;	3: 1=read high switches
F000:E11E							      ;	4: 0=enable RAM	parity checking
F000:E11E							      ;	5: 0=enable I/O	channel	check
F000:E11E							      ;	6: 0=hold keyboard clock low
F000:E11E							      ;	7: 0=enable kbrd
F000:E120		  or	  al, 1
F000:E122		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:E122							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:E122							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:E122							      ;	3: 1=read high switches
F000:E122							      ;	4: 0=enable RAM	parity checking
F000:E122							      ;	5: 0=enable I/O	channel	check
F000:E122							      ;	6: 0=hold keyboard clock low
F000:E122							      ;	7: 0=enable kbrd
F000:E124		  mov	  cx, 4000h
F000:E127
F000:E127 delay0:						      ;	CODE XREF: reset:delay0j
F000:E127		  loop	  delay0
F000:E129		  and	  al, 0FEh
F000:E12B		  out	  61h, al			      ;	PC/XT PPI port B bits:
F000:E12B							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:E12B							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:E12B							      ;	3: 1=read high switches
F000:E12B							      ;	4: 0=enable RAM	parity checking
F000:E12B							      ;	5: 0=enable I/O	channel	check
F000:E12B							      ;	6: 0=hold keyboard clock low
F000:E12B							      ;	7: 0=enable kbrd
F000:E12D		  mov	  ax, 40h ; '@'
F000:E130		  mov	  ds, ax			      ;	ds = 0x40
F000:E132		  mov	  dx, 213h
F000:E135		  mov	  al, 1
F000:E137		  out	  dx, al			      ;	XT Expansion chassis enable
F000:E138		  nop
F000:E139		  mov	  ax, 102Dh
F000:E13C		  mov	  ds:p400.installed_hardware, ax
F000:E13F		  mov	  ax, 1Eh
F000:E142		  mov	  ds:p400.keyb_buffer_head_ptr,	ax
F000:E145		  mov	  ds:p400.keyb_buffer_tail_ptr,	ax
F000:E148		  mov	  ds:p400.keyb_buffer_start_offset_ptr,	ax
F000:E14B		  add	  ax, 20h ; ' '
F000:E14E		  mov	  ds:p400.keyb_buffer_end_offset_ptr, ax
F000:E151		  mov	  byte ptr ds:p400.video_page_data, 3Fh	; '?'
F000:E156		  mov	  al, 0Eh
F000:E158		  out	  0Fh, al			      ;	DMA controller,	8237A-5.
F000:E158							      ;	master clear. Clear or mask any	or
F000:E158							      ;	all of the channels. Bits:
F000:E158							      ;	0: 1=mask channel 0; 0=enable
F000:E158							      ;	1: 1=mask channel 1;
F000:E158							      ;	2: 1=mask channel 2;
F000:E158							      ;	3: 1=mask channel 3;
F000:E15A		  out	  0Ch, al			      ;	DMA controller,	8237A-5.
F000:E15A							      ;	clear byte pointer flip-flop.
F000:E15C		  mov	  dx, 4
F000:E15F
F000:E15F l2:							      ;	CODE XREF: reset+120j
F000:E15F		  mov	  cx, 1
F000:E162
F000:E162 l3:							      ;	CODE XREF: reset+11Aj
F000:E162		  mov	  ax, cx
F000:E164		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:E164							      ;	channel	2 base address
F000:E164							      ;	(also sets current address)
F000:E165		  mov	  al, ah
F000:E167		  out	  dx, al			      ;	DMA controller,	8237A-5.
F000:E167							      ;	channel	2 base address
F000:E167							      ;	(also sets current address)
F000:E168		  nop
F000:E169		  in	  al, dx			      ;	DMA controller,	8237A-5.
F000:E169							      ;	channel	2 current address
F000:E16A		  mov	  ah, al
F000:E16C		  in	  al, dx			      ;	DMA controller,	8237A-5.
F000:E16C							      ;	channel	2 current address
F000:E16D		  xchg	  ah, al
F000:E16F		  cmp	  ax, cx
F000:E171		  jnz	  short	l4
F000:E173		  rcl	  cx, 1
F000:E175		  jnb	  short	l3
F000:E177		  inc	  dx
F000:E178		  cmp	  dx, 6
F000:E17B		  jnz	  short	l2
F000:E17D		  jmp	  short	l5
F000:E17F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E17F
F000:E17F l4:							      ;	CODE XREF: reset+116j
F000:E17F		  or	  word ptr ds:p400.installed_hardware, 100h
F000:E185
F000:E185 l5:							      ;	CODE XREF: reset+122j
F000:E185		  call	  play_bell_sound
F000:E188		  in	  al, 21h			      ;	Interrupt controller, 8259A.
F000:E18A		  and	  al, 0BFh
F000:E18C		  out	  21h, al			      ;	Interrupt controller, 8259A.
F000:E18E		  sti
F000:E18F		  mov	  ah, 0
F000:E191		  mov	  dl, 0
F000:E193		  int	  13h				      ;	DISK - RESET DISK SYSTEM
F000:E193							      ;	DL = drive (if bit 7 is	set both hard disks and	floppy disks reset)
F000:E195		  mov	  ax, 201h
F000:E198		  mov	  bx, 0F000h
F000:E19B		  mov	  es, bx
F000:E19D		  xor	  bx, bx
F000:E19F		  mov	  cx, 501h
F000:E1A2		  xor	  dx, dx
F000:E1A4		  int	  13h				      ;	DISK - READ SECTORS INTO MEMORY
F000:E1A4							      ;	AL = number of sectors to read,	CH = track, CL = sector
F000:E1A4							      ;	DH = head, DL =	drive, ES:BX ->	buffer to fill
F000:E1A4							      ;	Return:	CF set on error, AH = status, AL = number of sectors read
F000:E1A6		  mov	  ah, 0
F000:E1A8		  mov	  dl, 0
F000:E1AA		  int	  13h				      ;	DISK - RESET DISK SYSTEM
F000:E1AA							      ;	DL = drive (if bit 7 is	set both hard disks and	floppy disks reset)
F000:E1AC		  mov	  ax, 201h
F000:E1AF		  mov	  bx, 0F000h
F000:E1B2		  mov	  es, bx
F000:E1B4		  xor	  bx, bx
F000:E1B6		  mov	  cx, 0A01h
F000:E1B9		  mov	  dx, 1
F000:E1BC		  int	  13h				      ;	DISK - READ SECTORS INTO MEMORY
F000:E1BC							      ;	AL = number of sectors to read,	CH = track, CL = sector
F000:E1BC							      ;	DH = head, DL =	drive, ES:BX ->	buffer to fill
F000:E1BC							      ;	Return:	CF set on error, AH = status, AL = number of sectors read
F000:E1BE		  jnb	  short	l6
F000:E1C0		  test	  ah, 40h
F000:E1C3		  jnz	  short	l7
F000:E1C5
F000:E1C5 l6:							      ;	CODE XREF: reset+163j
F000:E1C5		  or	  word ptr ds:p400.installed_hardware, 40h
F000:E1CB
F000:E1CB l7:							      ;	CODE XREF: reset+168j
F000:E1CB		  cli
F000:E1CC		  in	  al, 21h			      ;	Interrupt controller, 8259A.
F000:E1CE		  or	  al, 40h
F000:E1D0		  out	  21h, al			      ;	Interrupt controller, 8259A.
F000:E1D2		  mov	  al, 0Fh
F000:E1D4		  mov	  dx, 3F2h
F000:E1D7		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
F000:E1D7							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
F000:E1D7							      ;	2:   0=reset diskette controller; 1=enable controller
F000:E1D7							      ;	3:   1=enable diskette DMA and interrupts
F000:E1D7							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
F000:E1D7							      ;
F000:E1D8		  mov	  bx, p400.lpt0_base_addr
F000:E1DB		  mov	  dx, 3BCh
F000:E1DE		  mov	  al, 0A5h ; '¥'
F000:E1E0		  out	  dx, al			      ;	Printer	Data Latch:
F000:E1E0							      ;	send byte to printer
F000:E1E1		  in	  al, dx			      ;	Printer	Data Latch:
F000:E1E1							      ;	fetch last byte	sent
F000:E1E2		  cmp	  al, 0A5h ; '¥'
F000:E1E4		  jnz	  short	l8
F000:E1E6		  mov	  [bx],	dx
F000:E1E8		  inc	  bx
F000:E1E9		  inc	  bx
F000:E1EA		  add	  word ptr ds:p400.installed_hardware, 4000h
F000:E1F0
F000:E1F0 l8:							      ;	CODE XREF: reset+189j
F000:E1F0		  mov	  dx, 378h
F000:E1F3		  mov	  al, 0A5h ; '¥'
F000:E1F5		  out	  dx, al			      ;	Printer	Data Latch:
F000:E1F5							      ;	send byte to printer
F000:E1F6		  in	  al, dx			      ;	Printer	Data Latch:
F000:E1F6							      ;	fetch last byte	sent
F000:E1F7		  cmp	  al, 0A5h ; '¥'
F000:E1F9		  jnz	  short	l9
F000:E1FB		  mov	  [bx],	dx
F000:E1FD		  inc	  bx
F000:E1FE		  inc	  bx
F000:E1FF		  add	  word ptr ds:p400.installed_hardware, 4000h
F000:E205
F000:E205 l9:							      ;	CODE XREF: reset+19Ej
F000:E205		  mov	  dx, 278h
F000:E208		  mov	  al, 0A5h ; '¥'
F000:E20A		  out	  dx, al			      ;	Printer	Data Latch:
F000:E20A							      ;	send byte to printer
F000:E20B		  in	  al, dx			      ;	Printer	Data Latch:
F000:E20B							      ;	fetch last byte	sent
F000:E20C		  cmp	  al, 0A5h ; '¥'
F000:E20E		  jnz	  short	l10
F000:E210		  mov	  [bx],	dx
F000:E212		  add	  word ptr ds:p400.installed_hardware, 4000h
F000:E218
F000:E218 l10:							      ;	CODE XREF: reset+1B3j
F000:E218		  mov	  bx, p400.lpt0_timeout
F000:E21B		  mov	  word ptr [bx], 1414h
F000:E21F		  mov	  word ptr [bx+2], 1414h
F000:E224		  mov	  bx, p400
F000:E227		  mov	  dx, 3FBh
F000:E22A		  mov	  al, 80h ; '€'
F000:E22C		  out	  dx, al			      ;	COM: line control register bits:
F000:E22C							      ;	0-1: word length: 00=5,	01=6, 10=7, 11=8
F000:E22C							      ;	2:   stop bits:	0=1,1=2
F000:E22C							      ;	3-4: parity: x0=None, 01=Odd, 11=Even
F000:E22C							      ;	5:   stuck parity
F000:E22C							      ;	6:   enable break control. 1=start sending 0s (spaces)
F000:E22C							      ;	7:   DLAB (Divisor Latch Access	Bit)
F000:E22D		  mov	  dx, 3F8h
F000:E230		  mov	  al, 0AAh ; 'ª'
F000:E232		  out	  dx, al			      ;	COM: transmitter holding register
F000:E232							      ;	or (when DLAB=1) divisor latch low byte.
F000:E233		  in	  al, dx			      ;	COM: receiver buffer register.
F000:E233							      ;	8 bits of character received.
F000:E234		  cmp	  al, 0AAh ; 'ª'
F000:E236		  jnz	  short	l11
F000:E238		  mov	  [bx],	dx
F000:E23A		  inc	  bx
F000:E23B		  inc	  bx
F000:E23C		  add	  word ptr ds:p400.installed_hardware, 200h
F000:E242
F000:E242 l11:							      ;	CODE XREF: reset+1DBj
F000:E242		  mov	  dx, 2FBh
F000:E245		  mov	  al, 80h ; '€'
F000:E247		  out	  dx, al			      ;	COM: line control register bits:
F000:E247							      ;	0-1: word length: 00=5,	01=6, 10=7, 11=8
F000:E247							      ;	2:   stop bits:	0=1,1=2
F000:E247							      ;	3-4: parity: x0=None, 01=Odd, 11=Even
F000:E247							      ;	5:   stuck parity
F000:E247							      ;	6:   enable break control. 1=start sending 0s (spaces)
F000:E247							      ;	7:   DLAB (Divisor Latch Access	Bit)
F000:E248		  mov	  dx, 2F8h
F000:E24B		  mov	  al, 0AAh ; 'ª'
F000:E24D		  out	  dx, al			      ;	COM: transmitter holding register
F000:E24D							      ;	or (when DLAB=1) divisor latch low byte.
F000:E24E		  in	  al, dx			      ;	COM: receiver buffer register.
F000:E24E							      ;	8 bits of character received.
F000:E24F		  cmp	  al, 0AAh ; 'ª'
F000:E251		  jnz	  short	l12
F000:E253		  mov	  [bx],	dx
F000:E255		  add	  word ptr ds:p400.installed_hardware, 200h
F000:E25B
F000:E25B l12:							      ;	CODE XREF: reset+1F6j
F000:E25B		  mov	  bx, p400.comm_0_timeout
F000:E25E		  mov	  word ptr [bx], 101h
F000:E262		  mov	  word ptr [bx+2], 101h
F000:E267		  mov	  ah, 1
F000:E269		  mov	  dx, 0
F000:E26C		  int	  17h				      ;	PRINTER	- INITIALIZE
F000:E26C							      ;	DX = printer port (0-3)
F000:E26C							      ;	Return:	AH = status
F000:E26E		  mov	  ax, 43h ; 'C'
F000:E271		  mov	  dx, 0
F000:E274		  int	  14h				      ;	SERIAL I/O - INITIALIZE	USART
F000:E274							      ;	AL = initializing parameters, DX = port	number (0-3)
F000:E274							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
F000:E276		  mov	  ah, 1
F000:E278		  int	  14h				      ;	SERIAL I/O - TRANSMIT CHARACTER
F000:E278							      ;	AL = character,	DX = port number (0-3)
F000:E278							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
F000:E27A		  mov	  ax, 43h ; 'C'
F000:E27D		  mov	  dx, 1
F000:E280		  int	  14h				      ;	SERIAL I/O - INITIALIZE	USART
F000:E280							      ;	AL = initializing parameters, DX = port	number (0-3)
F000:E280							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
F000:E282		  mov	  ah, 1
F000:E284		  int	  14h				      ;	SERIAL I/O - TRANSMIT CHARACTER
F000:E284							      ;	AL = character,	DX = port number (0-3)
F000:E284							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
F000:E286		  mov	  ax, 0C800h
F000:E289		  mov	  ds, ax			      ;	ds = 0xc800
F000:E28B		  mov	  cx, 58h ; 'X'
F000:E28E
F000:E28E l13:							      ;	CODE XREF: reset+26Ej
F000:E28E		  xor	  si, si
F000:E290		  cmp	  word ptr [si], 0AA55h
F000:E294		  jnz	  short	l16
F000:E296		  push	  cx
F000:E297		  mov	  cl, 0
F000:E299		  mov	  ch, [si+2]
F000:E29C		  add	  cx, cx
F000:E29E		  mov	  al, 0
F000:E2A0
F000:E2A0 l14:							      ;	CODE XREF: reset+248j
F000:E2A0		  add	  al, [si]
F000:E2A2		  inc	  si
F000:E2A3		  loop	  l14
F000:E2A5		  or	  al, al
F000:E2A7		  jnz	  short	l15
F000:E2A9		  mov	  ax, 40h ; '@'
F000:E2AC		  mov	  es, ax			      ;	es = 0x40
F000:E2AE		  mov	  word ptr es:p400.POST_entry_point_offset, 3
F000:E2B5		  mov	  word ptr es:p400.POST_entry_point_seg, ds
F000:E2BA		  push	  ds
F000:E2BB		  call	  dword	ptr es:p400.POST_entry_point_offset
F000:E2C0		  pop	  ds
F000:E2C1
F000:E2C1 l15:							      ;	CODE XREF: reset+24Cj
F000:E2C1		  pop	  cx
F000:E2C2
F000:E2C2 l16:							      ;	CODE XREF: reset+239j
F000:E2C2		  mov	  ax, ds
F000:E2C4		  add	  ax, 80h ; '€'
F000:E2C7		  mov	  ds, ax
F000:E2C9		  loop	  l13
F000:E2CB		  in	  al, 21h			      ;	Interrupt controller, 8259A.
F000:E2CD		  and	  al, 11111101b			      ;	mask off bit 1.	IRQ9 (Keyboard)	enabled, rest disabled
F000:E2CF		  out	  21h, al			      ;	Interrupt controller, 8259A.
F000:E2D1		  sti
F000:E2D2		  mov	  ah, 1
F000:E2D4		  int	  16h				      ;	KEYBOARD - CHECK BUFFER, DO NOT	CLEAR
F000:E2D4							      ;	Return:	ZF clear if character in buffer
F000:E2D4							      ;	AH = scan code,	AL = character
F000:E2D4							      ;	ZF set if no character in buffer
F000:E2D6		  cli
F000:E2D7		  jz	  short	l18
F000:E2D9		  cmp	  ax, 9900h			      ;	scancode / bytecode for	F12
F000:E2DC		  mov	  ax, 40h ; '@'
F000:E2DF		  mov	  ds, ax			      ;	ds = 0x40
F000:E2E1		  jnz	  short	l17
F000:E2E3		  mov	  ax, ds:p400.installed_hardware
F000:E2E6		  and	  ax, 0FFCFh			      ;	mask off "initial video	mode" bits
F000:E2E9		  or	  ax, 10h			      ;	initial	video mode = 40x25 color
F000:E2EC		  mov	  ds:p400.installed_hardware, ax
F000:E2EF		  xor	  ax, ax
F000:E2F1		  mov	  es, ax			      ;	es = 0x00
F000:E2F3		  mov	  bx, 74h ; 't'                       ; int 0x1d
F000:E2F6		  mov	  ax, offset int_1d_tv		      ;	video table parameter
F000:E2F9		  mov	  es:[bx], ax
F000:E2FC		  mov	  word ptr es:[bx+2], cs
F000:E300
F000:E300 l17:							      ;	CODE XREF: reset+286j
F000:E300		  mov	  ax, ds:p400.keyb_buffer_start_offset_ptr
F000:E303		  mov	  ds:p400.keyb_buffer_head_ptr,	ax
F000:E306		  mov	  ds:p400.keyb_buffer_tail_ptr,	ax
F000:E309
F000:E309 l18:							      ;	CODE XREF: reset+27Cj
F000:E309		  in	  al, 21h			      ;	Interrupt controller, 8259A.
F000:E30B		  or	  al, 10b			      ;	mask off everything execept bit	1. Keyboard disabled, rest enabled
F000:E30D		  out	  21h, al			      ;	Interrupt controller, 8259A.
F000:E30F		  mov	  ax, 40h ; '@'
F000:E312		  mov	  ds, ax			      ;	ds = 0x40
F000:E314		  xor	  ax, ax
F000:E316		  mov	  bx, ds:p400.installed_hardware
F000:E31A		  and	  bx, 30h
F000:E31E		  mov	  al, 7
F000:E320		  cmp	  bl, 30h ; '0'
F000:E323		  jz	  short	l19
F000:E325		  mov	  al, 2
F000:E327		  cmp	  bl, 20h ; ' '
F000:E32A		  jz	  short	l19
F000:E32C		  mov	  al, 0
F000:E32E
F000:E32E l19:							      ;	CODE XREF: reset+2C8j
F000:E32E							      ;	reset+2CFj
F000:E32E		  int	  10h				      ;	- VIDEO	- SET VIDEO MODE
F000:E32E							      ;	AL = mode
F000:E330		  mov	  al, 0BCh ; '¼'
F000:E332		  out	  21h, al			      ;	Interrupt controller, 8259A.
F000:E334		  mov	  si, offset aBiosRomVersion	      ;	"BIOS ROM version 01.00.00\r\nCopyright	19"...
F000:E337		  call	  print_dos_string
F000:E33A		  int	  19h				      ;	DISK BOOT
F000:E33A							      ;	causes reboot of disk system
F000:E33C		  jmp	  reset
F000:E33C ; END	OF FUNCTION CHUNK FOR reset
F000:E33F
F000:E33F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E33F
F000:E33F
F000:E33F set_int_table	  proc near				      ;	CODE XREF: reset+84p
F000:E33F							      ;	reset+90p
F000:E33F							      ;	reset+9Cp
F000:E33F							      ;	set_int_table+2j
F000:E33F		  movsw
F000:E340		  stosw
F000:E341		  loop	  set_int_table
F000:E343		  retn
F000:E343 set_int_table	  endp
F000:E343
F000:E344
F000:E344 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E344
F000:E344
F000:E344 int_18	  proc far				      ;	DATA XREF: F000:FF13o
F000:E344		  pop	  si
F000:E345		  pop	  si
F000:E346		  pop	  si
F000:E347		  mov	  si, offset aInsertSystemDisketteA   ;	"\n\rInsert System Diskette and\n\rStrike an"...
F000:E34A		  call	  print_dos_string
F000:E34D		  xor	  ah, ah
F000:E34F		  int	  16h				      ;	KEYBOARD - READ	CHAR FROM BUFFER, WAIT IF EMPTY
F000:E34F							      ;	Return:	AH = scan code,	AL = character
F000:E351		  int	  19h				      ;	DISK BOOT
F000:E351							      ;	causes reboot of disk system
F000:E353		  iret
F000:E353 int_18	  endp ; sp =  8
F000:E353
F000:E353 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E354 aInsertSystemDisketteA db 0Ah				      ;	DATA XREF: int_18+3o
F000:E354		  db 0Dh,'Insert System Diskette and',0Ah
F000:E354		  db 0Dh,'Strike any key when ready',0Ah
F000:E354		  db 0Dh,'$'
F000:E38E
F000:E38E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E38E
F000:E38E
F000:E38E print_dos_string proc	near				      ;	CODE XREF: reset+2DCp
F000:E38E							      ;	int_18+6p
F000:E38E							      ;	print_dos_string+10j
F000:E38E		  mov	  al, cs:[si]
F000:E391		  cmp	  al, 24h ; '$'
F000:E393		  jz	  short	lret
F000:E395		  push	  si
F000:E396		  mov	  ah, 0Eh
F000:E398		  mov	  bl, 7
F000:E39A		  int	  10h				      ;	- VIDEO	- WRITE	CHARACTER AND ADVANCE CURSOR (TTY WRITE)
F000:E39A							      ;	AL = character,	BH = display page (alpha modes)
F000:E39A							      ;	BL = foreground	color (graphics	modes)
F000:E39C		  pop	  si
F000:E39D		  inc	  si
F000:E39E		  jmp	  short	print_dos_string
F000:E3A0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E3A0
F000:E3A0 lret:							      ;	CODE XREF: print_dos_string+5j
F000:E3A0		  retn
F000:E3A0 print_dos_string endp
F000:E3A0
F000:E3A1
F000:E3A1 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E3A1
F000:E3A1
F000:E3A1 int_15	  proc far				      ;	DATA XREF: F000:FF0Do
F000:E3A1		  mov	  ah, 86h ; '†'
F000:E3A3		  stc
F000:E3A4		  retf	  2
F000:E3A4 int_15	  endp
F000:E3A4
F000:E3A7
F000:E3A7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E3A7
F000:E3A7
F000:E3A7 int_ack_handler proc far				      ;	DATA XREF: F000:FEF7o
F000:E3A7							      ;	F000:FEF9o
F000:E3A7							      ;	F000:FEFBo
F000:E3A7							      ;	F000:FEFDo
F000:E3A7							      ;	F000:FF01o
F000:E3A7		  push	  ax
F000:E3A8		  push	  ds
F000:E3A9		  mov	  ax, 40h ; '@'
F000:E3AC		  mov	  ds, ax
F000:E3AE		  mov	  al, 0Bh
F000:E3B0		  out	  20h, al			      ;	Interrupt controller, 8259A.
F000:E3B2		  in	  al, 20h			      ;	Interrupt controller, 8259A.
F000:E3B4		  or	  al, al
F000:E3B6		  jz	  short	l0
F000:E3B8		  mov	  ah, al
F000:E3BA		  in	  al, 21h			      ;	Interrupt controller, 8259A.
F000:E3BC		  or	  al, ah
F000:E3BE		  out	  21h, al			      ;	Interrupt controller, 8259A.
F000:E3C0		  mov	  al, 20h ; ' '
F000:E3C2		  out	  20h, al			      ;	Interrupt controller, 8259A.
F000:E3C4		  jmp	  short	l1
F000:E3C6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E3C6
F000:E3C6 l0:							      ;	CODE XREF: int_ack_handler+Fj
F000:E3C6		  mov	  ah, 0FFh
F000:E3C8
F000:E3C8 l1:							      ;	CODE XREF: int_ack_handler+1Dj
F000:E3C8		  mov	  ds:p400.POST_last_unexpected_int, ah
F000:E3CC		  pop	  ds
F000:E3CD		  pop	  ax
F000:E3CE		  iret
F000:E3CE int_ack_handler endp
F000:E3CE
F000:E3CE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E3CF value_7c00	  dd 7C00h				      ;	DATA XREF: int_19:l1r
F000:E3CF							      ;	0000:7c00 should have the boot code
F000:E3D3 aByLsd	  db 'by LSD'                                 ; Tandy developer author?
F000:E3D9		  db 319h dup(0)
F000:E6F2
F000:E6F2 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E6F2
F000:E6F2
F000:E6F2 int_19	  proc near				      ;	CODE XREF: int_19+29j
F000:E6F2							      ;	DATA XREF: F000:FF15o
F000:E6F2		  pop	  cx
F000:E6F3		  pop	  cx
F000:E6F4		  pop	  cx
F000:E6F5		  mov	  cx, 5
F000:E6F8
F000:E6F8 l0:							      ;	CODE XREF: int_19+25j
F000:E6F8		  sti
F000:E6F9		  push	  cx
F000:E6FA		  mov	  ah, 0
F000:E6FC		  int	  13h				      ;	DISK - RESET DISK SYSTEM
F000:E6FC							      ;	DL = drive (if bit 7 is	set both hard disks and	floppy disks reset)
F000:E6FE		  mov	  bx, 7C00h
F000:E701		  mov	  ax, 0
F000:E704		  mov	  es, ax
F000:E706		  mov	  dl, 0
F000:E708		  mov	  dh, 0
F000:E70A		  mov	  ch, 0
F000:E70C		  mov	  cl, 1
F000:E70E		  mov	  al, 1
F000:E710		  mov	  ah, 2
F000:E712		  int	  13h				      ;	DISK - READ SECTORS INTO MEMORY
F000:E712							      ;	AL = number of sectors to read,	CH = track, CL = sector
F000:E712							      ;	DH = head, DL =	drive, ES:BX ->	buffer to fill
F000:E712							      ;	Return:	CF set on error, AH = status, AL = number of sectors read
F000:E714		  pop	  cx
F000:E715		  jnb	  short	l1
F000:E717		  loop	  l0
F000:E719		  int	  18h				      ;	TRANSFER TO ROM	BASIC
F000:E719							      ;	causes transfer	to ROM-based BASIC (IBM-PC)
F000:E719							      ;	often reboots a	compatible; often has no effect	at all
F000:E71B		  jmp	  short	int_19
F000:E71D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E71D
F000:E71D l1:							      ;	CODE XREF: int_19+23j
F000:E71D		  jmp	  cs:value_7c00
F000:E71D int_19	  endp
F000:E71D
F000:E71D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E722		  db 7 dup(0)
F000:E729 comm_parameters dw 417h				      ;	DATA XREF: int_14+48r
F000:E72B		  dw 300h
F000:E72D		  dw 180h
F000:E72F		  dw 0C0h
F000:E731		  dw 60h
F000:E733		  dw 30h
F000:E735		  dw 18h
F000:E737		  dw 0Ch
F000:E739
F000:E739 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E739
F000:E739
F000:E739 int_14	  proc far				      ;	DATA XREF: F000:FF0Bo
F000:E739		  call	  int_push_regs
F000:E73C		  mov	  di, 8
F000:E73F		  nop
F000:E740		  call	  check_valid_subfunction
F000:E743		  jb	  short	exit0
F000:E745		  mov	  bx, dx
F000:E747		  xor	  cx, cx
F000:E749		  mov	  cl, [bx+p400.comm_0_timeout]
F000:E74D		  shl	  bx, 1
F000:E74F		  mov	  dx, [bx+p400.comm_0_base_addr]
F000:E753		  or	  dx, dx
F000:E755		  jnz	  short	l0
F000:E757		  xor	  ah, ah
F000:E759		  jmp	  exit1
F000:E75C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E75C
F000:E75C l0:							      ;	CODE XREF: int_14+1Cj
F000:E75C		  jmp	  word ptr cs:int_14_jump_tbl[di]
F000:E75C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E761 int_14_jump_tbl:					      ;	DATA XREF: int_14:l0r
F000:E761		  dw offset int_14_00
F000:E763		  dw offset int_14_01
F000:E765		  dw offset int_14_02
F000:E767		  dw offset int_14_03
F000:E769 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E769
F000:E769 exit0:						      ;	CODE XREF: int_14+Aj
F000:E769		  jmp	  exit1
F000:E76C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E76C
F000:E76C int_14_00:						      ;	CODE XREF: int_14:l0j
F000:E76C							      ;	DATA XREF: int_14:int_14_jump_tblo
F000:E76C		  mov	  ah, al
F000:E76E		  mov	  al, 80h ; '€'
F000:E770		  add	  dx, 3
F000:E773		  out	  dx, al
F000:E774		  dec	  dx
F000:E775		  dec	  dx
F000:E776		  mov	  bl, ah
F000:E778		  and	  bl, 0E0h
F000:E77B		  mov	  cl, 4
F000:E77D		  shr	  bl, cl
F000:E77F		  xor	  bh, bh
F000:E781		  mov	  cx, cs:comm_parameters[bx]
F000:E786		  mov	  al, ch
F000:E788		  out	  dx, al
F000:E789		  mov	  al, cl
F000:E78B		  dec	  dx
F000:E78C		  out	  dx, al
F000:E78D		  mov	  al, ah
F000:E78F		  and	  al, 1Fh
F000:E791		  add	  dx, 3
F000:E794		  out	  dx, al
F000:E795		  sub	  dx, 3
F000:E798		  inc	  dx
F000:E799		  xor	  al, al
F000:E79B		  out	  dx, al
F000:E79C		  dec	  dx
F000:E79D		  jmp	  int_14_03
F000:E7A0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E7A0
F000:E7A0 int_14_01:						      ;	CODE XREF: int_14:l0j
F000:E7A0							      ;	DATA XREF: int_14+2Ao
F000:E7A0		  mov	  ah, al
F000:E7A2		  mov	  al, 3
F000:E7A4		  add	  dx, 4
F000:E7A7		  out	  dx, al
F000:E7A8		  inc	  dx
F000:E7A9		  inc	  dx
F000:E7AA		  xor	  bx, bx
F000:E7AC
F000:E7AC l1:							      ;	CODE XREF: int_14+94j
F000:E7AC							      ;	int_14+96j
F000:E7AC		  in	  al, dx
F000:E7AD		  test	  al, 30h
F000:E7AF		  jz	  short	l4
F000:E7B1		  xor	  bx, bx
F000:E7B3		  dec	  dx
F000:E7B4
F000:E7B4 l2:							      ;	CODE XREF: int_14+81j
F000:E7B4							      ;	int_14+83j
F000:E7B4		  in	  al, dx
F000:E7B5		  test	  al, 20h
F000:E7B7		  jnz	  short	l3
F000:E7B9		  dec	  bx
F000:E7BA		  jnz	  short	l2
F000:E7BC		  loop	  l2
F000:E7BE		  jmp	  short	l5
F000:E7C0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E7C0
F000:E7C0 l3:							      ;	CODE XREF: int_14+7Ej
F000:E7C0		  sub	  dx, 5
F000:E7C3		  mov	  al, ah
F000:E7C5		  out	  dx, al
F000:E7C6		  xchg	  ah, al
F000:E7C8		  xor	  ah, ah
F000:E7CA		  jmp	  short	exit1
F000:E7CC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E7CC
F000:E7CC l4:							      ;	CODE XREF: int_14+76j
F000:E7CC		  dec	  bx
F000:E7CD		  jnz	  short	l1
F000:E7CF		  loop	  l1
F000:E7D1		  dec	  dx
F000:E7D2
F000:E7D2 l5:							      ;	CODE XREF: int_14+85j
F000:E7D2		  in	  al, dx
F000:E7D3		  or	  al, 80h
F000:E7D5		  xchg	  ah, al
F000:E7D7		  and	  ah, 9Eh
F000:E7DA		  jmp	  short	exit1
F000:E7DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E7DC
F000:E7DC int_14_02:						      ;	CODE XREF: int_14:l0j
F000:E7DC							      ;	DATA XREF: int_14+2Co
F000:E7DC		  mov	  al, 1
F000:E7DE		  add	  dx, 4
F000:E7E1		  out	  dx, al
F000:E7E2		  sub	  dx, 4
F000:E7E5		  xor	  bx, bx
F000:E7E7
F000:E7E7 l6:							      ;	CODE XREF: int_14+BAj
F000:E7E7							      ;	int_14+BCj
F000:E7E7		  add	  dx, 6
F000:E7EA		  in	  al, dx
F000:E7EB		  sub	  dx, 6
F000:E7EE		  test	  al, 20h
F000:E7F0		  jnz	  short	l7
F000:E7F2		  dec	  bx
F000:E7F3		  jnz	  short	l6
F000:E7F5		  loop	  l6
F000:E7F7		  jmp	  short	l10
F000:E7F9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E7F9
F000:E7F9 l7:							      ;	CODE XREF: int_14+B7j
F000:E7F9		  xor	  bx, bx
F000:E7FB
F000:E7FB l8:							      ;	CODE XREF: int_14+D6j
F000:E7FB							      ;	int_14+D8j
F000:E7FB		  add	  dx, 5
F000:E7FE		  in	  al, dx
F000:E7FF		  sub	  dx, 5
F000:E802		  test	  al, 1
F000:E804		  jz	  short	l9
F000:E806		  mov	  ah, al
F000:E808		  and	  ah, 1Eh
F000:E80B		  in	  al, dx
F000:E80C		  jmp	  short	exit1
F000:E80E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E80E
F000:E80E l9:							      ;	CODE XREF: int_14+CBj
F000:E80E		  dec	  bx
F000:E80F		  jnz	  short	l8
F000:E811		  loop	  l8
F000:E813
F000:E813 l10:							      ;	CODE XREF: int_14+BEj
F000:E813		  xor	  ah, ah
F000:E815		  add	  dx, 5
F000:E818		  in	  al, dx
F000:E819		  or	  al, 80h
F000:E81B		  xchg	  ah, al
F000:E81D		  or	  ah, 9Eh
F000:E820		  jmp	  short	exit1
F000:E822 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E822
F000:E822 int_14_03:						      ;	CODE XREF: int_14:l0j
F000:E822							      ;	int_14+64j
F000:E822							      ;	DATA XREF: int_14+2Eo
F000:E822		  add	  dx, 5
F000:E825		  in	  al, dx
F000:E826		  mov	  ah, al
F000:E828		  inc	  dx
F000:E829		  in	  al, dx
F000:E82A
F000:E82A exit1:						      ;	CODE XREF: int_14+20j
F000:E82A							      ;	int_14:exit0j
F000:E82A							      ;	int_14+91j
F000:E82A							      ;	int_14+A1j
F000:E82A							      ;	int_14+D3j
F000:E82A							      ;	int_14+E7j
F000:E82A		  jmp	  near ptr pop_regs_and_iret
F000:E82A int_14	  endp
F000:E82A
F000:E82A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E82D		  db	0
F000:E82E
F000:E82E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E82E
F000:E82E
F000:E82E int_16	  proc far				      ;	DATA XREF: F000:FF0Fo
F000:E82E		  sti
F000:E82F		  push	  bx
F000:E830		  push	  cx
F000:E831		  push	  si
F000:E832		  push	  di
F000:E833		  push	  ds
F000:E834		  pushf
F000:E835		  mov	  di, 6
F000:E838		  nop
F000:E839		  call	  check_valid_subfunction
F000:E83C		  jb	  short	error
F000:E83E		  jmp	  word ptr cs:int_16_jmp_tbl[di]
F000:E83E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E843 int_16_jmp_tbl:					      ;	DATA XREF: int_16+10r
F000:E843		  dw offset int_16_00
F000:E845		  dw offset int_16_01
F000:E847		  dw offset int_16_02
F000:E849 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E849
F000:E849 error:						      ;	CODE XREF: int_16+Ej
F000:E849		  jmp	  short	exit
F000:E849 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E84B		  db  90h ; 
F000:E84C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E84C
F000:E84C int_16_00:						      ;	CODE XREF: int_16+10j
F000:E84C							      ;	int_16+44j
F000:E84C							      ;	DATA XREF: int_16:int_16_jmp_tblo
F000:E84C		  cli
F000:E84D		  mov	  si, ds:p400.keyb_buffer_head_ptr
F000:E851		  cmp	  si, ds:p400.keyb_buffer_tail_ptr
F000:E855		  jz	  short	l1
F000:E857		  mov	  ax, [si]
F000:E859		  inc	  si
F000:E85A		  inc	  si
F000:E85B		  cmp	  si, ds:p400.keyb_buffer_end_offset_ptr
F000:E85F		  jb	  short	l0
F000:E861		  mov	  si, ds:p400.keyb_buffer_start_offset_ptr
F000:E865
F000:E865 l0:							      ;	CODE XREF: int_16+31j
F000:E865		  mov	  ds:p400.keyb_buffer_head_ptr,	si
F000:E869		  sti
F000:E86A		  jmp	  short	exit
F000:E86C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E86C
F000:E86C l1:							      ;	CODE XREF: int_16+27j
F000:E86C		  sti
F000:E86D		  mov	  cx, 19h
F000:E870
F000:E870 l2:							      ;	CODE XREF: int_16:l2j
F000:E870		  loop	  l2
F000:E872		  jmp	  short	int_16_00
F000:E874 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E874
F000:E874 int_16_01:						      ;	CODE XREF: int_16+10j
F000:E874							      ;	DATA XREF: int_16+17o
F000:E874		  popf
F000:E875		  xor	  bx, bx
F000:E877		  cli
F000:E878		  mov	  si, ds:p400.keyb_buffer_head_ptr
F000:E87C		  cmp	  si, ds:p400.keyb_buffer_tail_ptr
F000:E880		  sti
F000:E881		  jz	  short	l3
F000:E883		  mov	  ax, [si]
F000:E885		  cmp	  bx, 1
F000:E888		  jmp	  short	l4
F000:E888 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E88A		  db  90h ; 
F000:E88B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E88B
F000:E88B l3:							      ;	CODE XREF: int_16+53j
F000:E88B		  cmp	  bx, 0
F000:E88E
F000:E88E l4:							      ;	CODE XREF: int_16+5Aj
F000:E88E		  jmp	  short	exit2
F000:E890 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E890
F000:E890 int_16_02:						      ;	CODE XREF: int_16+10j
F000:E890							      ;	DATA XREF: int_16+19o
F000:E890		  mov	  al, ds:p400.keyb_status_flags_1
F000:E893
F000:E893 exit:							      ;	CODE XREF: int_16:errorj
F000:E893							      ;	int_16+3Cj
F000:E893		  popf
F000:E894
F000:E894 exit2:						      ;	CODE XREF: int_16:l4j
F000:E894		  pop	  ds
F000:E895		  pop	  di
F000:E896		  pop	  si
F000:E897		  pop	  cx
F000:E898		  pop	  bx
F000:E899		  retf	  2
F000:E899 int_16	  endp
F000:E899
F000:E899 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E89C		  db 0EBh dup(0)
F000:E987
F000:E987 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:E987
F000:E987 ;	The keyboard generates an INT 9	every time a key is pushed or
F000:E987 ;	released.
F000:E987 ;
F000:E987 ;	   Notes:	  This is a hardware interrupt (IRQ 1) activated by
F000:E987 ;			  the make or break of every keystroke.
F000:E987 ;
F000:E987 ;	The default INT	9 handler in the ROM reads the make and	break scan
F000:E987 ;	codes from the keyboard	and converts them into actions or key codes as
F000:E987 ;	follows:
F000:E987 ;
F000:E987 ;	     .	 For ASCII keys, when a	make code is encountered, the ASCII code
F000:E987 ;		 and the scan code for the key are placed in the 32-byte keyboard
F000:E987 ;		 buffer, which is located at 0:41Eh. The ASCII code and	scan code
F000:E987 ;		 are placed in the buffer at the location addressed by the
F000:E987 ;		 Keyboard Buffer Tail Pointer (0:041Ch). The Keyboard Buffer Tail
F000:E987 ;		 Pointer is then incremented by	2, and if it points past the end
F000:E987 ;		 of the	buffer,	it is adjusted so that it points to the	beginning
F000:E987 ;		 of the	buffer.
F000:E987 ;
F000:E987 ;	     .	 If Ctrl, Alt, or Shift	has been pressed, the Shift Status
F000:E987 ;		 (0:0417h) and Extended	Shift Status (0:0418h) bytes are updated.
F000:E987 ;
F000:E987 ;	     .	 If the	Ctrl-Alt-Del combination has been pressed, the Reset
F000:E987 ;		 Flag (0:0472h)	is set to 1234h	and control is given to	the
F000:E987 ;		 power-on self test (POST). Because the	Reset Flag is 1234h, the
F000:E987 ;		 POST routine bypasses the memory test.
F000:E987 ;
F000:E987 ;	     .	 If the	Pause key sequence has been entered, this interrupt
F000:E987 ;		 enters	an indefinite loop. The	loop is	broken as soon as a valid
F000:E987 ;		 ASCII keystroke is entered. (The PC Convertible issues	an INT
F000:E987 ;		 15h, Service 41h (Wait	on External Event), to execute its pause
F000:E987 ;		 loop.)
F000:E987 ;
F000:E987 ;	     .	 If the	Print Screen key sequence is entered, an INT 05h (Print
F000:E987 ;		 Screen) is executed.
F000:E987 ;
F000:E987 ;	     .	 If the	Control-Break key sequence is entered, an INT 1Bh
F000:E987 ;		 (Control-Break) is executed.
F000:E987 ;
F000:E987 ;	     .	 For XTs dated 1/10/86 and after, ATs, XT-286s,	and PC
F000:E987 ;		 Convertibles, the INT 9h handler generates an INT 15h,	function
F000:E987 ;		 91h (Interrupt	Complete) to signal that a keystroke is
F000:E987 ;		 available. Also, on these machines, a make or break of	the Sys
F000:E987 ;		 Req key generates an INT 15h, function	85h (System Request Key
F000:E987 ;		 Pressed).
F000:E987 ;
F000:E987 ;	     .	 For ATs dated 6/10/85 and after, XT-286s, and PC Convertibles,
F000:E987 ;		 an INT	15h, function 4Fh (Keyboard Intercept) is executed after
F000:E987 ;		 the scan code has been	read from the keyboard port (60h). This
F000:E987 ;		 allows	the user to redefine or	remove a keystroke.
F000:E987 ;
F000:E987 ;	INT 16 provides	a standard way to read characters from the keyboard
F000:E987 ;	buffer that have been placed there by the INT 9	handler	in ROM.
F000:E987
F000:E987 int_09	  proc far				      ;	DATA XREF: F000:FEF5o
F000:E987		  call	  int_push_regs
F000:E98A		  push	  ax
F000:E98B		  mov	  ax, 40h ; '@'
F000:E98E		  mov	  ds, ax			      ;	ds = 0x40
F000:E990		  mov	  ch, ds:p400.keyb_status_flags_1
F000:E994		  mov	  cl, ds:p400.keyb_status_flags_2
F000:E998		  mov	  dx, 60h ; '`'
F000:E99B		  in	  al, dx			      ;	AT Keyboard controller 8042.
F000:E99C		  cmp	  al, 0FFh
F000:E99E		  jnz	  short	l0
F000:E9A0		  call	  play_bell_sound
F000:E9A3		  jmp	  update_status_flag_and_exit
F000:E9A6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9A6
F000:E9A6 l0:							      ;	CODE XREF: int_09+17j
F000:E9A6		  mov	  ah, al
F000:E9A8		  and	  al, 7Fh
F000:E9AA		  cmp	  al, 1Dh			      ;	ctrl?
F000:E9AC		  jnz	  short	l1
F000:E9AE		  jmp	  l34
F000:E9B1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9B1
F000:E9B1 l1:							      ;	CODE XREF: int_09+25j
F000:E9B1		  cmp	  al, 2Ah ; '*'                       ; left shift?
F000:E9B3		  jnz	  short	l2
F000:E9B5		  jmp	  l36
F000:E9B8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9B8
F000:E9B8 l2:							      ;	CODE XREF: int_09+2Cj
F000:E9B8		  cmp	  al, 36h ; '6'                       ; right shift?
F000:E9BA		  jnz	  short	l3
F000:E9BC		  jmp	  l38
F000:E9BF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9BF
F000:E9BF l3:							      ;	CODE XREF: int_09+33j
F000:E9BF		  cmp	  al, 38h ; '8'                       ; alt?
F000:E9C1		  jnz	  short	l4
F000:E9C3		  jmp	  l40
F000:E9C6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9C6
F000:E9C6 l4:							      ;	CODE XREF: int_09+3Aj
F000:E9C6		  cmp	  al, 3Ah ; ':'
F000:E9C8		  jnz	  short	l5
F000:E9CA		  jmp	  l43
F000:E9CD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9CD
F000:E9CD l5:							      ;	CODE XREF: int_09+41j
F000:E9CD		  cmp	  al, 45h ; 'E'                       ; num lock?
F000:E9CF		  jnz	  short	l6
F000:E9D1		  jmp	  l47
F000:E9D4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9D4
F000:E9D4 l6:							      ;	CODE XREF: int_09+48j
F000:E9D4		  cmp	  al, 46h ; 'F'                       ; hold?
F000:E9D6		  jnz	  short	l7
F000:E9D8		  jmp	  l51
F000:E9DB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9DB
F000:E9DB l7:							      ;	CODE XREF: int_09+4Fj
F000:E9DB		  cmp	  al, 55h ; 'U'                       ; insert?
F000:E9DD		  jnz	  short	l8
F000:E9DF		  mov	  al, ah
F000:E9E1		  jmp	  short	l11
F000:E9E3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9E3
F000:E9E3 l8:							      ;	CODE XREF: int_09+56j
F000:E9E3		  mov	  al, ah
F000:E9E5		  test	  cl, 8
F000:E9E8		  jz	  short	l11
F000:E9EA		  cmp	  al, 9Dh ; ''                       ; break code: ctrl?
F000:E9EC		  jnz	  short	l9
F000:E9EE		  and	  ch, 11111011b			      ;	mask off ctrl bit from status
F000:E9F1		  jmp	  short	l10
F000:E9F3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:E9F3
F000:E9F3 l9:							      ;	CODE XREF: int_09+65j
F000:E9F3		  cmp	  al, 0
F000:E9F5		  jl	  short	l10
F000:E9F7		  and	  cl, 8
F000:E9FA
F000:E9FA l10:							      ;	CODE XREF: int_09+6Aj
F000:E9FA							      ;	int_09+6Ej
F000:E9FA		  call	  kbd_reset_and_ack_int
F000:E9FD		  jmp	  l32
F000:EA00 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA00
F000:EA00 l11:							      ;	CODE XREF: int_09+5Aj
F000:EA00							      ;	int_09+61j
F000:EA00		  cmp	  al, 0D5h ; 'Õ'                      ; break code: insert?
F000:EA02		  jnz	  short	l12
F000:EA04		  jmp	  l56
F000:EA07 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA07
F000:EA07 l12:							      ;	CODE XREF: int_09+7Bj
F000:EA07		  cmp	  al, 0
F000:EA09		  jge	  short	l13
F000:EA0B		  jmp	  update_status_flag_and_exit
F000:EA0E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA0E
F000:EA0E l13:							      ;	CODE XREF: int_09+82j
F000:EA0E		  cmp	  al, 47h ; 'G'
F000:EA10		  jl	  short	l14
F000:EA12		  jmp	  l60
F000:EA15 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA15
F000:EA15 l14:							      ;	CODE XREF: int_09+89j
F000:EA15		  mov	  byte ptr ds:p400.alt_keypad_entry, 0
F000:EA1A		  cmp	  al, 37h ; '7'
F000:EA1C		  jnz	  short	l15
F000:EA1E		  test	  ch, 3
F000:EA21		  jz	  short	l15
F000:EA23		  jmp	  print_screen_pressed
F000:EA26 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA26
F000:EA26 l15:							      ;	CODE XREF: int_09+95j
F000:EA26							      ;	int_09+9Aj
F000:EA26		  lea	  bx, tbl_scancode_to_ascii_default
F000:EA2A		  test	  ch, 40h
F000:EA2D		  jz	  short	l17
F000:EA2F		  cmp	  al, 10h
F000:EA31		  jl	  short	l17
F000:EA33		  cmp	  al, 1Ah
F000:EA35		  jl	  short	l16
F000:EA37		  cmp	  al, 1Eh
F000:EA39		  jl	  short	l17
F000:EA3B		  cmp	  al, 27h ; '''
F000:EA3D		  jl	  short	l16
F000:EA3F		  cmp	  al, 2Ch ; ','
F000:EA41		  jl	  short	l17
F000:EA43		  cmp	  al, 33h ; '3'
F000:EA45		  jge	  short	l17
F000:EA47
F000:EA47 l16:							      ;	CODE XREF: int_09+AEj
F000:EA47							      ;	int_09+B6j
F000:EA47		  lea	  bx, tbl_scancode_to_ascii_shift
F000:EA4B
F000:EA4B l17:							      ;	CODE XREF: int_09+A6j
F000:EA4B							      ;	int_09+AAj
F000:EA4B							      ;	int_09+B2j
F000:EA4B							      ;	int_09+BAj
F000:EA4B							      ;	int_09+BEj
F000:EA4B		  test	  ch, 3
F000:EA4E		  jz	  short	l19
F000:EA50		  cmp	  bx, offset tbl_scancode_to_ascii_shift
F000:EA54		  jnz	  short	l18
F000:EA56		  lea	  bx, tbl_scancode_to_ascii_default
F000:EA5A		  jmp	  short	l19
F000:EA5C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA5C
F000:EA5C l18:							      ;	CODE XREF: int_09+CDj
F000:EA5C		  lea	  bx, tbl_scancode_to_ascii_shift
F000:EA60
F000:EA60 l19:							      ;	CODE XREF: int_09+C7j
F000:EA60							      ;	int_09+D3j
F000:EA60		  test	  ch, 1000b			      ;	alt key	pressed?
F000:EA63		  jz	  short	l20
F000:EA65		  lea	  bx, tbl_scancode_to_ascii_alt
F000:EA69		  jmp	  short	l21
F000:EA6B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA6B
F000:EA6B l20:							      ;	CODE XREF: int_09+DCj
F000:EA6B		  test	  ch, 100b			      ;	ctrl key pressed?
F000:EA6E		  jz	  short	l21
F000:EA70		  lea	  bx, tbl_scancode_to_ascii_ctrl
F000:EA74
F000:EA74 l21:							      ;	CODE XREF: int_09+E2j
F000:EA74							      ;	int_09+E7j
F000:EA74		  call	  scancode_to_ascii
F000:EA77		  cmp	  al, 0FFh
F000:EA79		  jnz	  short	l22
F000:EA7B		  jmp	  short	update_status_flag_and_exit
F000:EA7B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA7D		  db  90h ; 
F000:EA7E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EA7E
F000:EA7E l22:							      ;	CODE XREF: int_09+F2j
F000:EA7E		  cmp	  ah, 29h ; ')'
F000:EA81		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EA83		  cmp	  ah, 2Bh ; '+'
F000:EA86		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EA88		  cmp	  ah, 3Ah ; ':'
F000:EA8B		  jg	  short	pre_put_ax_in_keyb_buffer
F000:EA8D		  test	  ch, 4
F000:EA90		  jz	  short	l23
F000:EA92		  cmp	  ah, 1
F000:EA95		  jz	  short	try_intl_xlat
F000:EA97		  cmp	  ah, 7
F000:EA9A		  jz	  short	try_intl_xlat
F000:EA9C		  cmp	  ah, 0Bh
F000:EA9F		  jbe	  short	pre_put_ax_in_keyb_buffer
F000:EAA1		  cmp	  ah, 0Dh
F000:EAA4		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EAA6		  cmp	  ah, 0Fh
F000:EAA9		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EAAB		  cmp	  ah, 27h ; '''
F000:EAAE		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EAB0		  cmp	  ah, 28h ; '('
F000:EAB3		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EAB5		  cmp	  ah, 33h ; '3'
F000:EAB8		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EABA		  cmp	  ah, 34h ; '4'
F000:EABD		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EABF		  cmp	  ah, 35h ; '5'
F000:EAC2		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EAC4		  cmp	  ah, 37h ; '7'
F000:EAC7		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EAC9
F000:EAC9 l23:							      ;	CODE XREF: int_09+109j
F000:EAC9		  test	  ch, 8
F000:EACC		  jz	  short	l24
F000:EACE		  cmp	  ah, 39h ; '9'
F000:EAD1		  jz	  short	try_intl_xlat
F000:EAD3		  jmp	  short	pre_put_ax_in_keyb_buffer
F000:EAD5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EAD5
F000:EAD5 l24:							      ;	CODE XREF: int_09+145j
F000:EAD5		  cmp	  ah, 0Fh
F000:EAD8		  jnz	  short	l25
F000:EADA		  cmp	  al, 0Fh
F000:EADC		  jz	  short	pre_put_ax_in_keyb_buffer
F000:EADE
F000:EADE l25:							      ;	CODE XREF: int_09+151j
F000:EADE		  test	  ch, 1000b			      ;	alt pressed?
F000:EAE1		  jz	  short	try_intl_xlat
F000:EAE3
F000:EAE3 pre_put_ax_in_keyb_buffer:				      ;	CODE XREF: int_09+FAj
F000:EAE3							      ;	int_09+FFj
F000:EAE3							      ;	int_09+104j
F000:EAE3							      ;	int_09+118j
F000:EAE3							      ;	int_09+11Dj
F000:EAE3							      ;	int_09+122j ...
F000:EAE3		  mov	  ah, al
F000:EAE5		  xor	  al, al
F000:EAE7
F000:EAE7 try_intl_xlat:					      ;	CODE XREF: int_09+10Ej
F000:EAE7							      ;	int_09+113j
F000:EAE7							      ;	int_09+14Aj
F000:EAE7							      ;	int_09+15Aj
F000:EAE7							      ;	int_09+1EBj
F000:EAE7							      ;	int_09:try_intl_xlat_0j
F000:EAE7		  mov	  bx, p400.keyb_intl_support
F000:EAEA		  mov	  dx, [bx]
F000:EAEC		  or	  dx, [bx+2]
F000:EAEF		  jz	  short	put_ax_in_keyb_buffer
F000:EAF1		  call	  dword	ptr [bx]
F000:EAF3		  jb	  short	update_status_flag_and_exit
F000:EAF5
F000:EAF5 put_ax_in_keyb_buffer:				      ;	CODE XREF: int_09+168j
F000:EAF5		  call	  put_char_in_keyb_buffer
F000:EAF8
F000:EAF8 update_status_flag_and_exit:				      ;	CODE XREF: int_09+1Cj
F000:EAF8							      ;	int_09+84j
F000:EAF8							      ;	int_09+F4j
F000:EAF8							      ;	int_09+16Cj
F000:EAF8							      ;	int_09+1A5j
F000:EAF8							      ;	int_09+1AAj ...
F000:EAF8		  call	  kbd_reset_and_ack_int
F000:EAFB		  test	  cl, 8
F000:EAFE		  jz	  short	l32
F000:EB00		  mov	  ds:p400.keyb_status_flags_1, ch
F000:EB04		  mov	  ds:p400.keyb_status_flags_2, cl
F000:EB08
F000:EB08 l30:							      ;	CODE XREF: int_09+189j
F000:EB08		  test	  byte ptr ds:p400.keyb_status_flags_2,	8
F000:EB0D		  jz	  short	l31
F000:EB0F		  sti
F000:EB10		  jmp	  short	l30
F000:EB12 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB12
F000:EB12 l31:							      ;	CODE XREF: int_09+186j
F000:EB12		  cli
F000:EB13		  jmp	  short	pop_and_exit
F000:EB15 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB15
F000:EB15 l32:							      ;	CODE XREF: int_09+76j
F000:EB15							      ;	int_09+177j
F000:EB15		  mov	  ds:p400.keyb_status_flags_1, ch
F000:EB19		  mov	  ds:p400.keyb_status_flags_2, cl
F000:EB1D
F000:EB1D pop_and_exit:						      ;	CODE XREF: int_09+18Cj
F000:EB1D							      ;	int_09:exit_1j
F000:EB1D		  pop	  ax
F000:EB1E		  jmp	  near ptr pop_regs_and_iret
F000:EB21 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB21
F000:EB21 l34:							      ;	CODE XREF: int_09+27j
F000:EB21		  cmp	  ah, 1Dh			      ;	ctrl?
F000:EB24		  jnz	  short	l35
F000:EB26		  or	  ch, 100b			      ;	turn on	ctrl bit in status
F000:EB29		  and	  ch, 11111100b			      ;	turn off shift bits
F000:EB2C		  jmp	  short	update_status_flag_and_exit
F000:EB2E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB2E
F000:EB2E l35:							      ;	CODE XREF: int_09+19Dj
F000:EB2E		  and	  ch, 11111011b			      ;	turn off ctrl bit in status
F000:EB31		  jmp	  short	update_status_flag_and_exit
F000:EB33 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB33
F000:EB33 l36:							      ;	CODE XREF: int_09+2Ej
F000:EB33		  cmp	  ah, 2Ah ; '*'                       ; left shift?
F000:EB36		  jnz	  short	l37
F000:EB38		  or	  ch, 10b			      ;	turn on	left shift in status
F000:EB3B		  jmp	  short	update_status_flag_and_exit
F000:EB3D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB3D
F000:EB3D l37:							      ;	CODE XREF: int_09+1AFj
F000:EB3D		  and	  ch, 11111101b			      ;	turn off left shift in status
F000:EB40		  jmp	  short	update_status_flag_and_exit
F000:EB42 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB42
F000:EB42 l38:							      ;	CODE XREF: int_09+35j
F000:EB42		  cmp	  ah, 36h ; '6'                       ; right shift?
F000:EB45		  jnz	  short	l39
F000:EB47		  or	  ch, 1				      ;	turn on	right shift in status
F000:EB4A		  jmp	  short	update_status_flag_and_exit
F000:EB4C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB4C
F000:EB4C l39:							      ;	CODE XREF: int_09+1BEj
F000:EB4C		  and	  ch, 11111110b			      ;	turn off right shift in	status
F000:EB4F		  jmp	  short	update_status_flag_and_exit
F000:EB51 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB51
F000:EB51 l40:							      ;	CODE XREF: int_09+3Cj
F000:EB51		  cmp	  ah, 38h ; '8'                       ; alt?
F000:EB54		  jnz	  short	l41
F000:EB56		  or	  ch, 1000b			      ;	turn on	alt in status
F000:EB59		  mov	  byte ptr ds:p400.alt_keypad_entry, 0 ; reset previous	alt+numpad value
F000:EB5E		  and	  ch, 11111100b			      ;	turn off shift in status
F000:EB61		  jmp	  short	update_status_flag_and_exit
F000:EB63 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB63
F000:EB63 l41:							      ;	CODE XREF: int_09+1CDj
F000:EB63		  and	  ch, 11110111b			      ;	turn off alt in	status
F000:EB66		  cmp	  byte ptr ds:p400.alt_keypad_entry, 0 ; alt + numpad with value?
F000:EB6B		  jz	  short	l42
F000:EB6D		  xor	  ax, ax
F000:EB6F		  mov	  al, ds:p400.alt_keypad_entry	      ;	get previous alt + numpad value
F000:EB72		  jmp	  try_intl_xlat
F000:EB75 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB75
F000:EB75 l42:							      ;	CODE XREF: int_09+1E4j
F000:EB75		  jmp	  short	update_status_flag_and_exit
F000:EB77 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB77
F000:EB77 l43:							      ;	CODE XREF: int_09+43j
F000:EB77		  cmp	  ah, 3Ah ; ':'                       ; caps?
F000:EB7A		  jnz	  short	l46
F000:EB7C		  test	  cl, 1000000b
F000:EB7F		  jnz	  short	l44
F000:EB81		  or	  cl, 1000000b
F000:EB84		  test	  ch, 1000000b
F000:EB87		  jnz	  short	l45
F000:EB89		  or	  ch, 1000000b
F000:EB8C
F000:EB8C l44:							      ;	CODE XREF: int_09+1F8j
F000:EB8C							      ;	int_09+254j
F000:EB8C		  jmp	  update_status_flag_and_exit
F000:EB8F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB8F
F000:EB8F l45:							      ;	CODE XREF: int_09+200j
F000:EB8F		  and	  ch, 0BFh
F000:EB92		  jmp	  update_status_flag_and_exit
F000:EB95 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB95
F000:EB95 l46:							      ;	CODE XREF: int_09+1F3j
F000:EB95		  and	  ch, 0BFh
F000:EB98		  and	  cl, 0BFh
F000:EB9B		  jmp	  update_status_flag_and_exit
F000:EB9E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EB9E
F000:EB9E l47:							      ;	CODE XREF: int_09+4Aj
F000:EB9E		  cmp	  ah, 45h ; 'E'                       ; num lock?
F000:EBA1		  jnz	  short	l50
F000:EBA3		  test	  ch, 100b
F000:EBA6		  jz	  short	l48
F000:EBA8		  jmp	  update_status_flag_and_exit
F000:EBAB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBAB
F000:EBAB l48:							      ;	CODE XREF: int_09+21Fj
F000:EBAB		  or	  cl, 100000b
F000:EBAE		  test	  ch, 100000b
F000:EBB1		  jnz	  short	l49
F000:EBB3		  or	  ch, 100000b
F000:EBB6		  jmp	  update_status_flag_and_exit
F000:EBB9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBB9
F000:EBB9 l49:							      ;	CODE XREF: int_09+22Aj
F000:EBB9		  and	  ch, 11011111b
F000:EBBC		  jmp	  update_status_flag_and_exit
F000:EBBF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBBF
F000:EBBF l50:							      ;	CODE XREF: int_09+21Aj
F000:EBBF		  and	  ch, 11011111b
F000:EBC2		  and	  cl, 11011111b
F000:EBC5		  jmp	  update_status_flag_and_exit
F000:EBC8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBC8
F000:EBC8 l51:							      ;	CODE XREF: int_09+51j
F000:EBC8		  cmp	  ah, 46h ; 'F'                       ; hold?
F000:EBCB		  jnz	  short	l55
F000:EBCD		  test	  cl, 1000b
F000:EBD0		  jz	  short	l52
F000:EBD2		  and	  cl, 11110111b
F000:EBD5		  jmp	  update_status_flag_and_exit
F000:EBD8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBD8
F000:EBD8 l52:							      ;	CODE XREF: int_09+249j
F000:EBD8		  test	  cl, 10000b
F000:EBDB		  jnz	  short	l44
F000:EBDD		  or	  cl, 10000b
F000:EBE0		  test	  ch, 10000b
F000:EBE3		  jnz	  short	l54
F000:EBE5		  or	  ch, 10000b
F000:EBE8		  jmp	  short	l53
F000:EBE8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBEA		  db  90h ; 				      ;	unused?
F000:EBEB		  db 0F6h ; ö
F000:EBEC		  db 0C5h ; Å
F000:EBED		  db	4
F000:EBEE		  db  74h ; t
F000:EBEF		  db	6
F000:EBF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBF0
F000:EBF0 l53:							      ;	CODE XREF: int_09+261j
F000:EBF0							      ;	int_09+274j
F000:EBF0							      ;	int_09+27Bj
F000:EBF0							      ;	int_09+282j
F000:EBF0		  or	  cl, 1000b
F000:EBF3		  jmp	  update_status_flag_and_exit
F000:EBF6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBF6		  test	  ch, 8				      ;	begin unused / orphan code
F000:EBF9		  jz	  short	l53_0
F000:EBFB		  jmp	  short	l53
F000:EBFD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EBFD
F000:EBFD l53_0:						      ;	CODE XREF: int_09+272j
F000:EBFD		  test	  ch, 1
F000:EC00		  jz	  short	l53_1
F000:EC02		  jmp	  short	l53
F000:EC04 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC04
F000:EC04 l53_1:						      ;	CODE XREF: int_09+279j
F000:EC04		  test	  ch, 2
F000:EC07		  jz	  short	l54
F000:EC09		  jmp	  short	l53			      ;	end of unused /	orphan code
F000:EC0B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC0B
F000:EC0B l54:							      ;	CODE XREF: int_09+25Cj
F000:EC0B							      ;	int_09+280j
F000:EC0B		  and	  ch, 11101111b
F000:EC0E		  jmp	  update_status_flag_and_exit
F000:EC11 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC11
F000:EC11 l55:							      ;	CODE XREF: int_09+244j
F000:EC11		  and	  cl, 11101111b
F000:EC14		  and	  ch, 11101111b
F000:EC17		  jmp	  update_status_flag_and_exit
F000:EC1A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC1A
F000:EC1A l56:							      ;	CODE XREF: int_09+7Dj
F000:EC1A		  test	  ch, 100000b
F000:EC1D		  jnz	  short	l58
F000:EC1F		  test	  ch, 1111b
F000:EC22		  jnz	  short	l59
F000:EC24
F000:EC24 l57:							      ;	CODE XREF: int_09+2A6j
F000:EC24		  and	  cl, 1111111b
F000:EC27		  jmp	  update_status_flag_and_exit
F000:EC2A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC2A
F000:EC2A l58:							      ;	CODE XREF: int_09+296j
F000:EC2A		  test	  ch, 3
F000:EC2D		  jnz	  short	l57
F000:EC2F
F000:EC2F l59:							      ;	CODE XREF: int_09+29Bj
F000:EC2F		  jmp	  update_status_flag_and_exit
F000:EC32 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC32
F000:EC32 l60:							      ;	CODE XREF: int_09+8Bj
F000:EC32		  test	  ch, 100b
F000:EC35		  jz	  short	l63
F000:EC37		  cmp	  al, 54h ; 'T'                       ; break?
F000:EC39		  jnz	  short	l61
F000:EC3B		  jmp	  ctrl_break_pressed
F000:EC3E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC3E
F000:EC3E l61:							      ;	CODE XREF: int_09+2B2j
F000:EC3E		  cmp	  al, 53h ; 'S'                       ; delete / - ?
F000:EC40		  jnz	  short	l62
F000:EC42		  test	  ch, 1000b
F000:EC45		  jz	  short	l62
F000:EC47		  jmp	  ctrl_alt_del_pressed
F000:EC4A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC4A
F000:EC4A l62:							      ;	CODE XREF: int_09+2B9j
F000:EC4A							      ;	int_09+2BEj
F000:EC4A		  lea	  bx, keypad_scancode_to_ascii_ctrl
F000:EC4E		  jmp	  l78
F000:EC51 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC51
F000:EC51 l63:							      ;	CODE XREF: int_09+2AEj
F000:EC51		  test	  ch, 1000b
F000:EC54		  jz	  short	l71
F000:EC56		  cmp	  al, 53h ; 'S'                       ; delete / - ?
F000:EC58		  jnz	  short	l64
F000:EC5A		  test	  ch, 4
F000:EC5D		  jz	  short	l64
F000:EC5F		  jmp	  ctrl_alt_del_pressed
F000:EC62 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EC62
F000:EC62 l64:							      ;	CODE XREF: int_09+2D1j
F000:EC62							      ;	int_09+2D6j
F000:EC62		  cmp	  al, 4Ah ; 'J'                       ; cursor down?
F000:EC64		  jz	  short	l69
F000:EC66		  cmp	  al, 4Eh ; 'N'                       ; cursor right?
F000:EC68		  jz	  short	l69
F000:EC6A		  cmp	  al, 54h ; 'T'                       ; break ?
F000:EC6C		  jz	  short	l66
F000:EC6E		  cmp	  al, 53h ; 'S'                       ; delete / - ?
F000:EC70		  jge	  short	l69
F000:EC72		  cmp	  al, 4Eh ; 'N'                       ; cursor right?
F000:EC74		  jz	  short	l65
F000:EC76		  mov	  dx, ax
F000:EC78		  xor	  ax, ax
F000:EC7A		  mov	  al, ds:p400.alt_keypad_entry
F000:EC7D		  shl	  ax, 1
F000:EC7F		  push	  ax
F000:EC80		  shl	  ax, 1
F000:EC82		  shl	  ax, 1
F000:EC84		  pop	  bx
F000:EC85		  add	  ax, bx
F000:EC87		  push	  ax
F000:EC88		  mov	  ax, dx
F000:EC8A		  lea	  bx, keypad_scancode_to_ascii_default
F000:EC8E		  sub	  al, 46h ; 'F'
F000:EC90		  call	  scancode_to_ascii
F000:EC93		  sub	  al, 30h ; '0'
F000:EC95		  xor	  ah, ah
F000:EC97		  pop	  dx
F000:EC98		  add	  dx, ax
F000:EC9A		  mov	  ds:p400.alt_keypad_entry, dl
F000:EC9E
F000:EC9E l65:							      ;	CODE XREF: int_09+2EDj
F000:EC9E		  jmp	  update_status_flag_and_exit
F000:ECA1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECA1
F000:ECA1 l66:							      ;	CODE XREF: int_09+2E5j
F000:ECA1		  cmp	  al, 54h ; 'T'
F000:ECA3		  jnz	  short	l68
F000:ECA5		  or	  cl, 10h
F000:ECA8		  test	  ch, 10h
F000:ECAB		  jnz	  short	l67
F000:ECAD		  or	  ch, 10h
F000:ECB0		  jmp	  update_status_flag_and_exit
F000:ECB3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECB3
F000:ECB3 l67:							      ;	CODE XREF: int_09+324j
F000:ECB3		  and	  ch, 0EFh
F000:ECB6		  jmp	  update_status_flag_and_exit
F000:ECB9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECB9
F000:ECB9 l68:							      ;	CODE XREF: int_09+31Cj
F000:ECB9		  and	  cl, 0EFh
F000:ECBC		  jmp	  update_status_flag_and_exit
F000:ECBF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECBF
F000:ECBF l69:							      ;	CODE XREF: int_09+2DDj
F000:ECBF							      ;	int_09+2E1j
F000:ECBF							      ;	int_09+2E9j
F000:ECBF		  lea	  bx, keypad_scancode_to_ascii_alt
F000:ECC3		  sub	  al, 46h ; 'F'
F000:ECC5		  call	  scancode_to_ascii
F000:ECC8		  cmp	  al, 0FFh
F000:ECCA		  jnz	  short	l70
F000:ECCC		  jmp	  update_status_flag_and_exit
F000:ECCF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECCF
F000:ECCF l70:							      ;	CODE XREF: int_09+343j
F000:ECCF		  jmp	  pre_put_ax_in_keyb_buffer
F000:ECD2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECD2
F000:ECD2 l71:							      ;	CODE XREF: int_09+2CDj
F000:ECD2		  test	  ch, 20h
F000:ECD5		  jnz	  short	l76
F000:ECD7		  cmp	  al, 4Ah ; 'J'
F000:ECD9		  jz	  short	l72
F000:ECDB		  cmp	  al, 4Eh ; 'N'
F000:ECDD		  jz	  short	l72
F000:ECDF		  cmp	  al, 58h ; 'X'
F000:ECE1		  jge	  short	l72
F000:ECE3		  jmp	  short	l73
F000:ECE5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECE5
F000:ECE5 l72:							      ;	CODE XREF: int_09+352j
F000:ECE5							      ;	int_09+356j
F000:ECE5							      ;	int_09+35Aj
F000:ECE5		  test	  ch, 3
F000:ECE8		  jnz	  short	l74
F000:ECEA		  jmp	  short	l77
F000:ECEC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ECEC
F000:ECEC l73:							      ;	CODE XREF: int_09+35Cj
F000:ECEC		  test	  ch, 3
F000:ECEF		  jnz	  short	l77
F000:ECF1
F000:ECF1 l74:							      ;	CODE XREF: int_09+361j
F000:ECF1							      ;	int_09+387j
F000:ECF1		  lea	  bx, keypad_scancode_to_ascii_shift
F000:ECF5		  cmp	  al, 52h ; 'R'
F000:ECF7		  jnz	  short	l78
F000:ECF9		  or	  cl, 80h
F000:ECFC		  test	  ch, 80h
F000:ECFF		  jnz	  short	l75
F000:ED01		  or	  ch, 80h
F000:ED04		  jmp	  short	l78
F000:ED06 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ED06
F000:ED06 l75:							      ;	CODE XREF: int_09+378j
F000:ED06		  and	  ch, 7Fh
F000:ED09		  jmp	  short	l78
F000:ED0B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ED0B
F000:ED0B l76:							      ;	CODE XREF: int_09+34Ej
F000:ED0B		  test	  ch, 3
F000:ED0E		  jnz	  short	l74
F000:ED10
F000:ED10 l77:							      ;	CODE XREF: int_09+363j
F000:ED10							      ;	int_09+368j
F000:ED10		  lea	  bx, keypad_scancode_to_ascii_default
F000:ED14
F000:ED14 l78:							      ;	CODE XREF: int_09+2C7j
F000:ED14							      ;	int_09+370j
F000:ED14							      ;	int_09+37Dj
F000:ED14							      ;	int_09+382j
F000:ED14		  sub	  al, 46h ; 'F'
F000:ED16		  call	  scancode_to_ascii
F000:ED19		  cmp	  al, 0FFh
F000:ED1B		  jnz	  short	l79
F000:ED1D		  jmp	  update_status_flag_and_exit
F000:ED20 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ED20
F000:ED20 l79:							      ;	CODE XREF: int_09+394j
F000:ED20		  cmp	  bx, offset keypad_scancode_to_ascii_default
F000:ED24		  jnz	  short	l81
F000:ED26		  cmp	  al, 50h ; 'P'
F000:ED28		  jz	  short	l82
F000:ED2A		  cmp	  al, 4Dh ; 'M'
F000:ED2C		  jz	  short	l82
F000:ED2E		  cmp	  al, 0
F000:ED30		  jz	  short	l82
F000:ED32		  cmp	  al, 47h ; 'G'
F000:ED34		  jz	  short	l82
F000:ED36		  cmp	  al, 98h ; '˜'
F000:ED38		  jz	  short	l82
F000:ED3A		  cmp	  al, 99h ; '™'
F000:ED3C		  jz	  short	l82
F000:ED3E
F000:ED3E try_intl_xlat_0:					      ;	CODE XREF: int_09+3BCj
F000:ED3E							      ;	int_09+3C0j
F000:ED3E							      ;	int_09+3C4j
F000:ED3E							      ;	int_09+3C8j
F000:ED3E							      ;	int_09+3CCj
F000:ED3E							      ;	int_09+3D0j ...
F000:ED3E		  jmp	  try_intl_xlat
F000:ED41 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ED41
F000:ED41 l81:							      ;	CODE XREF: int_09+39Dj
F000:ED41		  cmp	  al, 5Ch ; '\'
F000:ED43		  jz	  short	try_intl_xlat_0
F000:ED45		  cmp	  al, 7Ch ; '|'
F000:ED47		  jz	  short	try_intl_xlat_0
F000:ED49		  cmp	  al, 7Eh ; '~'
F000:ED4B		  jz	  short	try_intl_xlat_0
F000:ED4D		  cmp	  al, 60h ; '`'
F000:ED4F		  jz	  short	try_intl_xlat_0
F000:ED51		  cmp	  al, 0Dh
F000:ED53		  jz	  short	try_intl_xlat_0
F000:ED55		  cmp	  al, 5Eh ; '^'
F000:ED57		  jz	  short	try_intl_xlat_0
F000:ED59		  cmp	  al, 3Ch ; '<'
F000:ED5B		  jz	  short	try_intl_xlat_0
F000:ED5D		  cmp	  al, 23h ; '#'
F000:ED5F		  jz	  short	try_intl_xlat_0
F000:ED61		  cmp	  al, 7Bh ; '{'
F000:ED63		  jz	  short	try_intl_xlat_0
F000:ED65		  cmp	  al, 7Dh ; '}'
F000:ED67		  jz	  short	try_intl_xlat_0
F000:ED69		  cmp	  al, 0Ah
F000:ED6B		  jz	  short	try_intl_xlat_0
F000:ED6D
F000:ED6D l82:							      ;	CODE XREF: int_09+3A1j
F000:ED6D							      ;	int_09+3A5j
F000:ED6D							      ;	int_09+3A9j
F000:ED6D							      ;	int_09+3ADj
F000:ED6D							      ;	int_09+3B1j
F000:ED6D							      ;	int_09+3B5j
F000:ED6D		  jmp	  pre_put_ax_in_keyb_buffer
F000:ED70 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ED70
F000:ED70 ctrl_alt_del_pressed:					      ;	CODE XREF: int_09+2C0j
F000:ED70							      ;	int_09+2D8j
F000:ED70		  mov	  bx, p400.POST_reset_flag
F000:ED73		  mov	  word ptr [bx], 1234h
F000:ED77		  call	  kbd_reset_and_ack_int
F000:ED7A		  jmp	  reset_entry
F000:ED7D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ED7D
F000:ED7D ctrl_break_pressed:					      ;	CODE XREF: int_09+2B4j
F000:ED7D		  mov	  ax, ds:p400.keyb_buffer_start_offset_ptr
F000:ED80		  mov	  ds:p400.keyb_buffer_head_ptr,	ax
F000:ED83		  mov	  ds:p400.keyb_buffer_tail_ptr,	ax
F000:ED86		  push	  ds
F000:ED87		  mov	  ax, 40h ; '@'
F000:ED8A		  mov	  ds, ax
F000:ED8C		  mov	  bx, p400.ctrl_break_flag
F000:ED8F		  mov	  byte ptr [bx], 80h ; '€'
F000:ED92		  pop	  ds
F000:ED93		  int	  1Bh				      ;	CTRL-BREAK KEY
F000:ED95		  xor	  ax, ax
F000:ED97		  call	  put_char_in_keyb_buffer
F000:ED9A		  jmp	  update_status_flag_and_exit
F000:ED9D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:ED9D
F000:ED9D print_screen_pressed:					      ;	CODE XREF: int_09+9Cj
F000:ED9D		  call	  kbd_reset_and_ack_int
F000:EDA0		  call	  get_keyb_buffer_next_slot
F000:EDA3		  jb	  short	exit_1
F000:EDA5		  int	  5				      ;	 - PRINT-SCREEN	KEY
F000:EDA5							      ;	automatically called by	keyboard scanner when print-screen key is pressed
F000:EDA7
F000:EDA7 exit_1:						      ;	CODE XREF: int_09+41Cj
F000:EDA7		  jmp	  pop_and_exit
F000:EDA7 int_09	  endp
F000:EDA7
F000:EDAA
F000:EDAA ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:EDAA
F000:EDAA ; Entry:
F000:EDAA ;	AL = scancode to store in keyboard buffer
F000:EDAA ;	AH = ascii to store in keyboard	buffer
F000:EDAA ;
F000:EDAA
F000:EDAA put_char_in_keyb_buffer proc near			      ;	CODE XREF: int_09:put_ax_in_keyb_bufferp
F000:EDAA							      ;	int_09+410p
F000:EDAA		  cli
F000:EDAB		  call	  get_keyb_buffer_next_slot
F000:EDAE		  jb	  short	buffer_full
F000:EDB0		  mov	  si, ds:p400.keyb_buffer_tail_ptr
F000:EDB4		  mov	  [si],	ax
F000:EDB6		  inc	  si
F000:EDB7		  inc	  si
F000:EDB8		  cmp	  si, ds:p400.keyb_buffer_end_offset_ptr
F000:EDBC		  jb	  short	l0
F000:EDBE		  mov	  si, ds:p400.keyb_buffer_start_offset_ptr
F000:EDC2
F000:EDC2 l0:							      ;	CODE XREF: put_char_in_keyb_buffer+12j
F000:EDC2		  mov	  ds:p400.keyb_buffer_tail_ptr,	si
F000:EDC6		  retn
F000:EDC7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EDC7
F000:EDC7 buffer_full:						      ;	CODE XREF: put_char_in_keyb_buffer+4j
F000:EDC7		  sti
F000:EDC8		  call	  play_bell_sound
F000:EDCB		  retn
F000:EDCB put_char_in_keyb_buffer endp
F000:EDCB
F000:EDCC
F000:EDCC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:EDCC
F000:EDCC ; Returns:
F000:EDCC ;	SI = Keyboard buffer next slot
F000:EDCC ;	Carry =	Set if buffer is buffer	is full, Clear otherwise
F000:EDCC
F000:EDCC get_keyb_buffer_next_slot proc near			      ;	CODE XREF: int_09+419p
F000:EDCC							      ;	put_char_in_keyb_buffer+1p
F000:EDCC		  mov	  si, ds:p400.keyb_buffer_tail_ptr
F000:EDD0		  inc	  si
F000:EDD1		  inc	  si
F000:EDD2		  cmp	  si, ds:p400.keyb_buffer_end_offset_ptr
F000:EDD6		  jb	  short	l0
F000:EDD8		  mov	  si, ds:p400.keyb_buffer_start_offset_ptr
F000:EDDC
F000:EDDC l0:							      ;	CODE XREF: get_keyb_buffer_next_slot+Aj
F000:EDDC		  cmp	  si, ds:p400.keyb_buffer_head_ptr
F000:EDE0		  jz	  short	error
F000:EDE2		  clc
F000:EDE3		  jmp	  short	exit
F000:EDE5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EDE5
F000:EDE5 error:						      ;	CODE XREF: get_keyb_buffer_next_slot+14j
F000:EDE5		  stc
F000:EDE6
F000:EDE6 exit:							      ;	CODE XREF: get_keyb_buffer_next_slot+17j
F000:EDE6		  retn
F000:EDE6 get_keyb_buffer_next_slot endp
F000:EDE6
F000:EDE7
F000:EDE7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:EDE7
F000:EDE7
F000:EDE7 scancode_to_ascii proc near				      ;	CODE XREF: int_09:l21p
F000:EDE7							      ;	int_09+309p
F000:EDE7							      ;	int_09+33Ep
F000:EDE7							      ;	int_09+38Fp
F000:EDE7		  push	  ds
F000:EDE8		  push	  ax
F000:EDE9		  mov	  ax, cs
F000:EDEB		  mov	  ds, ax			      ;	ds = cs
F000:EDED		  pop	  ax
F000:EDEE		  dec	  al				      ;	al-- (?)
F000:EDF0		  xlat					      ;	al = [ds:bx + al]
F000:EDF1		  pop	  ds
F000:EDF2		  retn
F000:EDF2 scancode_to_ascii endp
F000:EDF2
F000:EDF3
F000:EDF3 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:EDF3
F000:EDF3
F000:EDF3 kbd_reset_and_ack_int	proc near			      ;	CODE XREF: int_09:l10p
F000:EDF3							      ;	int_09:update_status_flag_and_exitp
F000:EDF3							      ;	int_09+3F0p
F000:EDF3							      ;	int_09:print_screen_pressedp
F000:EDF3		  cli
F000:EDF4		  mov	  dx, 61h ; 'a'
F000:EDF7		  in	  al, dx			      ;	PC/XT PPI port B bits:
F000:EDF7							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:EDF7							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:EDF7							      ;	3: 1=read high switches
F000:EDF7							      ;	4: 0=enable RAM	parity checking
F000:EDF7							      ;	5: 0=enable I/O	channel	check
F000:EDF7							      ;	6: 0=hold keyboard clock low
F000:EDF7							      ;	7: 0=enable kbrd
F000:EDF8		  or	  al, 80h
F000:EDFA		  out	  dx, al			      ;	PC/XT PPI port B bits:
F000:EDFA							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:EDFA							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:EDFA							      ;	3: 1=read high switches
F000:EDFA							      ;	4: 0=enable RAM	parity checking
F000:EDFA							      ;	5: 0=enable I/O	channel	check
F000:EDFA							      ;	6: 0=hold keyboard clock low
F000:EDFA							      ;	7: 0=enable kbrd
F000:EDFB		  and	  al, 7Fh
F000:EDFD		  out	  dx, al			      ;	PC/XT PPI port B bits:
F000:EDFD							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
F000:EDFD							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
F000:EDFD							      ;	3: 1=read high switches
F000:EDFD							      ;	4: 0=enable RAM	parity checking
F000:EDFD							      ;	5: 0=enable I/O	channel	check
F000:EDFD							      ;	6: 0=hold keyboard clock low
F000:EDFD							      ;	7: 0=enable kbrd
F000:EDFE		  mov	  al, 20h ; ' '
F000:EE00		  mov	  dx, 20h ; ' '
F000:EE03		  out	  dx, al			      ;	Interrupt controller, 8259A.
F000:EE04		  retn
F000:EE04 kbd_reset_and_ack_int	endp
F000:EE04
F000:EE04 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EE05 tbl_scancode_to_ascii_default	db 1Bh,	31h, 32h, 33h, 34h, 35h, 36h, 37h, 38h,	39h, 30h, 2Dh, 3Dh, 8, 9, 71h, 77h, 65h
F000:EE05							      ;	DATA XREF: int_09:l15o
F000:EE05							      ;	int_09+CFo
F000:EE05		  db 72h, 74h, 79h, 75h, 69h, 6Fh, 70h,	5Bh, 5Dh, 0Dh, 0FEh, 61h, 73h, 64h, 66h, 67h, 68h
F000:EE05		  db 6Ah, 6Bh, 6Ch, 3Bh, 27h, 48h, 0FEh, 4Bh, 7Ah, 78h,	63h, 76h, 62h, 6Eh, 6Dh, 2Ch, 2Eh
F000:EE05		  db 2Fh, 0FEh,	10h, 0FEh, 20h,	0FEh, 3Bh, 3Ch,	3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h, 44h
F000:EE05		  db 0FEh, 0FEh
F000:EE4B tbl_scancode_to_ascii_shift db 1Bh, 21h, 40h,	23h, 24h, 25h, 5Eh, 26h, 2Ah, 28h, 29h,	5Fh, 2Bh, 8, 0Fh, 51h, 57h
F000:EE4B							      ;	DATA XREF: int_09:l16o
F000:EE4B							      ;	int_09+C9o
F000:EE4B							      ;	int_09:l18o
F000:EE4B		  db 45h, 52h, 54h, 59h, 55h, 49h, 4Fh,	50h, 7Bh, 7Dh, 0Dh, 0FFh, 41h, 53h, 44h, 46h, 47h
F000:EE4B		  db 48h, 4Ah, 4Bh, 4Ch, 3Ah, 22h, 85h,	0FFh, 87h, 5Ah,	58h, 43h, 56h, 42h, 4Eh, 4Dh, 3Ch
F000:EE4B		  db 3Eh, 3Fh, 0FFh, 0FEh, 0FFh, 20h, 0FFh, 54h, 55h, 56h, 57h,	58h, 59h, 5Ah, 5Bh, 5Ch
F000:EE4B		  db 5Dh, 0FFh,	0FEh
F000:EE91 tbl_scancode_to_ascii_ctrl db	1Bh, 0E1h, 3, 0E3h, 0E4h, 0E5h,	1Eh, 0E7h, 0E8h, 0E9h, 0E0h, 1Fh, 0F5h,	7Fh, 8Dh
F000:EE91							      ;	DATA XREF: int_09+E9o
F000:EE91		  db 11h, 17h, 5, 12h, 14h, 19h, 15h, 9, 0Fh, 10h, 1Bh,	1Dh, 0Ah, 0FFh,	1, 13h,	4, 6, 7
F000:EE91		  db 8,	0Ah, 0Bh, 0Ch, 0F6h, 0F7h, 90h,	0FFh, 73h, 1Ah,	18h, 3,	16h, 2,	0Eh, 0Dh, 0F9h
F000:EE91		  db 0FAh, 0FBh, 0FFh, 72h, 0FFh, 20h, 0FFh, 5Eh, 5Fh, 60h, 61h, 62h, 63h, 64h,	65h, 66h
F000:EE91		  db 67h, 0FFh,	0FEh
F000:EED7 tbl_scancode_to_ascii_alt db 8Bh, 78h, 79h, 7Ah, 7Bh,	7Ch, 7Dh, 7Eh, 7Fh, 80h, 81h, 82h, 83h,	8Ch, 8Eh, 10h, 11h
F000:EED7							      ;	DATA XREF: int_09+DEo
F000:EED7		  db 12h, 13h, 14h, 15h, 16h, 17h, 18h,	19h, 0EBh, 0F0h, 8Fh, 0FFh, 1Eh, 1Fh, 20h, 21h
F000:EED7		  db 22h, 23h, 24h, 25h, 26h, 0F8h, 0F1h, 91h, 0FFh, 92h, 2Ch, 2Dh, 2Eh, 2Fh, 30h, 31h
F000:EED7		  db 32h, 89h, 8Ah, 0F2h, 0FFh,	46h, 0FFh, 20h,	0FFh, 68h, 69h,	6Ah, 6Bh, 6Ch, 6Dh, 6Eh
F000:EED7		  db 6Fh, 70h, 71h, 0FFh, 0FEh
F000:EF1D keypad_scancode_to_ascii_default db 37h, 38h,	39h, 50h, 34h, 35h, 36h, 4Dh, 31h, 32h,	33h, 30h, 2Dh, 0, 2Bh, 2Eh, 0Dh
F000:EF1D							      ;	DATA XREF: int_09+303o
F000:EF1D							      ;	int_09:l77o
F000:EF1D							      ;	int_09:l79o
F000:EF1D		  db 47h, 98h, 99h, 5Eh, 3Eh, 40h, 5Bh,	5Dh
F000:EF36 keypad_scancode_to_ascii_shift db 5Ch, 7Eh, 49h, 86h,	7Ch, 0F3h, 0F4h, 88h, 4Fh, 60h,	51h, 9Bh, 53h, 0, 52h, 0A1h, 0Dh
F000:EF36							      ;	DATA XREF: int_09:l74o
F000:EF36		  db 4Ah, 0A2h,	0A3h, 5Eh, 3Ch,	23h, 7Bh, 7Dh
F000:EF4F keypad_scancode_to_ascii_ctrl	db 93h,	94h, 84h, 96h, 95h, 0FCh, 0FDh,	74h, 75h, 9Ah, 76h, 9Ch, 9Dh, 0, 9Fh, 0A4h, 0Ah
F000:EF4F							      ;	DATA XREF: int_09:l62o
F000:EF4F		  db 77h, 0ACh,	0ADh, 0A7h, 0A8h, 0A9h,	0AAh, 0ABh
F000:EF68 keypad_scancode_to_ascii_alt db 0FEh,	0FEh, 0FEh, 97h, 0FEh, 0FEh, 0FEh, 0EAh, 0FEh, 0FEh, 0FEh, 0FEh, 9Eh, 0FEh
F000:EF68							      ;	DATA XREF: int_09:l69o
F000:EF68		  db 0A0h, 0A5h, 8Fh, 0A6h, 0B6h, 0B7h,	0AEh, 0AFh, 45h, 4Ch, 4Eh, 0DEh, 0ADh, 0DEh, 0ADh
F000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
F000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
F000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
F000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
F000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
F000:EFC7 int_1e	  diskette_params <0CFh, 2, 25h, 2, 9, 2Ah, 0FFh, 50h, 0F6h, 19h, 4>
F000:EFC7							      ;	DATA XREF: F000:FF1Fo
F000:EFD2
F000:EFD2 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:EFD2
F000:EFD2 ; printer handler
F000:EFD2
F000:EFD2 int_17	  proc far				      ;	DATA XREF: F000:FF11o
F000:EFD2		  call	  int_push_regs
F000:EFD5		  mov	  di, 6
F000:EFD8		  nop
F000:EFD9		  call	  check_valid_subfunction
F000:EFDC		  jb	  short	exit0
F000:EFDE		  mov	  bx, dx
F000:EFE0		  xor	  cx, cx
F000:EFE2		  mov	  cl, [bx+p400.lpt0_timeout]
F000:EFE6		  shl	  bx, 1
F000:EFE8		  mov	  dx, [bx+p400.lpt0_base_addr]
F000:EFEC		  or	  dx, dx
F000:EFEE		  jz	  short	exit1
F000:EFF0		  jmp	  word ptr cs:int_17_jmp_tbl[di]
F000:EFF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EFF5 int_17_jmp_tbl:					      ;	DATA XREF: int_17+1Er
F000:EFF5		  dw offset int_17_00
F000:EFF7		  dw offset int_17_01
F000:EFF9		  dw offset int_17_02
F000:EFFB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EFFB
F000:EFFB exit0:						      ;	CODE XREF: int_17+Aj
F000:EFFB		  jmp	  short	exit1
F000:EFFD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:EFFD ;INT 17h,  00h (0)	    Send One Byte to Printer
F000:EFFD ;
F000:EFFD ;    Sends one character to the specified parallel printer and returns the
F000:EFFD ;    current status of the printer.
F000:EFFD ;
F000:EFFD ;	  On entry:	 AH	    00h
F000:EFFD ;			 AL	    Character to print
F000:EFFD ;			 DX	    Parallel printer number (0 - LPT1, 1 - LPT2,
F000:EFFD ;				    etc)
F000:EFFD ;
F000:EFFD ;	  Returns:	 AH	    Printer status (see	Service	02h)
F000:EFFD
F000:EFFD int_17_00:						      ;	CODE XREF: int_17+1Ej
F000:EFFD							      ;	DATA XREF: int_17:int_17_jmp_tblo
F000:EFFD		  mov	  ah, al
F000:EFFF		  xor	  bx, bx
F000:F001		  inc	  dx
F000:F002
F000:F002 l0:							      ;	CODE XREF: int_17+46j
F000:F002							      ;	int_17+48j
F000:F002		  in	  al, dx
F000:F003		  test	  al, 80h
F000:F005		  jz	  short	l1
F000:F007		  mov	  al, ah
F000:F009		  dec	  dx
F000:F00A		  out	  dx, al
F000:F00B		  inc	  dx
F000:F00C		  inc	  dx
F000:F00D		  mov	  al, 0Dh
F000:F00F		  out	  dx, al
F000:F010		  mov	  al, 0Ch
F000:F012		  out	  dx, al
F000:F013		  mov	  cl, ah
F000:F015		  jmp	  short	l3
F000:F017 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F017
F000:F017 l1:							      ;	CODE XREF: int_17+33j
F000:F017		  dec	  bx
F000:F018		  jnz	  short	l0
F000:F01A		  loop	  l0
F000:F01C		  mov	  ch, 1
F000:F01E		  mov	  cl, ah
F000:F020		  jmp	  short	get_status_and_exit
F000:F022 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F022 ;INT 17h,  01h (1)	    Initialize Printer
F000:F022 ;
F000:F022 ;    Sends initialization control codes to the specified parallel printer
F000:F022 ;    and returns the current status of the printer.
F000:F022 ;
F000:F022 ;	  On entry:	 AH	    01h
F000:F022 ;			 DX	    Parallel printer number (0 = LPT1, 1 = LPT2,
F000:F022 ;				    etc.)
F000:F022 ;
F000:F022 ;	  Returns:	 AH	    Printer status (See	service	02h)
F000:F022
F000:F022 int_17_01:						      ;	CODE XREF: int_17+1Ej
F000:F022							      ;	DATA XREF: int_17+25o
F000:F022		  mov	  cl, al
F000:F024		  inc	  dx
F000:F025		  inc	  dx
F000:F026		  mov	  al, 8
F000:F028		  out	  dx, al
F000:F029		  push	  cx
F000:F02A		  mov	  cx, 32h ; '2'
F000:F02D
F000:F02D l2:							      ;	CODE XREF: int_17:l2j
F000:F02D		  loop	  l2
F000:F02F		  pop	  cx
F000:F030		  mov	  al, 0Ch
F000:F032		  out	  dx, al
F000:F033
F000:F033 l3:							      ;	CODE XREF: int_17+43j
F000:F033		  dec	  dx
F000:F034		  xor	  ch, ch
F000:F036		  jmp	  short	get_status_and_exit
F000:F038 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F038 ;INT 17h,  02h (2)	    Get	Printer	Status
F000:F038 ;
F000:F038 ;    Returns status information about	the specified parallel printer.
F000:F038 ;
F000:F038 ;	  On entry:	 AH	    02h
F000:F038 ;			 DX	    Parallel printer number (0 = LPT1, 1 = LPT2,
F000:F038 ;				    etc.)
F000:F038 ;
F000:F038 ;	  Returns:	 AH	    Printer status
F000:F038
F000:F038 int_17_02:						      ;	CODE XREF: int_17+1Ej
F000:F038							      ;	DATA XREF: int_17+27o
F000:F038		  mov	  cl, al
F000:F03A		  inc	  dx
F000:F03B
F000:F03B get_status_and_exit:					      ;	CODE XREF: int_17+4Ej
F000:F03B							      ;	int_17+64j
F000:F03B		  in	  al, dx
F000:F03C		  and	  al, 0F8h
F000:F03E		  xor	  al, 48h
F000:F040		  mov	  ah, al
F000:F042		  or	  ah, ch
F000:F044		  mov	  al, cl
F000:F046
F000:F046 exit1:						      ;	CODE XREF: int_17+1Cj
F000:F046							      ;	int_17:exit0j
F000:F046		  jmp	  near ptr pop_regs_and_iret
F000:F046 int_17	  endp
F000:F046
F000:F046 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F049		  db 1Ch dup(0)
F000:F065
F000:F065 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F065
F000:F065
F000:F065 int_10	  proc far				      ;	DATA XREF: F000:FF03o
F000:F065		  call	  int_push_regs
F000:F068		  cld
F000:F069		  mov	  di, 22h ; '"'                       ; max sub-functions / 2
F000:F06C		  nop
F000:F06D		  call	  check_valid_subfunction
F000:F070		  jb	  short	error
F000:F072		  jmp	  cs:int_10_jmp_tbl[di]
F000:F072 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F077 int_10_jmp_tbl  dw offset int_10_00			      ;	DATA XREF: int_10+Dr
F000:F079		  dw offset int_10_01
F000:F07B		  dw offset int_10_02
F000:F07D		  dw offset int_10_03
F000:F07F		  dw offset int_10_04
F000:F081		  dw offset int_10_05
F000:F083		  dw offset int_10_06
F000:F085		  dw offset int_10_07
F000:F087		  dw offset int_10_08
F000:F089		  dw offset int_10_09
F000:F08B		  dw offset int_10_0a
F000:F08D		  dw offset int_10_0b
F000:F08F		  dw offset int_10_0c
F000:F091		  dw offset int_10_0d
F000:F093		  dw offset int_10_0e
F000:F095		  dw offset int_10_0f
F000:F097		  dw offset int_10_10
F000:F099 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F099
F000:F099 error:						      ;	CODE XREF: int_10+Bj
F000:F099		  jmp	  near ptr pop_regs_and_iret
F000:F099 int_10	  endp
F000:F099
F000:F099 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F09C		  db 8 dup(0)
F000:F0A4 int_1d_tv	  db 38h, 28h, 2Ch, 8, 1Fh, 6, 19h, 1Ch, 2, 7, 6, 7, 4 dup(0); init_modes_0_1
F000:F0A4							      ;	DATA XREF: reset+29Bo
F000:F0A4		  db 71h, 50h, 58h, 10h, 1Fh, 6, 19h, 1Ch, 2, 7, 6, 7, 4 dup(0); init_modes_2_3
F000:F0A4		  db 38h, 28h, 2Ch, 8, 7Fh, 6, 64h, 70h, 2, 1, 6, 7, 4 dup(0); init_modes_4_5_6_8
F000:F0A4		  db 61h, 50h, 52h, 0Fh, 19h, 6, 2 dup(19h), 2,	0Dh, 0Bh, 0Ch, 4 dup(0); init_mode_7
F000:F0A4		  db 71h, 50h, 58h, 10h, 3Fh, 6, 32h, 38h, 2, 3, 6, 7, 4 dup(0); init_modes_9_a
F000:F0F4 video_init_vars video_init_some_vars <0, 101100b, 28h, 8>   ;	DATA XREF: int_10_00+3Ar
F000:F0F4							      ;	int_10_00+3Fr
F000:F0F4							      ;	int_10_00+46r
F000:F0F4							      ;	int_10_00+50r
F000:F0F4							      ;	video mode 0
F000:F0F8		  video_init_some_vars <0, 101000b, 28h, 8>   ;	video mode 1
F000:F0FC		  video_init_some_vars <10h, 101101b, 50h, 10h>	; video	mode 2
F000:F100		  video_init_some_vars <10h, 101001b, 50h, 10h>	; video	mode 3
F000:F104		  video_init_some_vars <20h, 101010b, 28h, 40h>	; video	mode 4
F000:F108		  video_init_some_vars <20h, 101110b, 28h, 40h>	; video	mode 5
F000:F10C		  video_init_some_vars <20h, 11110b, 50h, 40h> ; video mode 6
F000:F110		  video_init_some_vars <30h, 101001b, 50h, 40h>	; video	mode 7
F000:F114		  video_init_some_vars <20h, 101010b, 14h, 40h>	; video	mode 8
F000:F118		  video_init_some_vars <40h, 101011b, 28h, 80h>	; video	mode 9
F000:F11C		  video_init_some_vars <40h, 111011b, 50h, 80h>	; video	mode a
F000:F120
F000:F120 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F120
F000:F120 ;	Sets the video mode.
F000:F120 ;
F000:F120 ;	   On entry:	  AH	     00h
F000:F120 ;			  AL	     Video mode
F000:F120 ;
F000:F120 ;	   Returns:	  None
F000:F120 ;
F000:F120 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F120 ;
F000:F120 ;   --------------------------------------------------------------------------
F000:F120 ;			     Table of Video Modes
F000:F120 ;									Buffer
F000:F120 ;   Mode     Type	   Resolution	   Adapter(s)	   Colors	Address
F000:F120 ;   00h     Text	    40 x 25	 All but MDA	   16 gray	 B8000
F000:F120 ;   01h     Text	    40 x 25	 All but MDA   16 fore/8 back	 B8000
F000:F120 ;   02h     Text	    80 x 25	 All but MDA	   16 gray	 B8000
F000:F120 ;   03h     Text	    80 x 25	 All but MDA   16 fore/8 back	 B8000
F000:F120 ;   04h   Graphics	   320 x 200	 All but MDA	     4		 B8000
F000:F120 ;   05h   Graphics	   320 x 200	 All but MDA	   4 gray	 B8000
F000:F120 ;   06h   Graphics	   640 x 200	 All but MDA	     2		 B8000
F000:F120 ;   07h     Text	    80 x 25	   MDA,EGA	    b/w		 B0000
F000:F120 ;   08h   Graphics	   160 x 200	    PCjr	    16		 B0000
F000:F120 ;   09h   Graphics	   320 x 200	    PCjr	    16		 B0000
F000:F120 ;   0Ah   Graphics	   640 x 200	    PCjr	     4		 B0000
F000:F120 ;   --------------------------------------------------------------------------
F000:F120
F000:F120 int_10_00	  proc far				      ;	CODE XREF: int_10+Dj
F000:F120							      ;	DATA XREF: int_10:int_10_jmp_tblo
F000:F120		  push	  ax
F000:F121		  and	  al, 7Fh
F000:F123		  mov	  bx, ds:p400.installed_hardware
F000:F127		  and	  bl, 110000b			      ;	filters	video bits
F000:F12A		  cmp	  bl, 110000b			      ;	is 80x25 mono?
F000:F12D		  jnz	  short	not_mono		      ;	not mono
F000:F12F		  mov	  al, 7				      ;	if 80x25 mono, mode should be 7
F000:F131
F000:F131 not_mono:						      ;	CODE XREF: int_10_00+Dj
F000:F131		  cmp	  al, 7				      ;	is mode	7?
F000:F133		  jz	  short	error			      ;	yes, error
F000:F135		  cmp	  al, 0Ah			      ;	is mode	0xa or below?
F000:F137		  jbe	  short	ok			      ;	yes, ok
F000:F139
F000:F139 error:						      ;	CODE XREF: int_10_00+13j
F000:F139		  pop	  ax
F000:F13A		  jmp	  near ptr pop_regs_and_iret
F000:F13D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F13D
F000:F13D ok:							      ;	CODE XREF: int_10_00+17j
F000:F13D		  mov	  ds:p400.crt_mode, al		      ;	update video mode in shadow var
F000:F140		  xor	  ah, ah
F000:F142		  mov	  dx, 3D4h			      ;	6845 address register
F000:F145		  cmp	  al, 7				      ;	is video mode 7? (impossible, since it was filtered out	before)
F000:F147		  jnz	  short	skip			      ;	no, jump to color
F000:F149		  mov	  ah, 21h ; '!'
F000:F14B		  mov	  dx, 3B4h			      ;	use MDA	address
F000:F14E
F000:F14E skip:							      ;	CODE XREF: int_10_00+27j
F000:F14E		  push	  ax
F000:F14F		  push	  dx
F000:F150		  xor	  ah, ah
F000:F152		  shl	  al, 1
F000:F154		  shl	  al, 1				      ;	al * 4 (video mode * 4)
F000:F156		  mov	  si, ax
F000:F158		  xor	  bx, bx
F000:F15A		  mov	  bl, byte ptr cs:video_init_vars.offset_to_6845_tbl[si]
F000:F15F		  mov	  cl, cs:video_init_vars.value_for_3d8[si]
F000:F164		  xor	  ax, ax
F000:F166		  mov	  al, cs:video_init_vars.nr_columns[si]
F000:F16B		  mov	  ds:p400.crt_nr_cols, ax
F000:F16E		  xor	  ax, ax
F000:F170		  mov	  ah, cs:video_init_vars.video_page_size_256[si]
F000:F175		  mov	  ds:p400.crt_page_len,	ax
F000:F178		  pop	  dx
F000:F179		  pop	  ax
F000:F17A		  mov	  ds:p400.crt_mode_set,	cl
F000:F17E		  mov	  ds:p400.addr_6845, dx
F000:F182		  add	  dx, 4
F000:F185		  mov	  al, ah
F000:F187		  out	  dx, al
F000:F188		  xor	  ax, ax
F000:F18A		  mov	  es, ax			      ;	es = 0
F000:F18C		  push	  dx
F000:F18D		  mov	  al, 3Fh ; '?'
F000:F18F		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:F194		  jb	  short	l0
F000:F196		  mov	  al, 0F6h ; 'ö'
F000:F198
F000:F198 l0:							      ;	CODE XREF: int_10_00+74j
F000:F198		  mov	  dx, 3DFh
F000:F19B		  out	  dx, al
F000:F19C		  mov	  ds:p400.video_page_data, al
F000:F19F		  mov	  si, 74h ; 't'                       ; int 0x1d (video param table)
F000:F1A2		  mov	  di, es:[si]			      ;	video param table offset
F000:F1A5		  add	  di, bx
F000:F1A7		  mov	  ax, es:[si+2]			      ;	video param table segment
F000:F1AB		  mov	  es, ax			      ;	es = segment for video param table
F000:F1AD		  xor	  bh, bh
F000:F1AF		  xor	  cx, cx
F000:F1B1
F000:F1B1 l1:							      ;	CODE XREF: int_10_00+A3j
F000:F1B1		  mov	  dx, ds:p400.addr_6845
F000:F1B5		  mov	  al, cl			      ;	update CRT register
F000:F1B7		  out	  dx, al
F000:F1B8		  inc	  dx
F000:F1B9		  mov	  bl, cl
F000:F1BB		  mov	  al, es:[bx+di]
F000:F1BE		  out	  dx, al			      ;	update CRT data
F000:F1BF		  inc	  cx
F000:F1C0		  cmp	  cx, 10h
F000:F1C3		  jl	  short	l1
F000:F1C5		  mov	  word ptr ds:p400.cursor_row_column, 607h
F000:F1CB		  mov	  word ptr ds:p400.crt_current_page_offset, 0
F000:F1D1		  mov	  byte ptr ds:p400.active_display_page,	0
F000:F1D6		  mov	  byte ptr ds:p400.shadow_3d9_crt_palette, 30h ; '0'
F000:F1DB		  pop	  dx
F000:F1DC		  pop	  ax
F000:F1DD		  push	  dx
F000:F1DE		  test	  al, 80h			      ;	clean screen?
F000:F1E0		  jnz	  short	skip_clean_screen	      ;	no, skip cleaning the screen
F000:F1E2		  mov	  ax, 0B800h
F000:F1E5		  mov	  cx, 2000h			      ;	8k words (16k bytes) to	clean by default
F000:F1E8		  cmp	  byte ptr ds:p400.crt_mode, 9	      ;	video is below 9?
F000:F1ED		  jb	  short	l2			      ;	yes, keep previous value
F000:F1EF		  mov	  cx, 4000h			      ;	16k words (32k bytes) for videos 9 and a
F000:F1F2
F000:F1F2 l2:							      ;	CODE XREF: int_10_00+CDj
F000:F1F2		  mov	  bx, 720h			      ;	for text modes,	clean it with space and	white attrib
F000:F1F5		  cmp	  byte ptr ds:p400.crt_mode, 7	      ;	video mode 7? (impossible)
F000:F1FA		  jnz	  short	l3			      ;	no, jump
F000:F1FC		  mov	  ax, 0B000h			      ;	use segment 0xb000 for mono
F000:F1FF		  mov	  cx, 800h			      ;	and only clean 2k words	(4k bytes)
F000:F202		  jmp	  short	l4
F000:F204 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F204
F000:F204 l3:							      ;	CODE XREF: int_10_00+DAj
F000:F204		  cmp	  byte ptr ds:p400.crt_mode, 4	      ;	video mode 4?
F000:F209		  jl	  short	l4			      ;	less than 4, then jump
F000:F20B		  xor	  bx, bx			      ;	for graphics mode, clean it with black screen (0x0000)
F000:F20D
F000:F20D l4:							      ;	CODE XREF: int_10_00+E2j
F000:F20D							      ;	int_10_00+E9j
F000:F20D		  mov	  es, ax			      ;	update video segment
F000:F20F		  xor	  di, di			      ;	di: offset is 0
F000:F211		  mov	  ax, bx			      ;	value to store
F000:F213		  rep stosw				      ;	clean screen
F000:F215
F000:F215 skip_clean_screen:					      ;	CODE XREF: int_10_00+C0j
F000:F215		  mov	  ax, ds
F000:F217		  mov	  es, ax			      ;	es = ds
F000:F219		  xor	  ax, ax
F000:F21B		  lea	  di, ds:p400.cursor_row_col_in_pages
F000:F21F		  mov	  cx, 8				      ;	8 pages
F000:F222		  rep stosw				      ;	clean col/row cursor values for	all 8 pages
F000:F224		  cmp	  byte ptr ds:p400.crt_mode, 7
F000:F229		  jz	  short	l6
F000:F22B		  mov	  al, 30h ; '0'
F000:F22D		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:F232		  jl	  short	l5
F000:F234		  mov	  al, 3Fh ; '?'
F000:F236		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F23B		  jnz	  short	l5
F000:F23D		  mov	  al, 0
F000:F23F
F000:F23F l5:							      ;	CODE XREF: int_10_00+112j
F000:F23F							      ;	int_10_00+11Bj
F000:F23F		  mov	  dx, 3D9h
F000:F242		  out	  dx, al
F000:F243		  mov	  ds:p400.shadow_3d9_crt_palette, al
F000:F246
F000:F246 l6:							      ;	CODE XREF: int_10_00+109j
F000:F246		  mov	  bl, 10h
F000:F248		  mov	  cx, 10h
F000:F24B		  mov	  dx, 3DAh
F000:F24E		  xor	  ah, ah
F000:F250
F000:F250 l7:							      ;	CODE XREF: int_10_00+140j
F000:F250		  mov	  al, bl
F000:F252		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F252							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F253		  add	  dx, 4
F000:F256		  mov	  al, ah
F000:F258		  out	  dx, al
F000:F259		  inc	  bl
F000:F25B		  inc	  ah
F000:F25D		  sub	  dx, 4
F000:F260		  loop	  l7
F000:F262		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F267		  jnz	  short	l8
F000:F269		  mov	  al, 11h
F000:F26B		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F26B							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F26C		  mov	  al, 3
F000:F26E		  add	  dx, 4
F000:F271		  out	  dx, al
F000:F272		  sub	  dx, 4
F000:F275		  mov	  al, 12h
F000:F277		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F277							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F278		  mov	  al, 5
F000:F27A		  add	  dx, 4
F000:F27D		  out	  dx, al
F000:F27E		  sub	  dx, 4
F000:F281		  mov	  al, 13h
F000:F283		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F283							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F284		  mov	  al, 0Fh
F000:F286		  add	  dx, 4
F000:F289		  out	  dx, al
F000:F28A		  sub	  dx, 4
F000:F28D
F000:F28D l8:							      ;	CODE XREF: int_10_00+147j
F000:F28D		  mov	  al, 1
F000:F28F		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F28F							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F290		  add	  dx, 4
F000:F293		  mov	  al, 0Fh
F000:F295		  out	  dx, al
F000:F296		  sub	  dx, 4
F000:F299		  mov	  al, 2
F000:F29B		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F29B							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F29C		  add	  dx, 4
F000:F29F		  xor	  al, al
F000:F2A1		  out	  dx, al
F000:F2A2		  sub	  dx, 4
F000:F2A5		  mov	  al, 3
F000:F2A7		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F2A7							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F2A8		  add	  dx, 4
F000:F2AB		  mov	  al, 0
F000:F2AD		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:F2B2		  jle	  short	l9
F000:F2B4		  mov	  al, 4
F000:F2B6		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:F2BB		  jnz	  short	l9
F000:F2BD		  mov	  al, 14h
F000:F2BF		  jmp	  short	l11
F000:F2BF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F2C1		  db  90h ; 
F000:F2C2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F2C2
F000:F2C2 l9:							      ;	CODE XREF: int_10_00+192j
F000:F2C2							      ;	int_10_00+19Bj
F000:F2C2		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:F2C7		  jnz	  short	l10
F000:F2C9		  mov	  al, 14h
F000:F2CB		  jmp	  short	l11
F000:F2CB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F2CD		  db  90h ; 
F000:F2CE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F2CE
F000:F2CE l10:							      ;	CODE XREF: int_10_00+1A7j
F000:F2CE		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F2D3		  jnz	  short	l11
F000:F2D5		  mov	  al, 0Ch
F000:F2D7
F000:F2D7 l11:							      ;	CODE XREF: int_10_00+19Fj
F000:F2D7							      ;	int_10_00+1ABj
F000:F2D7							      ;	int_10_00+1B3j
F000:F2D7		  out	  dx, al
F000:F2D8		  mov	  dx, 3DAh
F000:F2DB		  xor	  al, al
F000:F2DD		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F2DD							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F2DE		  pop	  dx
F000:F2DF		  mov	  al, ds:p400.crt_mode_set
F000:F2E2		  out	  dx, al
F000:F2E3		  jmp	  near ptr pop_regs_and_iret
F000:F2E3 int_10_00	  endp
F000:F2E3
F000:F2E6
F000:F2E6 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F2E6
F000:F2E6 ;	Adjusts	the size of the	cursor by setting its start and	end lines.
F000:F2E6 ;
F000:F2E6 ;	   On entry:	  AH	     01h
F000:F2E6 ;			  CH	     Cursor start line (bits 4 to 0)
F000:F2E6 ;			  CL	     Cursor end	line   (bits 4 to 0)
F000:F2E6 ;
F000:F2E6 ;	   Returns:	  None
F000:F2E6 ;
F000:F2E6 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F2E6 ;
F000:F2E6
F000:F2E6 int_10_01	  proc far				      ;	CODE XREF: int_10+Dj
F000:F2E6							      ;	DATA XREF: int_10+14o
F000:F2E6		  mov	  bh, 0Ah
F000:F2E8		  mov	  bl, 0Bh
F000:F2EA		  call	  set_pair_value_in_6845
F000:F2ED		  mov	  ds:p400.cursor_row_column, cx
F000:F2F1		  jmp	  near ptr pop_regs_and_iret
F000:F2F1 int_10_01	  endp
F000:F2F1
F000:F2F4
F000:F2F4 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F2F4
F000:F2F4 ;	Sets the cursor	position (row and column) for a	specified display
F000:F2F4 ;	page.
F000:F2F4 ;
F000:F2F4 ;	   On entry:	  AH	     02h
F000:F2F4 ;			  BH	     Display page number
F000:F2F4 ;			  DH	     Row
F000:F2F4 ;			  DL	     Column
F000:F2F4 ;
F000:F2F4 ;	   Returns:	  None
F000:F2F4 ;
F000:F2F4 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F2F4 ;
F000:F2F4
F000:F2F4 int_10_02	  proc far				      ;	CODE XREF: int_10+Dj
F000:F2F4							      ;	DATA XREF: int_10+16o
F000:F2F4		  call	  set_cursor_pos
F000:F2F7		  jmp	  near ptr pop_regs_and_iret
F000:F2F7 int_10_02	  endp
F000:F2F7
F000:F2FA
F000:F2FA ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F2FA
F000:F2FA
F000:F2FA set_cursor_pos  proc near				      ;	CODE XREF: int_10_02p
F000:F2FA							      ;	int_10_0e+8Ap
F000:F2FA							      ;	int_10_0e+99p
F000:F2FA		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:F2FF		  jl	  short	l0
F000:F301		  xor	  bh, bh			      ;	page 0 for modes >= 4 (graphics	mode)
F000:F303
F000:F303 l0:							      ;	CODE XREF: set_cursor_pos+5j
F000:F303		  lea	  di, ds:p400.cursor_row_col_in_pages
F000:F307		  push	  bx
F000:F308		  mov	  bl, bh
F000:F30A		  xor	  bh, bh
F000:F30C		  shl	  bx, 1
F000:F30E		  mov	  [bx+di], dx
F000:F310		  pop	  bx
F000:F311		  cmp	  ds:p400.active_display_page, bh
F000:F315		  jnz	  short	exit
F000:F317		  call	  update_cursor_offset
F000:F31A
F000:F31A exit:							      ;	CODE XREF: set_cursor_pos+1Bj
F000:F31A		  retn
F000:F31A set_cursor_pos  endp
F000:F31A
F000:F31B
F000:F31B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F31B
F000:F31B
F000:F31B update_cursor_offset proc near			      ;	CODE XREF: set_cursor_pos+1Dp
F000:F31B							      ;	int_10_05+31p
F000:F31B		  mov	  al, dh
F000:F31D		  mul	  byte ptr ds:p400.crt_nr_cols
F000:F321		  xor	  dh, dh
F000:F323		  add	  ax, dx
F000:F325		  mov	  cx, ax
F000:F327		  mov	  ax, ds:p400.crt_current_page_offset
F000:F32A		  shr	  ax, 1				      ;	page_offset / 2	(get rid of attributes bytes)
F000:F32C		  add	  cx, ax			      ;	cx = page offset + cursor offset
F000:F32E		  mov	  bh, 0Eh			      ;	reg 0e = cursor	start address hi
F000:F330		  mov	  bl, 0Fh			      ;	reg 0f = cursor	start address lo
F000:F332		  jmp	  set_pair_value_in_6845
F000:F332 update_cursor_offset endp
F000:F332
F000:F335
F000:F335 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F335
F000:F335 ;	Reports	the cursor position (row and column) and size for a specified
F000:F335 ;	display	page.
F000:F335 ;
F000:F335 ;	   On entry:	  AH	     03h
F000:F335 ;			  BH	     Display page number
F000:F335 ;
F000:F335 ;	   Returns:	  CH	     Cursor start line
F000:F335 ;			  CL	     Cursor end	line
F000:F335 ;			  DH	     Row
F000:F335 ;			  DL	     Column
F000:F335 ;
F000:F335 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F335 ; Attributes:	bp-based frame
F000:F335
F000:F335 int_10_03	  proc far				      ;	CODE XREF: int_10+Dj
F000:F335							      ;	DATA XREF: int_10+18o
F000:F335
F000:F335 arg_cursor_position= word ptr	 0Ah
F000:F335 arg_cursor_address_position= word ptr	 0Ch
F000:F335
F000:F335		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:F33A		  jl	  short	l0
F000:F33C		  xor	  bh, bh
F000:F33E
F000:F33E l0:							      ;	CODE XREF: int_10_03+5j
F000:F33E		  mov	  bl, bh
F000:F340		  call	  get_cursor_row_cols_for_page
F000:F343		  mov	  bp, sp
F000:F345		  mov	  [bp+arg_cursor_position], dx
F000:F348		  mov	  cx, ds:p400.cursor_row_column
F000:F34C		  mov	  [bp+arg_cursor_address_position], cx
F000:F34F		  jmp	  near ptr pop_regs_and_iret
F000:F34F int_10_03	  endp
F000:F34F
F000:F352
F000:F352 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F352
F000:F352 ;	Reports	the position and status	of the light pen.
F000:F352 ;
F000:F352 ;	   On entry:	  AH	     04h
F000:F352 ;
F000:F352 ;	   Returns:	  AH	     Status (0=not triggered, 1=triggered)
F000:F352 ;			  BX	     Pixel column number (0-639)
F000:F352 ;			  CH	     Pixel line	number (0-199)
F000:F352 ;			  CX	     Pixel line	number for modes 0Fh-10h (0-nnn)
F000:F352 ;			  DH	     Character row number (0-24)
F000:F352 ;			  DL	     Character column number (0-39 or 0-79)
F000:F352 ;
F000:F352 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F352
F000:F352 int_10_04	  proc far				      ;	CODE XREF: int_10+Dj
F000:F352							      ;	DATA XREF: int_10+1Ao
F000:F352
F000:F352 arg_light_pen_row_col= word ptr  0Ah
F000:F352 arg_light_pen_row_in_pixels= byte ptr	 0Dh
F000:F352 arg_light_pen_col_in_pixels= word ptr	 0Eh
F000:F352
F000:F352		  mov	  dx, 3DAh
F000:F355		  in	  al, dx			      ;	Video status bits:
F000:F355							      ;	0: retrace.  1=display is in vert or horiz retrace.
F000:F355							      ;	1: 1=light pen is triggered; 0=armed
F000:F355							      ;	2: 1=light pen switch is open; 0=closed
F000:F355							      ;	3: 1=vertical sync pulse is occurring.
F000:F356		  mov	  ah, 0
F000:F358		  test	  al, 2
F000:F35A		  jnz	  short	light_pen_present
F000:F35C		  jmp	  exit
F000:F35F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F35F
F000:F35F light_pen_present:					      ;	CODE XREF: int_10_04+8j
F000:F35F		  mov	  dx, ds:p400.addr_6845
F000:F363		  mov	  al, 10h
F000:F365		  out	  dx, al
F000:F366		  inc	  dx
F000:F367		  in	  al, dx
F000:F368		  mov	  bh, al
F000:F36A		  dec	  dx
F000:F36B		  mov	  al, 11h
F000:F36D		  out	  dx, al
F000:F36E		  inc	  dx
F000:F36F		  in	  al, dx
F000:F370		  mov	  ah, bh
F000:F372		  sub	  ax, 4
F000:F375		  mov	  dx, 3DBh
F000:F378		  out	  dx, al			      ;	Video: light pen latch reset.
F000:F378							      ;	Any OUT	clears the latch.
F000:F379		  mov	  bp, sp
F000:F37B		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:F380		  jnb	  short	modes_0_1_2_3
F000:F382		  xor	  dx, dx
F000:F384		  mov	  bx, ds:p400.crt_nr_cols
F000:F388		  div	  bx
F000:F38A		  mov	  dh, al
F000:F38C		  mov	  [bp+arg_light_pen_row_col], dx
F000:F38F		  mov	  cl, 3
F000:F391		  shl	  al, cl
F000:F393		  mov	  [bp+arg_light_pen_row_in_pixels], al
F000:F396		  xor	  bx, bx
F000:F398		  mov	  bl, dl
F000:F39A		  shl	  bx, cl
F000:F39C		  mov	  [bp+arg_light_pen_col_in_pixels], bx
F000:F39F		  jmp	  exit_triggered
F000:F3A2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F3A2
F000:F3A2 modes_0_1_2_3:					      ;	CODE XREF: int_10_04+2Ej
F000:F3A2		  xor	  dx, dx
F000:F3A4		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:F3A9		  jnb	  short	modes_9_a
F000:F3AB		  add	  ax, 2
F000:F3AE		  cmp	  ax, 1000h
F000:F3B1		  jb	  short	modes_4_and_up
F000:F3B3		  sub	  ax, 0FD8h
F000:F3B6
F000:F3B6 modes_4_and_up:					      ;	CODE XREF: int_10_04+5Fj
F000:F3B6		  mov	  bx, 28h ; '('
F000:F3B9		  div	  bx
F000:F3BB		  shl	  ax, 1
F000:F3BD		  mov	  [bp+arg_light_pen_row_in_pixels], al
F000:F3C0		  shl	  dx, 1
F000:F3C2		  shl	  dx, 1
F000:F3C4		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:F3C9		  jz	  short	mode_8
F000:F3CB		  shl	  dx, 1
F000:F3CD		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:F3D2		  jnz	  short	mode_8
F000:F3D4		  shl	  dx, 1
F000:F3D6
F000:F3D6 mode_8:						      ;	CODE XREF: int_10_04+77j
F000:F3D6							      ;	int_10_04+80j
F000:F3D6		  mov	  [bp+arg_light_pen_col_in_pixels], dx
F000:F3D9		  jmp	  short	from_pixel_to_char
F000:F3D9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F3DB		  db  90h ; 
F000:F3DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F3DC
F000:F3DC modes_9_a:						      ;	CODE XREF: int_10_04+57j
F000:F3DC		  mov	  bx, 80
F000:F3DF		  cmp	  ax, 12288
F000:F3E2		  jb	  short	l1
F000:F3E4		  sub	  ax, 12288
F000:F3E7		  div	  bx
F000:F3E9		  shl	  ax, 1
F000:F3EB		  shl	  ax, 1
F000:F3ED		  add	  ax, 3
F000:F3F0		  jmp	  short	l4
F000:F3F0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F3F2		  db  90h ; 
F000:F3F3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F3F3
F000:F3F3 l1:							      ;	CODE XREF: int_10_04+90j
F000:F3F3		  cmp	  ax, 8192
F000:F3F6		  jb	  short	l2
F000:F3F8		  sub	  ax, 8192
F000:F3FB		  div	  bx
F000:F3FD		  shl	  ax, 1
F000:F3FF		  shl	  ax, 1
F000:F401		  add	  ax, 2
F000:F404		  jmp	  short	l4
F000:F404 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F406		  db  90h ; 
F000:F407 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F407
F000:F407 l2:							      ;	CODE XREF: int_10_04+A4j
F000:F407		  cmp	  ax, 4096
F000:F40A		  jb	  short	l3
F000:F40C		  sub	  ax, 4096
F000:F40F		  div	  bx
F000:F411		  shl	  ax, 1
F000:F413		  shl	  ax, 1
F000:F415		  add	  ax, 1
F000:F418		  jmp	  short	l4
F000:F418 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F41A		  db  90h ; 
F000:F41B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F41B
F000:F41B l3:							      ;	CODE XREF: int_10_04+B8j
F000:F41B		  div	  bx
F000:F41D		  shl	  ax, 1
F000:F41F		  shl	  ax, 1
F000:F421
F000:F421 l4:							      ;	CODE XREF: int_10_04+9Ej
F000:F421							      ;	int_10_04+B2j
F000:F421							      ;	int_10_04+C6j
F000:F421		  shl	  dx, 1
F000:F423		  shl	  dx, 1
F000:F425		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F42A		  jnz	  short	l5
F000:F42C		  shl	  dx, 1
F000:F42E
F000:F42E l5:							      ;	CODE XREF: int_10_04+D8j
F000:F42E		  mov	  [bp+arg_light_pen_row_in_pixels], al
F000:F431		  mov	  [bp+arg_light_pen_col_in_pixels], dx
F000:F434
F000:F434 from_pixel_to_char:					      ;	CODE XREF: int_10_04+87j
F000:F434		  mov	  al, [bp+arg_light_pen_row_in_pixels]
F000:F437		  mov	  cl, 3
F000:F439		  shr	  al, cl
F000:F43B		  mov	  dx, [bp+arg_light_pen_col_in_pixels]
F000:F43E		  shr	  dx, cl
F000:F440		  mov	  dh, al
F000:F442		  mov	  [bp+arg_light_pen_row_col], dx
F000:F445
F000:F445 exit_triggered:					      ;	CODE XREF: int_10_04+4Dj
F000:F445		  mov	  ah, 1
F000:F447
F000:F447 exit:							      ;	CODE XREF: int_10_04+Aj
F000:F447		  jmp	  near ptr pop_regs_and_iret
F000:F447 int_10_04	  endp
F000:F447
F000:F44A
F000:F44A ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F44A
F000:F44A ;	Sets the active	display	page.
F000:F44A ;
F000:F44A ;	   On entry:	  AH	     05h
F000:F44A ;			  AL	     Display page number
F000:F44A ;
F000:F44A ;	   Returns:	  None
F000:F44A ;
F000:F44A ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F44A
F000:F44A int_10_05	  proc far				      ;	CODE XREF: int_10+Dj
F000:F44A							      ;	DATA XREF: int_10+1Co
F000:F44A
F000:F44A arg_CRT_CPU_pages= word ptr  0Eh
F000:F44A
F000:F44A		  test	  al, 80h
F000:F44C		  jnz	  short	l1
F000:F44E		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:F453		  jl	  short	l0
F000:F455		  jmp	  near ptr pop_regs_and_iret
F000:F458 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F458
F000:F458 l0:							      ;	CODE XREF: int_10_05+9j
F000:F458		  mov	  ds:p400.active_display_page, al
F000:F45B		  mov	  ax, ds:p400.crt_page_len
F000:F45E		  xor	  bh, bh
F000:F460		  mov	  bl, ds:p400.active_display_page
F000:F464		  mul	  bx
F000:F466		  mov	  ds:p400.crt_current_page_offset, ax
F000:F469		  mov	  cx, ax
F000:F46B		  sar	  cx, 1				      ;	cx /= 2	(bc. page len count attributes)	??
F000:F46D		  mov	  bh, 0Ch			      ;	reg 0x0c = start address hi
F000:F46F		  mov	  bl, 0Dh			      ;	reg 0x0d = start address lo
F000:F471		  call	  set_pair_value_in_6845
F000:F474		  mov	  bl, ds:p400.active_display_page
F000:F478		  call	  get_cursor_row_cols_for_page
F000:F47B		  call	  update_cursor_offset
F000:F47E		  jmp	  near ptr pop_regs_and_iret
F000:F481 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F481
F000:F481 l1:							      ;	CODE XREF: int_10_05+2j
F000:F481		  mov	  ah, al
F000:F483		  cmp	  ah, 84h ; '„'
F000:F486		  jnb	  short	error
F000:F488		  cmp	  ah, 80h ; '€'
F000:F48B		  jz	  short	get_registers
F000:F48D		  and	  bl, 7				      ;	set registers
F000:F490		  and	  bh, 7
F000:F493		  mov	  cl, 3
F000:F495		  shl	  bl, cl
F000:F497		  mov	  al, ds:p400.video_page_data
F000:F49A		  cmp	  ah, 81h ; ''
F000:F49D		  jnz	  short	set_crt_register
F000:F49F		  and	  al, 11000111b
F000:F4A1		  or	  al, bl
F000:F4A3		  jmp	  short	l2
F000:F4A3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F4A5		  db  90h ; 
F000:F4A6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F4A6
F000:F4A6 set_crt_register:					      ;	CODE XREF: int_10_05+53j
F000:F4A6		  cmp	  ah, 82h ; '‚'
F000:F4A9		  jnz	  short	set_cpu_crt_registers
F000:F4AB		  and	  al, 11111000b
F000:F4AD		  or	  al, bh
F000:F4AF		  jmp	  short	l2
F000:F4AF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F4B1		  db  90h ; 
F000:F4B2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F4B2
F000:F4B2 set_cpu_crt_registers:				      ;	CODE XREF: int_10_05+5Fj
F000:F4B2		  and	  al, 0C0h
F000:F4B4		  or	  al, bl
F000:F4B6		  or	  al, bh
F000:F4B8
F000:F4B8 l2:							      ;	CODE XREF: int_10_05+59j
F000:F4B8							      ;	int_10_05+65j
F000:F4B8		  mov	  ds:p400.video_page_data, al
F000:F4BB		  mov	  dx, 3DFh
F000:F4BE		  out	  dx, al
F000:F4BF
F000:F4BF get_registers:					      ;	CODE XREF: int_10_05+41j
F000:F4BF		  mov	  bp, sp
F000:F4C1		  mov	  al, ds:p400.video_page_data
F000:F4C4		  and	  al, 7
F000:F4C6		  mov	  bh, al
F000:F4C8		  mov	  al, ds:p400.video_page_data
F000:F4CB		  mov	  cl, 3
F000:F4CD		  shr	  al, cl
F000:F4CF		  and	  al, 7
F000:F4D1		  mov	  bl, al
F000:F4D3		  mov	  [bp+arg_CRT_CPU_pages], bx
F000:F4D6		  clc
F000:F4D7		  jmp	  near ptr pop_regs_and_iret
F000:F4DA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F4DA
F000:F4DA error:						      ;	CODE XREF: int_10_05+3Cj
F000:F4DA		  stc
F000:F4DB		  jmp	  near ptr pop_regs_and_iret
F000:F4DB int_10_05	  endp
F000:F4DB
F000:F4DE
F000:F4DE ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F4DE
F000:F4DE ;	Scrolls	a specified window upward a specified number of	lines.
F000:F4DE ;
F000:F4DE ;	   On entry:	  AH	     06h
F000:F4DE ;			  AL	     Number of lines to	scroll (if 0, clear entire
F000:F4DE ;				     window)
F000:F4DE ;			  BH	     Display attribute for blank lines
F000:F4DE ;			  CH	     Row number	of upper left corner
F000:F4DE ;			  CL	     Column number of upper left corner
F000:F4DE ;			  DH	     Row number	of lower right corner
F000:F4DE ;			  DL	     Column number of lower right corner
F000:F4DE ;
F000:F4DE ;	   Returns:	  None
F000:F4DE ;
F000:F4DE ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F4DE ;
F000:F4DE ; Attributes:	bp-based frame
F000:F4DE
F000:F4DE int_10_06	  proc far				      ;	CODE XREF: int_10+Dj
F000:F4DE							      ;	DATA XREF: int_10+1Eo
F000:F4DE		  push	  ax
F000:F4DF		  mov	  bp, sp
F000:F4E1		  mov	  word ptr [bp+0], 0
F000:F4E6		  call	  scroll_up_or_down
F000:F4E9		  pop	  bx
F000:F4EA		  jmp	  near ptr pop_regs_and_iret
F000:F4EA int_10_06	  endp
F000:F4EA
F000:F4ED
F000:F4ED ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F4ED
F000:F4ED ; Attributes:	bp-based frame
F000:F4ED
F000:F4ED scroll_up_or_down proc near				      ;	CODE XREF: int_10_06+8p
F000:F4ED							      ;	int_10_07+8p
F000:F4ED
F000:F4ED var_4		  = word ptr -4
F000:F4ED var_2		  = word ptr -2
F000:F4ED arg_scroll_direction=	word ptr  4
F000:F4ED arg_C		  = word ptr  0Eh
F000:F4ED arg_row_bottom  = byte ptr  11h
F000:F4ED arg_row_top	  = byte ptr  13h
F000:F4ED arg_char_attrib = byte ptr  15h
F000:F4ED
F000:F4ED ; FUNCTION CHUNK AT F000:D413	SIZE 00000119 BYTES
F000:F4ED ; FUNCTION CHUNK AT F000:D52D	SIZE 00000085 BYTES
F000:F4ED ; FUNCTION CHUNK AT F000:D5B3	SIZE 00000014 BYTES
F000:F4ED
F000:F4ED		  mov	  ah, dl
F000:F4EF		  sub	  ah, cl
F000:F4F1		  inc	  ah
F000:F4F3		  cmp	  ah, 0
F000:F4F6		  jg	  short	l0
F000:F4F8		  jmp	  exit
F000:F4FB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F4FB
F000:F4FB l0:							      ;	CODE XREF: scroll_up_or_down+9j
F000:F4FB		  mov	  bl, dh
F000:F4FD		  sub	  bl, ch
F000:F4FF		  cmp	  al, bl
F000:F501		  jle	  short	l1
F000:F503		  xor	  al, al
F000:F505
F000:F505 l1:							      ;	CODE XREF: scroll_up_or_down+14j
F000:F505		  call	  is_text_mode
F000:F508		  jnb	  short	is_text_mode
F000:F50A		  jmp	  scroll_graphics_up_or_down
F000:F50D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F50D
F000:F50D is_text_mode:						      ;	CODE XREF: scroll_up_or_down+1Bj
F000:F50D		  cmp	  word ptr [bp+0], 0		      ;	direction: 0 up, 1 down
F000:F511		  jz	  short	l3
F000:F513		  mov	  dh, ch
F000:F515
F000:F515 l3:							      ;	CODE XREF: scroll_up_or_down+24j
F000:F515		  mov	  bh, ds:p400.active_display_page
F000:F519		  xor	  bl, bl
F000:F51B		  call	  get_screen_offset
F000:F51E		  inc	  bx
F000:F51F		  inc	  bx
F000:F520		  push	  bx
F000:F521		  mov	  bp, sp
F000:F523		  xor	  ch, ch
F000:F525		  cmp	  [bp+arg_scroll_direction], 0
F000:F529		  jz	  short	l4
F000:F52B		  mov	  ch, [bp+arg_row_bottom]
F000:F52E		  sub	  ch, [bp+arg_row_top]
F000:F531
F000:F531 l4:							      ;	CODE XREF: scroll_up_or_down+3Cj
F000:F531		  mov	  dx, [bp+12h]
F000:F534		  add	  dh, ch
F000:F536		  mov	  bh, ds:p400.active_display_page
F000:F53A		  xor	  bl, bl
F000:F53C		  call	  get_screen_offset
F000:F53F		  mov	  di, bx
F000:F541		  mov	  dh, [bp+arg_row_bottom]
F000:F544		  sub	  dh, [bp+arg_row_top]
F000:F547		  cmp	  dh, 0
F000:F54A		  jnz	  short	l5
F000:F54C		  jmp	  short	l10
F000:F54C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F54E		  db  90h ; 
F000:F54F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F54F
F000:F54F l5:							      ;	CODE XREF: scroll_up_or_down+5Dj
F000:F54F		  mov	  dx, [bp+12h]
F000:F552		  add	  dh, ch
F000:F554		  cmp	  [bp+arg_scroll_direction], 0
F000:F558		  jnz	  short	l6
F000:F55A		  add	  dh, al
F000:F55C		  jmp	  short	l7
F000:F55E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F55E
F000:F55E l6:							      ;	CODE XREF: scroll_up_or_down+6Bj
F000:F55E		  sub	  dh, al
F000:F560
F000:F560 l7:							      ;	CODE XREF: scroll_up_or_down+6Fj
F000:F560		  mov	  bh, ds:p400.active_display_page
F000:F564		  xor	  bl, bl
F000:F566		  call	  get_screen_offset
F000:F569		  mov	  si, bx
F000:F56B		  xor	  cx, cx
F000:F56D		  cmp	  al, 0
F000:F56F		  jz	  short	l10
F000:F571
F000:F571 l8:							      ;	CODE XREF: scroll_up_or_down+9Cj
F000:F571		  push	  si
F000:F572		  push	  di
F000:F573		  push	  ds
F000:F574		  push	  ax
F000:F575		  mov	  ax, es
F000:F577		  mov	  ds, ax
F000:F579		  pop	  ax
F000:F57A		  mov	  cl, ah
F000:F57C		  rep movsw
F000:F57E		  pop	  ds
F000:F57F		  cmp	  si, [bp+0]
F000:F582		  jz	  short	l9
F000:F584		  pop	  di
F000:F585		  pop	  si
F000:F586		  call	  add_or_sub_bytes_per_row
F000:F589		  jmp	  short	l8
F000:F58B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F58B
F000:F58B l9:							      ;	CODE XREF: scroll_up_or_down+95j
F000:F58B		  pop	  di
F000:F58C		  pop	  si
F000:F58D		  call	  add_or_sub_bytes_per_row
F000:F590
F000:F590 l10:							      ;	CODE XREF: scroll_up_or_down+5Fj
F000:F590							      ;	scroll_up_or_down+82j
F000:F590							      ;	scroll_up_or_down+BAj
F000:F590		  push	  si
F000:F591		  push	  di
F000:F592		  mov	  cl, ah
F000:F594		  push	  ax
F000:F595		  mov	  al, 20h ; ' '
F000:F597		  mov	  ah, [bp+arg_char_attrib]
F000:F59A		  rep stosw
F000:F59C		  pop	  ax
F000:F59D		  cmp	  di, [bp+0]
F000:F5A0		  jz	  short	l11
F000:F5A2		  pop	  di
F000:F5A3		  pop	  si
F000:F5A4		  call	  add_or_sub_bytes_per_row
F000:F5A7		  jmp	  short	l10
F000:F5A9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F5A9
F000:F5A9 l11:							      ;	CODE XREF: scroll_up_or_down+B3j
F000:F5A9		  pop	  di
F000:F5AA		  pop	  si
F000:F5AB		  pop	  bx
F000:F5AC
F000:F5AC exit:							      ;	CODE XREF: scroll_up_or_down+Bj
F000:F5AC		  retn
F000:F5AC scroll_up_or_down endp
F000:F5AC
F000:F5AD
F000:F5AD ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F5AD
F000:F5AD ;	Scrolls	a specified window downward a specified	number of lines.
F000:F5AD ;
F000:F5AD ;	   On entry:	  AH	     07h
F000:F5AD ;			  AL	     Number of lines to	scroll (if 0, clear entire
F000:F5AD ;				     window)
F000:F5AD ;			  BH	     Display attribute for blank lines
F000:F5AD ;			  CH	     Row number	of upper left corner
F000:F5AD ;			  CL	     Column number of upper left corner
F000:F5AD ;			  DH	     Row number	of lower right corner
F000:F5AD ;			  DL	     Column number of lower right corner
F000:F5AD ;
F000:F5AD ;	   Returns:	  None
F000:F5AD ;
F000:F5AD ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F5AD ; Attributes:	bp-based frame
F000:F5AD
F000:F5AD int_10_07	  proc far				      ;	CODE XREF: int_10+Dj
F000:F5AD							      ;	DATA XREF: int_10+20o
F000:F5AD		  push	  ax
F000:F5AE		  mov	  bp, sp
F000:F5B0		  mov	  word ptr [bp+0], 1
F000:F5B5		  call	  scroll_up_or_down
F000:F5B8		  pop	  bx
F000:F5B9		  jmp	  near ptr pop_regs_and_iret
F000:F5B9 int_10_07	  endp
F000:F5B9
F000:F5BC
F000:F5BC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F5BC
F000:F5BC ;	Reports	the ASCII value	and (in	text mode) attribute of	the character
F000:F5BC ;	at the current cursor location of the specified	display	page.
F000:F5BC ;
F000:F5BC ;	   On entry:	  AH	     08h
F000:F5BC ;			  BH	     Display page number (text modes only)
F000:F5BC ;
F000:F5BC ;	   Returns:	  AH	     Attribute of character (text mode)
F000:F5BC ;			  AL	     ASCII value of character
F000:F5BC ;
F000:F5BC ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F5BC
F000:F5BC int_10_08	  proc far				      ;	CODE XREF: int_10+Dj
F000:F5BC							      ;	DATA XREF: int_10+22o
F000:F5BC		  call	  is_text_mode
F000:F5BF		  jnb	  short	text_mode
F000:F5C1		  xor	  bl, bl
F000:F5C3		  call	  get_cursor_row_cols_for_page
F000:F5C6		  call	  gfx_get_ascii_value_for_row_col
F000:F5C9		  jmp	  short	exit
F000:F5CB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F5CB
F000:F5CB text_mode:						      ;	CODE XREF: int_10_08+3j
F000:F5CB		  mov	  bl, 1
F000:F5CD		  call	  get_screen_offset
F000:F5D0		  mov	  ax, es:[bx]			      ;	get ascii value	+ attribute
F000:F5D3		  sti
F000:F5D4
F000:F5D4 exit:							      ;	CODE XREF: int_10_08+Dj
F000:F5D4		  jmp	  near ptr pop_regs_and_iret
F000:F5D4 int_10_08	  endp
F000:F5D4
F000:F5D7
F000:F5D7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F5D7
F000:F5D7 ;	Displays a specified character with a specified	attribute a specified
F000:F5D7 ;	number of times.
F000:F5D7 ;
F000:F5D7 ;	   On entry:	  AX	     09h
F000:F5D7 ;			  AL	     ASCII value of character
F000:F5D7 ;			  BH	     Display page (text	mode only)
F000:F5D7 ;			  BL	     Attribute/Color
F000:F5D7 ;			  CX	     Number of times to	write character
F000:F5D7 ;
F000:F5D7 ;	   Returns:	  None
F000:F5D7 ;
F000:F5D7 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F5D7
F000:F5D7 int_10_09	  proc far				      ;	CODE XREF: int_10+Dj
F000:F5D7							      ;	DATA XREF: int_10+24o
F000:F5D7		  xor	  dl, dl
F000:F5D9		  jmp	  short	display_chars
F000:F5D9 int_10_09	  endp
F000:F5D9
F000:F5DB
F000:F5DB ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F5DB
F000:F5DB ;
F000:F5DB ;	Displays a specified character a specified number of times.
F000:F5DB ;
F000:F5DB ;	   On entry:	  AH	     0Ah
F000:F5DB ;			  AL	     ASCII value of character
F000:F5DB ;			  BH	     Display page number (text mode only)
F000:F5DB ;			  CX	     Number of times to	write character
F000:F5DB ;
F000:F5DB ;	   Returns:	  None
F000:F5DB ;
F000:F5DB ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F5DB ;
F000:F5DB ; Attributes:	bp-based frame
F000:F5DB
F000:F5DB int_10_0a	  proc far				      ;	CODE XREF: int_10+Dj
F000:F5DB							      ;	DATA XREF: int_10+26o
F000:F5DB		  mov	  dl, 0FFh
F000:F5DD
F000:F5DD display_chars:					      ;	CODE XREF: int_10_09+2j
F000:F5DD		  or	  cx, cx
F000:F5DF		  jz	  short	exit
F000:F5E1		  mov	  ah, bl
F000:F5E3		  call	  is_text_mode
F000:F5E6		  jnb	  short	display_chars_text_mode
F000:F5E8		  xor	  bl, bl
F000:F5EA		  call	  get_cursor_row_cols_for_page
F000:F5ED		  call	  gfx_print_char
F000:F5F0		  jmp	  short	exit
F000:F5F2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F5F2
F000:F5F2 display_chars_text_mode:				      ;	CODE XREF: int_10_0a+Bj
F000:F5F2		  push	  dx
F000:F5F3		  mov	  bp, sp
F000:F5F5		  mov	  bl, 1
F000:F5F7		  call	  get_screen_offset
F000:F5FA		  mov	  di, bx
F000:F5FC		  mov	  bl, al
F000:F5FE		  cmp	  byte ptr [bp+0], 0
F000:F602		  jnz	  short	write_ascii_only
F000:F604
F000:F604 write_ascii_and_attribute:				      ;	CODE XREF: int_10_0a+2Dj
F000:F604		  mov	  al, bl
F000:F606		  stosw
F000:F607		  sti
F000:F608		  loop	  write_ascii_and_attribute
F000:F60A		  jmp	  short	pop_and_exit
F000:F60C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F60C
F000:F60C write_ascii_only:					      ;	CODE XREF: int_10_0a+27j
F000:F60C							      ;	int_10_0a+36j
F000:F60C		  mov	  al, bl
F000:F60E		  stosb
F000:F60F		  sti
F000:F610		  inc	  di
F000:F611		  loop	  write_ascii_only
F000:F613
F000:F613 pop_and_exit:						      ;	CODE XREF: int_10_0a+2Fj
F000:F613		  pop	  bx
F000:F614
F000:F614 exit:							      ;	CODE XREF: int_10_0a+4j
F000:F614							      ;	int_10_0a+15j
F000:F614		  jmp	  near ptr pop_regs_and_iret
F000:F614 int_10_0a	  endp
F000:F614
F000:F617
F000:F617 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F617
F000:F617 ;
F000:F617 ;	Selects	color palette for various display modes.
F000:F617 ;
F000:F617 ;	   On entry:	  AX	     0Bh
F000:F617 ;			  BH	     Palette Color ID (0 or 1, See below)
F000:F617 ;			  BL	     Color or palette value to be used with Color
F000:F617 ;				     ID	(0 - 31)
F000:F617 ;
F000:F617 ;	   Returns:	  None
F000:F617 ;
F000:F617 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F617
F000:F617 int_10_0b	  proc far				      ;	CODE XREF: int_10+Dj
F000:F617							      ;	DATA XREF: int_10+28o
F000:F617		  mov	  dx, 3D9h
F000:F61A		  mov	  al, ds:p400.shadow_3d9_crt_palette
F000:F61D		  cmp	  bh, 0
F000:F620		  jnz	  short	l2
F000:F622		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:F627		  jb	  short	l0
F000:F629		  mov	  bh, bl
F000:F62B		  mov	  bl, 0
F000:F62D		  call	  set_palette_color
F000:F630		  mov	  bl, bh
F000:F632
F000:F632 l0:							      ;	CODE XREF: int_10_0b+10j
F000:F632		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:F637		  jz	  short	l1
F000:F639		  mov	  dx, 3DAh
F000:F63C		  mov	  al, 2
F000:F63E		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F63E							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F63F		  mov	  al, bl
F000:F641		  add	  dx, 4
F000:F644		  out	  dx, al
F000:F645		  xor	  al, al
F000:F647		  sub	  dx, 4
F000:F64A		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F64A							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F64B
F000:F64B l1:							      ;	CODE XREF: int_10_0b+20j
F000:F64B		  mov	  dx, 3D9h
F000:F64E		  mov	  al, ds:p400.shadow_3d9_crt_palette
F000:F651		  and	  al, 0E0h
F000:F653		  and	  bl, 1Fh
F000:F656		  or	  al, bl
F000:F658		  jmp	  short	l3
F000:F65A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F65A
F000:F65A l2:							      ;	CODE XREF: int_10_0b+9j
F000:F65A		  and	  al, 0DFh
F000:F65C		  cmp	  bl, 0
F000:F65F		  jz	  short	l3
F000:F661		  or	  al, 20h
F000:F663
F000:F663 l3:							      ;	CODE XREF: int_10_0b+41j
F000:F663							      ;	int_10_0b+48j
F000:F663		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F668		  jnz	  short	l4
F000:F66A		  mov	  al, 0
F000:F66C
F000:F66C l4:							      ;	CODE XREF: int_10_0b+51j
F000:F66C		  out	  dx, al
F000:F66D		  mov	  ds:p400.shadow_3d9_crt_palette, al
F000:F670		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F675		  jnz	  short	l7
F000:F677		  cmp	  bl, 0
F000:F67A		  jz	  short	set_cga_palette_0
F000:F67C		  mov	  bx, 301h
F000:F67F		  call	  set_palette_color
F000:F682		  mov	  bx, 502h
F000:F685		  call	  set_palette_color
F000:F688		  mov	  bx, 0F03h
F000:F68B		  call	  set_palette_color
F000:F68E		  jmp	  short	l6
F000:F68E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F690		  db  90h ; 
F000:F691 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F691
F000:F691 set_cga_palette_0:					      ;	CODE XREF: int_10_0b+63j
F000:F691		  mov	  bx, 201h
F000:F694		  call	  set_palette_color
F000:F697		  mov	  bx, 402h
F000:F69A		  call	  set_palette_color
F000:F69D		  mov	  bx, 603h
F000:F6A0		  call	  set_palette_color
F000:F6A3
F000:F6A3 l6:							      ;	CODE XREF: int_10_0b+77j
F000:F6A3		  mov	  dx, 3DAh
F000:F6A6		  xor	  al, al
F000:F6A8		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F6A8							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F6A9
F000:F6A9 l7:							      ;	CODE XREF: int_10_0b+5Ej
F000:F6A9		  jmp	  near ptr pop_regs_and_iret
F000:F6A9 int_10_0b	  endp
F000:F6A9
F000:F6AC
F000:F6AC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F6AC
F000:F6AC ;
F000:F6AC ;	Writes a pixel dot of a	specified color	at a specified screen
F000:F6AC ;	coordinate.
F000:F6AC ;
F000:F6AC ;	   On entry:	  AH	     0Ch
F000:F6AC ;			  AL	     Pixel color
F000:F6AC ;			  CX	     Horizontal	position of pixel
F000:F6AC ;			  DX	     Vertical position of pixel
F000:F6AC ;			  BH	     Display page number (graphics modes with more
F000:F6AC ;				     than 1 page)
F000:F6AC ;
F000:F6AC ;	   Returns:	  None
F000:F6AC ;
F000:F6AC ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F6AC
F000:F6AC int_10_0c	  proc far				      ;	CODE XREF: int_10+Dj
F000:F6AC							      ;	DATA XREF: int_10+2Ao
F000:F6AC		  call	  get_pixel_address_and_mask
F000:F6AF		  jb	  short	error
F000:F6B1		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:F6B6		  jz	  short	mode_8_9
F000:F6B8		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:F6BD		  jz	  short	mode_8_9
F000:F6BF		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F6C4		  jz	  short	mode_a
F000:F6C6
F000:F6C6 l0:							      ;	CODE XREF: int_10_0c+39j
F000:F6C6		  mov	  ah, al
F000:F6C8		  and	  al, dl
F000:F6CA		  shl	  al, cl
F000:F6CC		  test	  ah, 80h
F000:F6CF		  jnz	  short	l1
F000:F6D1		  rol	  dh, cl
F000:F6D3		  and	  es:[bx], dh
F000:F6D6		  or	  es:[bx], al
F000:F6D9		  jmp	  near ptr pop_regs_and_iret
F000:F6DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F6DC
F000:F6DC l1:							      ;	CODE XREF: int_10_0c+23j
F000:F6DC		  xor	  es:[bx], al
F000:F6DF
F000:F6DF error:						      ;	CODE XREF: int_10_0c+3j
F000:F6DF		  jmp	  near ptr pop_regs_and_iret
F000:F6E2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F6E2
F000:F6E2 mode_8_9:						      ;	CODE XREF: int_10_0c+Aj
F000:F6E2							      ;	int_10_0c+11j
F000:F6E2		  mov	  dx, 1111000000001111b
F000:F6E5		  jmp	  short	l0
F000:F6E7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F6E7
F000:F6E7 mode_a:						      ;	CODE XREF: int_10_0c+18j
F000:F6E7		  mov	  dx, 1111111000000001b
F000:F6EA		  mov	  ah, al
F000:F6EC		  and	  al, dl
F000:F6EE		  shl	  al, cl
F000:F6F0		  test	  ah, 80h
F000:F6F3		  jnz	  short	l5
F000:F6F5		  rol	  dh, cl
F000:F6F7		  and	  es:[bx], dh
F000:F6FA		  or	  es:[bx], al
F000:F6FD		  jmp	  short	l6
F000:F6FD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F6FF		  db  90h ; 
F000:F700 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F700
F000:F700 l5:							      ;	CODE XREF: int_10_0c+47j
F000:F700		  xor	  es:[bx], al
F000:F703
F000:F703 l6:							      ;	CODE XREF: int_10_0c+51j
F000:F703		  mov	  al, ah
F000:F705		  shr	  al, 1
F000:F707		  and	  al, dl
F000:F709		  shl	  al, cl
F000:F70B		  test	  ah, 80h
F000:F70E		  jnz	  short	l7
F000:F710		  and	  es:[bx+1], dh
F000:F714		  or	  es:[bx+1], al
F000:F718		  jmp	  near ptr pop_regs_and_iret
F000:F71B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F71B
F000:F71B l7:							      ;	CODE XREF: int_10_0c+62j
F000:F71B		  xor	  es:[bx+1], al
F000:F71F		  jmp	  near ptr pop_regs_and_iret
F000:F71F int_10_0c	  endp
F000:F71F
F000:F722
F000:F722 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F722
F000:F722 ; Reports the	color of the pixel at a	specified screen coordinate.
F000:F722 ;
F000:F722 ;	   On entry:	  AH	     0Dh
F000:F722 ;			  CX	     Horizontal	position of pixel
F000:F722 ;			  DX	     Vertical position of pixel
F000:F722 ;			  BH	     Display page number (graphics modes with more
F000:F722 ;				     than 1 page)
F000:F722 ;
F000:F722 ;	   Returns:	  AL	     Color of pixel
F000:F722 ;
F000:F722 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F722
F000:F722 int_10_0d	  proc far				      ;	CODE XREF: int_10+Dj
F000:F722							      ;	DATA XREF: int_10+2Co
F000:F722		  call	  get_pixel_address_and_mask
F000:F725		  jb	  short	l1
F000:F727		  cmp	  byte ptr ds:p400.crt_mode, 8
F000:F72C		  jz	  short	l2
F000:F72E		  cmp	  byte ptr ds:p400.crt_mode, 9
F000:F733		  jz	  short	l2
F000:F735		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
F000:F73A		  jz	  short	l3
F000:F73C
F000:F73C l0:							      ;	CODE XREF: int_10_0d+26j
F000:F73C		  mov	  al, es:[bx]
F000:F73F		  shr	  al, cl
F000:F741		  and	  al, ah
F000:F743
F000:F743 l1:							      ;	CODE XREF: int_10_0d+3j
F000:F743		  jmp	  near ptr pop_regs_and_iret
F000:F746 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F746
F000:F746 l2:							      ;	CODE XREF: int_10_0d+Aj
F000:F746							      ;	int_10_0d+11j
F000:F746		  mov	  ah, 0Fh
F000:F748		  jmp	  short	l0
F000:F74A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F74A
F000:F74A l3:							      ;	CODE XREF: int_10_0d+18j
F000:F74A		  mov	  ah, 1
F000:F74C		  mov	  al, es:[bx]
F000:F74F		  shr	  al, cl
F000:F751		  and	  al, ah
F000:F753		  mov	  dl, es:[bx+1]
F000:F757		  shr	  dl, cl
F000:F759		  and	  dl, ah
F000:F75B		  shl	  dl, 1
F000:F75D		  or	  al, dl
F000:F75F		  jmp	  near ptr pop_regs_and_iret
F000:F75F int_10_0d	  endp
F000:F75F
F000:F762
F000:F762 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F762
F000:F762 ;  Writes one	character at the current cursor	location and advances the
F000:F762 ;	cursor.
F000:F762 ;
F000:F762 ;	   On entry:	  AH	     0Eh
F000:F762 ;			  AL	     Character to write
F000:F762 ;			  BL	     Foreground	color (graphics	modes only)
F000:F762 ;			  BH	     Display page number (text modes only)
F000:F762 ;
F000:F762 ;	   Returns:	  None
F000:F762
F000:F762 int_10_0e	  proc far				      ;	CODE XREF: int_10+Dj
F000:F762							      ;	DATA XREF: int_10+2Eo
F000:F762		  push	  ax
F000:F763		  mov	  cl, bl
F000:F765		  call	  get_active_display_page
F000:F768		  call	  get_cursor_row_cols_for_page
F000:F76B		  cmp	  al, 7				      ;	7 = ascii bell
F000:F76D		  jnz	  short	no_bell
F000:F76F		  call	  play_bell_sound
F000:F772		  jmp	  l12
F000:F775 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F775
F000:F775 no_bell:						      ;	CODE XREF: int_10_0e+Bj
F000:F775		  cmp	  al, 0Dh
F000:F777		  jnz	  short	no_cr
F000:F779		  xor	  dl, dl
F000:F77B		  jmp	  short	update_cursor_position
F000:F77B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F77D		  db  90h ; 
F000:F77E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F77E
F000:F77E no_cr:						      ;	CODE XREF: int_10_0e+15j
F000:F77E		  cmp	  al, 8				      ;	8 = backscape
F000:F780		  jnz	  short	no_backspace
F000:F782		  dec	  dl
F000:F784		  jge	  short	l2
F000:F786		  cmp	  dh, 0
F000:F789		  jg	  short	l3
F000:F78B		  xor	  dl, dl
F000:F78D
F000:F78D l2:							      ;	CODE XREF: int_10_0e+22j
F000:F78D		  jmp	  short	update_cursor_position
F000:F78D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F78F		  db  90h ; 
F000:F790 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F790
F000:F790 l3:							      ;	CODE XREF: int_10_0e+27j
F000:F790		  dec	  dh
F000:F792		  add	  dl, ds:p400.crt_nr_cols
F000:F796		  jmp	  short	update_cursor_position
F000:F796 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F798		  db  90h ; 
F000:F799 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F799
F000:F799 no_backspace:						      ;	CODE XREF: int_10_0e+1Ej
F000:F799		  cmp	  al, 0Ah
F000:F79B		  jnz	  short	l9
F000:F79D		  cmp	  dh, 18h
F000:F7A0		  jnz	  short	l8
F000:F7A2
F000:F7A2 l5:							      ;	CODE XREF: int_10_0e+90j
F000:F7A2		  call	  is_text_mode
F000:F7A5		  jnb	  short	text_mode
F000:F7A7		  mov	  ah, 0
F000:F7A9		  jmp	  short	do_scroll_up
F000:F7AB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F7AB
F000:F7AB text_mode:						      ;	CODE XREF: int_10_0e+43j
F000:F7AB		  mov	  bp, sp
F000:F7AD		  call	  get_active_display_page
F000:F7B0		  mov	  ah, 8
F000:F7B2		  int	  10h				      ;	- VIDEO	- READ ATTRIBUTES/CHARACTER AT CURSOR POSITION
F000:F7B2							      ;	BH = display page
F000:F7B2							      ;	Return:	AL = character
F000:F7B2							      ;	AH = attribute of character (alpha modes)
F000:F7B4
F000:F7B4 do_scroll_up:						      ;	CODE XREF: int_10_0e+47j
F000:F7B4		  mov	  bh, ah
F000:F7B6		  mov	  ah, 6
F000:F7B8		  mov	  al, 1
F000:F7BA		  xor	  cx, cx
F000:F7BC		  mov	  dl, ds:p400.crt_nr_cols
F000:F7C0		  dec	  dl
F000:F7C2		  int	  10h				      ;	- VIDEO	- SCROLL PAGE UP
F000:F7C2							      ;	AL = number of lines to	scroll window (0 = blank whole window)
F000:F7C2							      ;	BH = attributes	to be used on blanked lines
F000:F7C2							      ;	CH,CL =	row,column of upper left corner	of window to scroll
F000:F7C2							      ;	DH,DL =	row,column of lower right corner of window
F000:F7C4		  jmp	  short	l12
F000:F7C4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F7C6		  db  90h ; 
F000:F7C7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F7C7
F000:F7C7 l8:							      ;	CODE XREF: int_10_0e+3Ej
F000:F7C7		  inc	  dh
F000:F7C9		  jmp	  short	update_cursor_position
F000:F7C9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F7CB		  db  90h ; 
F000:F7CC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F7CC
F000:F7CC l9:							      ;	CODE XREF: int_10_0e+39j
F000:F7CC		  mov	  ah, 0Ah
F000:F7CE		  mov	  bl, cl
F000:F7D0		  mov	  cx, 1
F000:F7D3		  int	  10h				      ;	- VIDEO	- WRITE	CHARACTERS ONLY	AT CURSOR POSITION
F000:F7D3							      ;	AL = character,	BH = display page - alpha mode
F000:F7D3							      ;	BL = color of character	(graphics mode,	PCjr only)
F000:F7D3							      ;	CX = number of times to	write character
F000:F7D5		  inc	  dl
F000:F7D7		  cmp	  dl, ds:p400.crt_nr_cols
F000:F7DB		  jnz	  short	update_cursor_position
F000:F7DD		  xor	  dl, dl
F000:F7DF		  cmp	  dh, 18h
F000:F7E2		  jnz	  short	l10
F000:F7E4		  mov	  bp, sp
F000:F7E6		  push	  ax
F000:F7E7		  push	  cx
F000:F7E8		  push	  dx
F000:F7E9		  call	  get_active_display_page
F000:F7EC		  call	  set_cursor_pos
F000:F7EF		  pop	  dx
F000:F7F0		  pop	  cx
F000:F7F1		  pop	  ax
F000:F7F2		  jmp	  short	l5
F000:F7F4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F7F4
F000:F7F4 l10:							      ;	CODE XREF: int_10_0e+80j
F000:F7F4		  inc	  dh
F000:F7F6
F000:F7F6 update_cursor_position:				      ;	CODE XREF: int_10_0e+19j
F000:F7F6							      ;	int_10_0e:l2j
F000:F7F6							      ;	int_10_0e+34j
F000:F7F6							      ;	int_10_0e+67j
F000:F7F6							      ;	int_10_0e+79j
F000:F7F6		  mov	  bp, sp
F000:F7F8		  call	  get_active_display_page
F000:F7FB		  call	  set_cursor_pos
F000:F7FE
F000:F7FE l12:							      ;	CODE XREF: int_10_0e+10j
F000:F7FE							      ;	int_10_0e+62j
F000:F7FE		  pop	  ax
F000:F7FF		  jmp	  short	int_10_exit
F000:F7FF int_10_0e	  endp
F000:F7FF
F000:F801
F000:F801 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F801
F000:F801 ;  Reports the current video mode, the number	of character positions per
F000:F801 ;	line in	that video mode, and the current display page.
F000:F801 ;
F000:F801 ;	   On entry:	  AH	     0Fh
F000:F801 ;
F000:F801 ;	   Returns:	  AL	     Video mode
F000:F801 ;			  AH	     Number of character columns per line
F000:F801 ;			  BH	     Active display page number
F000:F801 ;
F000:F801 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F801 ;
F000:F801 ; Attributes:	bp-based frame
F000:F801
F000:F801 int_10_0f	  proc far				      ;	CODE XREF: int_10+Dj
F000:F801							      ;	DATA XREF: int_10+30o
F000:F801
F000:F801 arg_A		  = word ptr  0Eh
F000:F801
F000:F801		  mov	  ax, ds:p400.crt_nr_cols
F000:F804		  mov	  ah, al
F000:F806		  mov	  al, ds:p400.crt_mode
F000:F809		  mov	  bh, ds:p400.active_display_page
F000:F80D		  mov	  bp, sp
F000:F80F		  mov	  [bp+arg_A], bx
F000:F812
F000:F812 int_10_exit:						      ;	CODE XREF: int_10_0e+9Dj
F000:F812							      ;	int_10_10+D6j
F000:F812							      ;	int_10_10+DAj
F000:F812		  jmp	  near ptr pop_regs_and_iret
F000:F812 int_10_0f	  endp
F000:F812
F000:F815
F000:F815 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F815
F000:F815 ; Sets the palette and overscan (border) registers on	the PCjr and EGA.
F000:F815 ;
F000:F815 ;	   On entry:	  AH	     10h
F000:F815 ;			  AL	     Subservice
F000:F815 ;				     0 - Set palette register
F000:F815 ;					 BL	 Palette register
F000:F815 ;					 BH	 Value to set
F000:F815 ;
F000:F815 ;				     1 - Set overscan (border) color register
F000:F815 ;					 BH	 Value to set
F000:F815 ;
F000:F815 ;				     2 - Set palette registers and border register
F000:F815 ;					 ES:DX	 Pointer to color list
F000:F815 ;
F000:F815 ;				     3 - Toggle	intensify/blinking bit
F000:F815 ;					 BL	 0 - Enable intensify
F000:F815 ;					 BL	 1 - Enable blinking
F000:F815 ;
F000:F815 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
F000:F815 ;
F000:F815
F000:F815 int_10_10	  proc far				      ;	CODE XREF: int_10+Dj
F000:F815							      ;	DATA XREF: int_10+32o
F000:F815		  cmp	  al, 3
F000:F817		  jb	  short	ok
F000:F819		  jmp	  error
F000:F81C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F81C
F000:F81C ok:							      ;	CODE XREF: int_10_10+2j
F000:F81C		  cmp	  al, 0
F000:F81E		  jnz	  short	l8
F000:F820		  cmp	  byte ptr ds:p400.crt_mode, 6
F000:F825		  jnz	  short	l0
F000:F827		  cmp	  bl, 1
F000:F82A		  jnz	  short	l7
F000:F82C		  mov	  bl, 0Fh
F000:F82E		  jmp	  short	l7
F000:F82E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F830		  db  90h ; 
F000:F831 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F831
F000:F831 l0:							      ;	CODE XREF: int_10_10+10j
F000:F831		  jnb	  short	l7
F000:F833		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:F838		  jb	  short	l7
F000:F83A		  mov	  al, ds:p400.shadow_3d9_crt_palette
F000:F83D		  and	  al, 20h
F000:F83F		  jz	  short	l4
F000:F841		  cmp	  bl, 1
F000:F844		  jnz	  short	l1
F000:F846		  mov	  bl, 0Bh
F000:F848		  jmp	  short	l7
F000:F848 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F84A		  db  90h ; 
F000:F84B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F84B
F000:F84B l1:							      ;	CODE XREF: int_10_10+2Fj
F000:F84B		  cmp	  bl, 2
F000:F84E		  jnz	  short	l3
F000:F850		  mov	  bl, 0Dh
F000:F852		  jmp	  short	l7
F000:F852 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F854		  db  90h ; 
F000:F855 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F855
F000:F855 l3:							      ;	CODE XREF: int_10_10+39j
F000:F855		  cmp	  bl, 3
F000:F858		  jnz	  short	l7
F000:F85A		  mov	  bl, 0Fh
F000:F85C		  jmp	  short	l7
F000:F85C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F85E		  db  90h ; 
F000:F85F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F85F
F000:F85F l4:							      ;	CODE XREF: int_10_10+2Aj
F000:F85F		  cmp	  bl, 1
F000:F862		  jnz	  short	l5
F000:F864		  mov	  bl, 0Ah
F000:F866		  jmp	  short	l7
F000:F866 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F868		  db  90h ; 
F000:F869 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F869
F000:F869 l5:							      ;	CODE XREF: int_10_10+4Dj
F000:F869		  cmp	  bl, 2
F000:F86C		  jnz	  short	l6
F000:F86E		  mov	  bl, 0Ch
F000:F870		  jmp	  short	l7
F000:F870 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F872		  db  90h ; 
F000:F873 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F873
F000:F873 l6:							      ;	CODE XREF: int_10_10+57j
F000:F873		  cmp	  bl, 3
F000:F876		  jnz	  short	l7
F000:F878		  mov	  bl, 0Eh
F000:F87A
F000:F87A l7:							      ;	CODE XREF: int_10_10+15j
F000:F87A							      ;	int_10_10+19j
F000:F87A							      ;	int_10_10:l0j
F000:F87A							      ;	int_10_10+23j
F000:F87A							      ;	int_10_10+33j
F000:F87A							      ;	int_10_10+3Dj ...
F000:F87A		  call	  set_palette_color
F000:F87D		  jb	  short	error
F000:F87F		  jmp	  short	l14
F000:F87F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F881		  db  90h ; 
F000:F882 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F882
F000:F882 l8:							      ;	CODE XREF: int_10_10+9j
F000:F882		  push	  ax
F000:F883		  cmp	  byte ptr ds:p400.crt_mode, 7
F000:F888		  jnb	  short	l9
F000:F88A		  mov	  dx, 3DAh
F000:F88D		  mov	  al, 3
F000:F88F		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F88F							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F890		  add	  dx, 4
F000:F893		  mov	  al, 4
F000:F895		  out	  dx, al
F000:F896
F000:F896 l9:							      ;	CODE XREF: int_10_10+73j
F000:F896		  pop	  ax
F000:F897		  cmp	  al, 1
F000:F899		  jnz	  short	l10
F000:F89B		  mov	  al, 2
F000:F89D		  mov	  dx, 3DAh
F000:F8A0		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F8A0							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F8A1		  mov	  al, bh
F000:F8A3		  add	  dx, 4
F000:F8A6		  out	  dx, al
F000:F8A7		  jmp	  short	l14
F000:F8A7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F8A9		  db  90h ; 
F000:F8AA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F8AA
F000:F8AA l10:							      ;	CODE XREF: int_10_10+84j
F000:F8AA		  mov	  bl, 10h
F000:F8AC		  mov	  si, dx
F000:F8AE		  mov	  dx, 3DAh
F000:F8B1		  mov	  cx, 10h
F000:F8B4
F000:F8B4 l11:							      ;	CODE XREF: int_10_10+C3j
F000:F8B4		  push	  dx
F000:F8B5		  mov	  dx, 3DAh
F000:F8B8
F000:F8B8 l12:							      ;	CODE XREF: int_10_10+A6j
F000:F8B8		  in	  al, dx			      ;	Video status bits:
F000:F8B8							      ;	0: retrace.  1=display is in vert or horiz retrace.
F000:F8B8							      ;	1: 1=light pen is triggered; 0=armed
F000:F8B8							      ;	2: 1=light pen switch is open; 0=closed
F000:F8B8							      ;	3: 1=vertical sync pulse is occurring.
F000:F8B9		  test	  al, 8
F000:F8BB		  jnz	  short	l12
F000:F8BD		  cli
F000:F8BE
F000:F8BE l13:							      ;	CODE XREF: int_10_10+ACj
F000:F8BE		  in	  al, dx			      ;	Video status bits:
F000:F8BE							      ;	0: retrace.  1=display is in vert or horiz retrace.
F000:F8BE							      ;	1: 1=light pen is triggered; 0=armed
F000:F8BE							      ;	2: 1=light pen switch is open; 0=closed
F000:F8BE							      ;	3: 1=vertical sync pulse is occurring.
F000:F8BF		  test	  al, 8
F000:F8C1		  jz	  short	l13
F000:F8C3		  pop	  dx
F000:F8C4		  mov	  al, bl
F000:F8C6		  out	  dx, al
F000:F8C7		  mov	  al, es:[si]
F000:F8CA		  add	  dx, 4
F000:F8CD		  out	  dx, al
F000:F8CE		  sti
F000:F8CF		  inc	  si
F000:F8D0		  sub	  dx, 4
F000:F8D3		  xor	  al, al
F000:F8D5		  out	  dx, al
F000:F8D6		  inc	  bl
F000:F8D8		  loop	  l11
F000:F8DA		  mov	  al, 2
F000:F8DC		  out	  dx, al
F000:F8DD		  add	  dx, 4
F000:F8E0		  mov	  al, es:[si]
F000:F8E3		  out	  dx, al
F000:F8E4
F000:F8E4 l14:							      ;	CODE XREF: int_10_10+6Aj
F000:F8E4							      ;	int_10_10+92j
F000:F8E4		  mov	  dx, 3DAh
F000:F8E7		  xor	  al, al
F000:F8E9		  out	  dx, al			      ;	Video: bits 0-1	control
F000:F8E9							      ;	Feature	Control	outputs	FC0 and	FC1
F000:F8EA		  clc
F000:F8EB		  jmp	  int_10_exit
F000:F8EE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F8EE
F000:F8EE error:						      ;	CODE XREF: int_10_10+4j
F000:F8EE							      ;	int_10_10+68j
F000:F8EE		  stc
F000:F8EF		  jmp	  int_10_exit
F000:F8EF int_10_10	  endp
F000:F8EF
F000:F8F2
F000:F8F2 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F8F2
F000:F8F2
F000:F8F2 set_palette_color proc near				      ;	CODE XREF: int_10_0b+16p
F000:F8F2							      ;	int_10_0b+68p
F000:F8F2							      ;	int_10_0b+6Ep
F000:F8F2							      ;	int_10_0b+74p
F000:F8F2							      ;	int_10_0b+7Dp
F000:F8F2							      ;	int_10_0b+83p ...
F000:F8F2		  mov	  dx, 3DAh
F000:F8F5		  mov	  al, bl
F000:F8F7		  cmp	  al, 10h
F000:F8F9		  jnb	  short	error
F000:F8FB		  push	  ax
F000:F8FC		  push	  dx
F000:F8FD		  mov	  dx, 3DAh
F000:F900
F000:F900 wait_vert_retrace_finish:				      ;	CODE XREF: set_palette_color+11j
F000:F900		  in	  al, dx			      ;	Video status bits:
F000:F900							      ;	0: retrace.  1=display is in vert or horiz retrace.
F000:F900							      ;	1: 1=light pen is triggered; 0=armed
F000:F900							      ;	2: 1=light pen switch is open; 0=closed
F000:F900							      ;	3: 1=vertical sync pulse is occurring.
F000:F901		  test	  al, 8
F000:F903		  jnz	  short	wait_vert_retrace_finish
F000:F905		  cli
F000:F906
F000:F906 wait_vert_retrace_start:				      ;	CODE XREF: set_palette_color+17j
F000:F906		  in	  al, dx			      ;	Video status bits:
F000:F906							      ;	0: retrace.  1=display is in vert or horiz retrace.
F000:F906							      ;	1: 1=light pen is triggered; 0=armed
F000:F906							      ;	2: 1=light pen switch is open; 0=closed
F000:F906							      ;	3: 1=vertical sync pulse is occurring.
F000:F907		  test	  al, 8
F000:F909		  jz	  short	wait_vert_retrace_start
F000:F90B		  pop	  dx
F000:F90C		  pop	  ax
F000:F90D		  add	  al, 10h
F000:F90F		  out	  dx, al
F000:F910		  add	  dx, 4
F000:F913		  mov	  al, bh
F000:F915		  out	  dx, al
F000:F916		  sti
F000:F917		  clc
F000:F918		  retn
F000:F919 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F919
F000:F919 error:						      ;	CODE XREF: set_palette_color+7j
F000:F919		  stc
F000:F91A		  retn
F000:F91A set_palette_color endp
F000:F91A
F000:F91B
F000:F91B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F91B
F000:F91B
F000:F91B get_active_display_page proc near			      ;	CODE XREF: int_10_0e+3p
F000:F91B							      ;	int_10_0e+4Bp
F000:F91B							      ;	int_10_0e+87p
F000:F91B							      ;	int_10_0e+96p
F000:F91B		  mov	  bl, ds:p400.active_display_page
F000:F91F		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:F924		  jl	  short	l0
F000:F926		  xor	  bl, bl
F000:F928
F000:F928 l0:							      ;	CODE XREF: get_active_display_page+9j
F000:F928		  mov	  bh, bl
F000:F92A		  retn
F000:F92A get_active_display_page endp
F000:F92A
F000:F92B
F000:F92B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F92B
F000:F92B
F000:F92B set_pair_value_in_6845 proc near			      ;	CODE XREF: int_10_01+4p
F000:F92B							      ;	update_cursor_offset+17j
F000:F92B							      ;	int_10_05+27p
F000:F92B		  mov	  dx, ds:p400.addr_6845
F000:F92F		  mov	  al, bh
F000:F931		  out	  dx, al
F000:F932		  inc	  dx
F000:F933		  mov	  al, ch
F000:F935		  out	  dx, al
F000:F936		  dec	  dx
F000:F937		  mov	  al, bl
F000:F939		  out	  dx, al
F000:F93A		  inc	  dx
F000:F93B		  mov	  al, cl
F000:F93D		  out	  dx, al
F000:F93E		  retn
F000:F93E set_pair_value_in_6845 endp
F000:F93E
F000:F93F
F000:F93F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F93F
F000:F93F
F000:F93F get_pixel_address_and_mask proc near			      ;	CODE XREF: int_10_0cp
F000:F93F							      ;	int_10_0dp
F000:F93F		  push	  ax
F000:F940		  mov	  ax, 0B000h
F000:F943		  mov	  es, ax
F000:F945		  pop	  ax
F000:F946		  cmp	  dx, 199			      ;	vertical position of the pixel
F000:F94A		  ja	  short	error
F000:F94C		  mov	  ah, ds:p400.crt_mode
F000:F950		  cmp	  ah, 4
F000:F953		  jz	  short	test_320_200_mode
F000:F955		  cmp	  ah, 5
F000:F958		  jz	  short	test_320_200_mode
F000:F95A		  cmp	  ah, 6
F000:F95D		  jz	  short	test_640_200_mode
F000:F95F		  cmp	  ah, 8
F000:F962		  jz	  short	test_160_200_mode
F000:F964		  cmp	  ah, 9
F000:F967		  jz	  short	test_320_200_mode
F000:F969		  cmp	  ah, 0Ah
F000:F96C		  jz	  short	test_640_200_mode
F000:F96E
F000:F96E error:						      ;	CODE XREF: get_pixel_address_and_mask+Bj
F000:F96E							      ;	get_pixel_address_and_mask+36j
F000:F96E							      ;	get_pixel_address_and_mask+3Fj
F000:F96E							      ;	get_pixel_address_and_mask+4Fj
F000:F96E		  stc
F000:F96F		  jmp	  short	exit
F000:F971 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F971
F000:F971 test_160_200_mode:					      ;	CODE XREF: get_pixel_address_and_mask+23j
F000:F971		  cmp	  cx, 159
F000:F975		  ja	  short	error
F000:F977		  jmp	  short	l3
F000:F977 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F979		  db  90h ; 
F000:F97A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F97A
F000:F97A test_320_200_mode:					      ;	CODE XREF: get_pixel_address_and_mask+14j
F000:F97A							      ;	get_pixel_address_and_mask+19j
F000:F97A							      ;	get_pixel_address_and_mask+28j
F000:F97A		  cmp	  cx, 319
F000:F97E		  ja	  short	error
F000:F980
F000:F980 l3:							      ;	CODE XREF: get_pixel_address_and_mask+38j
F000:F980		  call	  get_address_for_pixel
F000:F983		  mov	  ah, 3
F000:F985		  mov	  dx, 0FC03h
F000:F988		  jmp	  short	ok
F000:F98A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F98A
F000:F98A test_640_200_mode:					      ;	CODE XREF: get_pixel_address_and_mask+1Ej
F000:F98A							      ;	get_pixel_address_and_mask+2Dj
F000:F98A		  cmp	  cx, 639
F000:F98E		  ja	  short	error
F000:F990		  call	  get_address_for_pixel
F000:F993		  mov	  ah, 1
F000:F995		  mov	  dx, 1111111000000001b
F000:F998
F000:F998 ok:							      ;	CODE XREF: get_pixel_address_and_mask+49j
F000:F998		  clc
F000:F999
F000:F999 exit:							      ;	CODE XREF: get_pixel_address_and_mask+30j
F000:F999		  retn
F000:F999 get_pixel_address_and_mask endp
F000:F999
F000:F99A
F000:F99A ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:F99A
F000:F99A ; Returns:
F000:F99A ;    Carry set if in graphics	mode
F000:F99A ;    Carry clear if in text mode
F000:F99A
F000:F99A is_text_mode	  proc near				      ;	CODE XREF: scroll_up_or_down:l1p
F000:F99A							      ;	int_10_08p
F000:F99A							      ;	int_10_0a+8p
F000:F99A							      ;	int_10_0e:l5p
F000:F99A		  cmp	  byte ptr ds:p400.crt_mode, 7	      ;	monochrome text	mode?
F000:F99F		  jz	  short	ok
F000:F9A1		  cmp	  byte ptr ds:p400.crt_mode, 4
F000:F9A6		  jl	  short	ok
F000:F9A8		  stc
F000:F9A9		  retn
F000:F9AA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F9AA
F000:F9AA ok:							      ;	CODE XREF: is_text_mode+5j
F000:F9AA							      ;	is_text_mode+Cj
F000:F9AA		  clc
F000:F9AB		  retn
F000:F9AB is_text_mode	  endp
F000:F9AB
F000:F9AB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:F9AC		  db 0C2h dup(0)
F000:FA6E int_44_charset_0_127 db 8 dup(0), 7Eh, 81h, 0A5h, 81h, 0BDh, 99h, 81h, 2 dup(7Eh), 0FFh, 0DBh, 0FFh, 0C3h
F000:FA6E							      ;	DATA XREF: F000:int_44_tblo
F000:FA6E		  db 0E7h, 0FFh, 7Eh, 36h, 3 dup(7Fh), 3Eh, 1Ch, 8, 0, 8, 1Ch, 3Eh, 7Fh, 3Eh, 1Ch, 8, 0
F000:FA6E		  db 1Ch, 3Eh, 1Ch, 2 dup(7Fh),	3Eh, 1Ch, 3Eh, 2 dup(8), 1Ch, 3Eh, 7Fh,	3Eh, 1Ch, 3Eh
F000:FA6E		  db 2 dup(0), 18h, 2 dup(3Ch),	18h, 2 dup(0), 2 dup(0FFh), 0E7h, 2 dup(0C3h), 0E7h, 2 dup(0FFh)
F000:FA6E		  db 0,	3Ch, 66h, 2 dup(42h), 66h, 3Ch,	0, 0FFh, 0C3h, 99h, 2 dup(0BDh), 99h, 0C3h, 0FFh
F000:FA6E		  db 0Fh, 7, 0Fh, 7Dh, 3 dup(0CCh), 78h, 3Ch, 3	dup(66h), 3Ch, 18h, 7Eh, 18h, 30h, 3Ch
F000:FA6E		  db 33h, 2 dup(31h), 2	dup(70h), 0, 60h, 78h, 66h, 73h, 6Fh, 0E3h, 0E7h, 7, 99h, 5Ah
F000:FA6E		  db 3Ch, 2 dup(0E7h), 3Ch, 5Ah, 99h, 40h, 70h,	7Ch, 7Fh, 7Ch, 70h, 40h, 0, 1, 7, 1Fh
F000:FA6E		  db 7Fh, 1Fh, 7, 1, 0,	18h, 3Ch, 7Eh, 2 dup(18h), 7Eh,	3Ch, 18h, 5 dup(66h), 0, 66h, 0
F000:FA6E		  db 7Fh, 2 dup(0DBh), 7Bh, 3 dup(1Bh),	0, 3Fh,	60h, 3Eh, 63h, 3Eh, 3, 7Eh, 5 dup(0), 3	dup(7Eh)
F000:FA6E		  db 0,	18h, 3Ch, 7Eh, 18h, 7Eh, 3Ch, 18h, 0FFh, 18h, 3Ch, 7Eh,	4 dup(18h), 0, 4 dup(18h)
F000:FA6E		  db 7Eh, 3Ch, 18h, 2 dup(0), 0Ch, 6, 7Fh, 6, 0Ch, 3 dup(0), 18h, 30h, 7Fh, 30h, 18h, 4	dup(0)
F000:FA6E		  db 3 dup(60h), 7Fh, 3	dup(0),	24h, 66h, 0FFh,	66h, 24h, 3 dup(0), 18h, 3Ch, 7Eh, 2 dup(0FFh)
F000:FA6E		  db 3 dup(0), 2 dup(0FFh), 7Eh, 3Ch, 18h, 0Ah dup(0), 18h, 2 dup(3Ch),	2 dup(18h), 0
F000:FA6E		  db 18h, 0, 3 dup(36h), 5 dup(0), 2 dup(36h), 7Fh, 36h, 7Fh, 2	dup(36h), 0, 18h, 3Eh
F000:FA6E		  db 60h, 3Ch, 6, 7Ch, 18h, 2 dup(0), 63h, 66h,	0Ch, 18h, 33h, 63h, 0, 1Ch, 36h, 1Ch, 3Bh
F000:FA6E		  db 6Eh, 66h, 3Bh, 0, 2 dup(18h), 30h,	5 dup(0), 0Ch, 18h, 3 dup(30h),	18h, 0Ch, 0, 30h
F000:FA6E		  db 18h, 3 dup(0Ch), 18h, 30h,	2 dup(0), 66h, 3Ch, 0FFh, 3Ch, 66h, 3 dup(0), 2	dup(18h)
F000:FA6E		  db 7Eh, 2 dup(18h), 7	dup(0),	2 dup(18h), 30h, 3 dup(0), 7Eh,	9 dup(0), 2 dup(18h), 0
F000:FA6E		  db 3,	6, 0Ch,	18h, 30h, 60h, 0C0h, 0,	3Eh, 63h, 67h, 6Fh, 7Bh, 73h, 3Eh, 0, 18h, 38h
F000:FA6E		  db 4 dup(18h), 7Eh, 0, 3Ch, 66h, 6, 1Ch, 30h,	66h, 7Eh, 0, 3Ch, 66h, 6, 1Ch, 6, 66h
F000:FA6E		  db 3Ch, 0, 0Eh, 1Eh, 36h, 66h, 7Fh, 6, 0Fh, 0, 7Eh, 60h, 7Ch,	2 dup(6), 66h, 3Ch, 0
F000:FA6E		  db 1Ch, 30h, 60h, 7Ch, 2 dup(66h), 3Ch, 0, 7Eh, 66h, 6, 0Ch, 3 dup(18h), 0, 3Ch, 2 dup(66h)
F000:FA6E		  db 3Ch, 2 dup(66h), 3Ch, 0, 3Ch, 2 dup(66h), 3Eh, 6, 0Ch, 38h, 2 dup(0), 2 dup(18h)
F000:FA6E		  db 2 dup(0), 2 dup(18h), 2 dup(0), 2 dup(18h), 2 dup(0), 2 dup(18h), 30h, 6, 0Ch, 18h
F000:FA6E		  db 30h, 18h, 0Ch, 6, 3 dup(0), 7Eh, 0, 7Eh, 3	dup(0),	30h, 18h, 0Ch, 6, 0Ch, 18h, 30h
F000:FA6E		  db 0,	3Ch, 66h, 6, 0Ch, 18h, 0, 18h, 0, 3Eh, 63h, 3 dup(6Fh),	60h, 3Ch, 0, 1Ch, 36h
F000:FA6E		  db 2 dup(63h), 7Fh, 2	dup(63h), 0, 7Eh, 2 dup(33h), 3Eh, 2 dup(33h), 7Eh, 0, 1Eh, 33h
F000:FA6E		  db 3 dup(60h), 33h, 1Eh, 0, 7Ch, 36h,	3 dup(33h), 36h, 7Ch, 0, 7Fh, 31h, 34h,	3Ch, 34h
F000:FA6E		  db 31h, 7Fh, 0, 7Fh, 31h, 34h, 3Ch, 34h, 30h,	78h, 0,	1Eh, 33h, 2 dup(60h), 67h, 33h
F000:FA6E		  db 1Fh, 0, 3 dup(66h), 7Eh, 3	dup(66h), 0, 3Ch, 5 dup(18h), 3Ch, 0, 0Fh, 3 dup(6), 2 dup(66h)
F000:FA6E		  db 3Ch, 0, 73h, 33h, 36h, 3Ch, 36h, 33h, 73h,	0, 78h,	3 dup(30h), 31h, 33h, 7Fh, 0, 63h
F000:FA6E		  db 77h, 2 dup(7Fh), 6Bh, 2 dup(63h), 0, 63h, 73h, 7Bh, 6Fh, 67h, 2 dup(63h), 0, 3Eh
F000:FA6E		  db 5 dup(63h), 3Eh, 0, 7Eh, 2	dup(33h), 3Eh, 2 dup(30h), 78h,	0, 3Eh,	4 dup(63h), 6Fh
F000:FA6E		  db 3Eh, 3, 7Eh, 2 dup(33h), 3Eh, 36h,	33h, 73h, 0, 3Ch, 66h, 70h, 38h, 0Eh, 66h, 3Ch
F000:FA6E		  db 0,	7Eh, 5Ah, 4 dup(18h), 3Ch, 0, 6	dup(63h), 3Eh, 0, 5 dup(66h), 3Ch, 18h,	0, 3 dup(63h)
F000:FA6E		  db 6Bh, 7Fh, 77h, 63h, 0, 2 dup(63h),	36h, 2 dup(1Ch), 36h, 63h, 0, 3	dup(66h), 3Ch
F000:FA6E		  db 2 dup(18h), 3Ch, 0, 7Fh, 63h, 46h,	0Ch, 19h, 33h, 7Fh, 0, 3Ch, 5 dup(30h),	3Ch, 0
F000:FA6E		  db 60h, 30h, 18h, 0Ch, 6, 3, 1, 0, 3Ch, 5 dup(0Ch), 3Ch, 0, 8, 1Ch, 36h, 0Ch dup(0)
F000:FA6E		  db 0FFh, 2 dup(18h), 0Ch, 7 dup(0), 3Ch, 6, 3Eh, 66h,	3Bh, 0,	70h, 30h, 3Eh, 3 dup(33h)
F000:FA6E		  db 6Eh, 3 dup(0), 3Ch, 66h, 60h, 66h,	3Ch, 0,	0Eh, 6,	3Eh, 3 dup(66h), 3Bh, 3	dup(0)
F000:FA6E		  db 3Ch, 66h, 7Eh, 60h, 3Ch, 0, 1Ch, 36h, 30h,	78h, 2 dup(30h), 78h, 3	dup(0),	3Bh, 2 dup(66h)
F000:FA6E		  db 3Eh, 6, 7Ch, 70h, 30h, 36h, 3Bh, 2	dup(33h), 73h, 0, 18h, 0, 38h, 3 dup(18h), 3Ch
F000:FA6E		  db 0,	6, 0, 0Eh, 2 dup(6), 2 dup(66h), 3Ch, 70h, 30h,	33h, 36h, 3Ch, 36h, 73h, 0, 38h
F000:FA6E		  db 5 dup(18h), 3Ch, 3	dup(0),	0E6h, 2	dup(7Fh), 6Bh, 63h, 3 dup(0), 6Eh, 4 dup(33h)
F000:FA6E		  db 3 dup(0), 3Ch, 3 dup(66h),	3Ch, 3 dup(0), 6Eh, 2 dup(33h),	3Eh, 30h, 78h, 2 dup(0)
F000:FA6E		  db 3Bh, 2 dup(66h), 3Eh, 6, 0Fh, 2 dup(0), 6Eh, 3Bh, 33h, 30h, 78h, 3	dup(0),	3Eh, 60h
F000:FA6E		  db 3Ch, 6, 7Ch, 0, 10h, 30h, 7Ch, 2 dup(30h),	36h, 1Ch, 3 dup(0), 4 dup(66h),	3Bh, 3 dup(0)
F000:FA6E		  db 3 dup(66h), 3Ch, 18h, 3 dup(0), 63h, 6Bh, 2 dup(7Fh), 36h,	3 dup(0), 63h, 36h, 1Ch
F000:FA6E		  db 36h, 63h, 3 dup(0), 3 dup(66h), 3Eh, 6, 7Ch, 2 dup(0), 7Eh, 4Ch, 18h, 32h,	7Eh, 0
F000:FA6E		  db 0Eh, 2 dup(18h), 70h, 2 dup(18h), 0Eh, 0, 3 dup(18h), 0, 3	dup(18h), 0, 70h, 2 dup(18h)
F000:FA6E		  db 0Eh, 2 dup(18h), 70h, 0, 3Bh, 6Eh,	7 dup(0), 8, 1Ch, 36h, 2 dup(63h), 7Fh,	0
F000:FE6E		  dw 42h dup(0ADDEh)
F000:FEF2		  db 0FFh
F000:FEF3 int_08_1f_tbl	  dw offset int_08			      ;	DATA XREF: reset+87o
F000:FEF3							      ;	int 0x08
F000:FEF5		  dw offset int_09			      ;	int 0x09
F000:FEF7		  dw offset int_ack_handler		      ;	int 0x0a
F000:FEF9		  dw offset int_ack_handler		      ;	int 0x0b
F000:FEFB		  dw offset int_ack_handler		      ;	int 0x0c
F000:FEFD		  dw offset int_ack_handler		      ;	int 0x0d
F000:FEFF		  dw offset int_0e			      ;	int 0x0e
F000:FF01		  dw offset int_ack_handler		      ;	int 0x0f
F000:FF03		  dw offset int_10			      ;	int 0x10
F000:FF05		  dw offset int_11			      ;	int 0x11
F000:FF07		  dw offset int_12			      ;	int 0x12
F000:FF09		  dw offset int_13			      ;	int 0x13
F000:FF0B		  dw offset int_14			      ;	int 0x14
F000:FF0D		  dw offset int_15			      ;	int 0x15
F000:FF0F		  dw offset int_16			      ;	int 0x16
F000:FF11		  dw offset int_17			      ;	int 0x17
F000:FF13		  dw offset int_18			      ;	int 0x18
F000:FF15		  dw offset int_19			      ;	int 0x19
F000:FF17		  dw offset int_1a			      ;	int 0x1a
F000:FF19		  dw offset nullsub_1			      ;	int 0x1b
F000:FF1B		  dw offset nullsub_1			      ;	int 0x1c
F000:FF1D		  dw offset int_1d_monitor		      ;	int 0x1d: video	init param
F000:FF1F		  dw offset int_1e			      ;	int 0x1e
F000:FF21		  dw offset int_1f_charset_128_255	      ;	int 0x1f: charset 128-255
F000:FF23 int_00_07_tbl	  dw offset nullsub_1			      ;	DATA XREF: reset+7Co
F000:FF23							      ;	int 0
F000:FF25		  dw offset nullsub_1			      ;	int 1
F000:FF27		  dw offset nullsub_1			      ;	int 2
F000:FF29		  dw offset nullsub_1			      ;	int 3
F000:FF2B		  dw offset nullsub_1			      ;	int 4
F000:FF2D		  dw offset int_05			      ;	int 5
F000:FF2F		  dw offset nullsub_1			      ;	int 6
F000:FF31		  dw offset nullsub_1			      ;	int 7
F000:FF33 int_44_tbl	  dw offset int_44_charset_0_127	      ;	DATA XREF: reset+93o
F000:FF33							      ;	int 0x44
F000:FF35 value_0040	  dw 40h				      ;	DATA XREF: int_1a+1r
F000:FF35							      ;	int_08+5r
F000:FF37		  db 1Ch dup(0)
F000:FF53
F000:FF53 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:FF53
F000:FF53
F000:FF53 nullsub_1	  proc far				      ;	DATA XREF: F000:FF19o
F000:FF53							      ;	F000:FF1Bo
F000:FF53							      ;	F000:int_00_07_tblo
F000:FF53							      ;	F000:FF25o
F000:FF53							      ;	F000:FF27o
F000:FF53							      ;	F000:FF29o ...
F000:FF53		  iret
F000:FF53 nullsub_1	  endp
F000:FF53
F000:FF54
F000:FF54 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:FF54
F000:FF54
F000:FF54 int_05	  proc far				      ;	DATA XREF: F000:FF2Do
F000:FF54		  push	  ax
F000:FF55		  push	  bx
F000:FF56		  push	  cx
F000:FF57		  push	  dx
F000:FF58		  push	  ds
F000:FF59		  mov	  ax, 50h ; 'P'
F000:FF5C		  mov	  ds, ax			      ;	ds = 0x50
F000:FF5E		  xor	  bx, bx
F000:FF60		  cmp	  byte ptr [bx], 1
F000:FF63		  jz	  short	l3
F000:FF65		  mov	  byte ptr [bx], 1
F000:FF68		  sti
F000:FF69		  mov	  ah, 3
F000:FF6B		  int	  10h				      ;	- VIDEO	- READ CURSOR POSITION
F000:FF6B							      ;	BH = page number
F000:FF6B							      ;	Return:	DH,DL =	row,column, CH = cursor	start line, CL = cursor	end line
F000:FF6D		  push	  dx
F000:FF6E		  mov	  ah, 0Fh
F000:FF70		  int	  10h				      ;	- VIDEO	- GET CURRENT VIDEO MODE
F000:FF70							      ;	Return:	AH = number of columns on screen
F000:FF70							      ;	AL = current video mode
F000:FF70							      ;	BH = current active display page
F000:FF72		  mov	  cl, ah
F000:FF74		  call	  near ptr printer_out_return
F000:FF77		  xor	  dx, dx
F000:FF79
F000:FF79 l0:							      ;	CODE XREF: int_05+3Cj
F000:FF79							      ;	int_05+48j
F000:FF79		  mov	  ah, 2
F000:FF7B		  int	  10h				      ;	- VIDEO	- SET CURSOR POSITION
F000:FF7B							      ;	DH,DL =	row, column (0,0 = upper left)
F000:FF7B							      ;	BH = page number
F000:FF7D		  mov	  ah, 8
F000:FF7F		  int	  10h				      ;	- VIDEO	- READ ATTRIBUTES/CHARACTER AT CURSOR POSITION
F000:FF7F							      ;	BH = display page
F000:FF7F							      ;	Return:	AL = character
F000:FF7F							      ;	AH = attribute of character (alpha modes)
F000:FF81		  cmp	  al, 0
F000:FF83		  jnz	  short	l1
F000:FF85		  mov	  al, 20h ; ' '
F000:FF87
F000:FF87 l1:							      ;	CODE XREF: int_05+2Fj
F000:FF87		  call	  printer_out_char
F000:FF8A		  jnz	  short	loc_FFFA0
F000:FF8C		  inc	  dl
F000:FF8E		  cmp	  dl, cl
F000:FF90		  jnz	  short	l0
F000:FF92		  call	  near ptr printer_out_return
F000:FF95		  xor	  dl, dl
F000:FF97		  inc	  dh
F000:FF99		  cmp	  dh, 19h
F000:FF9C		  jnz	  short	l0
F000:FF9E		  mov	  cl, 0
F000:FFA0
F000:FFA0 loc_FFFA0:						      ;	CODE XREF: int_05+36j
F000:FFA0							      ;	printer_out_return+10j
F000:FFA0		  pop	  dx
F000:FFA1		  mov	  ah, 2
F000:FFA3		  int	  10h				      ;	- VIDEO	- SET CURSOR POSITION
F000:FFA3							      ;	DH,DL =	row, column (0,0 = upper left)
F000:FFA3							      ;	BH = page number
F000:FFA5		  mov	  [bx],	cl
F000:FFA7
F000:FFA7 l3:							      ;	CODE XREF: int_05+Fj
F000:FFA7		  pop	  ds
F000:FFA8		  pop	  dx
F000:FFA9		  pop	  cx
F000:FFAA		  pop	  bx
F000:FFAB		  pop	  ax
F000:FFAC		  iret
F000:FFAC int_05	  endp ; sp =  4
F000:FFAC
F000:FFAD
F000:FFAD ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:FFAD
F000:FFAD ; in:
F000:FFAD ;    al = char to print
F000:FFAD
F000:FFAD printer_out_char proc	near				      ;	CODE XREF: int_05:l1p
F000:FFAD							      ;	printer_out_return+2p
F000:FFAD							      ;	printer_out_return+9p
F000:FFAD		  push	  dx
F000:FFAE		  xor	  ah, ah
F000:FFB0		  xor	  dx, dx
F000:FFB2		  int	  17h				      ;	PRINTER	- OUTPUT CHARACTER
F000:FFB2							      ;	AL = character,	DX = printer port (0-3)
F000:FFB2							      ;	Return:	AH = status bits
F000:FFB4		  and	  ah, 1001b
F000:FFB7		  cmp	  ah, 0
F000:FFBA		  jz	  short	exit
F000:FFBC		  mov	  cl, 0FFh
F000:FFBE
F000:FFBE exit:							      ;	CODE XREF: printer_out_char+Dj
F000:FFBE		  pop	  dx
F000:FFBF		  retn
F000:FFBF printer_out_char endp
F000:FFBF
F000:FFC0
F000:FFC0 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
F000:FFC0
F000:FFC0
F000:FFC0 printer_out_return proc far				      ;	CODE XREF: int_05+20p
F000:FFC0							      ;	int_05+3Ep
F000:FFC0		  mov	  al, 0Dh
F000:FFC2		  call	  printer_out_char
F000:FFC5		  jnz	  short	error
F000:FFC7		  mov	  al, 0Ah
F000:FFC9		  call	  printer_out_char
F000:FFCC		  jnz	  short	error
F000:FFCE		  retn
F000:FFCF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:FFCF
F000:FFCF error:						      ;	CODE XREF: printer_out_return+5j
F000:FFCF							      ;	printer_out_return+Cj
F000:FFCF		  pop	  dx
F000:FFD0		  jmp	  short	loc_FFFA0
F000:FFD0 printer_out_return endp
F000:FFD0
F000:FFD0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:FFD2		  db 1Eh dup(0)
F000:FFF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:FFF0
F000:FFF0 reset_entry:						      ;	CODE XREF: int_09+3F3j
F000:FFF0		  jmp	  far ptr reset
F000:FFF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
F000:FFF5 a100384	  db '10/03/84'
F000:FFFD		  db 0FFh
F000:FFFE		  db 0FFh
F000:FFFF		  db 0FFh
F000:FFFF F000		  ends
F000:FFFF
F000:FFFF
F000:FFFF		  end
