f000:C000 ;
f000:C000 ; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
f000:C000 ; º	  This file is generated by The	Interactive Disassembler (IDA)	      º
f000:C000 ; º	  Copyright (c)	2010 by	Hex-Rays SA, <support@hex-rays.com>	      º
f000:C000 ; º			   Licensed to:	Freeware version		      º
f000:C000 ; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
f000:C000 ;
f000:C000 ; Input MD5	: BEB50E3A5831F2661B91B2E52C94B3EA
f000:C000
f000:C000 ; File Name	: Z:\Users\riq\progs\bios-8088\tandy_1000\bios-fc000-fffff.bin
f000:C000 ; Format	: Binary file
f000:C000 ; Base Address: F000h	Range: FC000h -	100000h	Loaded length: 4000h
f000:C000
f000:C000		  .8086
f000:C000		  .model flat
f000:C000
f000:C000 ; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
f000:C000
f000:C000 ; Segment type: Pure code
f000:C000 f000		  segment byte public 'CODE'
f000:C000		  ;org 0C000h
f000:C000		  db  21h ; !
f000:C001 aBiosRomVersion db 'BIOS ROM version 01.00.00',0Dh,0Ah      ; DATA XREF: reset+2D9o
f000:C001		  db 'Copyright 1984 Tandy Corp.',0Dh,0Ah
f000:C001		  db 'and Phoenix Compatibility Corp.',0Dh,0Ah
f000:C001		  db 'All rights reserved.',0Dh,0Ah,'$'
f000:C070 int_1f_charset_128_255 db  1Eh, 33h,3	dup( 60h), 33h,	1Eh, 0Ch, 66h,	 0,4 dup( 66h),	3Bh,   0, 0Ch, 18h, 3Ch
f000:C070							      ;	DATA XREF: f000:FF21o
f000:C070		  db  66h, 7Eh,	60h, 3Ch,   0, 3Ch,0C3h, 3Ch,	6, 3Eh,	66h, 3Fh,   0, 66h,   0, 3Ch,	6
f000:C070		  db  3Eh, 66h,	3Fh,   0, 30h, 18h, 3Ch,   6, 3Eh, 66h,	3Fh,   0, 18h,	 0, 3Ch,   6, 3Eh
f000:C070		  db  66h, 3Fh,3 dup(	0), 3Ch, 66h, 60h, 66h,	3Ch, 18h, 3Ch,0C3h, 3Ch, 66h, 7Eh, 60h
f000:C070		  db  3Ch,   0,	66h,   0, 3Ch, 66h, 7Eh, 60h, 3Ch,   0,	30h, 18h, 3Ch, 66h, 7Eh, 60h, 3Ch
f000:C070		  db	0, 66h,	  0, 38h,3 dup(	18h), 3Ch,   0,	38h,0C6h, 38h,3	dup( 18h), 3Ch,	  0, 30h
f000:C070		  db  18h, 38h,3 dup( 18h), 3Ch,   0, 63h, 1Ch,	36h, 63h, 7Fh,2	dup( 63h),   0,2 dup( 1Ch)
f000:C070		  db  3Eh, 63h,	7Fh,2 dup( 63h),   0,	6, 0Ch,	7Fh, 31h, 3Ch, 31h, 7Fh,3 dup(	 0), 7Eh
f000:C070		  db  1Bh, 7Eh,0D8h, 7Eh,   0, 3Fh, 6Ch,0CCh,0FFh,2 dup(0CCh),0CFh,   0, 3Ch,0C3h, 3Ch
f000:C070		  db 3 dup( 66h), 3Ch,	 0, 66h,   0, 3Ch,3 dup( 66h), 3Ch,   0, 30h, 18h, 3Ch,3 dup( 66h)
f000:C070		  db  3Ch,   0,	3Ch,0C3h,4 dup(	66h), 3Bh,   0,	30h, 18h,4 dup(	66h), 3Bh,   0,	66h,   0
f000:C070		  db 3 dup( 66h), 3Eh,	 6, 7Ch, 63h, 3Eh,4 dup( 63h), 3Eh,   0, 36h,5 dup( 63h), 3Eh
f000:C070		  db	0,2 dup( 0Ch), 3Fh,2 dup( 60h),	3Fh,2 dup( 0Ch), 1Ch, 36h, 32h,	78h, 30h, 73h
f000:C070		  db  7Eh,   0,2 dup( 66h), 3Ch, 7Eh, 18h, 7Eh,2 dup( 18h),0F8h,2 dup(0CCh),0FAh,0C6h
f000:C070		  db 0CFh,0C6h,0C7h, 0Eh,2 dup(	18h), 3Ch,3 dup( 18h), 70h, 0Ch, 18h, 3Ch,   6,	3Eh, 66h
f000:C070		  db  3Fh,   0,	18h, 30h, 38h,3	dup( 18h), 3Ch,	  0, 0Ch, 18h, 3Ch,3 dup( 66h),	3Ch,   0
f000:C070		  db  0Ch, 18h,4 dup( 66h), 3Bh,   0, 3Bh, 6Fh,	  0, 6Eh,3 dup(	33h),	0, 76h,0DEh, 73h
f000:C070		  db  7Bh, 6Fh,	67h, 63h,   0, 3Ch,   6, 3Eh, 66h, 3Bh,	  0,0FFh,   0, 3Ch,3 dup( 66h)
f000:C070		  db  3Ch,   0,0FFh,2 dup(   0), 18h,	0, 18h,	30h, 60h, 66h, 3Ch,3 dup(   0),	7Eh,2 dup( 60h)
f000:C070		  db 5 dup(   0), 7Eh,2	dup(   6),2 dup(   0),0C3h,0C6h,0CCh,0DEh, 33h,	66h,0CCh, 0Fh
f000:C070		  db 0C3h,0C6h,0CCh,0D8h, 37h, 6Fh,0CFh,   3,	0, 18h,	  0,2 dup( 18h),2 dup( 3Ch), 18h
f000:C070		  db	0, 33h,	66h,0CCh, 66h, 33h,3 dup(   0),0CCh, 66h, 33h, 66h,0CCh,2 dup(	 0), 22h
f000:C070		  db  88h, 22h,	88h, 22h, 88h, 22h, 88h, 55h,0AAh, 55h,0AAh, 55h,0AAh, 55h,0AAh,0DBh, 77h
f000:C070		  db 0DBh,0EEh,0DBh, 77h,0DBh,0EEh,0Ch dup( 18h),0F8h,5	dup( 18h),0F8h,	18h,0F8h,3 dup(	18h)
f000:C070		  db 4 dup( 36h),0F6h,3	dup( 36h),4 dup(   0),0FEh,3 dup( 36h),2 dup(	0),0F8h, 18h,0F8h
f000:C070		  db 3 dup( 18h),2 dup(	36h),0F6h,   6,0F6h,0Bh	dup( 36h),2 dup(   0),0FEh,   6,0F6h,5 dup( 36h)
f000:C070		  db 0F6h,   6,0FEh,3 dup(   0),4 dup( 36h),0FEh,3 dup(	  0),2 dup( 18h),0F8h, 18h,0F8h
f000:C070		  db 7 dup(   0),0F8h,7	dup( 18h), 1Fh,3 dup(	0),4 dup( 18h),0FFh,7 dup(   0),0FFh,7 dup( 18h)
f000:C070		  db  1Fh,3 dup( 18h),4	dup(   0),0FFh,3 dup(	0),4 dup( 18h),0FFh,5 dup( 18h), 1Fh, 18h
f000:C070		  db  1Fh,3 dup( 18h),4	dup( 36h), 37h,5 dup( 36h), 37h, 30h, 3Fh,5 dup(   0), 3Fh, 30h
f000:C070		  db  37h,5 dup( 36h),0F7h,   0,0FFh,5 dup(   0),0FFh,	 0,0F7h,5 dup( 36h), 37h, 30h
f000:C070		  db  37h,3 dup( 36h),2	dup(   0),0FFh,	  0,0FFh,3 dup(	  0),2 dup( 36h),0F7h,	 0,0F7h
f000:C070		  db 3 dup( 36h),2 dup(	18h),0FFh,   0,0FFh,3 dup(   0),4 dup( 36h),0FFh,5 dup(	  0),0FFh
f000:C070		  db	0,0FFh,3 dup( 18h),4 dup(   0),0FFh,7 dup( 36h), 3Fh,3 dup(   0),2 dup(	18h), 1Fh
f000:C070		  db  18h, 1Fh,5 dup(	0), 1Fh, 18h, 1Fh,3 dup( 18h),4	dup(   0), 3Fh,7 dup( 36h),0FFh
f000:C070		  db 3 dup( 36h),2 dup(	18h),0FFh, 18h,0FFh,7 dup( 18h),0F8h,7 dup(   0), 1Fh,3	dup( 18h)
f000:C070		  db 8 dup(0FFh),4 dup(	  0),4 dup(0FFh),8 dup(0F0h),8 dup( 0Fh),4 dup(0FFh),6 dup(   0)
f000:C070		  db  3Bh, 6Eh,	64h, 6Eh, 3Bh,	 0, 3Ch,2 dup( 66h), 7Ch,2 dup(	63h), 6Eh, 60h,	7Fh, 33h
f000:C070		  db  31h,3 dup( 30h), 78h,3 dup(   0),	7Fh,3 dup( 36h), 33h,	0, 7Eh,	66h, 30h, 18h
f000:C070		  db  30h, 66h,	7Eh,3 dup(   0), 3Fh,3 dup( 66h), 3Ch,3	dup(   0),4 dup( 33h), 3Eh, 60h
f000:C070		  db 2 dup(   0), 7Eh, 98h,3 dup( 18h),	  0, 7Eh, 18h, 3Ch,2 dup( 66h),	3Ch, 18h, 7Eh
f000:C070		  db  1Ch, 36h,	63h, 7Fh, 63h, 36h, 1Ch,   0, 3Ch, 66h,3 dup(0C3h), 66h,0E7h,	0, 0Eh
f000:C070		  db  18h, 0Ch,	3Eh,2 dup( 66h), 3Ch,3 dup(   0), 7Eh,2	dup(0DBh), 7Eh,3 dup(	0),   3
f000:C070		  db  3Eh, 67h,	6Bh, 73h, 3Eh, 60h, 1Ch, 30h, 60h, 7Ch,	60h, 30h, 1Ch,	 0, 3Ch,6 dup( 66h)
f000:C070		  db 2 dup(   0), 7Eh,	 0, 7Eh,   0, 7Eh,3 dup(   0), 18h, 7Eh, 18h,	0, 7Eh,2 dup(	0)
f000:C070		  db  30h, 18h,	0Ch, 18h, 30h, 7Eh,2 dup(   0),	0Ch, 18h, 30h, 18h, 0Ch, 7Eh,2 dup(   0)
f000:C070		  db	7,0Ch dup( 0Ch),2 dup( 6Ch), 38h,2 dup(	18h),	0, 7Eh,	  0,2 dup( 18h),2 dup(	 0)
f000:C070		  db  3Bh, 6Eh,	  0, 3Bh, 6Eh,2	dup(   0), 1Ch,2 dup( 36h), 1Ch,5 dup(	 0),2 dup( 1Ch)
f000:C070		  db 8 dup(   0),2 dup(	18h),3 dup(   0), 0Fh,3	dup( 0Ch),0ECh,	6Ch, 3Ch, 1Ch, 3Ch,4 dup( 36h)
f000:C070		  db 3 dup(   0), 38h, 0Ch, 18h, 30h, 3Ch,5 dup(   0),4	dup( 3Ch),0Ah dup(   0)
f000:C470 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C470 ; START OF FUNCTION CHUNK FOR	reset
f000:C470
f000:C470 test_system:						      ;	CODE XREF: reset+25j
f000:C470		  cli
f000:C471		  mov	  al, 0Ah
f000:C473		  out	  0A0h,	al			      ;	PIC 2  same as 0020 for	PIC 1
f000:C475		  mov	  al, 3
f000:C477		  mov	  dx, 3F2h
f000:C47A		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:C47A							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:C47A							      ;	2:   0=reset diskette controller; 1=enable controller
f000:C47A							      ;	3:   1=enable diskette DMA and interrupts
f000:C47A							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:C47A							      ;
f000:C47B		  mov	  al, 24h ; '$'
f000:C47D		  mov	  dx, 3D8h
f000:C480		  out	  dx, al
f000:C481		  mov	  dx, 3DBh
f000:C484		  out	  dx, al			      ;	Video: light pen latch reset.
f000:C484							      ;	Any OUT	clears the latch.
f000:C485		  mov	  al, 0
f000:C487		  mov	  dx, 3DAh
f000:C48A		  out	  dx, al			      ;	Video: bits 0-1	control
f000:C48A							      ;	Feature	Control	outputs	FC0 and	FC1
f000:C48B		  add	  dx, 4
f000:C48E		  out	  dx, al
f000:C48F		  mov	  dx, 3D9h
f000:C492		  out	  dx, al
f000:C493		  mov	  al, 3
f000:C495		  mov	  dx, 3DAh
f000:C498		  out	  dx, al			      ;	Video: bits 0-1	control
f000:C498							      ;	Feature	Control	outputs	FC0 and	FC1
f000:C499		  xor	  al, al
f000:C49B		  mov	  dx, 3DEh
f000:C49E		  out	  dx, al
f000:C49F		  mov	  al, 2
f000:C4A1		  mov	  dx, 3DAh
f000:C4A4		  out	  dx, al			      ;	Video: bits 0-1	control
f000:C4A4							      ;	Feature	Control	outputs	FC0 and	FC1
f000:C4A5		  mov	  al, 0
f000:C4A7		  mov	  dx, 3DEh
f000:C4AA		  out	  dx, al
f000:C4AB		  mov	  al, 1
f000:C4AD		  mov	  dx, 3DAh
f000:C4B0		  out	  dx, al			      ;	Video: bits 0-1	control
f000:C4B0							      ;	Feature	Control	outputs	FC0 and	FC1
f000:C4B1		  mov	  al, 0FFh
f000:C4B3		  mov	  dx, 3DEh
f000:C4B6		  out	  dx, al
f000:C4B7		  mov	  bl, 10h
f000:C4B9		  mov	  dx, 3DAh
f000:C4BC		  xor	  al, al
f000:C4BE
f000:C4BE l20:							      ;	CODE XREF: reset-1B8Ej
f000:C4BE		  mov	  al, bl
f000:C4C0		  out	  dx, al			      ;	Video: bits 0-1	control
f000:C4C0							      ;	Feature	Control	outputs	FC0 and	FC1
f000:C4C1		  add	  dx, 4
f000:C4C4		  out	  dx, al
f000:C4C5		  sub	  dx, 4
f000:C4C8		  inc	  bl
f000:C4CA		  cmp	  bl, 20h ; ' '
f000:C4CD		  jnz	  short	l20
f000:C4CF		  xor	  al, al
f000:C4D1		  out	  dx, al			      ;	Video: bits 0-1	control
f000:C4D1							      ;	Feature	Control	outputs	FC0 and	FC1
f000:C4D2		  mov	  al, 3Fh ; '?'
f000:C4D4		  mov	  dx, 3DFh
f000:C4D7		  out	  dx, al
f000:C4D8		  mov	  al, 0FFh
f000:C4DA		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
f000:C4DA							      ;	channel	0 base address
f000:C4DA							      ;	(also sets current address)
f000:C4DC		  mov	  al, 0BFh ; '¿'
f000:C4DE		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
f000:C4DE							      ;	channel	0 base address
f000:C4DE							      ;	(also sets current address)
f000:C4E0		  mov	  al, 0DFh ; 'ß'
f000:C4E2		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
f000:C4E2							      ;	channel	0 base address
f000:C4E2							      ;	(also sets current address)
f000:C4E4		  mov	  al, 9Fh ; 'Ÿ'
f000:C4E6		  out	  0C0h,	al			      ;	DMA controller,	8237A-5.
f000:C4E6							      ;	channel	0 base address
f000:C4E6							      ;	(also sets current address)
f000:C4E8		  mov	  cx, 10h
f000:C4EB		  mov	  dx, 3D4h
f000:C4EE		  mov	  bx, offset crt_idx_and_value
f000:C4F1
f000:C4F1 l21:							      ;	CODE XREF: reset-1B5Dj
f000:C4F1		  mov	  al, cs:[bx]
f000:C4F4		  out	  dx, al			      ;	Video: CRT cntrlr addr
f000:C4F4							      ;	horizontal total
f000:C4F5		  inc	  dx
f000:C4F6		  inc	  bx
f000:C4F7		  mov	  al, cs:[bx]
f000:C4FA		  out	  dx, al			      ;	Video: CRT controller internal registers
f000:C4FB		  dec	  dx
f000:C4FC		  inc	  bx
f000:C4FD		  dec	  cx
f000:C4FE		  jnz	  short	l21
f000:C500		  jmp	  short	l22
f000:C500 ; END	OF FUNCTION CHUNK FOR reset
f000:C500 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C502		  db  90h ; 
f000:C503 crt_idx_and_value dw 3800h, 2801h, 2D02h, 0A03h, 1F04h, 605h,	1906h, 1C07h, 208h, 709h, 60Ah,	70Bh, 0Ch
f000:C503							      ;	DATA XREF: reset-1B6Do
f000:C503		  dw 0Dh, 0Eh, 0Fh
f000:C523 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C523 ; START OF FUNCTION CHUNK FOR	reset
f000:C523
f000:C523 l22:							      ;	CODE XREF: reset-1B5Bj
f000:C523		  mov	  dx, 3D8h
f000:C526		  mov	  al, 2Ch ; ','
f000:C528		  out	  dx, al
f000:C529		  mov	  ax, 0B800h
f000:C52C		  mov	  es, ax			      ;	es = 0xb800
f000:C52E		  cld
f000:C52F		  mov	  di, 0
f000:C532		  mov	  cx, 3E8h
f000:C535		  mov	  ax, 720h
f000:C538		  rep stosw
f000:C53A		  mov	  ax, 0BBE8h
f000:C53D		  mov	  ds, ax			      ;	ds = 0xbbe8
f000:C53F		  mov	  bp, ds:pbbe80.shadow_keyb_status_flags_1
f000:C543		  mov	  si, ds:pbbe80.shadow_POST_reset_flag
f000:C547		  mov	  ax, 0
f000:C54A
f000:C54A l23:							      ;	CODE XREF: reset-1AD3j
f000:C54A		  mov	  di, 0
f000:C54D
f000:C54D l24:							      ;	CODE XREF: reset-1AFCj
f000:C54D		  mov	  [di],	ax
f000:C54F		  add	  di, 2
f000:C552		  not	  ax
f000:C554		  mov	  [di],	ax
f000:C556		  add	  di, 2
f000:C559		  not	  ax
f000:C55B		  cmp	  di, 180h
f000:C55F		  jb	  short	l24
f000:C561		  mov	  cx, 118h
f000:C564
f000:C564 delay1:						      ;	CODE XREF: reset:delay1j
f000:C564		  loop	  delay1
f000:C566		  mov	  di, 0
f000:C569
f000:C569 l25:							      ;	CODE XREF: reset-1AD8j
f000:C569		  mov	  dx, [di]
f000:C56B		  cmp	  ax, dx
f000:C56D		  jnz	  short	l26
f000:C56F		  add	  di, 2
f000:C572		  not	  ax
f000:C574		  mov	  dx, [di]
f000:C576		  cmp	  ax, dx
f000:C578		  jnz	  short	l26
f000:C57A		  add	  di, 2
f000:C57D		  not	  ax
f000:C57F		  cmp	  di, 180h
f000:C583		  jb	  short	l25
f000:C585		  add	  ax, 5555h
f000:C588		  jnb	  short	l23
f000:C58A		  mov	  ds:pbbe80.shadow_POST_reset_flag, si
f000:C58E		  mov	  ds:pbbe80.shadow_keyb_status_flags_1,	bp
f000:C592		  jmp	  l43
f000:C595 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C595
f000:C595 l26:							      ;	CODE XREF: reset-1AEEj
f000:C595							      ;	reset-1AE3j
f000:C595		  mov	  ss, ax
f000:C597		  mov	  sp, dx
f000:C599		  mov	  ax, di
f000:C59B		  mov	  ds, ax
f000:C59D		  mov	  si, offset aVidAddrBaseBbe	      ;	"Vid Addr:   Base:    BBE8h  Off: xxxxh"
f000:C5A0		  mov	  di, 370h
f000:C5A3		  mov	  ax, 0B800h
f000:C5A6		  mov	  es, ax
f000:C5A8		  mov	  ah, 7
f000:C5AA
f000:C5AA l27:							      ;	CODE XREF: reset-1AA3j
f000:C5AA		  mov	  al, cs:[si]
f000:C5AD		  or	  al, al
f000:C5AF		  jz	  short	l28
f000:C5B1		  mov	  es:[di], ax
f000:C5B4		  add	  di, 2
f000:C5B7		  inc	  si
f000:C5B8		  jmp	  short	l27
f000:C5BA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C5BA
f000:C5BA l28:							      ;	CODE XREF: reset-1AACj
f000:C5BA		  sub	  di, 0Ah
f000:C5BD		  mov	  ax, ds
f000:C5BF		  mov	  dx, ax
f000:C5C1		  mov	  al, ah
f000:C5C3		  mov	  cl, al
f000:C5C5		  shr	  al, 1
f000:C5C7		  shr	  al, 1
f000:C5C9		  shr	  al, 1
f000:C5CB		  shr	  al, 1
f000:C5CD		  and	  al, 0Fh
f000:C5CF		  add	  al, 30h ; '0'
f000:C5D1		  cmp	  al, 3Ah ; ':'
f000:C5D3		  js	  short	l29
f000:C5D5		  add	  al, 7
f000:C5D7
f000:C5D7 l29:							      ;	CODE XREF: reset-1A88j
f000:C5D7		  mov	  ch, al
f000:C5D9		  mov	  al, cl
f000:C5DB		  and	  al, 0Fh
f000:C5DD		  add	  al, 30h ; '0'
f000:C5DF		  cmp	  al, 3Ah ; ':'
f000:C5E1		  js	  short	l30
f000:C5E3		  add	  al, 7
f000:C5E5
f000:C5E5 l30:							      ;	CODE XREF: reset-1A7Aj
f000:C5E5		  mov	  ah, ch
f000:C5E7		  mov	  bp, ax
f000:C5E9		  mov	  al, ah
f000:C5EB		  mov	  ah, 7
f000:C5ED		  mov	  es:[di], ax
f000:C5F0		  add	  di, 2
f000:C5F3		  mov	  ax, bp
f000:C5F5		  mov	  ah, 7
f000:C5F7		  mov	  es:[di], ax
f000:C5FA		  add	  di, 2
f000:C5FD		  mov	  ax, dx
f000:C5FF		  mov	  cl, al
f000:C601		  shr	  al, 1
f000:C603		  shr	  al, 1
f000:C605		  shr	  al, 1
f000:C607		  shr	  al, 1
f000:C609		  and	  al, 0Fh
f000:C60B		  add	  al, 30h ; '0'
f000:C60D		  cmp	  al, 3Ah ; ':'
f000:C60F		  js	  short	l31
f000:C611		  add	  al, 7
f000:C613
f000:C613 l31:							      ;	CODE XREF: reset-1A4Cj
f000:C613		  mov	  ch, al
f000:C615		  mov	  al, cl
f000:C617		  and	  al, 0Fh
f000:C619		  add	  al, 30h ; '0'
f000:C61B		  cmp	  al, 3Ah ; ':'
f000:C61D		  js	  short	l32
f000:C61F		  add	  al, 7
f000:C621
f000:C621 l32:							      ;	CODE XREF: reset-1A3Ej
f000:C621		  mov	  ah, ch
f000:C623		  mov	  bp, ax
f000:C625		  mov	  al, ah
f000:C627		  mov	  ah, 7
f000:C629		  mov	  es:[di], ax
f000:C62C		  add	  di, 2
f000:C62F		  mov	  ax, bp
f000:C631		  mov	  ah, 7
f000:C633		  mov	  es:[di], ax
f000:C636		  add	  di, 2
f000:C639		  mov	  si, offset aDataFaultWritt	      ;	"Data Fault: Written: xxxxh Read: xxxxh"
f000:C63C		  mov	  di, 3C0h
f000:C63F		  mov	  ah, 7
f000:C641
f000:C641 l33:							      ;	CODE XREF: reset-1A0Cj
f000:C641		  mov	  al, cs:[si]
f000:C644		  or	  al, al
f000:C646		  jz	  short	l34
f000:C648		  mov	  es:[di], ax
f000:C64B		  add	  di, 2
f000:C64E		  inc	  si
f000:C64F		  jmp	  short	l33
f000:C651 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C651
f000:C651 l34:							      ;	CODE XREF: reset-1A15j
f000:C651		  sub	  di, 22h ; '"'
f000:C654		  mov	  ax, ss
f000:C656		  mov	  dx, ax
f000:C658		  mov	  al, ah
f000:C65A		  mov	  cl, al
f000:C65C		  shr	  al, 1
f000:C65E		  shr	  al, 1
f000:C660		  shr	  al, 1
f000:C662		  shr	  al, 1
f000:C664		  and	  al, 0Fh
f000:C666		  add	  al, 30h ; '0'
f000:C668		  cmp	  al, 3Ah ; ':'
f000:C66A		  js	  short	l35
f000:C66C		  add	  al, 7
f000:C66E
f000:C66E l35:							      ;	CODE XREF: reset-19F1j
f000:C66E		  mov	  ch, al
f000:C670		  mov	  al, cl
f000:C672		  and	  al, 0Fh
f000:C674		  add	  al, 30h ; '0'
f000:C676		  cmp	  al, 3Ah ; ':'
f000:C678		  js	  short	l36
f000:C67A		  add	  al, 7
f000:C67C
f000:C67C l36:							      ;	CODE XREF: reset-19E3j
f000:C67C		  mov	  ah, ch
f000:C67E		  mov	  bp, ax
f000:C680		  mov	  al, ah
f000:C682		  mov	  ah, 7
f000:C684		  mov	  es:[di], ax
f000:C687		  add	  di, 2
f000:C68A		  mov	  ax, bp
f000:C68C		  mov	  ah, 7
f000:C68E		  mov	  es:[di], ax
f000:C691		  add	  di, 2
f000:C694		  mov	  ax, dx
f000:C696		  mov	  cl, al
f000:C698		  shr	  al, 1
f000:C69A		  shr	  al, 1
f000:C69C		  shr	  al, 1
f000:C69E		  shr	  al, 1
f000:C6A0		  and	  al, 0Fh
f000:C6A2		  add	  al, 30h ; '0'
f000:C6A4		  cmp	  al, 3Ah ; ':'
f000:C6A6		  js	  short	l37
f000:C6A8		  add	  al, 7
f000:C6AA
f000:C6AA l37:							      ;	CODE XREF: reset-19B5j
f000:C6AA		  mov	  ch, al
f000:C6AC		  mov	  al, cl
f000:C6AE		  and	  al, 0Fh
f000:C6B0		  add	  al, 30h ; '0'
f000:C6B2		  cmp	  al, 3Ah ; ':'
f000:C6B4		  js	  short	l38
f000:C6B6		  add	  al, 7
f000:C6B8
f000:C6B8 l38:							      ;	CODE XREF: reset-19A7j
f000:C6B8		  mov	  ah, ch
f000:C6BA		  mov	  bp, ax
f000:C6BC		  mov	  al, ah
f000:C6BE		  mov	  ah, 7
f000:C6C0		  mov	  es:[di], ax
f000:C6C3		  add	  di, 2
f000:C6C6		  mov	  ax, bp
f000:C6C8		  mov	  ah, 7
f000:C6CA		  mov	  es:[di], ax
f000:C6CD		  add	  di, 2
f000:C6D0		  add	  di, 10h
f000:C6D3		  mov	  ax, sp
f000:C6D5		  mov	  dx, ax
f000:C6D7		  mov	  al, ah
f000:C6D9		  mov	  cl, al
f000:C6DB		  shr	  al, 1
f000:C6DD		  shr	  al, 1
f000:C6DF		  shr	  al, 1
f000:C6E1		  shr	  al, 1
f000:C6E3		  and	  al, 0Fh
f000:C6E5		  add	  al, 30h ; '0'
f000:C6E7		  cmp	  al, 3Ah ; ':'
f000:C6E9		  js	  short	l39
f000:C6EB		  add	  al, 7
f000:C6ED
f000:C6ED l39:							      ;	CODE XREF: reset-1972j
f000:C6ED		  mov	  ch, al
f000:C6EF		  mov	  al, cl
f000:C6F1		  and	  al, 0Fh
f000:C6F3		  add	  al, 30h ; '0'
f000:C6F5		  cmp	  al, 3Ah ; ':'
f000:C6F7		  js	  short	l40
f000:C6F9		  add	  al, 7
f000:C6FB
f000:C6FB l40:							      ;	CODE XREF: reset-1964j
f000:C6FB		  mov	  ah, ch
f000:C6FD		  mov	  bp, ax
f000:C6FF		  mov	  al, ah
f000:C701		  mov	  ah, 7
f000:C703		  mov	  es:[di], ax
f000:C706		  add	  di, 2
f000:C709		  mov	  ax, bp
f000:C70B		  mov	  ah, 7
f000:C70D		  mov	  es:[di], ax
f000:C710		  add	  di, 2
f000:C713		  mov	  ax, dx
f000:C715		  mov	  cl, al
f000:C717		  shr	  al, 1
f000:C719		  shr	  al, 1
f000:C71B		  shr	  al, 1
f000:C71D		  shr	  al, 1
f000:C71F		  and	  al, 0Fh
f000:C721		  add	  al, 30h ; '0'
f000:C723		  cmp	  al, 3Ah ; ':'
f000:C725		  js	  short	l41
f000:C727		  add	  al, 7
f000:C729
f000:C729 l41:							      ;	CODE XREF: reset-1936j
f000:C729		  mov	  ch, al
f000:C72B		  mov	  al, cl
f000:C72D		  and	  al, 0Fh
f000:C72F		  add	  al, 30h ; '0'
f000:C731		  cmp	  al, 3Ah ; ':'
f000:C733		  js	  short	l42
f000:C735		  add	  al, 7
f000:C737
f000:C737 l42:							      ;	CODE XREF: reset-1928j
f000:C737		  mov	  ah, ch
f000:C739		  mov	  bp, ax
f000:C73B		  mov	  al, ah
f000:C73D		  mov	  ah, 7
f000:C73F		  mov	  es:[di], ax
f000:C742		  add	  di, 2
f000:C745		  mov	  ax, bp
f000:C747		  mov	  ah, 7
f000:C749		  mov	  es:[di], ax
f000:C74C		  add	  di, 2
f000:C74F
f000:C74F halt0:						      ;	CODE XREF: reset:halt0j
f000:C74F		  jmp	  short	halt0
f000:C74F ; END	OF FUNCTION CHUNK FOR reset
f000:C74F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C751 aVidAddrBaseBbe db 'Vid Addr:   Base:    BBE8h  Off: xxxxh',0
f000:C751							      ;	DATA XREF: reset-1ABEo
f000:C778 aDataFaultWritt db 'Data Fault: Written: xxxxh Read: xxxxh',0
f000:C778							      ;	DATA XREF: reset-1A22o
f000:C79F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C79F ; START OF FUNCTION CHUNK FOR	reset
f000:C79F
f000:C79F l43:							      ;	CODE XREF: reset-1AC9j
f000:C79F		  mov	  ax, 0BBF0h
f000:C7A2		  mov	  ss, ax			      ;	ss = 0xbbf0
f000:C7A4		  mov	  sp, 0F0h ; 'ğ'
f000:C7A7		  xor	  al, al
f000:C7A9		  out	  81h, al			      ;	DMA page register 74LS612:
f000:C7A9							      ;	Channel	2 (diskette DMA)  (address bits	16-23)
f000:C7AB		  out	  82h, al			      ;	DMA page register 74LS612:
f000:C7AB							      ;	Channel	3 (hard	disk DMA) (address bits	16-23)
f000:C7AD		  out	  83h, al			      ;	DMA page register 74LS612:
f000:C7AD							      ;	Channel	1 (address bits	16-23)
f000:C7AF		  out	  0Dh, al			      ;	DMA controller,	8237A-5.
f000:C7AF							      ;	master clear.
f000:C7AF							      ;	Any OUT	clears the ctrlr (must be re-initialized)
f000:C7B1		  mov	  cx, 2
f000:C7B4
f000:C7B4 l44:							      ;	CODE XREF: reset:l44j
f000:C7B4		  loop	  l44
f000:C7B6		  mov	  al, 24h ; '$'
f000:C7B8		  out	  8, al				      ;	DMA 8237A-5. cmd reg bits:
f000:C7B8							      ;	0: enable mem-to-mem DMA
f000:C7B8							      ;	1: enable Ch0 address hold
f000:C7B8							      ;	2: disable controller
f000:C7B8							      ;	3: compressed timing mode
f000:C7B8							      ;	4: enable rotating priority
f000:C7B8							      ;	5: extended write mode;	0=late write
f000:C7B8							      ;	6: DRQ sensing - active	high
f000:C7B8							      ;	7: DACK	sensing	- active high
f000:C7BA		  mov	  dx, 0
f000:C7BD		  mov	  ah, 0
f000:C7BF		  mov	  cx, 1
f000:C7C2
f000:C7C2 l45:							      ;	CODE XREF: reset-1886j
f000:C7C2		  mov	  al, cl
f000:C7C4		  out	  dx, al
f000:C7C5		  mov	  al, ah
f000:C7C7		  out	  dx, al
f000:C7C8		  nop
f000:C7C9		  in	  al, dx
f000:C7CA		  cmp	  al, cl
f000:C7CC		  jnz	  short	l47
f000:C7CE		  in	  al, dx
f000:C7CF		  cmp	  al, 0
f000:C7D1		  jnz	  short	l47
f000:C7D3		  rcl	  cl, 1
f000:C7D5		  jnb	  short	l45
f000:C7D7		  mov	  dx, 0
f000:C7DA		  xor	  al, al
f000:C7DC
f000:C7DC l46:							      ;	CODE XREF: reset-1879j
f000:C7DC		  out	  dx, al
f000:C7DD		  out	  dx, al
f000:C7DE		  inc	  dx
f000:C7DF		  cmp	  dx, 8
f000:C7E2		  jnz	  short	l46
f000:C7E4		  mov	  dx, 0Bh
f000:C7E7		  mov	  al, 58h ; 'X'
f000:C7E9		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
f000:C7E9							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
f000:C7E9							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
f000:C7E9							      ;	4: 1=enable auto-initialization
f000:C7E9							      ;	5: 1=address increment;	0=address decrement
f000:C7E9							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
f000:C7EA		  mov	  al, 49h ; 'I'
f000:C7EC		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
f000:C7EC							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
f000:C7EC							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
f000:C7EC							      ;	4: 1=enable auto-initialization
f000:C7EC							      ;	5: 1=address increment;	0=address decrement
f000:C7EC							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
f000:C7ED		  mov	  al, 4Ah ; 'J'
f000:C7EF		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
f000:C7EF							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
f000:C7EF							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
f000:C7EF							      ;	4: 1=enable auto-initialization
f000:C7EF							      ;	5: 1=address increment;	0=address decrement
f000:C7EF							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
f000:C7F0		  mov	  al, 4Bh ; 'K'
f000:C7F2		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
f000:C7F2							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
f000:C7F2							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
f000:C7F2							      ;	4: 1=enable auto-initialization
f000:C7F2							      ;	5: 1=address increment;	0=address decrement
f000:C7F2							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
f000:C7F3		  mov	  al, 0Eh
f000:C7F5		  out	  0Fh, al			      ;	DMA controller,	8237A-5.
f000:C7F5							      ;	master clear. Clear or mask any	or
f000:C7F5							      ;	all of the channels. Bits:
f000:C7F5							      ;	0: 1=mask channel 0; 0=enable
f000:C7F5							      ;	1: 1=mask channel 1;
f000:C7F5							      ;	2: 1=mask channel 2;
f000:C7F5							      ;	3: 1=mask channel 3;
f000:C7F7		  mov	  al, 0FFh
f000:C7F9		  out	  1, al				      ;	DMA controller,	8237A-5.
f000:C7F9							      ;	channel	0 base address and word	count
f000:C7FB		  mov	  al, 20h ; ' '
f000:C7FD		  out	  8, al				      ;	DMA 8237A-5. cmd reg bits:
f000:C7FD							      ;	0: enable mem-to-mem DMA
f000:C7FD							      ;	1: enable Ch0 address hold
f000:C7FD							      ;	2: disable controller
f000:C7FD							      ;	3: compressed timing mode
f000:C7FD							      ;	4: enable rotating priority
f000:C7FD							      ;	5: extended write mode;	0=late write
f000:C7FD							      ;	6: DRQ sensing - active	high
f000:C7FD							      ;	7: DACK	sensing	- active high
f000:C7FF
f000:C7FF l47:							      ;	CODE XREF: reset-188Fj
f000:C7FF							      ;	reset-188Aj
f000:C7FF		  mov	  ch, 0
f000:C801
f000:C801 l48:							      ;	CODE XREF: reset-182Cj
f000:C801							      ;	reset-180Dj
f000:C801		  mov	  al, 98h ; '˜'
f000:C803		  out	  63h, al			      ;	PC/XT PPI Command/Mode Register.
f000:C803							      ;	Selects	which PPI ports	are input or output.
f000:C803							      ;	BIOS sets to 99H (Ports	A and C	are input, B is	output).
f000:C805		  nop
f000:C806		  mov	  al, 0C0h ; 'À'
f000:C808		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:C808							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:C808							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:C808							      ;	3: 1=read high switches
f000:C808							      ;	4: 0=enable RAM	parity checking
f000:C808							      ;	5: 0=enable I/O	channel	check
f000:C808							      ;	6: 0=hold keyboard clock low
f000:C808							      ;	7: 0=enable kbrd
f000:C80A		  mov	  cl, 1
f000:C80C
f000:C80C l49:							      ;	CODE XREF: reset-1831j
f000:C80C		  mov	  al, 90h ; ''
f000:C80E		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C810		  mov	  al, cl
f000:C812		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C814		  mov	  al, 80h ; '€'
f000:C816		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C818		  mov	  al, 90h ; ''
f000:C81A		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C81C		  nop
f000:C81D		  in	  al, 42h			      ;	Timer 8253-5 (AT: 8254.2).
f000:C81F		  cmp	  ch, 1
f000:C822		  jz	  short	l50
f000:C824		  cmp	  al, cl
f000:C826		  jnz	  short	l51
f000:C828
f000:C828 l50:							      ;	CODE XREF: reset-1839j
f000:C828		  rcl	  cl, 1
f000:C82A		  jnb	  short	l49
f000:C82C		  cmp	  ch, 1
f000:C82F		  jz	  short	l48
f000:C831		  jmp	  short	l54
f000:C831 ; END	OF FUNCTION CHUNK FOR reset
f000:C833 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C833		  nop
f000:C834 ; START OF FUNCTION CHUNK FOR	reset
f000:C834
f000:C834 l51:							      ;	CODE XREF: reset-1835j
f000:C834		  mov	  si, offset aFaultyWriteRea	      ;	"Faulty	write &	read of	8253 Chan 2 Reg"
f000:C837		  mov	  di, 3C0h
f000:C83A		  mov	  ah, 7
f000:C83C
f000:C83C l52:							      ;	CODE XREF: reset-1811j
f000:C83C		  mov	  al, cs:[si]
f000:C83F		  or	  al, al
f000:C841		  jz	  short	l53
f000:C843		  mov	  es:[di], ax
f000:C846		  add	  di, 2
f000:C849		  inc	  si
f000:C84A		  jmp	  short	l52
f000:C84C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C84C
f000:C84C l53:							      ;	CODE XREF: reset-181Aj
f000:C84C		  mov	  ch, 1
f000:C84E		  jmp	  short	l48
f000:C84E ; END	OF FUNCTION CHUNK FOR reset
f000:C84E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C850 aFaultyWriteRea db 'Faulty write & read of 8253 Chan 2 Reg',0
f000:C850							      ;	DATA XREF: reset:l51o
f000:C877 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C877 ; START OF FUNCTION CHUNK FOR	reset
f000:C877
f000:C877 l54:							      ;	CODE XREF: reset-182Aj
f000:C877		  mov	  al, 74h ; 't'
f000:C879		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C87B		  mov	  al, 12h
f000:C87D		  out	  41h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C87F		  mov	  al, 0
f000:C881		  out	  41h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C883		  mov	  al, 30h ; '0'
f000:C885		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C887		  mov	  al, 0
f000:C889		  out	  40h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C88B		  out	  40h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C88D		  mov	  al, 0B0h ; '°'
f000:C88F		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C891		  mov	  al, 0
f000:C893		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C895		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:C897		  mov	  ax, 0
f000:C89A		  mov	  es, ax
f000:C89C		  xor	  si, si
f000:C89E
f000:C89E l55:							      ;	CODE XREF: reset-1790j
f000:C89E		  mov	  ax, es:[si]
f000:C8A1		  not	  ax
f000:C8A3		  mov	  es:[si], ax
f000:C8A6		  mov	  cx, 118h
f000:C8A9
f000:C8A9 l56:							      ;	CODE XREF: reset:l56j
f000:C8A9		  loop	  l56
f000:C8AB		  cmp	  ax, es:[si]
f000:C8AE		  jnz	  short	l60
f000:C8B0		  not	  ax
f000:C8B2		  mov	  es:[si], ax
f000:C8B5		  mov	  cx, 118h
f000:C8B8
f000:C8B8 l57:							      ;	CODE XREF: reset:l57j
f000:C8B8		  loop	  l57
f000:C8BA		  cmp	  ax, es:[si]
f000:C8BD		  jnz	  short	l60
f000:C8BF
f000:C8BF l58:							      ;	CODE XREF: reset-1773j
f000:C8BF		  mov	  ax, es
f000:C8C1		  add	  ax, 1000h
f000:C8C4		  cmp	  ax, 8000h
f000:C8C7		  jz	  short	l59
f000:C8C9		  mov	  es, ax
f000:C8CB		  jmp	  short	l55
f000:C8CD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C8CD
f000:C8CD l59:							      ;	CODE XREF: reset-1794j
f000:C8CD		  mov	  es, ax
f000:C8CF		  jmp	  short	l63
f000:C8CF ; END	OF FUNCTION CHUNK FOR reset
f000:C8D1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C8D1		  nop
f000:C8D2 ; START OF FUNCTION CHUNK FOR	reset
f000:C8D2
f000:C8D2 l60:							      ;	CODE XREF: reset-17ADj
f000:C8D2							      ;	reset-179Ej
f000:C8D2		  xor	  ax, es:[si]
f000:C8D5		  mov	  bl, 0
f000:C8D7		  mov	  cx, 11h
f000:C8DA
f000:C8DA l61:							      ;	CODE XREF: reset-177Cj
f000:C8DA							      ;	reset-1778j
f000:C8DA		  dec	  cx
f000:C8DB		  jcxz	  short	l62
f000:C8DD		  rcl	  ax, 1
f000:C8DF		  jnb	  short	l61
f000:C8E1		  inc	  bl
f000:C8E3		  jmp	  short	l61
f000:C8E5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C8E5
f000:C8E5 l62:							      ;	CODE XREF: reset-1780j
f000:C8E5		  cmp	  bl, 0
f000:C8E8		  jb	  short	l58
f000:C8EA
f000:C8EA l63:							      ;	CODE XREF: reset-178Cj
f000:C8EA		  mov	  dx, es
f000:C8EC		  mov	  al, dh
f000:C8EE		  mov	  cl, 4
f000:C8F0		  shr	  al, cl
f000:C8F2		  out	  0A0h,	al			      ;	PIC 2  same as 0020 for	PIC 1
f000:C8F4		  mov	  ds:pbbe80.field_D, al
f000:C8F7		  mov	  ds:pbbe80.field_B, dx
f000:C8FB		  mov	  ax, 0B800h
f000:C8FE		  mov	  es, ax
f000:C900		  mov	  si, offset aMemorySizeNone	      ;	"MEMORY	SIZE =	None  "
f000:C903		  mov	  di, 4
f000:C906		  mov	  ah, 7
f000:C908
f000:C908 l64:							      ;	CODE XREF: reset-1745j
f000:C908		  mov	  al, cs:[si]
f000:C90B		  or	  al, al
f000:C90D		  jz	  short	l65
f000:C90F		  mov	  es:[di], ax
f000:C912		  add	  di, 2
f000:C915		  inc	  si
f000:C916		  jmp	  short	l64
f000:C918 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C918
f000:C918 l65:							      ;	CODE XREF: reset-174Ej
f000:C918		  mov	  al, ds:pbbe80.field_D
f000:C91B		  mov	  cx, 4
f000:C91E		  mul	  cl
f000:C920		  xor	  ah, ah
f000:C922		  mov	  si, ax
f000:C924		  mov	  ah, 7
f000:C926		  mov	  bx, offset a128k192k256k320k384k448k512k57 ; "128K192K256K320K384K448K512K576K640K704"...
f000:C929		  mov	  di, 22h ; '"'
f000:C92C
f000:C92C l66:							      ;	CODE XREF: reset-1725j
f000:C92C		  mov	  al, cs:[bx+si]
f000:C92F		  mov	  es:[di], ax
f000:C932		  add	  di, 2
f000:C935		  inc	  si
f000:C936		  loop	  l66
f000:C938		  jmp	  short	l67
f000:C938 ; END	OF FUNCTION CHUNK FOR reset
f000:C93A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C93A		  nop
f000:C93A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C93B aMemorySizeNone db 'MEMORY SIZE =  None  ',0                ; DATA XREF: reset-175Bo
f000:C951 a128k192k256k320k384k448k512k57 db '128K192K256K320K384K448K512K576K640K704K768K832K896K960K'
f000:C951							      ;	DATA XREF: reset-1735o
f000:C989 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C989 ; START OF FUNCTION CHUNK FOR	reset
f000:C989
f000:C989 l67:							      ;	CODE XREF: reset-1723j
f000:C989							      ;	reset:l71j
f000:C989		  mov	  al, 98h ; '˜'
f000:C98B		  out	  63h, al			      ;	PC/XT PPI Command/Mode Register.
f000:C98B							      ;	Selects	which PPI ports	are input or output.
f000:C98B							      ;	BIOS sets to 99H (Ports	A and C	are input, B is	output).
f000:C98D		  mov	  dx, 61h ; 'a'
f000:C990		  mov	  cl, 1
f000:C992
f000:C992 l68:							      ;	CODE XREF: reset-16BEj
f000:C992		  mov	  al, cl
f000:C994		  out	  dx, al			      ;	PC/XT PPI port B bits:
f000:C994							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:C994							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:C994							      ;	3: 1=read high switches
f000:C994							      ;	4: 0=enable RAM	parity checking
f000:C994							      ;	5: 0=enable I/O	channel	check
f000:C994							      ;	6: 0=hold keyboard clock low
f000:C994							      ;	7: 0=enable kbrd
f000:C995		  nop
f000:C996		  in	  al, dx			      ;	PC/XT PPI port B bits:
f000:C996							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:C996							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:C996							      ;	3: 1=read high switches
f000:C996							      ;	4: 0=enable RAM	parity checking
f000:C996							      ;	5: 0=enable I/O	channel	check
f000:C996							      ;	6: 0=hold keyboard clock low
f000:C996							      ;	7: 0=enable kbrd
f000:C997		  cmp	  al, cl
f000:C999		  jnz	  short	l69
f000:C99B		  rcl	  cl, 1
f000:C99D		  jnb	  short	l68
f000:C99F		  jmp	  short	l72
f000:C99F ; END	OF FUNCTION CHUNK FOR reset
f000:C99F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C9A1		  db  90h ; 
f000:C9A2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C9A2 ; START OF FUNCTION CHUNK FOR	reset
f000:C9A2
f000:C9A2 l69:							      ;	CODE XREF: reset-16C2j
f000:C9A2		  mov	  si, offset aFaultyWriteR_0	      ;	"Faulty	write &	read of	8255 PPI Chan B"
f000:C9A5		  mov	  di, 3C0h
f000:C9A8		  mov	  ah, 7
f000:C9AA
f000:C9AA l70:							      ;	CODE XREF: reset-16A3j
f000:C9AA		  mov	  al, cs:[si]
f000:C9AD		  or	  al, al
f000:C9AF		  jz	  short	l71
f000:C9B1		  mov	  es:[di], ax
f000:C9B4		  add	  di, 2
f000:C9B7		  inc	  si
f000:C9B8		  jmp	  short	l70
f000:C9BA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C9BA
f000:C9BA l71:							      ;	CODE XREF: reset-16ACj
f000:C9BA		  jmp	  short	l67
f000:C9BA ; END	OF FUNCTION CHUNK FOR reset
f000:C9BA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C9BC aFaultyWriteR_0 db 'Faulty write & read of 8255 PPI Chan B',0
f000:C9BC							      ;	DATA XREF: reset:l69o
f000:C9E3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:C9E3 ; START OF FUNCTION CHUNK FOR	reset
f000:C9E3
f000:C9E3 l72:							      ;	CODE XREF: reset-16BCj
f000:C9E3		  mov	  dx, 63h ; 'c'
f000:C9E6		  mov	  al, 98h ; '˜'
f000:C9E8		  out	  dx, al			      ;	PC/XT PPI Command/Mode Register.
f000:C9E8							      ;	Selects	which PPI ports	are input or output.
f000:C9E8							      ;	BIOS sets to 99H (Ports	A and C	are input, B is	output).
f000:C9E9		  mov	  dx, 61h ; 'a'
f000:C9EC		  mov	  al, 88h ; 'ˆ'
f000:C9EE		  out	  dx, al			      ;	PC/XT PPI port B bits:
f000:C9EE							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:C9EE							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:C9EE							      ;	3: 1=read high switches
f000:C9EE							      ;	4: 0=enable RAM	parity checking
f000:C9EE							      ;	5: 0=enable I/O	channel	check
f000:C9EE							      ;	6: 0=hold keyboard clock low
f000:C9EE							      ;	7: 0=enable kbrd
f000:C9EF		  mov	  al, 8
f000:C9F1		  out	  dx, al			      ;	PC/XT PPI port B bits:
f000:C9F1							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:C9F1							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:C9F1							      ;	3: 1=read high switches
f000:C9F1							      ;	4: 0=enable RAM	parity checking
f000:C9F1							      ;	5: 0=enable I/O	channel	check
f000:C9F1							      ;	6: 0=hold keyboard clock low
f000:C9F1							      ;	7: 0=enable kbrd
f000:C9F2		  mov	  dx, 62h ; 'b'
f000:C9F5		  mov	  al, 0
f000:C9F7		  out	  dx, al			      ;	PC/XT PPI port C. Bits:
f000:C9F7							      ;	0-3: values of DIP switches
f000:C9F7							      ;	5: 1=Timer 2 channel out
f000:C9F7							      ;	6: 1=I/O channel check
f000:C9F7							      ;	7: 1=RAM parity	check error occurred.
f000:C9F8		  mov	  al, 13h
f000:C9FA		  out	  20h, al			      ;	Interrupt controller, 8259A.
f000:C9FC		  mov	  al, 8
f000:C9FE		  mov	  dx, 21h ; '!'
f000:CA01		  out	  dx, al			      ;	Interrupt controller, 8259A.
f000:CA02		  mov	  al, 1
f000:CA04		  out	  dx, al			      ;	Interrupt controller, 8259A.
f000:CA05		  mov	  al, 0FFh
f000:CA07		  out	  dx, al			      ;	Interrupt controller, 8259A.
f000:CA08		  mov	  cl, al
f000:CA0A		  mov	  al, 40h ; '@'
f000:CA0C		  out	  20h, al			      ;	Interrupt controller, 8259A.
f000:CA0E		  in	  al, dx			      ;	Interrupt controller, 8259A.
f000:CA0F		  cmp	  al, cl
f000:CA11		  jnz	  short	l75
f000:CA13		  mov	  cl, 1
f000:CA15
f000:CA15 l73:							      ;	CODE XREF: reset-163Cj
f000:CA15		  mov	  al, cl
f000:CA17		  out	  dx, al			      ;	Interrupt controller, 8259A.
f000:CA18		  in	  al, dx			      ;	Interrupt controller, 8259A.
f000:CA19		  cmp	  al, cl
f000:CA1B		  jnz	  short	l75
f000:CA1D		  rcl	  cl, 1
f000:CA1F		  jnb	  short	l73
f000:CA21		  mov	  al, 0FDh ; 'ı'
f000:CA23		  out	  dx, al			      ;	Interrupt controller, 8259A.
f000:CA24		  mov	  cl, al
f000:CA26		  in	  al, dx			      ;	Interrupt controller, 8259A.
f000:CA27		  cmp	  al, cl
f000:CA29		  jnz	  short	l75
f000:CA2B		  mov	  cx, 8
f000:CA2E
f000:CA2E l74:							      ;	CODE XREF: reset-1629j
f000:CA2E		  mov	  al, 20h ; ' '
f000:CA30		  out	  20h, al			      ;	Interrupt controller, 8259A.
f000:CA32		  loop	  l74
f000:CA34		  jmp	  short	l77
f000:CA34 ; END	OF FUNCTION CHUNK FOR reset
f000:CA34 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CA36		  db  90h ; 
f000:CA37 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CA37 ; START OF FUNCTION CHUNK FOR	reset
f000:CA37
f000:CA37 l75:							      ;	CODE XREF: reset-164Aj
f000:CA37							      ;	reset-1640j
f000:CA37							      ;	reset-1632j
f000:CA37		  mov	  si, offset aFaultyWriteR_1	      ;	"Faulty	write &	read of	8259 Mask Reg"
f000:CA3A		  mov	  di, 3C0h
f000:CA3D		  mov	  ah, 7
f000:CA3F
f000:CA3F l76:							      ;	CODE XREF: reset-160Ej
f000:CA3F		  mov	  al, cs:[si]
f000:CA42		  or	  al, al
f000:CA44		  jz	  short	halt1
f000:CA46		  mov	  es:[di], ax
f000:CA49		  add	  di, 2
f000:CA4C		  inc	  si
f000:CA4D		  jmp	  short	l76
f000:CA4D ; END	OF FUNCTION CHUNK FOR reset
f000:CA4D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CA4F aFaultyWriteR_1 db 'Faulty write & read of 8259 Mask Reg',0 ; DATA XREF: reset:l75o
f000:CA74 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CA74 ; START OF FUNCTION CHUNK FOR	reset
f000:CA74
f000:CA74 halt1:						      ;	CODE XREF: reset-1617j
f000:CA74							      ;	reset:halt1j
f000:CA74		  jmp	  short	halt1
f000:CA76 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CA76
f000:CA76 l77:							      ;	CODE XREF: reset-1627j
f000:CA76		  xor	  cx, cx
f000:CA78
f000:CA78 delay2:						      ;	CODE XREF: reset:delay2j
f000:CA78		  loop	  delay2
f000:CA7A		  mov	  cx, 11h
f000:CA7D
f000:CA7D l78:							      ;	CODE XREF: reset-15C9j
f000:CA7D		  xchg	  bx, cx
f000:CA7F		  mov	  al, 88h ; 'ˆ'
f000:CA81		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:CA81							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:CA81							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:CA81							      ;	3: 1=read high switches
f000:CA81							      ;	4: 0=enable RAM	parity checking
f000:CA81							      ;	5: 0=enable I/O	channel	check
f000:CA81							      ;	6: 0=hold keyboard clock low
f000:CA81							      ;	7: 0=enable kbrd
f000:CA83		  mov	  al, 20h ; ' '
f000:CA85		  out	  20h, al			      ;	Interrupt controller, 8259A.
f000:CA87		  mov	  al, 8
f000:CA89		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:CA89							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:CA89							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:CA89							      ;	3: 1=read high switches
f000:CA89							      ;	4: 0=enable RAM	parity checking
f000:CA89							      ;	5: 0=enable I/O	channel	check
f000:CA89							      ;	6: 0=hold keyboard clock low
f000:CA89							      ;	7: 0=enable kbrd
f000:CA8B		  mov	  cx, 0A9h ; '©'
f000:CA8E
f000:CA8E delay3:						      ;	CODE XREF: reset:delay3j
f000:CA8E		  loop	  delay3
f000:CA90		  xchg	  bx, cx
f000:CA92		  loop	  l78
f000:CA94		  mov	  ax, 1
f000:CA97		  mov	  ds:pbbe80.field_10, ax
f000:CA9A		  xor	  ax, ax
f000:CA9C		  mov	  ds:pbbe80.field_E, ax
f000:CA9F		  mov	  cx, 5A5Ah
f000:CAA2		  mov	  bp, 0
f000:CAA5
f000:CAA5 l79:							      ;	CODE XREF: reset-158Cj
f000:CAA5		  mov	  bx, 0FFFEh
f000:CAA8
f000:CAA8 l80:							      ;	CODE XREF: reset-1587j
f000:CAA8		  mov	  es, bp
f000:CAAA		  mov	  si, 0FFFEh
f000:CAAD
f000:CAAD l81:							      ;	CODE XREF: reset-15A1j
f000:CAAD		  mov	  ax, bx
f000:CAAF		  xor	  ax, cx
f000:CAB1		  xor	  ax, bp
f000:CAB3		  mov	  es:[bx], ax
f000:CAB6		  dec	  bx
f000:CAB7		  dec	  bx
f000:CAB8		  cmp	  bx, si
f000:CABA		  jnz	  short	l81
f000:CABC		  mov	  ax, bp
f000:CABE		  add	  ax, 1000h
f000:CAC1		  mov	  bp, ax
f000:CAC3		  mov	  ax, ds:pbbe80.field_B
f000:CAC6		  add	  ax, 1000h
f000:CAC9		  cmp	  ax, bp
f000:CACB		  jz	  short	l82
f000:CACD		  jb	  short	l83
f000:CACF		  jmp	  short	l79
f000:CAD1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CAD1
f000:CAD1 l82:							      ;	CODE XREF: reset-1590j
f000:CAD1		  mov	  bx, 0BFFEh
f000:CAD4		  jmp	  short	l80
f000:CAD6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CAD6
f000:CAD6 l83:							      ;	CODE XREF: reset-158Ej
f000:CAD6		  mov	  bp, 0
f000:CAD9
f000:CAD9 l84:							      ;	CODE XREF: reset-1554j
f000:CAD9		  mov	  bx, 0FFFEh
f000:CADC
f000:CADC l85:							      ;	CODE XREF: reset-154Fj
f000:CADC		  mov	  es, bp
f000:CADE
f000:CADE l86:							      ;	CODE XREF: reset-1566j
f000:CADE		  mov	  ax, bx
f000:CAE0		  xor	  ax, cx
f000:CAE2		  xor	  ax, bp
f000:CAE4		  mov	  si, ax
f000:CAE6		  mov	  di, es:[bx]
f000:CAE9		  cmp	  si, di
f000:CAEB		  jz	  short	l87
f000:CAED		  call	  sub_FCB8E
f000:CAF0
f000:CAF0 l87:							      ;	CODE XREF: reset-1570j
f000:CAF0		  dec	  bx
f000:CAF1		  dec	  bx
f000:CAF2		  cmp	  bx, 0FFFEh
f000:CAF5		  jnz	  short	l86
f000:CAF7		  add	  bp, 1000h
f000:CAFB		  mov	  ax, ds:pbbe80.field_B
f000:CAFE		  add	  ax, 1000h
f000:CB01		  cmp	  ax, bp
f000:CB03		  jz	  short	l88
f000:CB05		  jb	  short	l89
f000:CB07		  jmp	  short	l84
f000:CB09 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CB09
f000:CB09 l88:							      ;	CODE XREF: reset-1558j
f000:CB09		  mov	  bx, 0BFFEh
f000:CB0C		  jmp	  short	l85
f000:CB0E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CB0E
f000:CB0E l89:							      ;	CODE XREF: reset-1556j
f000:CB0E		  cld
f000:CB0F		  mov	  bp, 0
f000:CB12
f000:CB12 l90:							      ;	CODE XREF: reset-152Dj
f000:CB12		  mov	  cx, 8000h
f000:CB15
f000:CB15 l91:							      ;	CODE XREF: reset-1528j
f000:CB15		  mov	  es, bp
f000:CB17		  mov	  di, 0
f000:CB1A		  xor	  ax, ax
f000:CB1C		  rep stosw
f000:CB1E		  add	  bp, 1000h
f000:CB22		  mov	  ax, ds:pbbe80.field_B
f000:CB25		  add	  ax, 1000h
f000:CB28		  cmp	  ax, bp
f000:CB2A		  jz	  short	l92
f000:CB2C		  jb	  short	l93
f000:CB2E		  jmp	  short	l90
f000:CB30 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CB30
f000:CB30 l92:							      ;	CODE XREF: reset-1531j
f000:CB30		  mov	  cx, 5FFEh
f000:CB33		  jmp	  short	l91
f000:CB35 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CB35
f000:CB35 l93:							      ;	CODE XREF: reset-152Fj
f000:CB35		  mov	  ax, 0BBE8h
f000:CB38		  mov	  ds, ax			      ;	ds = 0xbbe8
f000:CB3A		  mov	  ax, ds:pbbe80.field_10
f000:CB3D		  cmp	  ax, 1
f000:CB40		  jnz	  short	halt
f000:CB42		  jmp	  _reset_cont
f000:CB45 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CB45
f000:CB45 halt:							      ;	CODE XREF: reset-151Bj
f000:CB45							      ;	reset:haltj
f000:CB45		  jmp	  short	halt
f000:CB45 ; END	OF FUNCTION CHUNK FOR reset
f000:CB45 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CB47 aMemoryErrorInf db 'Memory Error Information:               Written  Read    Base   Offset',0
f000:CB47							      ;	DATA XREF: sub_FCB8E+Ao
f000:CB8E
f000:CB8E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:CB8E
f000:CB8E
f000:CB8E sub_FCB8E	  proc near				      ;	CODE XREF: reset-156Ep
f000:CB8E		  mov	  ds:pbbe80.field_10, si
f000:CB92		  mov	  si, di
f000:CB94		  push	  si
f000:CB95		  mov	  di, 14Ah
f000:CB98		  mov	  si, offset aMemoryErrorInf	      ;	"Memory	Error Information:		"...
f000:CB9B		  call	  print_asciiz
f000:CB9E		  pop	  si
f000:CB9F		  mov	  ax, ds:pbbe80.field_E
f000:CBA2		  cmp	  al, 0Fh
f000:CBA4		  jz	  short	l0
f000:CBA6		  inc	  ax
f000:CBA7		  mov	  ds:pbbe80.field_E, ax
f000:CBAA
f000:CBAA l0:							      ;	CODE XREF: sub_FCB8E+16j
f000:CBAA		  mov	  ax, ds:pbbe80.field_E
f000:CBAD		  mov	  ah, 50h ; 'P'
f000:CBAF		  mul	  ah
f000:CBB1		  mov	  di, 1ECh
f000:CBB4		  add	  di, ax
f000:CBB6		  mov	  ax, ds:pbbe80.field_10
f000:CBB9		  call	  sub_FCBD9
f000:CBBC		  add	  di, 8
f000:CBBF		  mov	  ax, si
f000:CBC1		  call	  sub_FCBD9
f000:CBC4		  add	  di, 8
f000:CBC7		  mov	  ax, bp
f000:CBC9		  call	  sub_FCBD9
f000:CBCC		  add	  di, 8
f000:CBCF		  mov	  ax, bx
f000:CBD1		  call	  sub_FCBD9
f000:CBD4		  mov	  si, ds:pbbe80.field_10
f000:CBD8		  retn
f000:CBD8 sub_FCB8E	  endp
f000:CBD8
f000:CBD9
f000:CBD9 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:CBD9
f000:CBD9
f000:CBD9 sub_FCBD9	  proc near				      ;	CODE XREF: sub_FCB8E+2Bp
f000:CBD9							      ;	sub_FCB8E+33p
f000:CBD9							      ;	sub_FCB8E+3Bp
f000:CBD9							      ;	sub_FCB8E+43p
f000:CBD9		  mov	  dx, ax
f000:CBDB		  mov	  ax, 0B800h
f000:CBDE		  mov	  es, ax			      ;	es = 0xb800
f000:CBE0		  mov	  al, dh
f000:CBE2		  shr	  al, 1
f000:CBE4		  shr	  al, 1
f000:CBE6		  shr	  al, 1
f000:CBE8		  shr	  al, 1
f000:CBEA		  and	  al, 0Fh
f000:CBEC		  add	  al, 30h ; '0'
f000:CBEE		  cmp	  al, 3Ah ; ':'
f000:CBF0		  js	  short	l0
f000:CBF2		  add	  al, 7
f000:CBF4
f000:CBF4 l0:							      ;	CODE XREF: sub_FCBD9+17j
f000:CBF4		  mov	  ah, 7
f000:CBF6		  mov	  es:[di], ax
f000:CBF9		  inc	  di
f000:CBFA		  inc	  di
f000:CBFB		  mov	  al, dh
f000:CBFD		  and	  al, 0Fh
f000:CBFF		  add	  al, 30h ; '0'
f000:CC01		  cmp	  al, 3Ah ; ':'
f000:CC03		  js	  short	l1
f000:CC05		  add	  al, 7
f000:CC07
f000:CC07 l1:							      ;	CODE XREF: sub_FCBD9+2Aj
f000:CC07		  mov	  es:[di], ax
f000:CC0A		  inc	  di
f000:CC0B		  inc	  di
f000:CC0C		  mov	  al, dl
f000:CC0E		  shr	  al, 1
f000:CC10		  shr	  al, 1
f000:CC12		  shr	  al, 1
f000:CC14		  shr	  al, 1
f000:CC16		  and	  al, 0Fh
f000:CC18		  add	  al, 30h ; '0'
f000:CC1A		  cmp	  al, 3Ah ; ':'
f000:CC1C		  js	  short	l2
f000:CC1E		  add	  al, 7
f000:CC20
f000:CC20 l2:							      ;	CODE XREF: sub_FCBD9+43j
f000:CC20		  mov	  es:[di], ax
f000:CC23		  inc	  di
f000:CC24		  inc	  di
f000:CC25		  mov	  al, dl
f000:CC27		  and	  al, 0Fh
f000:CC29		  add	  al, 30h ; '0'
f000:CC2B		  cmp	  al, 3Ah ; ':'
f000:CC2D		  js	  short	l3
f000:CC2F		  add	  al, 7
f000:CC31
f000:CC31 l3:							      ;	CODE XREF: sub_FCBD9+54j
f000:CC31		  mov	  es:[di], ax
f000:CC34		  inc	  di
f000:CC35		  inc	  di
f000:CC36		  mov	  ax, bp
f000:CC38		  mov	  es, ax
f000:CC3A		  retn
f000:CC3A sub_FCBD9	  endp
f000:CC3A
f000:CC3B
f000:CC3B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:CC3B
f000:CC3B ; print asciiz
f000:CC3B ;
f000:CC3B ; input:
f000:CC3B ;	    cs:si -> asciiz
f000:CC3B ;	0xb800:di -> destination
f000:CC3B
f000:CC3B print_asciiz	  proc near				      ;	CODE XREF: sub_FCB8E+Dp
f000:CC3B		  mov	  ax, 0B800h
f000:CC3E		  mov	  es, ax			      ;	es = 0xb800
f000:CC40		  mov	  ah, 7
f000:CC42
f000:CC42 loop:							      ;	CODE XREF: print_asciiz+14j
f000:CC42		  mov	  al, cs:[si]
f000:CC45		  or	  al, al
f000:CC47		  jz	  short	exit
f000:CC49		  mov	  es:[di], ax
f000:CC4C		  inc	  di
f000:CC4D		  inc	  di
f000:CC4E		  inc	  si
f000:CC4F		  jmp	  short	loop
f000:CC51 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CC51
f000:CC51 exit:							      ;	CODE XREF: print_asciiz+Cj
f000:CC51		  mov	  ax, bp
f000:CC53		  mov	  es, ax
f000:CC55		  retn
f000:CC55 print_asciiz	  endp
f000:CC55
f000:CC56 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CC56 ; START OF FUNCTION CHUNK FOR	reset
f000:CC56
f000:CC56 _reset_cont:						      ;	CODE XREF: reset-1519j
f000:CC56		  jmp	  reset_cont
f000:CC56 ; END	OF FUNCTION CHUNK FOR reset
f000:CC59
f000:CC59 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:CC59
f000:CC59
f000:CC59 int_13	  proc far				      ;	DATA XREF: f000:FF09o
f000:CC59
f000:CC59 ; FUNCTION CHUNK AT f000:CFB4	SIZE 00000076 BYTES
f000:CC59 ; FUNCTION CHUNK AT f000:D02B	SIZE 00000025 BYTES
f000:CC59 ; FUNCTION CHUNK AT f000:D051	SIZE 0000000A BYTES
f000:CC59 ; FUNCTION CHUNK AT f000:D05C	SIZE 0000000C BYTES
f000:CC59 ; FUNCTION CHUNK AT f000:D069	SIZE 0000000E BYTES
f000:CC59 ; FUNCTION CHUNK AT f000:D078	SIZE 00000074 BYTES
f000:CC59
f000:CC59		  call	  int_push_regs
f000:CC5C		  mov	  di, 0Ch
f000:CC5F		  nop
f000:CC60		  call	  check_valid_subfunction
f000:CC63		  jb	  short	error
f000:CC65		  push	  bx
f000:CC66		  mov	  bx, ds:p400.installed_hardware
f000:CC6A		  test	  bx, 100h			      ;	dma present ?
f000:CC6E		  pop	  bx
f000:CC6F		  jz	  short	no_dma
f000:CC71		  jmp	  word ptr cs:int_13_jmp_tbl_dma[di]
f000:CC76 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CC76
f000:CC76 no_dma:						      ;	CODE XREF: int_13+16j
f000:CC76		  jmp	  word ptr cs:int_13_jmp_tbl[di]
f000:CC76 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CC7B int_13_jmp_tbl:					      ;	DATA XREF: int_13:no_dmar
f000:CC7B		  dw offset int_13_00
f000:CC7D		  dw offset int_13_01
f000:CC7F		  dw offset int_13_02
f000:CC81		  dw offset int_13_03
f000:CC83		  dw offset int_13_04
f000:CC85		  dw offset int_13_05
f000:CC87 int_13_jmp_tbl_dma:					      ;	DATA XREF: int_13+18r
f000:CC87		  dw offset int_13_00
f000:CC89		  dw offset int_13_01
f000:CC8B		  dw offset int_13_02_dma
f000:CC8D		  dw offset int_13_03_dma
f000:CC8F		  dw offset int_13_04_dma
f000:CC91		  dw offset int_13_05_dma
f000:CC93 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CC93
f000:CC93 error:						      ;	CODE XREF: int_13+Aj
f000:CC93		  mov	  byte ptr ds:p400.diskette_last_status, 1
f000:CC98		  jmp	  exit
f000:CC9B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CC9B
f000:CC9B int_13_00:						      ;	CODE XREF: int_13+18j
f000:CC9B							      ;	int_13:no_dmaj
f000:CC9B							      ;	DATA XREF: int_13:int_13_jmp_tblo
f000:CC9B							      ;	int_13:int_13_jmp_tbl_dmao
f000:CC9B		  mov	  byte ptr ds:p400.diskette_last_status, 0
f000:CCA0		  and	  byte ptr ds:p400.diskette_recalibrate_status,	70h ; 'p'
f000:CCA5		  cli
f000:CCA6		  mov	  dl, ds:p400.diskette_motor_status
f000:CCAA		  mov	  al, 3
f000:CCAC		  test	  dl, 8
f000:CCAF		  jnz	  short	l0
f000:CCB1		  mov	  al, 2
f000:CCB3		  test	  dl, 4
f000:CCB6		  jnz	  short	l0
f000:CCB8		  mov	  al, 1
f000:CCBA		  test	  dl, 2
f000:CCBD		  jnz	  short	l0
f000:CCBF		  xor	  al, al
f000:CCC1
f000:CCC1 l0:							      ;	CODE XREF: int_13+56j
f000:CCC1							      ;	int_13+5Dj
f000:CCC1							      ;	int_13+64j
f000:CCC1		  mov	  cl, 4
f000:CCC3		  shl	  dl, cl
f000:CCC5		  and	  dl, 0F0h
f000:CCC8		  or	  al, dl
f000:CCCA		  or	  al, 8
f000:CCCC		  mov	  dx, 3F2h
f000:CCCF		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:CCCF							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:CCCF							      ;	2:   0=reset diskette controller; 1=enable controller
f000:CCCF							      ;	3:   1=enable diskette DMA and interrupts
f000:CCCF							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:CCCF							      ;
f000:CCD0		  or	  al, 4
f000:CCD2		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:CCD2							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:CCD2							      ;	2:   0=reset diskette controller; 1=enable controller
f000:CCD2							      ;	3:   1=enable diskette DMA and interrupts
f000:CCD2							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:CCD2							      ;
f000:CCD3		  sti
f000:CCD4		  call	  diskette_wait_until_op_finished
f000:CCD7		  call	  sub_FD360
f000:CCDA		  jb	  short	l4
f000:CCDC		  test	  ah, 8
f000:CCDF		  jz	  short	l1
f000:CCE1		  or	  byte ptr ds:p400.diskette_last_status, 20h
f000:CCE6		  jmp	  short	l4
f000:CCE8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CCE8
f000:CCE8 l1:							      ;	CODE XREF: int_13+86j
f000:CCE8		  mov	  al, 3
f000:CCEA		  call	  sub_FD1EB
f000:CCED		  jb	  short	l4
f000:CCEF		  xor	  bx, bx
f000:CCF1		  mov	  cx, 2
f000:CCF4		  mov	  ax, ds:p400.installed_hardware
f000:CCF7		  test	  ax, 100h			      ;	dma present?
f000:CCFA		  jz	  short	l2			      ;	no, jump
f000:CCFC		  call	  sub_FD3F7
f000:CCFF		  jmp	  short	l3
f000:CCFF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD01		  db  90h ; 
f000:CD02 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD02
f000:CD02 l2:							      ;	CODE XREF: int_13+A1j
f000:CD02		  call	  sub_FD3CA
f000:CD05
f000:CD05 l3:							      ;	CODE XREF: int_13+A6j
f000:CD05		  jb	  short	l4
f000:CD07		  xor	  ax, ax
f000:CD09		  mov	  ds:p400.diskette_last_status,	al
f000:CD0C		  clc
f000:CD0D		  jmp	  exit
f000:CD10 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD10
f000:CD10 l4:							      ;	CODE XREF: int_13+81j
f000:CD10							      ;	int_13+8Dj
f000:CD10							      ;	int_13+94j
f000:CD10							      ;	int_13:l3j
f000:CD10		  xor	  al, al
f000:CD12		  mov	  ah, ds:p400.diskette_last_status
f000:CD16		  stc
f000:CD17		  jmp	  exit
f000:CD1A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD1A
f000:CD1A int_13_01:						      ;	CODE XREF: int_13+18j
f000:CD1A							      ;	int_13:no_dmaj
f000:CD1A							      ;	DATA XREF: int_13+24o
f000:CD1A							      ;	int_13+30o
f000:CD1A		  mov	  ah, ds:p400.diskette_last_status
f000:CD1E		  mov	  al, ah
f000:CD20		  cmp	  ah, 0
f000:CD23		  jz	  short	l5
f000:CD25		  stc
f000:CD26		  jmp	  exit
f000:CD29 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD29
f000:CD29 l5:							      ;	CODE XREF: int_13+CAj
f000:CD29		  clc
f000:CD2A		  jmp	  exit
f000:CD2D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD2D
f000:CD2D int_13_02:						      ;	CODE XREF: int_13:no_dmaj
f000:CD2D							      ;	DATA XREF: int_13+26o
f000:CD2D		  mov	  ah, 46h ; 'F'
f000:CD2F		  call	  diskette_no_dma_functions
f000:CD32		  mov	  al, 0E6h ; 'æ'
f000:CD34		  jmp	  short	l6
f000:CD36 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD36
f000:CD36 int_13_03:						      ;	CODE XREF: int_13:no_dmaj
f000:CD36							      ;	DATA XREF: int_13+28o
f000:CD36		  mov	  ah, 4Ah ; 'J'
f000:CD38		  call	  diskette_no_dma_functions
f000:CD3B		  mov	  al, 0C5h ; 'Å'
f000:CD3D		  jmp	  short	l6
f000:CD3F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD3F
f000:CD3F int_13_04:						      ;	CODE XREF: int_13:no_dmaj
f000:CD3F							      ;	DATA XREF: int_13+2Ao
f000:CD3F		  mov	  ah, 42h ; 'B'
f000:CD41		  call	  diskette_no_dma_functions
f000:CD44		  mov	  al, 0E6h ; 'æ'
f000:CD46
f000:CD46 l6:							      ;	CODE XREF: int_13+DBj
f000:CD46							      ;	int_13+E4j
f000:CD46		  jnb	  short	l7
f000:CD48		  jmp	  short	l11
f000:CD48 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD4A		  db  90h ; 
f000:CD4B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD4B
f000:CD4B l7:							      ;	CODE XREF: int_13:l6j
f000:CD4B		  push	  cx
f000:CD4C		  cmp	  dl, 4
f000:CD4F		  jb	  short	l9
f000:CD51		  mov	  byte ptr ds:p400.diskette_last_status, 1
f000:CD56
f000:CD56 l8:							      ;	CODE XREF: int_13+10Bj
f000:CD56							      ;	int_13+110j
f000:CD56							      ;	int_13+121j
f000:CD56							      ;	int_13+128j
f000:CD56		  jmp	  short	l10
f000:CD56 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD58		  db  90h ; 
f000:CD59 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CD59
f000:CD59 l9:							      ;	CODE XREF: int_13+F6j
f000:CD59		  mov	  byte ptr ds:p400.diskette_last_status, 0
f000:CD5E		  call	  get_diskette_params
f000:CD61		  call	  sub_FD297
f000:CD64		  jb	  short	l8
f000:CD66		  call	  sub_FD1EB
f000:CD69		  jb	  short	l8
f000:CD6B		  mov	  al, dl
f000:CD6D		  and	  al, 3
f000:CD6F		  push	  dx
f000:CD70		  shl	  dh, 1
f000:CD72		  shl	  dh, 1
f000:CD74		  or	  al, dh
f000:CD76		  pop	  dx
f000:CD77		  call	  sub_FD1EB
f000:CD7A		  jb	  short	l8
f000:CD7C		  mov	  al, ch
f000:CD7E		  call	  sub_FD1EB
f000:CD81		  jb	  short	l8
f000:CD83		  mov	  al, dh
f000:CD85		  call	  sub_FD1EB
f000:CD88		  jb	  short	l10
f000:CD8A		  mov	  al, cl
f000:CD8C		  call	  sub_FD1EB
f000:CD8F		  jb	  short	l10
f000:CD91		  mov	  bx, 3
f000:CD94		  mov	  cx, 4
f000:CD97		  call	  sub_FD3CA
f000:CD9A		  jb	  short	l10
f000:CD9C		  call	  diskette_wait_until_op_finished
f000:CD9F		  jb	  short	l10
f000:CDA1		  mov	  cx, 7
f000:CDA4		  call	  sub_FD243
f000:CDA7		  jb	  short	l10
f000:CDA9		  pop	  cx
f000:CDAA		  test	  ah, 0C0h
f000:CDAD		  jz	  short	l11
f000:CDAF		  call	  sub_FD387
f000:CDB2		  jmp	  short	l11
f000:CDB4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDB4
f000:CDB4 l10:							      ;	CODE XREF: int_13:l8j
f000:CDB4							      ;	int_13+12Fj
f000:CDB4							      ;	int_13+136j
f000:CDB4							      ;	int_13+141j
f000:CDB4							      ;	int_13+146j
f000:CDB4							      ;	int_13+14Ej
f000:CDB4		  pop	  cx
f000:CDB5
f000:CDB5 l11:							      ;	CODE XREF: int_13+EFj
f000:CDB5							      ;	int_13+154j
f000:CDB5							      ;	int_13+159j
f000:CDB5		  xor	  al, al
f000:CDB7		  mov	  ah, ds:p400.diskette_last_status
f000:CDBB		  cmp	  ah, 0
f000:CDBE		  jz	  short	l12
f000:CDC0		  stc
f000:CDC1		  jmp	  exit
f000:CDC4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDC4
f000:CDC4 l12:							      ;	CODE XREF: int_13+165j
f000:CDC4		  clc
f000:CDC5		  jmp	  exit
f000:CDC8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDC8
f000:CDC8 int_13_02_dma:					      ;	CODE XREF: int_13+18j
f000:CDC8							      ;	int_13:no_dmaj
f000:CDC8							      ;	DATA XREF: int_13+32o
f000:CDC8		  push	  cx
f000:CDC9		  push	  ax
f000:CDCA		  call	  diskette_dma_functions
f000:CDCD		  push	  ax
f000:CDCE		  mov	  al, 0E6h ; 'æ'
f000:CDD0		  jmp	  short	l13
f000:CDD0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDD2		  db  90h ; 
f000:CDD3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDD3
f000:CDD3 int_13_03_dma:					      ;	CODE XREF: int_13+18j
f000:CDD3							      ;	int_13:no_dmaj
f000:CDD3							      ;	DATA XREF: int_13+34o
f000:CDD3		  push	  cx
f000:CDD4		  push	  ax
f000:CDD5		  call	  diskette_dma_functions
f000:CDD8		  push	  ax
f000:CDD9		  mov	  al, 0C5h ; 'Å'
f000:CDDB		  jmp	  short	l13
f000:CDDB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDDD		  db  90h ; 
f000:CDDE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDDE
f000:CDDE int_13_04_dma:					      ;	CODE XREF: int_13+18j
f000:CDDE							      ;	int_13:no_dmaj
f000:CDDE							      ;	DATA XREF: int_13+36o
f000:CDDE		  push	  cx
f000:CDDF		  push	  ax
f000:CDE0		  call	  diskette_dma_functions
f000:CDE3		  push	  ax
f000:CDE4		  mov	  al, 0E6h ; 'æ'
f000:CDE6
f000:CDE6 l13:							      ;	CODE XREF: int_13+177j
f000:CDE6							      ;	int_13+182j
f000:CDE6		  jnb	  short	l14
f000:CDE8		  jmp	  l38
f000:CDEB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDEB
f000:CDEB l14:							      ;	CODE XREF: int_13:l13j
f000:CDEB		  push	  es
f000:CDEC		  push	  bx
f000:CDED		  cmp	  dl, 4
f000:CDF0		  jb	  short	l16
f000:CDF2		  mov	  byte ptr ds:p400.diskette_last_status, 1
f000:CDF7		  jmp	  short	l15
f000:CDF7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDF9		  db  90h ; 
f000:CDFA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDFA
f000:CDFA l15:							      ;	CODE XREF: int_13+19Ej
f000:CDFA							      ;	int_13+1AFj
f000:CDFA							      ;	int_13+1B4j
f000:CDFA							      ;	int_13+1C5j
f000:CDFA							      ;	int_13+1CCj
f000:CDFA							      ;	int_13+1D3j ...
f000:CDFA		  jmp	  l37
f000:CDFD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CDFD
f000:CDFD l16:							      ;	CODE XREF: int_13+197j
f000:CDFD		  mov	  byte ptr ds:p400.diskette_last_status, 0
f000:CE02		  call	  get_diskette_params
f000:CE05		  call	  sub_FD297
f000:CE08		  jb	  short	l15
f000:CE0A		  call	  sub_FD1EB
f000:CE0D		  jb	  short	l15
f000:CE0F		  mov	  al, dl
f000:CE11		  and	  al, 3
f000:CE13		  push	  dx
f000:CE14		  shl	  dh, 1
f000:CE16		  shl	  dh, 1
f000:CE18		  or	  al, dh
f000:CE1A		  pop	  dx
f000:CE1B		  call	  sub_FD1EB
f000:CE1E		  jb	  short	l15
f000:CE20		  mov	  al, ch
f000:CE22		  call	  sub_FD1EB
f000:CE25		  jb	  short	l15
f000:CE27		  mov	  al, dh
f000:CE29		  call	  sub_FD1EB
f000:CE2C		  jb	  short	l15
f000:CE2E		  mov	  al, cl
f000:CE30		  call	  sub_FD1EB
f000:CE33		  jb	  short	l15
f000:CE35		  mov	  bx, 3
f000:CE38		  mov	  cx, 4
f000:CE3B		  call	  sub_FD3DC
f000:CE3E		  jb	  short	l15
f000:CE40		  mov	  al, ds:p400.diskette_motor_status
f000:CE43		  mov	  cl, 4
f000:CE45		  shl	  al, cl
f000:CE47		  or	  al, 4Ch
f000:CE49		  or	  al, dl
f000:CE4B		  mov	  dl, al
f000:CE4D		  pop	  bx
f000:CE4E		  pop	  es
f000:CE4F		  pop	  cx
f000:CE50		  pop	  ax
f000:CE51		  push	  dx
f000:CE52		  mov	  di, bx
f000:CE54		  mov	  si, bx
f000:CE56		  mov	  bh, 20h ; ' '
f000:CE58		  cmp	  ah, 4
f000:CE5B		  jnz	  short	l17
f000:CE5D		  jmp	  short	l27
f000:CE5D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE5F		  db  90h ; 
f000:CE60 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE60
f000:CE60 l17:							      ;	CODE XREF: int_13+202j
f000:CE60		  cmp	  ah, 3
f000:CE63		  jz	  short	l22
f000:CE65		  mov	  al, dh
f000:CE67		  mov	  dx, 3F5h
f000:CE6A		  cli
f000:CE6B		  out	  dx, al			      ;	Floppy:	FDC command/data register.
f000:CE6C		  mov	  dx, 3F4h
f000:CE6F		  mov	  ah, 80h ; '€'
f000:CE71		  jmp	  short	l19
f000:CE71 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE73		  db  90h ; 
f000:CE74 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE74
f000:CE74 l18:							      ;	CODE XREF: int_13+22Bj
f000:CE74		  loop	  l20
f000:CE76		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:CE7B		  jmp	  l35
f000:CE7E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE7E
f000:CE7E l19:							      ;	CODE XREF: int_13+218j
f000:CE7E							      ;	int_13+236j
f000:CE7E		  push	  cx
f000:CE7F		  xor	  cx, cx
f000:CE81
f000:CE81 l20:							      ;	CODE XREF: int_13:l18j
f000:CE81		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:CE81							      ;	0-3: diskette busy
f000:CE81							      ;	4: 1=cntrlr busy
f000:CE81							      ;	5: 1=non-DMA mode
f000:CE81							      ;	6: Data	dir: 1=cntrlr to CPU
f000:CE81							      ;	7: 1=OK	to snd/rcv cmd or data
f000:CE82		  test	  al, ah
f000:CE84		  jz	  short	l18
f000:CE86		  test	  al, bh
f000:CE88		  jz	  short	l21
f000:CE8A		  inc	  dx
f000:CE8B		  in	  al, dx			      ;	Floppy:	FDC command/data register.
f000:CE8C		  stosb
f000:CE8D		  pop	  cx
f000:CE8E		  dec	  dx
f000:CE8F		  loop	  l19
f000:CE91		  jmp	  short	l34
f000:CE91 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE93		  db  90h ; 
f000:CE94 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE94
f000:CE94 l21:							      ;	CODE XREF: int_13+22Fj
f000:CE94		  pop	  cx
f000:CE95		  jmp	  short	l34
f000:CE95 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE97		  db  90h ; 
f000:CE98 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CE98
f000:CE98 l22:							      ;	CODE XREF: int_13+20Aj
f000:CE98		  mov	  al, dh
f000:CE9A		  mov	  dx, 3F5h
f000:CE9D		  cli
f000:CE9E		  out	  dx, al			      ;	Floppy:	FDC command/data register.
f000:CE9F		  dec	  dx
f000:CEA0		  mov	  ah, 80h ; '€'
f000:CEA2		  jmp	  short	l24
f000:CEA2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEA4		  db  90h ; 
f000:CEA5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEA5
f000:CEA5 l23:							      ;	CODE XREF: int_13+25Cj
f000:CEA5		  loop	  l25
f000:CEA7		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:CEAC		  jmp	  short	l35
f000:CEAC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEAE		  db  90h ; 
f000:CEAF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEAF
f000:CEAF l24:							      ;	CODE XREF: int_13+249j
f000:CEAF							      ;	int_13+268j
f000:CEAF		  push	  cx
f000:CEB0		  xor	  cx, cx
f000:CEB2
f000:CEB2 l25:							      ;	CODE XREF: int_13:l23j
f000:CEB2		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:CEB2							      ;	0-3: diskette busy
f000:CEB2							      ;	4: 1=cntrlr busy
f000:CEB2							      ;	5: 1=non-DMA mode
f000:CEB2							      ;	6: Data	dir: 1=cntrlr to CPU
f000:CEB2							      ;	7: 1=OK	to snd/rcv cmd or data
f000:CEB3		  test	  al, ah
f000:CEB5		  jz	  short	l23
f000:CEB7		  test	  al, bh
f000:CEB9		  jz	  short	l26
f000:CEBB		  lods	  byte ptr es:[si]
f000:CEBD		  inc	  dx
f000:CEBE		  out	  dx, al			      ;	Floppy:	FDC command/data register.
f000:CEBF		  pop	  cx
f000:CEC0		  dec	  dx
f000:CEC1		  loop	  l24
f000:CEC3		  jmp	  short	l34
f000:CEC3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEC5		  db  90h ; 
f000:CEC6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEC6
f000:CEC6 l26:							      ;	CODE XREF: int_13+260j
f000:CEC6		  pop	  cx
f000:CEC7		  jmp	  short	l34
f000:CEC7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEC9		  db  90h ; 
f000:CECA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CECA
f000:CECA l27:							      ;	CODE XREF: int_13+204j
f000:CECA		  mov	  al, dh
f000:CECC		  mov	  dx, 3F5h
f000:CECF		  cli
f000:CED0		  out	  dx, al			      ;	Floppy:	FDC command/data register.
f000:CED1		  mov	  ah, 80h ; '€'
f000:CED3		  dec	  dx
f000:CED4		  push	  cx
f000:CED5		  xor	  cx, cx
f000:CED7
f000:CED7 l28:							      ;	CODE XREF: int_13+283j
f000:CED7		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:CED7							      ;	0-3: diskette busy
f000:CED7							      ;	4: 1=cntrlr busy
f000:CED7							      ;	5: 1=non-DMA mode
f000:CED7							      ;	6: Data	dir: 1=cntrlr to CPU
f000:CED7							      ;	7: 1=OK	to snd/rcv cmd or data
f000:CED8		  test	  al, 80h
f000:CEDA		  jnz	  short	l29
f000:CEDC		  loop	  l28
f000:CEDE		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:CEE3		  jmp	  short	l35
f000:CEE3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEE5		  db  90h ; 
f000:CEE6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEE6
f000:CEE6 l29:							      ;	CODE XREF: int_13+281j
f000:CEE6		  test	  al, 20h
f000:CEE8		  jnz	  short	l32
f000:CEEA		  jmp	  short	l33
f000:CEEA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEEC		  db  90h ; 
f000:CEED ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEED
f000:CEED l30:							      ;	CODE XREF: int_13+2AAj
f000:CEED		  push	  cx
f000:CEEE		  xor	  cx, cx
f000:CEF0
f000:CEF0 l31:							      ;	CODE XREF: int_13+29Cj
f000:CEF0		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:CEF0							      ;	0-3: diskette busy
f000:CEF0							      ;	4: 1=cntrlr busy
f000:CEF0							      ;	5: 1=non-DMA mode
f000:CEF0							      ;	6: Data	dir: 1=cntrlr to CPU
f000:CEF0							      ;	7: 1=OK	to snd/rcv cmd or data
f000:CEF1		  test	  al, 80h
f000:CEF3		  jnz	  short	l32
f000:CEF5		  loop	  l31
f000:CEF7		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:CEFC		  jmp	  short	l35
f000:CEFC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEFE		  db  90h ; 
f000:CEFF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CEFF
f000:CEFF l32:							      ;	CODE XREF: int_13+28Fj
f000:CEFF							      ;	int_13+29Aj
f000:CEFF		  inc	  dx
f000:CF00		  in	  al, dx			      ;	Floppy:	FDC command/data register.
f000:CF01		  pop	  cx
f000:CF02		  dec	  dx
f000:CF03		  loop	  l30
f000:CF05		  jmp	  short	l34
f000:CF05 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF07		  db  90h ; 
f000:CF08 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF08
f000:CF08 l33:							      ;	CODE XREF: int_13+291j
f000:CF08		  pop	  cx
f000:CF09
f000:CF09 l34:							      ;	CODE XREF: int_13+238j
f000:CF09							      ;	int_13+23Cj
f000:CF09							      ;	int_13+26Aj
f000:CF09							      ;	int_13+26Ej
f000:CF09							      ;	int_13+2ACj
f000:CF09		  pop	  ax
f000:CF0A		  mov	  dx, 3F2h
f000:CF0D		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:CF0D							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:CF0D							      ;	2:   0=reset diskette controller; 1=enable controller
f000:CF0D							      ;	3:   1=enable diskette DMA and interrupts
f000:CF0D							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:CF0D							      ;
f000:CF0E		  and	  al, 0BFh
f000:CF10		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:CF10							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:CF10							      ;	2:   0=reset diskette controller; 1=enable controller
f000:CF10							      ;	3:   1=enable diskette DMA and interrupts
f000:CF10							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:CF10							      ;
f000:CF11		  sti
f000:CF12		  call	  diskette_wait_until_ready
f000:CF15		  jb	  short	l36
f000:CF17		  mov	  cx, 7
f000:CF1A		  call	  sub_FD243
f000:CF1D		  jb	  short	l36
f000:CF1F		  pop	  cx
f000:CF20		  test	  ah, 0C0h
f000:CF23		  jz	  short	l39
f000:CF25		  call	  sub_FD387
f000:CF28		  jmp	  short	l39
f000:CF28 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF2A		  db  90h ; 
f000:CF2B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF2B
f000:CF2B l35:							      ;	CODE XREF: int_13+222j
f000:CF2B							      ;	int_13+253j
f000:CF2B							      ;	int_13+28Aj
f000:CF2B							      ;	int_13+2A3j
f000:CF2B		  pop	  cx
f000:CF2C		  pop	  dx
f000:CF2D
f000:CF2D l36:							      ;	CODE XREF: int_13+2BCj
f000:CF2D							      ;	int_13+2C4j
f000:CF2D		  pop	  cx
f000:CF2E		  jmp	  short	l39
f000:CF2E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF30		  db  90h ; 
f000:CF31 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF31
f000:CF31 l37:							      ;	CODE XREF: int_13:l15j
f000:CF31		  pop	  bx
f000:CF32		  pop	  es
f000:CF33		  pop	  ax
f000:CF34		  pop	  ax
f000:CF35		  pop	  cx
f000:CF36		  jmp	  short	l39
f000:CF36 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF38		  db  90h ; 
f000:CF39 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF39
f000:CF39 l38:							      ;	CODE XREF: int_13+18Fj
f000:CF39		  pop	  ax
f000:CF3A		  pop	  ax
f000:CF3B		  pop	  cx
f000:CF3C
f000:CF3C l39:							      ;	CODE XREF: int_13+2CAj
f000:CF3C							      ;	int_13+2CFj
f000:CF3C							      ;	int_13+2D5j
f000:CF3C							      ;	int_13+2DDj
f000:CF3C		  xor	  al, al
f000:CF3E		  mov	  ah, ds:p400.diskette_last_status
f000:CF42		  cmp	  ah, 0
f000:CF45		  jz	  short	ok
f000:CF47		  stc
f000:CF48		  jmp	  exit
f000:CF4B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF4B
f000:CF4B ok:							      ;	CODE XREF: int_13+2ECj
f000:CF4B		  clc
f000:CF4C		  jmp	  exit
f000:CF4C int_13	  endp
f000:CF4C
f000:CF4F
f000:CF4F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:CF4F
f000:CF4F ; Attributes:	bp-based frame
f000:CF4F
f000:CF4F diskette_dma_functions proc near			      ;	CODE XREF: int_13+171p
f000:CF4F							      ;	int_13+17Cp
f000:CF4F							      ;	int_13+187p
f000:CF4F							      ;	int_13+36Dp
f000:CF4F		  push	  cx
f000:CF50		  push	  dx
f000:CF51		  push	  es
f000:CF52		  push	  bx
f000:CF53		  push	  ax
f000:CF54		  mov	  al, 6
f000:CF56		  out	  0Fh, al			      ;	DMA controller,	8237A-5.
f000:CF56							      ;	master clear. Clear or mask any	or
f000:CF56							      ;	all of the channels. Bits:
f000:CF56							      ;	0: 1=mask channel 0; 0=enable
f000:CF56							      ;	1: 1=mask channel 1;
f000:CF56							      ;	2: 1=mask channel 2;
f000:CF56							      ;	3: 1=mask channel 3;
f000:CF58		  mov	  bp, sp
f000:CF5A		  call	  get_diskette_params
f000:CF5D		  mov	  cl, es:[si+3]
f000:CF61		  mov	  dx, 80h ; '€'
f000:CF64		  shl	  dx, cl
f000:CF66		  mov	  ax, [bp+0]
f000:CF69		  xor	  ah, ah
f000:CF6B		  mul	  dx
f000:CF6D		  cmp	  dx, 0
f000:CF70		  jnz	  short	loc_FCFA8
f000:CF72		  mov	  dx, bx
f000:CF74		  add	  bx, ax
f000:CF76		  jb	  short	loc_FCF7C
f000:CF78		  clc
f000:CF79		  jmp	  short	loc_FCFAE
f000:CF79 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF7B		  db  90h ; 
f000:CF7C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CF7C
f000:CF7C loc_FCF7C:						      ;	CODE XREF: diskette_dma_functions+27j
f000:CF7C		  mov	  bx, dx
f000:CF7E		  and	  bx, 0Fh
f000:CF82		  add	  bx, ax
f000:CF84		  jb	  short	loc_FCFAE
f000:CF86		  pop	  cx
f000:CF87		  pop	  cx
f000:CF88		  pop	  es
f000:CF89		  mov	  bx, dx
f000:CF8B		  mov	  cl, 4
f000:CF8D		  shr	  bx, cl
f000:CF8F		  mov	  cx, es
f000:CF91		  add	  cx, bx
f000:CF93		  jb	  short	loc_FCFA1
f000:CF95		  mov	  es, cx
f000:CF97		  mov	  bx, dx
f000:CF99		  and	  bx, 0Fh
f000:CF9D		  clc
f000:CF9E
f000:CF9E loc_FCF9E:						      ;	CODE XREF: diskette_dma_functions+57j
f000:CF9E		  pop	  dx
f000:CF9F		  pop	  cx
f000:CFA0		  retn
f000:CFA1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CFA1
f000:CFA1 loc_FCFA1:						      ;	CODE XREF: diskette_dma_functions+44j
f000:CFA1		  mov	  byte ptr ds:p400.diskette_last_status, 9
f000:CFA6		  jmp	  short	loc_FCF9E
f000:CFA8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CFA8
f000:CFA8 loc_FCFA8:						      ;	CODE XREF: diskette_dma_functions+21j
f000:CFA8		  stc
f000:CFA9		  mov	  byte ptr ds:p400.diskette_last_status, 9
f000:CFAE
f000:CFAE loc_FCFAE:						      ;	CODE XREF: diskette_dma_functions+2Aj
f000:CFAE							      ;	diskette_dma_functions+35j
f000:CFAE		  pop	  bx
f000:CFAF		  pop	  bx
f000:CFB0		  pop	  es
f000:CFB1		  pop	  dx
f000:CFB2		  pop	  cx
f000:CFB3		  retn
f000:CFB3 diskette_dma_functions endp
f000:CFB3
f000:CFB4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CFB4 ; START OF FUNCTION CHUNK FOR	int_13
f000:CFB4
f000:CFB4 int_13_05_dma:					      ;	CODE XREF: int_13+18j
f000:CFB4							      ;	int_13:no_dmaj
f000:CFB4							      ;	DATA XREF: int_13+38o
f000:CFB4		  cmp	  dl, 4
f000:CFB7		  jb	  short	l40
f000:CFB9		  mov	  byte ptr ds:p400.diskette_last_status, 1
f000:CFBE		  jmp	  l46
f000:CFC1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CFC1
f000:CFC1 l40:							      ;	CODE XREF: int_13+35Ej
f000:CFC1		  mov	  byte ptr ds:p400.diskette_last_status, 0
f000:CFC6		  call	  diskette_dma_functions
f000:CFC9		  push	  ax
f000:CFCA		  push	  es
f000:CFCB		  push	  bx
f000:CFCC		  jnb	  short	l42
f000:CFCE
f000:CFCE l41:							      ;	CODE XREF: int_13+37Ej
f000:CFCE							      ;	int_13+385j
f000:CFCE		  jmp	  l47
f000:CFD1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:CFD1
f000:CFD1 l42:							      ;	CODE XREF: int_13+373j
f000:CFD1		  call	  get_diskette_params
f000:CFD4		  call	  sub_FD297
f000:CFD7		  jb	  short	l41
f000:CFD9		  mov	  al, 4Dh ; 'M'
f000:CFDB		  call	  sub_FD1EB
f000:CFDE		  jb	  short	l41
f000:CFE0		  mov	  al, dl
f000:CFE2		  and	  al, 3
f000:CFE4		  shl	  dh, 1
f000:CFE6		  shl	  dh, 1
f000:CFE8		  or	  al, dh
f000:CFEA		  call	  sub_FD1EB
f000:CFED		  jb	  short	l47
f000:CFEF		  mov	  bx, 3
f000:CFF2		  mov	  cx, 2
f000:CFF5		  call	  sub_FD3CA
f000:CFF8		  jb	  short	l47
f000:CFFA		  dec	  bx
f000:CFFB		  mov	  dl, es:[bx+si]
f000:CFFE		  cli
f000:CFFF		  mov	  bx, 7
f000:D002		  call	  sub_FD3DC
f000:D005		  jb	  short	l47
f000:D007		  pop	  bx
f000:D008		  pop	  es
f000:D009		  pop	  cx
f000:D00A		  mov	  al, 4
f000:D00C		  mul	  dl
f000:D00E		  mov	  cx, ax
f000:D010		  mov	  al, dh
f000:D012		  mov	  ah, 80h ; '€'
f000:D014		  mov	  dx, 3F5h
f000:D017		  out	  dx, al			      ;	Floppy:	FDC command/data register.
f000:D018
f000:D018 l43:							      ;	CODE XREF: int_13+3D9j
f000:D018		  push	  cx
f000:D019		  xor	  cx, cx
f000:D01B		  dec	  dx
f000:D01C
f000:D01C l44:							      ;	CODE XREF: int_13+3C8j
f000:D01C		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D01C							      ;	0-3: diskette busy
f000:D01C							      ;	4: 1=cntrlr busy
f000:D01C							      ;	5: 1=non-DMA mode
f000:D01C							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D01C							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D01D		  test	  al, ah
f000:D01F		  jnz	  short	l45
f000:D021		  loop	  l44
f000:D023		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:D028		  jmp	  short	l48
f000:D028 ; END	OF FUNCTION CHUNK FOR int_13
f000:D028 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D02A		  db  90h ; 
f000:D02B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D02B ; START OF FUNCTION CHUNK FOR	int_13
f000:D02B
f000:D02B l45:							      ;	CODE XREF: int_13+3C6j
f000:D02B		  mov	  al, es:[bx]
f000:D02E		  inc	  dx
f000:D02F		  out	  dx, al			      ;	Floppy:	FDC command/data register.
f000:D030		  inc	  bx
f000:D031		  pop	  cx
f000:D032		  loop	  l43
f000:D034		  call	  diskette_wait_until_ready
f000:D037		  mov	  cx, 7
f000:D03A		  call	  sub_FD243
f000:D03D		  jb	  short	l49
f000:D03F		  test	  ah, 0C0h
f000:D042		  jz	  short	exit_ok
f000:D044		  call	  sub_FD387
f000:D047		  jmp	  short	l49
f000:D049 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D049
f000:D049 l46:							      ;	CODE XREF: int_13+365j
f000:D049		  mov	  ah, ds:p400.diskette_last_status
f000:D04D		  clc
f000:D04E		  jmp	  short	exit
f000:D04E ; END	OF FUNCTION CHUNK FOR int_13
f000:D04E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D050		  db  90h ; 
f000:D051 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D051 ; START OF FUNCTION CHUNK FOR	int_13
f000:D051
f000:D051 l47:							      ;	CODE XREF: int_13:l41j
f000:D051							      ;	int_13+394j
f000:D051							      ;	int_13+39Fj
f000:D051							      ;	int_13+3ACj
f000:D051		  pop	  bx
f000:D052		  pop	  es
f000:D053
f000:D053 l48:							      ;	CODE XREF: int_13+3CFj
f000:D053		  pop	  ax
f000:D054
f000:D054 l49:							      ;	CODE XREF: int_13+3E4j
f000:D054							      ;	int_13+3EEj
f000:D054		  mov	  ah, ds:p400.diskette_last_status
f000:D058		  stc
f000:D059		  jmp	  short	exit
f000:D059 ; END	OF FUNCTION CHUNK FOR int_13
f000:D059 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D05B		  db  90h ; 
f000:D05C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D05C ; START OF FUNCTION CHUNK FOR	int_13
f000:D05C
f000:D05C int_13_05:						      ;	CODE XREF: int_13:no_dmaj
f000:D05C							      ;	DATA XREF: int_13+2Co
f000:D05C		  cmp	  dl, 4
f000:D05F		  jb	  short	l50
f000:D061		  mov	  byte ptr ds:p400.diskette_last_status, 1
f000:D066		  jmp	  short	exit_ok
f000:D066 ; END	OF FUNCTION CHUNK FOR int_13
f000:D066 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D068		  db  90h ; 
f000:D069 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D069 ; START OF FUNCTION CHUNK FOR	int_13
f000:D069
f000:D069 l50:							      ;	CODE XREF: int_13+406j
f000:D069		  mov	  byte ptr ds:p400.diskette_last_status, 0
f000:D06E		  mov	  ah, 4Ah ; 'J'
f000:D070		  call	  diskette_no_dma_functions
f000:D073		  jnb	  short	l51
f000:D075		  jmp	  short	exit_error
f000:D075 ; END	OF FUNCTION CHUNK FOR int_13
f000:D075 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D077		  db  90h ; 
f000:D078 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D078 ; START OF FUNCTION CHUNK FOR	int_13
f000:D078
f000:D078 l51:							      ;	CODE XREF: int_13+41Aj
f000:D078		  call	  get_diskette_params
f000:D07B		  call	  sub_FD297
f000:D07E		  jb	  short	exit_error
f000:D080		  mov	  al, 4Dh ; 'M'
f000:D082		  call	  sub_FD1EB
f000:D085		  jb	  short	exit_error
f000:D087		  mov	  al, dl
f000:D089		  and	  al, 3
f000:D08B		  shl	  dh, 1
f000:D08D		  shl	  dh, 1
f000:D08F		  or	  al, dh
f000:D091		  call	  sub_FD1EB
f000:D094		  jb	  short	exit_error
f000:D096		  mov	  bx, 3
f000:D099		  mov	  cx, 2
f000:D09C		  call	  sub_FD3CA
f000:D09F		  jb	  short	exit_error
f000:D0A1		  mov	  bx, 7
f000:D0A4		  call	  sub_FD3CA
f000:D0A7		  jb	  short	exit_error
f000:D0A9		  call	  diskette_wait_until_op_finished
f000:D0AC		  jb	  short	exit_error
f000:D0AE		  mov	  cx, 7
f000:D0B1		  call	  sub_FD243
f000:D0B4		  jb	  short	exit_error
f000:D0B6		  test	  ah, 0C0h
f000:D0B9		  jz	  short	exit_ok
f000:D0BB		  call	  sub_FD387
f000:D0BE		  jmp	  short	exit_error
f000:D0C0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D0C0
f000:D0C0 exit_ok:						      ;	CODE XREF: int_13+3E9j
f000:D0C0							      ;	int_13+40Dj
f000:D0C0							      ;	int_13+460j
f000:D0C0		  mov	  ah, ds:p400.diskette_last_status
f000:D0C4		  clc
f000:D0C5		  jmp	  short	exit
f000:D0C7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D0C7
f000:D0C7 exit_error:						      ;	CODE XREF: int_13+41Cj
f000:D0C7							      ;	int_13+425j
f000:D0C7							      ;	int_13+42Cj
f000:D0C7							      ;	int_13+43Bj
f000:D0C7							      ;	int_13+446j
f000:D0C7							      ;	int_13+44Ej ...
f000:D0C7		  mov	  ah, ds:p400.diskette_last_status
f000:D0CB		  stc
f000:D0CC
f000:D0CC exit:							      ;	CODE XREF: int_13+3Fj
f000:D0CC							      ;	int_13+B4j
f000:D0CC							      ;	int_13+BEj
f000:D0CC							      ;	int_13+CDj
f000:D0CC							      ;	int_13+D1j
f000:D0CC							      ;	int_13+168j ...
f000:D0CC		  pushf
f000:D0CD		  push	  ax
f000:D0CE		  call	  get_diskette_params
f000:D0D1		  mov	  al, es:[si+2]
f000:D0D5		  cli
f000:D0D6		  mov	  ds:p400.diskette_motor_off_timeout, al
f000:D0D9		  sti
f000:D0DA		  pop	  ax
f000:D0DB		  and	  byte ptr ds:p400.diskette_recalibrate_status,	7Fh
f000:D0E0		  popf
f000:D0E1		  pop	  es
f000:D0E2		  pop	  ds
f000:D0E3		  pop	  bp
f000:D0E4		  pop	  di
f000:D0E5		  pop	  si
f000:D0E6		  pop	  dx
f000:D0E7		  pop	  cx
f000:D0E8		  pop	  bx
f000:D0E9		  retf	  2
f000:D0E9 ; END	OF FUNCTION CHUNK FOR int_13
f000:D0EC
f000:D0EC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D0EC
f000:D0EC ; this interrupt is generated	by the floppy disk controller on
f000:D0EC ; completion of an operation
f000:D0EC
f000:D0EC int_0e	  proc far				      ;	DATA XREF: f000:FEFFo
f000:D0EC		  push	  ax
f000:D0ED		  push	  dx
f000:D0EE		  push	  ds
f000:D0EF		  mov	  ax, 40h ; '@'
f000:D0F2		  mov	  ds, ax			      ;	ds = 0x40
f000:D0F4		  or	  byte ptr ds:p400.diskette_recalibrate_status,	80h ; signal that interrupt was	triggered
f000:D0F9		  mov	  al, 20h ; ' '
f000:D0FB		  mov	  dx, 20h ; ' '
f000:D0FE		  out	  dx, al			      ;	Interrupt controller, 8259A.
f000:D0FF		  pop	  ds
f000:D100		  pop	  dx
f000:D101		  pop	  ax
f000:D102		  iret
f000:D102 int_0e	  endp
f000:D102
f000:D103
f000:D103 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D103
f000:D103
f000:D103 diskette_wait_until_op_finished proc near		      ;	CODE XREF: int_13+7Bp
f000:D103							      ;	int_13+143p
f000:D103							      ;	int_13+450p
f000:D103							      ;	sub_FD297+67p
f000:D103							      ;	sub_FD297+97p
f000:D103		  push	  cx
f000:D104		  mov	  cx, 2
f000:D107		  xor	  bx, bx
f000:D109
f000:D109 l0:							      ;	CODE XREF: diskette_wait_until_op_finished+11j
f000:D109							      ;	diskette_wait_until_op_finished+13j
f000:D109		  test	  byte ptr ds:p400.diskette_recalibrate_status,	80h ; interrupt	triggered?
f000:D10E		  jnz	  short	ok			      ;	yes, exit
f000:D110		  dec	  bx
f000:D111		  cmp	  bx, 0
f000:D114		  jnz	  short	l0
f000:D116		  loop	  l0
f000:D118		  or	  byte ptr ds:p400.diskette_last_status, 80h ; timeout
f000:D11D		  stc
f000:D11E		  jmp	  short	exit
f000:D120 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D120
f000:D120 ok:							      ;	CODE XREF: diskette_wait_until_op_finished+Bj
f000:D120		  and	  byte ptr ds:p400.diskette_recalibrate_status,	7Fh ; mask off "interrupt triggered"
f000:D125		  clc
f000:D126
f000:D126 exit:							      ;	CODE XREF: diskette_wait_until_op_finished+1Bj
f000:D126		  pop	  cx
f000:D127		  retn
f000:D127 diskette_wait_until_op_finished endp
f000:D127
f000:D128
f000:D128 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D128
f000:D128
f000:D128 diskette_wait_until_ready proc near			      ;	CODE XREF: int_13+2B9p
f000:D128							      ;	int_13+3DBp
f000:D128		  push	  dx
f000:D129		  push	  ax
f000:D12A		  push	  cx
f000:D12B		  mov	  cx, 2
f000:D12E		  xor	  bx, bx
f000:D130		  mov	  dx, 3F4h
f000:D133
f000:D133 l0:							      ;	CODE XREF: diskette_wait_until_ready+14j
f000:D133							      ;	diskette_wait_until_ready+16j
f000:D133							      ;	diskette_wait_until_ready+28j
f000:D133		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D133							      ;	0-3: diskette busy
f000:D133							      ;	4: 1=cntrlr busy
f000:D133							      ;	5: 1=non-DMA mode
f000:D133							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D133							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D134		  test	  al, 80h
f000:D136		  jnz	  short	l1
f000:D138		  dec	  bx
f000:D139		  cmp	  bx, 0
f000:D13C		  jnz	  short	l0			      ;	wait until Ok to snd/rcv cmd/data
f000:D13E		  loop	  l0
f000:D140		  or	  byte ptr ds:p400.diskette_last_status, 80h ; timeout flag
f000:D145		  stc
f000:D146		  jmp	  short	exit
f000:D146 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D148		  db  90h ; 
f000:D149 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D149
f000:D149 l1:							      ;	CODE XREF: diskette_wait_until_ready+Ej
f000:D149		  test	  al, 20h ; ' '
f000:D14B		  jz	  short	ok
f000:D14D		  inc	  dx
f000:D14E		  in	  al, dx			      ;	Floppy:	FDC command/data register.
f000:D14F		  dec	  dx
f000:D150		  jmp	  short	l0
f000:D152 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D152
f000:D152 ok:							      ;	CODE XREF: diskette_wait_until_ready+23j
f000:D152		  and	  byte ptr ds:p400.diskette_recalibrate_status,	7Fh ; mask off "interrupt triggered"
f000:D157		  clc
f000:D158
f000:D158 exit:							      ;	CODE XREF: diskette_wait_until_ready+1Ej
f000:D158		  pop	  cx
f000:D159		  pop	  ax
f000:D15A		  pop	  dx
f000:D15B		  retn
f000:D15B diskette_wait_until_ready endp
f000:D15B
f000:D15C
f000:D15C ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D15C
f000:D15C ; Attributes:	bp-based frame
f000:D15C
f000:D15C diskette_no_dma_functions proc near			      ;	CODE XREF: int_13+D6p
f000:D15C							      ;	int_13+DFp
f000:D15C							      ;	int_13+E8p
f000:D15C							      ;	int_13+417p
f000:D15C		  push	  cx
f000:D15D		  push	  dx
f000:D15E		  push	  es
f000:D15F		  push	  bx
f000:D160		  push	  ax
f000:D161		  mov	  bp, sp
f000:D163		  call	  get_diskette_params
f000:D166		  mov	  cl, es:[si+3]
f000:D16A		  mov	  dx, 80h ; '€'
f000:D16D		  shl	  dx, cl
f000:D16F		  mov	  ax, [bp+0]
f000:D172		  xor	  ah, ah
f000:D174		  mul	  dx
f000:D176		  cmp	  dx, 0
f000:D179		  jnz	  short	l2
f000:D17B		  pop	  cx
f000:D17C		  pop	  bx
f000:D17D		  pop	  es
f000:D17E		  push	  es
f000:D17F		  push	  bx
f000:D180		  push	  cx
f000:D181		  mov	  dx, ax
f000:D183		  mov	  ax, es
f000:D185		  mov	  cl, 4
f000:D187		  shl	  ax, cl
f000:D189		  add	  bx, ax
f000:D18B		  mov	  ax, dx
f000:D18D		  dec	  dx
f000:D18E		  add	  bx, dx
f000:D190		  jb	  short	l2
f000:D192		  dec	  ax
f000:D193		  cli
f000:D194		  mov	  dx, 0Ch
f000:D197		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:D197							      ;	clear byte pointer flip-flop.
f000:D198		  mov	  dx, 5
f000:D19B		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:D19B							      ;	channel	2 base address and word	count
f000:D19C		  xchg	  ah, al
f000:D19E		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:D19E							      ;	channel	2 base address and word	count
f000:D19F		  pop	  ax
f000:D1A0		  xchg	  ah, al
f000:D1A2		  mov	  dx, 0Bh
f000:D1A5		  out	  dx, al			      ;	DMA 8237A-5. mode register bits:
f000:D1A5							      ;	0-1: channel (00=0; 01=1; 10=2;	11=3)
f000:D1A5							      ;	2-3: transfer type (00=verify=Nop; 01=write; 10=read)
f000:D1A5							      ;	4: 1=enable auto-initialization
f000:D1A5							      ;	5: 1=address increment;	0=address decrement
f000:D1A5							      ;	6-7: 00=demand mode; 01=single;	10=block; 11=cascade
f000:D1A6		  pop	  bx
f000:D1A7		  pop	  es
f000:D1A8		  mov	  ax, es
f000:D1AA		  mov	  cl, 4
f000:D1AC		  shl	  ax, cl
f000:D1AE		  add	  ax, bx
f000:D1B0		  mov	  bx, 0
f000:D1B3		  jnb	  short	l0
f000:D1B5		  mov	  bx, 1
f000:D1B8
f000:D1B8 l0:							      ;	CODE XREF: diskette_no_dma_functions+57j
f000:D1B8		  mov	  dx, 4
f000:D1BB		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:D1BB							      ;	channel	2 base address
f000:D1BB							      ;	(also sets current address)
f000:D1BC		  xchg	  ah, al
f000:D1BE		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:D1BE							      ;	channel	2 base address
f000:D1BE							      ;	(also sets current address)
f000:D1BF		  mov	  ax, es
f000:D1C1		  and	  ax, 0F000h
f000:D1C4		  mov	  cl, 0Ch
f000:D1C6		  shr	  ax, cl
f000:D1C8		  cmp	  bx, 0
f000:D1CB		  jz	  short	l1
f000:D1CD		  inc	  al
f000:D1CF
f000:D1CF l1:							      ;	CODE XREF: diskette_no_dma_functions+6Fj
f000:D1CF		  mov	  dx, 81h ; ''
f000:D1D2		  out	  dx, al			      ;	DMA page register 74LS612:
f000:D1D2							      ;	Channel	2 (diskette DMA)  (address bits	16-23)
f000:D1D3		  sti
f000:D1D4		  mov	  dx, 0Ah
f000:D1D7		  mov	  al, 2
f000:D1D9		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:D1D9							      ;	single mask bit	register
f000:D1D9							      ;	0-1: select channel (00=0; 01=1; 10=2; 11=3)
f000:D1D9							      ;	2: 1=set mask for channel; 0=clear mask	(enable)
f000:D1DA		  jmp	  short	ok
f000:D1DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D1DC
f000:D1DC l2:							      ;	CODE XREF: diskette_no_dma_functions+1Dj
f000:D1DC							      ;	diskette_no_dma_functions+34j
f000:D1DC		  stc
f000:D1DD		  mov	  byte ptr ds:p400.diskette_last_status, 9
f000:D1E2		  pop	  ax
f000:D1E3		  pop	  bx
f000:D1E4		  pop	  es
f000:D1E5		  jmp	  short	exit
f000:D1E7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D1E7
f000:D1E7 ok:							      ;	CODE XREF: diskette_no_dma_functions+7Ej
f000:D1E7		  clc
f000:D1E8
f000:D1E8 exit:							      ;	CODE XREF: diskette_no_dma_functions+89j
f000:D1E8		  pop	  dx
f000:D1E9		  pop	  cx
f000:D1EA		  retn
f000:D1EA diskette_no_dma_functions endp
f000:D1EA
f000:D1EB
f000:D1EB ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D1EB
f000:D1EB
f000:D1EB sub_FD1EB	  proc near				      ;	CODE XREF: int_13+91p
f000:D1EB							      ;	int_13+10Dp
f000:D1EB							      ;	int_13+11Ep
f000:D1EB							      ;	int_13+125p
f000:D1EB							      ;	int_13+12Cp
f000:D1EB							      ;	int_13+133p ...
f000:D1EB		  push	  cx
f000:D1EC		  push	  dx
f000:D1ED		  mov	  ah, al
f000:D1EF		  mov	  dx, 3F4h
f000:D1F2		  xor	  cx, cx
f000:D1F4
f000:D1F4 l0:							      ;	CODE XREF: sub_FD1EB+Ej
f000:D1F4		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D1F4							      ;	0-3: diskette busy
f000:D1F4							      ;	4: 1=cntrlr busy
f000:D1F4							      ;	5: 1=non-DMA mode
f000:D1F4							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D1F4							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D1F5		  test	  al, 80h
f000:D1F7		  jnz	  short	l1
f000:D1F9		  loop	  l0
f000:D1FB		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:D200		  jmp	  short	exit_error
f000:D202 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D202
f000:D202 l1:							      ;	CODE XREF: sub_FD1EB+Cj
f000:D202		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D202							      ;	0-3: diskette busy
f000:D202							      ;	4: 1=cntrlr busy
f000:D202							      ;	5: 1=non-DMA mode
f000:D202							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D202							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D203		  test	  al, 40h
f000:D205		  jz	  short	l2
f000:D207		  or	  byte ptr ds:p400.diskette_last_status, 20h
f000:D20C		  jmp	  short	exit_error
f000:D20E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D20E
f000:D20E l2:							      ;	CODE XREF: sub_FD1EB+1Aj
f000:D20E		  mov	  dx, 3F5h
f000:D211		  mov	  al, ah
f000:D213		  out	  dx, al			      ;	Floppy:	FDC command/data register.
f000:D214		  clc
f000:D215		  jmp	  short	exit
f000:D217 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D217
f000:D217 exit_error:						      ;	CODE XREF: sub_FD1EB+15j
f000:D217							      ;	sub_FD1EB+21j
f000:D217		  stc
f000:D218
f000:D218 exit:							      ;	CODE XREF: sub_FD1EB+2Aj
f000:D218		  pop	  dx
f000:D219		  pop	  cx
f000:D21A		  retn
f000:D21A sub_FD1EB	  endp
f000:D21A
f000:D21B
f000:D21B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D21B
f000:D21B
f000:D21B sub_FD21B	  proc near				      ;	CODE XREF: sub_FD3DC+11p
f000:D21B		  push	  cx
f000:D21C		  push	  dx
f000:D21D		  mov	  dx, 3F4h
f000:D220		  xor	  cx, cx
f000:D222
f000:D222 l0:							      ;	CODE XREF: sub_FD21B+Cj
f000:D222		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D222							      ;	0-3: diskette busy
f000:D222							      ;	4: 1=cntrlr busy
f000:D222							      ;	5: 1=non-DMA mode
f000:D222							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D222							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D223		  test	  al, 80h
f000:D225		  jnz	  short	l1
f000:D227		  loop	  l0
f000:D229		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:D22E		  jmp	  short	error
f000:D230 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D230
f000:D230 l1:							      ;	CODE XREF: sub_FD21B+Aj
f000:D230		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D230							      ;	0-3: diskette busy
f000:D230							      ;	4: 1=cntrlr busy
f000:D230							      ;	5: 1=non-DMA mode
f000:D230							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D230							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D231		  test	  al, 40h
f000:D233		  jz	  short	ok
f000:D235		  or	  byte ptr ds:p400.diskette_last_status, 20h
f000:D23A		  jmp	  short	error
f000:D23C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D23C
f000:D23C ok:							      ;	CODE XREF: sub_FD21B+18j
f000:D23C		  clc
f000:D23D		  jmp	  short	exit
f000:D23F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D23F
f000:D23F error:						      ;	CODE XREF: sub_FD21B+13j
f000:D23F							      ;	sub_FD21B+1Fj
f000:D23F		  stc
f000:D240
f000:D240 exit:							      ;	CODE XREF: sub_FD21B+22j
f000:D240		  pop	  dx
f000:D241		  pop	  cx
f000:D242		  retn
f000:D242 sub_FD21B	  endp
f000:D242
f000:D243
f000:D243 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D243
f000:D243
f000:D243 sub_FD243	  proc near				      ;	CODE XREF: int_13+14Bp
f000:D243							      ;	int_13+2C1p
f000:D243							      ;	int_13+3E1p
f000:D243							      ;	int_13+458p
f000:D243							      ;	sub_FD360+13p
f000:D243		  push	  dx
f000:D244		  push	  es
f000:D245		  mov	  ax, ds
f000:D247		  mov	  es, ax
f000:D249		  lea	  di, ds:p400.diskette_command_bytes
f000:D24D		  mov	  dx, 3F4h
f000:D250		  xor	  bx, bx
f000:D252
f000:D252 l0:							      ;	CODE XREF: sub_FD243+15j
f000:D252		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D252							      ;	0-3: diskette busy
f000:D252							      ;	4: 1=cntrlr busy
f000:D252							      ;	5: 1=non-DMA mode
f000:D252							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D252							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D253		  test	  al, 80h
f000:D255		  jnz	  short	l1
f000:D257		  dec	  bx
f000:D258		  jnz	  short	l0
f000:D25A		  or	  byte ptr ds:p400.diskette_last_status, 80h
f000:D25F		  jmp	  short	error
f000:D261 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D261
f000:D261 l1:							      ;	CODE XREF: sub_FD243+12j
f000:D261		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D261							      ;	0-3: diskette busy
f000:D261							      ;	4: 1=cntrlr busy
f000:D261							      ;	5: 1=non-DMA mode
f000:D261							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D261							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D262		  test	  al, 40h
f000:D264		  jnz	  short	l2
f000:D266		  or	  byte ptr ds:p400.diskette_last_status, 20h
f000:D26B		  jmp	  short	error
f000:D26D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D26D
f000:D26D l2:							      ;	CODE XREF: sub_FD243+21j
f000:D26D							      ;	sub_FD243+3Ej
f000:D26D		  mov	  dx, 3F5h
f000:D270		  in	  al, dx			      ;	Floppy:	FDC command/data register.
f000:D271		  stosb
f000:D272		  push	  cx
f000:D273		  mov	  cx, 8
f000:D276
f000:D276 l3:							      ;	CODE XREF: sub_FD243:l3j
f000:D276		  loop	  l3				      ;	delay
f000:D278		  pop	  cx
f000:D279		  mov	  dx, 3F4h
f000:D27C		  in	  al, dx			      ;	Floppy:	main status reg	bits:
f000:D27C							      ;	0-3: diskette busy
f000:D27C							      ;	4: 1=cntrlr busy
f000:D27C							      ;	5: 1=non-DMA mode
f000:D27C							      ;	6: Data	dir: 1=cntrlr to CPU
f000:D27C							      ;	7: 1=OK	to snd/rcv cmd or data
f000:D27D		  test	  al, 10h
f000:D27F		  jz	  short	l4
f000:D281		  loop	  l2
f000:D283		  or	  byte ptr ds:p400.diskette_last_status, 20h
f000:D288		  jmp	  short	error
f000:D28A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D28A
f000:D28A l4:							      ;	CODE XREF: sub_FD243+3Cj
f000:D28A		  lea	  di, ds:p400.diskette_command_bytes
f000:D28E		  mov	  ah, [di]
f000:D290		  clc
f000:D291		  jmp	  short	exit
f000:D293 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D293
f000:D293 error:						      ;	CODE XREF: sub_FD243+1Cj
f000:D293							      ;	sub_FD243+28j
f000:D293							      ;	sub_FD243+45j
f000:D293		  stc
f000:D294
f000:D294 exit:							      ;	CODE XREF: sub_FD243+4Ej
f000:D294		  pop	  es
f000:D295		  pop	  dx
f000:D296		  retn
f000:D296 sub_FD243	  endp
f000:D296
f000:D297
f000:D297 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D297
f000:D297
f000:D297 sub_FD297	  proc near				      ;	CODE XREF: int_13+108p
f000:D297							      ;	int_13+1ACp
f000:D297							      ;	int_13+37Bp
f000:D297							      ;	int_13+422p
f000:D297		  push	  ax
f000:D298		  push	  cx
f000:D299		  push	  dx
f000:D29A		  mov	  al, 1
f000:D29C		  mov	  cl, dl
f000:D29E		  shl	  al, cl
f000:D2A0		  mov	  ah, al
f000:D2A2		  cli
f000:D2A3		  test	  ds:p400.diskette_motor_status, ah
f000:D2A7		  jnz	  short	l1
f000:D2A9		  mov	  cl, 4
f000:D2AB		  shl	  al, cl
f000:D2AD		  or	  al, 0Ch
f000:D2AF		  or	  al, dl
f000:D2B1		  mov	  dx, 3F2h
f000:D2B4		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:D2B4							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:D2B4							      ;	2:   0=reset diskette controller; 1=enable controller
f000:D2B4							      ;	3:   1=enable diskette DMA and interrupts
f000:D2B4							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:D2B4							      ;
f000:D2B5		  and	  byte ptr ds:p400.diskette_motor_status, 0F0h
f000:D2BA		  or	  ds:p400.diskette_motor_status, ah
f000:D2BE		  mov	  al, es:[si+0Ah]
f000:D2C2		  cmp	  al, 0
f000:D2C4		  jz	  short	l1
f000:D2C6		  xor	  cx, cx
f000:D2C8		  mov	  byte ptr ds:p400.diskette_motor_off_timeout, 0
f000:D2CD		  sti
f000:D2CE
f000:D2CE l0:							      ;	CODE XREF: sub_FD297:l0j
f000:D2CE							      ;	sub_FD297+3Dj
f000:D2CE		  loop	  l0
f000:D2D0		  dec	  al
f000:D2D2		  cmp	  al, 0
f000:D2D4		  jnz	  short	l0
f000:D2D6
f000:D2D6 l1:							      ;	CODE XREF: sub_FD297+10j
f000:D2D6							      ;	sub_FD297+2Dj
f000:D2D6		  mov	  byte ptr ds:p400.diskette_motor_off_timeout, 0FFh
f000:D2DB		  sti
f000:D2DC		  pop	  dx
f000:D2DD		  pop	  cx
f000:D2DE		  push	  cx
f000:D2DF		  push	  dx
f000:D2E0		  mov	  al, 1
f000:D2E2		  mov	  cl, dl
f000:D2E4		  shl	  al, cl
f000:D2E6		  mov	  cl, al
f000:D2E8		  test	  ds:p400.diskette_recalibrate_status, al
f000:D2EC		  jnz	  short	l2
f000:D2EE		  mov	  al, 7
f000:D2F0		  call	  sub_FD1EB
f000:D2F3		  jb	  short	exit_error
f000:D2F5		  mov	  al, dl
f000:D2F7		  and	  al, 3
f000:D2F9		  call	  sub_FD1EB
f000:D2FC		  jb	  short	exit_error
f000:D2FE		  call	  diskette_wait_until_op_finished
f000:D301		  jb	  short	exit_error
f000:D303		  call	  sub_FD360
f000:D306		  jb	  short	exit_error
f000:D308		  test	  ah, 0C0h
f000:D30B		  jnz	  short	exit_error
f000:D30D		  or	  ds:p400.diskette_recalibrate_status, cl
f000:D311
f000:D311 l2:							      ;	CODE XREF: sub_FD297+55j
f000:D311		  mov	  al, 0Fh
f000:D313		  call	  sub_FD1EB
f000:D316		  jb	  short	exit_error
f000:D318		  mov	  al, dl
f000:D31A		  and	  al, 3
f000:D31C		  shl	  dh, 1
f000:D31E		  shl	  dh, 1
f000:D320		  or	  al, dh
f000:D322		  call	  sub_FD1EB
f000:D325		  jb	  short	exit_error
f000:D327		  mov	  al, ch
f000:D329		  call	  sub_FD1EB
f000:D32C		  jb	  short	exit_error
f000:D32E		  call	  diskette_wait_until_op_finished
f000:D331		  jb	  short	exit_error
f000:D333		  call	  sub_FD360
f000:D336		  jb	  short	exit_error
f000:D338		  test	  ah, 0C0h
f000:D33B		  jnz	  short	exit_error
f000:D33D		  mov	  al, es:[si+9]
f000:D341		  cmp	  al, 0
f000:D343		  jz	  short	exit_ok
f000:D345
f000:D345 l3:							      ;	CODE XREF: sub_FD297+B7j
f000:D345		  mov	  cx, 221h
f000:D348
f000:D348 l4:							      ;	CODE XREF: sub_FD297:l4j
f000:D348		  loop	  l4				      ;	delay
f000:D34A		  dec	  al
f000:D34C		  cmp	  al, 0
f000:D34E		  jnz	  short	l3
f000:D350
f000:D350 exit_ok:						      ;	CODE XREF: sub_FD297+ACj
f000:D350		  clc
f000:D351		  jmp	  short	exit
f000:D353 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D353
f000:D353 exit_error:						      ;	CODE XREF: sub_FD297+5Cj
f000:D353							      ;	sub_FD297+65j
f000:D353							      ;	sub_FD297+6Aj
f000:D353							      ;	sub_FD297+6Fj
f000:D353							      ;	sub_FD297+74j
f000:D353							      ;	sub_FD297+7Fj ...
f000:D353		  or	  byte ptr ds:p400.diskette_last_status, 40h
f000:D358		  call	  sub_FD387
f000:D35B		  stc
f000:D35C
f000:D35C exit:							      ;	CODE XREF: sub_FD297+BAj
f000:D35C		  pop	  dx
f000:D35D		  pop	  cx
f000:D35E		  pop	  ax
f000:D35F		  retn
f000:D35F sub_FD297	  endp
f000:D35F
f000:D360
f000:D360 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D360
f000:D360
f000:D360 sub_FD360	  proc near				      ;	CODE XREF: int_13+7Ep
f000:D360							      ;	sub_FD297+6Cp
f000:D360							      ;	sub_FD297+9Cp
f000:D360		  push	  cx
f000:D361		  push	  si
f000:D362		  lea	  si, ds:p400.diskette_command_bytes
f000:D366		  mov	  ax, [si]
f000:D368		  push	  ax
f000:D369		  mov	  al, 8
f000:D36B		  call	  sub_FD1EB
f000:D36E		  jb	  short	error
f000:D370		  mov	  cx, 2
f000:D373		  call	  sub_FD243
f000:D376		  jb	  short	error
f000:D378		  mov	  ax, [si]
f000:D37A		  xchg	  ah, al
f000:D37C		  pop	  bx
f000:D37D		  mov	  [si],	bx
f000:D37F		  clc
f000:D380		  jmp	  short	exit
f000:D382 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D382
f000:D382 error:						      ;	CODE XREF: sub_FD360+Ej
f000:D382							      ;	sub_FD360+16j
f000:D382		  pop	  bx
f000:D383		  stc
f000:D384
f000:D384 exit:							      ;	CODE XREF: sub_FD360+20j
f000:D384		  pop	  si
f000:D385		  pop	  cx
f000:D386		  retn
f000:D386 sub_FD360	  endp
f000:D386
f000:D387
f000:D387 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D387
f000:D387
f000:D387 sub_FD387	  proc near				      ;	CODE XREF: int_13+156p
f000:D387							      ;	int_13+2CCp
f000:D387							      ;	int_13+3EBp
f000:D387							      ;	int_13+462p
f000:D387							      ;	sub_FD297+C1p
f000:D387		  lea	  si, ds:p400.diskette_command_bytes
f000:D38B		  mov	  al, [si+1]
f000:D38E		  or	  al, [si+2]
f000:D391		  mov	  cx, 8
f000:D394		  xor	  bx, bx
f000:D396		  and	  al, 0B7h
f000:D398
f000:D398 l0:							      ;	CODE XREF: sub_FD387+18j
f000:D398		  test	  al, 1
f000:D39A		  jnz	  short	l1
f000:D39C		  inc	  bx
f000:D39D		  ror	  al, 1
f000:D39F		  loop	  l0
f000:D3A1		  jmp	  short	exit
f000:D3A3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D3A3
f000:D3A3 l1:							      ;	CODE XREF: sub_FD387+13j
f000:D3A3		  mov	  al, cs:byte_FD3AD[bx]
f000:D3A8		  or	  ds:p400.diskette_last_status,	al
f000:D3AC
f000:D3AC exit:							      ;	CODE XREF: sub_FD387+1Aj
f000:D3AC		  retn
f000:D3AC sub_FD387	  endp
f000:D3AC
f000:D3AC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D3AD byte_FD3AD	  db 2					      ;	DATA XREF: sub_FD387:l1r
f000:D3AE		  db	3
f000:D3AF		  db	4
f000:D3B0		  db	0
f000:D3B1		  db	8
f000:D3B2		  db  10h
f000:D3B3		  db	0
f000:D3B4		  db	4
f000:D3B5
f000:D3B5 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D3B5
f000:D3B5 ; out:
f000:D3B5 ;    es:si ->	table for diskette parameters
f000:D3B5
f000:D3B5 get_diskette_params proc near				      ;	CODE XREF: int_13+105p
f000:D3B5							      ;	int_13+1A9p
f000:D3B5							      ;	diskette_dma_functions+Bp
f000:D3B5							      ;	int_13:l42p
f000:D3B5							      ;	int_13:l51p
f000:D3B5							      ;	int_13+475p ...
f000:D3B5		  push	  ax
f000:D3B6		  xor	  ax, ax
f000:D3B8		  mov	  es, ax			      ;	es = 0x00
f000:D3BA		  push	  bx
f000:D3BB		  mov	  bx, 78h ; 'x'                       ; int 0x1e (diskette parameters)
f000:D3BE		  mov	  si, es:[bx]
f000:D3C1		  mov	  ax, es:[bx+2]
f000:D3C5		  mov	  es, ax
f000:D3C7		  pop	  bx
f000:D3C8		  pop	  ax
f000:D3C9		  retn
f000:D3C9 get_diskette_params endp
f000:D3C9
f000:D3CA
f000:D3CA ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D3CA
f000:D3CA
f000:D3CA sub_FD3CA	  proc near				      ;	CODE XREF: int_13:l2p
f000:D3CA							      ;	int_13+13Ep
f000:D3CA							      ;	int_13+39Cp
f000:D3CA							      ;	int_13+443p
f000:D3CA							      ;	int_13+44Bp
f000:D3CA		  push	  cx
f000:D3CB		  call	  get_diskette_params
f000:D3CE
f000:D3CE l0:							      ;	CODE XREF: sub_FD3CA+Dj
f000:D3CE		  mov	  al, es:[bx+si]
f000:D3D1		  call	  sub_FD1EB
f000:D3D4		  jb	  short	l1
f000:D3D6		  inc	  bx
f000:D3D7		  loop	  l0
f000:D3D9		  clc
f000:D3DA
f000:D3DA l1:							      ;	CODE XREF: sub_FD3CA+Aj
f000:D3DA		  pop	  cx
f000:D3DB		  retn
f000:D3DB sub_FD3CA	  endp
f000:D3DB
f000:D3DC
f000:D3DC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D3DC
f000:D3DC
f000:D3DC sub_FD3DC	  proc near				      ;	CODE XREF: int_13+1E2p
f000:D3DC							      ;	int_13+3A9p
f000:D3DC		  push	  cx
f000:D3DD		  call	  get_diskette_params
f000:D3E0		  dec	  cx
f000:D3E1
f000:D3E1 l0:							      ;	CODE XREF: sub_FD3DC+Ej
f000:D3E1		  mov	  al, es:[bx+si]
f000:D3E4		  call	  sub_FD1EB
f000:D3E7		  jb	  short	l1
f000:D3E9		  inc	  bx
f000:D3EA		  loop	  l0
f000:D3EC		  clc
f000:D3ED		  call	  sub_FD21B
f000:D3F0		  jb	  short	l1
f000:D3F2		  mov	  dh, es:[bx+si]
f000:D3F5
f000:D3F5 l1:							      ;	CODE XREF: sub_FD3DC+Bj
f000:D3F5							      ;	sub_FD3DC+14j
f000:D3F5		  pop	  cx
f000:D3F6		  retn
f000:D3F6 sub_FD3DC	  endp
f000:D3F6
f000:D3F7
f000:D3F7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D3F7
f000:D3F7
f000:D3F7 sub_FD3F7	  proc near				      ;	CODE XREF: int_13+A3p
f000:D3F7		  push	  cx
f000:D3F8		  call	  get_diskette_params
f000:D3FB		  mov	  al, es:[bx+si]
f000:D3FE		  call	  sub_FD1EB
f000:D401		  jb	  short	l0
f000:D403		  inc	  bx
f000:D404		  mov	  al, es:[bx+si]
f000:D407		  or	  al, 1
f000:D409		  call	  sub_FD1EB
f000:D40C		  jb	  short	l0
f000:D40E		  clc
f000:D40F
f000:D40F l0:							      ;	CODE XREF: sub_FD3F7+Aj
f000:D40F							      ;	sub_FD3F7+15j
f000:D40F		  pop	  cx
f000:D410		  retn
f000:D410 sub_FD3F7	  endp
f000:D410
f000:D410 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D411 value_b000	  dw 0B000h				      ;	DATA XREF: sub_FF4ED:loc_FD413r
f000:D411							      ;	sub_FD5C7+15r
f000:D411							      ;	sub_FD754+CEr
f000:D411							      ;	sub_FD754+127r
f000:D413 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D413 ; START OF FUNCTION CHUNK FOR	sub_FF4ED
f000:D413
f000:D413 loc_FD413:						      ;	CODE XREF: sub_FF4ED+1Dj
f000:D413		  mov	  es, cs:value_b000		      ;	es = 0xb000
f000:D418		  cmp	  word ptr [bp+0], 0
f000:D41C		  jz	  short	loc_FD420
f000:D41E		  mov	  dh, ch
f000:D420
f000:D420 loc_FD420:						      ;	CODE XREF: sub_FF4ED-20D1j
f000:D420		  inc	  dl
f000:D422		  push	  ax
f000:D423		  mov	  ax, ds:p400.crt_nr_cols
f000:D426		  mov	  ch, al
f000:D428		  pop	  ax
f000:D429		  cmp	  dl, ch
f000:D42B		  jnz	  short	loc_FD436
f000:D42D		  inc	  dh
f000:D42F		  xor	  dl, dl
f000:D431		  call	  sub_FD9C8
f000:D434		  jmp	  short	loc_FD447
f000:D436 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D436
f000:D436 loc_FD436:						      ;	CODE XREF: sub_FF4ED-20C2j
f000:D436		  call	  sub_FD9C8
f000:D439		  add	  bx, 0F0h ; 'ğ'
f000:D43D		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D442		  jb	  short	loc_FD447
f000:D444		  sub	  bx, 50h ; 'P'
f000:D447
f000:D447 loc_FD447:						      ;	CODE XREF: sub_FF4ED-20B9j
f000:D447							      ;	sub_FF4ED-20ABj
f000:D447		  add	  bh, 20h ; ' '
f000:D44A		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D44F		  jb	  short	loc_FD454
f000:D451		  add	  bh, 40h ; '@'
f000:D454
f000:D454 loc_FD454:						      ;	CODE XREF: sub_FF4ED-209Ej
f000:D454		  push	  bx
f000:D455		  mov	  bp, sp
f000:D457		  xor	  ch, ch
f000:D459		  cmp	  word ptr [bp+4], 0
f000:D45D		  jz	  short	loc_FD465
f000:D45F		  mov	  ch, [bp+11h]
f000:D462		  sub	  ch, [bp+13h]
f000:D465
f000:D465 loc_FD465:						      ;	CODE XREF: sub_FF4ED-2090j
f000:D465		  mov	  dx, [bp+12h]
f000:D468		  add	  dh, ch
f000:D46A		  push	  cx
f000:D46B		  call	  sub_FD9C8
f000:D46E		  mov	  di, bx
f000:D470		  pop	  cx
f000:D471		  mov	  dh, [bp+11h]
f000:D474		  sub	  dh, [bp+13h]
f000:D477		  cmp	  dh, 0
f000:D47A		  jnz	  short	loc_FD47F
f000:D47C		  jmp	  loc_FD547
f000:D47F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D47F
f000:D47F loc_FD47F:						      ;	CODE XREF: sub_FF4ED-2073j
f000:D47F		  mov	  dx, [bp+12h]
f000:D482		  add	  dh, ch
f000:D484		  cmp	  word ptr [bp+4], 0
f000:D488		  jnz	  short	loc_FD48E
f000:D48A		  add	  dh, al
f000:D48C		  jmp	  short	loc_FD490
f000:D48E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D48E
f000:D48E loc_FD48E:						      ;	CODE XREF: sub_FF4ED-2065j
f000:D48E		  sub	  dh, al
f000:D490
f000:D490 loc_FD490:						      ;	CODE XREF: sub_FF4ED-2061j
f000:D490		  call	  sub_FD9C8
f000:D493		  mov	  si, bx
f000:D495		  xor	  cx, cx
f000:D497		  cmp	  al, 0
f000:D499		  jnz	  short	loc_FD49E
f000:D49B		  jmp	  loc_FD547
f000:D49E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D49E
f000:D49E loc_FD49E:						      ;	CODE XREF: sub_FF4ED-2054j
f000:D49E							      ;	sub_FF4ED-1FAEj
f000:D49E		  push	  si
f000:D49F		  push	  di
f000:D4A0		  push	  ds
f000:D4A1		  xor	  bx, bx
f000:D4A3		  mov	  cl, ah
f000:D4A5		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:D4AA		  jz	  short	loc_FD4BE
f000:D4AC		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:D4B1		  jb	  short	loc_FD4BC
f000:D4B3		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:D4B8		  jnb	  short	loc_FD4BC
f000:D4BA		  shl	  cl, 1
f000:D4BC
f000:D4BC loc_FD4BC:						      ;	CODE XREF: sub_FF4ED-203Cj
f000:D4BC							      ;	sub_FF4ED-2035j
f000:D4BC		  shl	  cl, 1
f000:D4BE
f000:D4BE loc_FD4BE:						      ;	CODE XREF: sub_FF4ED-2043j
f000:D4BE		  mov	  dh, ds:p400.crt_mode
f000:D4C2		  push	  ax
f000:D4C3		  mov	  ax, es
f000:D4C5		  mov	  ds, ax
f000:D4C7		  pop	  ax
f000:D4C8		  mov	  dl, 4
f000:D4CA		  cmp	  dh, 9
f000:D4CD		  jb	  short	loc_FD4D1
f000:D4CF		  mov	  dl, 2
f000:D4D1
f000:D4D1 loc_FD4D1:						      ;	CODE XREF: sub_FF4ED-2020j
f000:D4D1							      ;	sub_FF4ED-1FBBj
f000:D4D1		  mov	  si, [bp-2]
f000:D4D4		  mov	  di, [bp-4]
f000:D4D7		  add	  si, bx
f000:D4D9		  add	  di, bx
f000:D4DB		  push	  cx
f000:D4DC		  rep movsb
f000:D4DE		  pop	  cx
f000:D4DF		  mov	  si, [bp-2]
f000:D4E2		  mov	  di, [bp-4]
f000:D4E5		  add	  si, 2000h
f000:D4E9		  add	  di, 2000h
f000:D4ED		  add	  si, bx
f000:D4EF		  add	  di, bx
f000:D4F1		  push	  cx
f000:D4F2		  rep movsb
f000:D4F4		  pop	  cx
f000:D4F5		  cmp	  dh, 9
f000:D4F8		  jb	  short	loc_FD52D
f000:D4FA		  mov	  si, [bp-2]
f000:D4FD		  mov	  di, [bp-4]
f000:D500		  add	  si, 4000h
f000:D504		  add	  di, 4000h
f000:D508		  add	  si, bx
f000:D50A		  add	  di, bx
f000:D50C		  push	  cx
f000:D50D		  rep movsb
f000:D50F		  pop	  cx
f000:D510		  mov	  si, [bp-2]
f000:D513		  mov	  di, [bp-4]
f000:D516		  add	  si, 6000h
f000:D51A		  add	  di, 6000h
f000:D51E		  add	  si, bx
f000:D520		  add	  di, bx
f000:D522		  push	  cx
f000:D523		  rep movsb
f000:D525		  pop	  cx
f000:D526		  add	  bx, 0A0h ; ' '
f000:D52A		  jmp	  short	loc_FD530
f000:D52A ; END	OF FUNCTION CHUNK FOR sub_FF4ED
f000:D52A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D52C		  db  90h ; 
f000:D52D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D52D ; START OF FUNCTION CHUNK FOR	sub_FF4ED
f000:D52D
f000:D52D loc_FD52D:						      ;	CODE XREF: sub_FF4ED-1FF5j
f000:D52D		  add	  bx, 50h ; 'P'
f000:D530
f000:D530 loc_FD530:						      ;	CODE XREF: sub_FF4ED-1FC3j
f000:D530		  dec	  dl
f000:D532		  jnz	  short	loc_FD4D1
f000:D534		  pop	  ds
f000:D535		  cmp	  si, [bp+0]
f000:D538		  jz	  short	loc_FD542
f000:D53A		  pop	  di
f000:D53B		  pop	  si
f000:D53C		  call	  sub_FDB23
f000:D53F		  jmp	  loc_FD49E
f000:D542 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D542
f000:D542 loc_FD542:						      ;	CODE XREF: sub_FF4ED-1FB5j
f000:D542		  pop	  di
f000:D543		  pop	  si
f000:D544		  call	  sub_FDB23
f000:D547
f000:D547 loc_FD547:						      ;	CODE XREF: sub_FF4ED-2071j
f000:D547							      ;	sub_FF4ED-2052j
f000:D547							      ;	sub_FF4ED-1F2Bj
f000:D547		  push	  di
f000:D548		  mov	  al, [bp+15h]
f000:D54B		  xor	  bx, bx
f000:D54D		  mov	  cl, ah
f000:D54F		  mov	  dx, 4
f000:D552		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D557		  jb	  short	loc_FD55C
f000:D559		  mov	  dx, 2
f000:D55C
f000:D55C loc_FD55C:						      ;	CODE XREF: sub_FF4ED-1F96j
f000:D55C		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:D561		  jz	  short	loc_FD575
f000:D563		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:D568		  jb	  short	loc_FD573
f000:D56A		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:D56F		  jnb	  short	loc_FD573
f000:D571		  shl	  cl, 1
f000:D573
f000:D573 loc_FD573:						      ;	CODE XREF: sub_FF4ED-1F85j
f000:D573							      ;	sub_FF4ED-1F7Ej
f000:D573		  shl	  cl, 1
f000:D575
f000:D575 loc_FD575:						      ;	CODE XREF: sub_FF4ED-1F8Cj
f000:D575							      ;	sub_FF4ED-1F36j
f000:D575		  mov	  di, [bp-2]
f000:D578		  add	  di, bx
f000:D57A		  push	  cx
f000:D57B		  rep stosb
f000:D57D		  pop	  cx
f000:D57E		  mov	  di, [bp-2]
f000:D581		  add	  di, 2000h
f000:D585		  add	  di, bx
f000:D587		  push	  cx
f000:D588		  rep stosb
f000:D58A		  pop	  cx
f000:D58B		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D590		  jb	  short	loc_FD5B3
f000:D592		  mov	  di, [bp-2]
f000:D595		  add	  di, 4000h
f000:D599		  add	  di, bx
f000:D59B		  push	  cx
f000:D59C		  rep stosb
f000:D59E		  pop	  cx
f000:D59F		  mov	  di, [bp-2]
f000:D5A2		  add	  di, 6000h
f000:D5A6		  add	  di, bx
f000:D5A8		  push	  cx
f000:D5A9		  rep stosb
f000:D5AB		  pop	  cx
f000:D5AC		  add	  bx, 0A0h ; ' '
f000:D5B0		  jmp	  short	loc_FD5B6
f000:D5B0 ; END	OF FUNCTION CHUNK FOR sub_FF4ED
f000:D5B0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D5B2		  db  90h ; 
f000:D5B3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D5B3 ; START OF FUNCTION CHUNK FOR	sub_FF4ED
f000:D5B3
f000:D5B3 loc_FD5B3:						      ;	CODE XREF: sub_FF4ED-1F5Dj
f000:D5B3		  add	  bx, 50h ; 'P'
f000:D5B6
f000:D5B6 loc_FD5B6:						      ;	CODE XREF: sub_FF4ED-1F3Dj
f000:D5B6		  dec	  dx
f000:D5B7		  jnz	  short	loc_FD575
f000:D5B9		  cmp	  di, [bp+0]
f000:D5BC		  jz	  short	loc_FD5C4
f000:D5BE		  pop	  di
f000:D5BF		  call	  sub_FDB23
f000:D5C2		  jmp	  short	loc_FD547
f000:D5C4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D5C4
f000:D5C4 loc_FD5C4:						      ;	CODE XREF: sub_FF4ED-1F31j
f000:D5C4		  pop	  di
f000:D5C5		  pop	  bx
f000:D5C6		  retn
f000:D5C6 ; END	OF FUNCTION CHUNK FOR sub_FF4ED
f000:D5C7
f000:D5C7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D5C7
f000:D5C7
f000:D5C7 sub_FD5C7	  proc near				      ;	CODE XREF: int_10_08+Ap
f000:D5C7		  call	  sub_FD9C8
f000:D5CA		  sub	  sp, 0Ah
f000:D5CD		  mov	  bp, sp
f000:D5CF		  push	  bx
f000:D5D0		  xor	  bx, bx
f000:D5D2		  mov	  cx, 8
f000:D5D5		  xor	  dl, dl
f000:D5D7
f000:D5D7 l0:							      ;	CODE XREF: sub_FD5C7:l23j
f000:D5D7		  pop	  si
f000:D5D8		  push	  si
f000:D5D9		  add	  si, bx
f000:D5DB		  push	  es
f000:D5DC		  mov	  es, cs:value_b000
f000:D5E1		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:D5E6		  jnz	  short	l1
f000:D5E8		  jmp	  l17
f000:D5EB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D5EB
f000:D5EB l1:							      ;	CODE XREF: sub_FD5C7+1Fj
f000:D5EB		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:D5F0		  jnz	  short	l2
f000:D5F2		  jmp	  l14
f000:D5F5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D5F5
f000:D5F5 l2:							      ;	CODE XREF: sub_FD5C7+29j
f000:D5F5		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:D5FA		  jnb	  short	l7
f000:D5FC		  mov	  ax, es:[si]
f000:D5FF		  inc	  si
f000:D600		  inc	  si
f000:D601		  xchg	  ah, al
f000:D603		  push	  bx
f000:D604		  push	  cx
f000:D605		  mov	  cx, 8
f000:D608		  xor	  dh, dh
f000:D60A
f000:D60A l3:							      ;	CODE XREF: sub_FD5C7:l6j
f000:D60A		  xor	  bl, bl
f000:D60C		  shl	  dh, 1
f000:D60E		  shl	  ax, 1
f000:D610		  jnb	  short	l4
f000:D612		  or	  dl, 2
f000:D615		  mov	  bl, 1
f000:D617
f000:D617 l4:							      ;	CODE XREF: sub_FD5C7+49j
f000:D617		  shl	  ax, 1
f000:D619		  jnb	  short	l5
f000:D61B		  or	  dl, 1
f000:D61E		  mov	  bl, 1
f000:D620
f000:D620 l5:							      ;	CODE XREF: sub_FD5C7+52j
f000:D620		  cmp	  bl, 0
f000:D623		  jz	  short	l6
f000:D625		  or	  dh, 1
f000:D628
f000:D628 l6:							      ;	CODE XREF: sub_FD5C7+5Cj
f000:D628		  loop	  l3
f000:D62A		  pop	  cx
f000:D62B		  pop	  bx
f000:D62C		  mov	  al, dh
f000:D62E		  jmp	  short	l18
f000:D630 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D630
f000:D630 l7:							      ;	CODE XREF: sub_FD5C7+33j
f000:D630		  push	  bx
f000:D631		  push	  cx
f000:D632		  xor	  dh, dh
f000:D634		  mov	  cx, 2
f000:D637
f000:D637 l7_1:							      ;	CODE XREF: sub_FD5C7+AEj
f000:D637		  push	  cx
f000:D638		  mov	  cx, 4
f000:D63B		  mov	  ax, es:[si]
f000:D63E		  inc	  si
f000:D63F		  inc	  si
f000:D640		  xchg	  ah, al
f000:D642
f000:D642 l8:							      ;	CODE XREF: sub_FD5C7:l13j
f000:D642		  xor	  bl, bl
f000:D644		  shl	  dh, 1
f000:D646		  shl	  ax, 1
f000:D648		  jnb	  short	l9
f000:D64A		  or	  dl, 8
f000:D64D		  mov	  bl, 1
f000:D64F
f000:D64F l9:							      ;	CODE XREF: sub_FD5C7+81j
f000:D64F		  shl	  ax, 1
f000:D651		  jnb	  short	l10
f000:D653		  or	  dl, 4
f000:D656		  mov	  bl, 1
f000:D658
f000:D658 l10:							      ;	CODE XREF: sub_FD5C7+8Aj
f000:D658		  shl	  ax, 1
f000:D65A		  jnb	  short	l11
f000:D65C		  or	  dl, 2
f000:D65F		  mov	  bl, 1
f000:D661
f000:D661 l11:							      ;	CODE XREF: sub_FD5C7+93j
f000:D661		  shl	  ax, 1
f000:D663		  jnb	  short	l12
f000:D665		  or	  dl, 1
f000:D668		  mov	  bl, 1
f000:D66A
f000:D66A l12:							      ;	CODE XREF: sub_FD5C7+9Cj
f000:D66A		  cmp	  bl, 0
f000:D66D		  jz	  short	l13
f000:D66F		  or	  dh, 1
f000:D672
f000:D672 l13:							      ;	CODE XREF: sub_FD5C7+A6j
f000:D672		  loop	  l8
f000:D674		  pop	  cx
f000:D675		  loop	  l7_1
f000:D677		  pop	  cx
f000:D678		  pop	  bx
f000:D679		  mov	  al, dh
f000:D67B		  jmp	  short	l18
f000:D67D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D67D
f000:D67D l14:							      ;	CODE XREF: sub_FD5C7+2Bj
f000:D67D		  mov	  al, es:[si]
f000:D680		  cmp	  al, 0
f000:D682		  jz	  short	l15
f000:D684		  or	  dl, 1
f000:D687
f000:D687 l15:							      ;	CODE XREF: sub_FD5C7+BBj
f000:D687		  mov	  ah, es:[si]
f000:D68A		  cmp	  ah, 0
f000:D68D		  jz	  short	l16
f000:D68F		  or	  dl, 2
f000:D692
f000:D692 l16:							      ;	CODE XREF: sub_FD5C7+C6j
f000:D692		  or	  al, ah
f000:D694		  jmp	  short	l18
f000:D694 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D696		  db  90h ; 
f000:D697 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D697
f000:D697 l17:							      ;	CODE XREF: sub_FD5C7+21j
f000:D697		  mov	  al, es:[si]
f000:D69A		  inc	  si
f000:D69B		  cmp	  al, 0
f000:D69D		  jz	  short	l18
f000:D69F		  mov	  dl, 1
f000:D6A1
f000:D6A1 l18:							      ;	CODE XREF: sub_FD5C7+67j
f000:D6A1							      ;	sub_FD5C7+B4j
f000:D6A1							      ;	sub_FD5C7+CDj
f000:D6A1							      ;	sub_FD5C7+D6j
f000:D6A1		  pop	  es
f000:D6A2		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D6A7		  jb	  short	l19
f000:D6A9		  cmp	  cx, 5
f000:D6AC		  jnz	  short	l20
f000:D6AE		  sub	  bx, 5F60h
f000:D6B2		  jmp	  short	l22
f000:D6B2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D6B4		  db  90h ; 
f000:D6B5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D6B5
f000:D6B5 l19:							      ;	CODE XREF: sub_FD5C7+E0j
f000:D6B5		  test	  cx, 1
f000:D6B9		  jnz	  short	l21
f000:D6BB
f000:D6BB l20:							      ;	CODE XREF: sub_FD5C7+E5j
f000:D6BB		  add	  bh, 20h ; ' '
f000:D6BE		  jmp	  short	l22
f000:D6C0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D6C0
f000:D6C0 l21:							      ;	CODE XREF: sub_FD5C7+F2j
f000:D6C0		  sub	  bx, 1FB0h
f000:D6C4
f000:D6C4 l22:							      ;	CODE XREF: sub_FD5C7+EBj
f000:D6C4							      ;	sub_FD5C7+F7j
f000:D6C4		  mov	  [bp+0], al
f000:D6C7		  inc	  bp
f000:D6C8		  loop	  l23
f000:D6CA		  jmp	  short	l24
f000:D6CA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D6CC		  db  90h ; 
f000:D6CD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D6CD
f000:D6CD l23:							      ;	CODE XREF: sub_FD5C7+101j
f000:D6CD		  jmp	  l0
f000:D6D0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D6D0
f000:D6D0 l24:							      ;	CODE XREF: sub_FD5C7+103j
f000:D6D0		  sub	  bp, 8
f000:D6D3		  mov	  [bp+8], dl
f000:D6D6		  xor	  ax, ax
f000:D6D8		  mov	  es, ax
f000:D6DA		  mov	  bx, 110h
f000:D6DD		  mov	  di, es:[bx]
f000:D6E0		  mov	  ax, es:[bx+2]
f000:D6E4		  mov	  es, ax
f000:D6E6		  xor	  cx, cx
f000:D6E8		  push	  ds
f000:D6E9		  mov	  ax, ss
f000:D6EB		  mov	  ds, ax
f000:D6ED		  xor	  ax, ax
f000:D6EF		  jmp	  short	l26
f000:D6F1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D6F1
f000:D6F1 l25:							      ;	CODE XREF: sub_FD5C7+13Dj
f000:D6F1							      ;	sub_FD5C7+142j
f000:D6F1		  inc	  ax
f000:D6F2		  cmp	  ax, 7Fh ; ''
f000:D6F5		  ja	  short	l28
f000:D6F7
f000:D6F7 l26:							      ;	CODE XREF: sub_FD5C7+128j
f000:D6F7		  mov	  si, bp
f000:D6F9		  mov	  cx, 4
f000:D6FC		  repe cmpsw
f000:D6FE		  jz	  short	l27
f000:D700		  add	  di, cx
f000:D702		  add	  di, cx
f000:D704		  jmp	  short	l25
f000:D706 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D706
f000:D706 l27:							      ;	CODE XREF: sub_FD5C7+137j
f000:D706		  cmp	  cx, 0
f000:D709		  jnz	  short	l25
f000:D70B		  jmp	  short	l33
f000:D70D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D70D
f000:D70D l28:							      ;	CODE XREF: sub_FD5C7+12Ej
f000:D70D		  xor	  ax, ax
f000:D70F		  mov	  es, ax
f000:D711		  mov	  bx, 7Ch ; '|'
f000:D714		  mov	  di, es:[bx]
f000:D717		  mov	  ax, es:[bx+2]
f000:D71B		  mov	  es, ax
f000:D71D		  xor	  cx, cx
f000:D71F		  mov	  ax, ss
f000:D721		  mov	  ds, ax
f000:D723		  xor	  ax, ax
f000:D725		  jmp	  short	l30
f000:D727 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D727
f000:D727 l29:							      ;	CODE XREF: sub_FD5C7+173j
f000:D727							      ;	sub_FD5C7+178j
f000:D727		  inc	  ax
f000:D728		  cmp	  ax, 7Fh ; ''
f000:D72B		  ja	  short	l32
f000:D72D
f000:D72D l30:							      ;	CODE XREF: sub_FD5C7+15Ej
f000:D72D		  mov	  si, bp
f000:D72F		  mov	  cx, 4
f000:D732		  repe cmpsw
f000:D734		  jz	  short	l31
f000:D736		  add	  di, cx
f000:D738		  add	  di, cx
f000:D73A		  jmp	  short	l29
f000:D73C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D73C
f000:D73C l31:							      ;	CODE XREF: sub_FD5C7+16Dj
f000:D73C		  cmp	  cx, 0
f000:D73F		  jnz	  short	l29
f000:D741		  add	  ax, 80h ; '€'
f000:D744		  jmp	  short	l33
f000:D746 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D746
f000:D746 l32:							      ;	CODE XREF: sub_FD5C7+164j
f000:D746		  pop	  ds
f000:D747		  xor	  ax, ax
f000:D749		  jmp	  short	l34
f000:D74B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D74B
f000:D74B l33:							      ;	CODE XREF: sub_FD5C7+144j
f000:D74B							      ;	sub_FD5C7+17Dj
f000:D74B		  pop	  ds
f000:D74C		  mov	  ah, [bp+8]
f000:D74F
f000:D74F l34:							      ;	CODE XREF: sub_FD5C7+182j
f000:D74F		  add	  sp, 0Ah
f000:D752		  pop	  bx
f000:D753		  retn
f000:D753 sub_FD5C7	  endp
f000:D753
f000:D754
f000:D754 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D754
f000:D754
f000:D754 sub_FD754	  proc near				      ;	CODE XREF: int_10_0a+12p
f000:D754
f000:D754 ; FUNCTION CHUNK AT f000:D91B	SIZE 00000003 BYTES
f000:D754
f000:D754		  mov	  bx, cx
f000:D756		  call	  sub_FDAE9
f000:D759		  push	  cx
f000:D75A		  push	  dx
f000:D75B		  push	  bx
f000:D75C		  push	  ax
f000:D75D		  cmp	  al, 7Fh ; ''
f000:D75F		  jbe	  short	loc_FD777
f000:D761		  pop	  ax
f000:D762		  sub	  al, 80h ; '€'
f000:D764		  push	  ax
f000:D765		  xor	  ax, ax
f000:D767		  mov	  es, ax			      ;	es = 0
f000:D769		  mov	  bx, 7Ch ; '|'                       ; int 0x1f
f000:D76C		  mov	  si, es:[bx]			      ;	int 0x1f offset	(chatset 128-255)
f000:D76F		  mov	  ax, es:[bx+2]			      ;	int 0x1f segment
f000:D773		  mov	  es, ax
f000:D775		  jmp	  short	loc_FD787
f000:D777 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D777
f000:D777 loc_FD777:						      ;	CODE XREF: sub_FD754+Bj
f000:D777		  xor	  ax, ax
f000:D779		  mov	  es, ax
f000:D77B		  mov	  bx, 110h			      ;	int 0x44
f000:D77E		  mov	  si, es:[bx]			      ;	int 0x44 offset	(charset 0-127)
f000:D781		  mov	  ax, es:[bx+2]			      ;	int 0x44 segment
f000:D785		  mov	  es, ax
f000:D787
f000:D787 loc_FD787:						      ;	CODE XREF: sub_FD754+21j
f000:D787		  pop	  ax
f000:D788		  xor	  bh, bh
f000:D78A		  mov	  bl, al
f000:D78C		  shl	  bx, 1
f000:D78E		  shl	  bx, 1
f000:D790		  shl	  bx, 1
f000:D792		  add	  si, bx
f000:D794		  jmp	  short	loc_FD7D1
f000:D796 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D796
f000:D796 loc_FD796:						      ;	CODE XREF: sub_FD754:loc_FD86Cj
f000:D796		  mov	  bp, cx
f000:D798		  pop	  dx
f000:D799		  pop	  cx
f000:D79A		  sub	  si, 8
f000:D79D		  mov	  bx, 0A0h ; ' '
f000:D7A0		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:D7A5		  jz	  short	loc_FD7BB
f000:D7A7		  mov	  bx, 140h
f000:D7AA		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D7AF		  jz	  short	loc_FD7BB
f000:D7B1		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:D7B6		  jb	  short	loc_FD7BB
f000:D7B8		  mov	  bx, 280h
f000:D7BB
f000:D7BB loc_FD7BB:						      ;	CODE XREF: sub_FD754+51j
f000:D7BB							      ;	sub_FD754+5Bj
f000:D7BB							      ;	sub_FD754+62j
f000:D7BB		  add	  cx, 8
f000:D7BE		  cmp	  cx, bx
f000:D7C0		  jnz	  short	loc_FD7CE
f000:D7C2		  add	  dx, 8
f000:D7C5		  xor	  cx, cx
f000:D7C7		  cmp	  dx, 0C8h ; 'È'
f000:D7CB		  jnz	  short	loc_FD7CE
f000:D7CD		  retn
f000:D7CE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D7CE
f000:D7CE loc_FD7CE:						      ;	CODE XREF: sub_FD754+6Cj
f000:D7CE							      ;	sub_FD754+77j
f000:D7CE		  push	  cx
f000:D7CF		  push	  dx
f000:D7D0		  push	  bp
f000:D7D1
f000:D7D1 loc_FD7D1:						      ;	CODE XREF: sub_FD754+40j
f000:D7D1		  call	  loc_FD9CB
f000:D7D4		  mov	  di, bx
f000:D7D6		  push	  di
f000:D7D7		  mov	  bp, sp
f000:D7D9		  xor	  bx, bx
f000:D7DB		  mov	  cx, 8
f000:D7DE		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:D7E3		  jnz	  short	loc_FD7E8
f000:D7E5		  jmp	  loc_FD86F
f000:D7E8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D7E8
f000:D7E8 loc_FD7E8:						      ;	CODE XREF: sub_FD754+8Fj
f000:D7E8		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D7ED		  jnz	  short	loc_FD7F2
f000:D7EF		  jmp	  short	loc_FD86F
f000:D7EF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D7F1		  db  90h ; 
f000:D7F2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D7F2
f000:D7F2 loc_FD7F2:						      ;	CODE XREF: sub_FD754+99j
f000:D7F2		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:D7F7		  jnz	  short	loc_FD7FC
f000:D7F9		  jmp	  loc_FD91B
f000:D7FC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D7FC
f000:D7FC loc_FD7FC:						      ;	CODE XREF: sub_FD754+A3j
f000:D7FC							      ;	sub_FD754:loc_FD863j
f000:D7FC		  mov	  dl, es:[si]
f000:D7FF		  inc	  si
f000:D800		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:D805		  jz	  short	loc_FD821
f000:D807		  push	  cx
f000:D808		  mov	  cx, 8
f000:D80B		  mov	  al, dl
f000:D80D		  xor	  dx, dx
f000:D80F
f000:D80F loc_FD80F:						      ;	CODE XREF: sub_FD754:loc_FD81Ej
f000:D80F		  shl	  dx, 1
f000:D811		  shl	  dx, 1
f000:D813		  shl	  al, 1
f000:D815		  jnb	  short	loc_FD81E
f000:D817		  push	  ax
f000:D818		  and	  ah, 3
f000:D81B		  or	  dl, ah
f000:D81D		  pop	  ax
f000:D81E
f000:D81E loc_FD81E:						      ;	CODE XREF: sub_FD754+C1j
f000:D81E		  loop	  loc_FD80F
f000:D820		  pop	  cx
f000:D821
f000:D821 loc_FD821:						      ;	CODE XREF: sub_FD754+B1j
f000:D821		  push	  es
f000:D822		  mov	  es, cs:value_b000
f000:D827		  push	  ax
f000:D828		  xchg	  ax, dx
f000:D829		  mov	  di, [bp+0]
f000:D82C		  add	  di, bx
f000:D82E		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:D833		  jz	  short	loc_FD846
f000:D835		  xchg	  ah, al
f000:D837		  test	  dh, 80h
f000:D83A		  jz	  short	loc_FD843
f000:D83C		  xor	  es:[di], ax
f000:D83F		  inc	  di
f000:D840		  inc	  di
f000:D841		  jmp	  short	loc_FD852
f000:D843 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D843
f000:D843 loc_FD843:						      ;	CODE XREF: sub_FD754+E6j
f000:D843		  stosw
f000:D844		  jmp	  short	loc_FD852
f000:D846 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D846
f000:D846 loc_FD846:						      ;	CODE XREF: sub_FD754+DFj
f000:D846		  test	  dh, 80h
f000:D849		  jz	  short	loc_FD851
f000:D84B		  xor	  es:[di], al
f000:D84E		  inc	  di
f000:D84F		  jmp	  short	loc_FD852
f000:D851 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D851
f000:D851 loc_FD851:						      ;	CODE XREF: sub_FD754+F5j
f000:D851		  stosb
f000:D852
f000:D852 loc_FD852:						      ;	CODE XREF: sub_FD754+EDj
f000:D852							      ;	sub_FD754+F0j
f000:D852							      ;	sub_FD754+FBj
f000:D852		  pop	  ax
f000:D853		  pop	  es
f000:D854		  test	  cx, 1
f000:D858		  jnz	  short	loc_FD85F
f000:D85A		  add	  bh, 20h ; ' '
f000:D85D		  jmp	  short	loc_FD863
f000:D85F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D85F
f000:D85F loc_FD85F:						      ;	CODE XREF: sub_FD754+104j
f000:D85F		  sub	  bx, 1FB0h
f000:D863
f000:D863 loc_FD863:						      ;	CODE XREF: sub_FD754+109j
f000:D863		  loop	  loc_FD7FC
f000:D865
f000:D865 loc_FD865:						      ;	CODE XREF: sub_FD754+198j
f000:D865		  pop	  di
f000:D866		  pop	  cx
f000:D867		  loop	  loc_FD86C
f000:D869		  pop	  dx
f000:D86A		  pop	  cx
f000:D86B		  retn
f000:D86C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D86C
f000:D86C loc_FD86C:						      ;	CODE XREF: sub_FD754+113j
f000:D86C		  jmp	  loc_FD796
f000:D86F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D86F
f000:D86F loc_FD86F:						      ;	CODE XREF: sub_FD754+91j
f000:D86F							      ;	sub_FD754+9Bj
f000:D86F							      ;	sub_FD754:loc_FD91Bj
f000:D86F		  mov	  cx, 8
f000:D872
f000:D872 loc_FD872:						      ;	CODE XREF: sub_FD754:loc_FD8EAj
f000:D872		  push	  cx
f000:D873		  mov	  dl, es:[si]
f000:D876		  inc	  si
f000:D877		  mov	  al, dl
f000:D879		  push	  es
f000:D87A		  push	  bx
f000:D87B		  mov	  es, cs:value_b000
f000:D880		  mov	  di, [bp+0]
f000:D883		  add	  di, bx
f000:D885		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:D88A		  jnz	  short	loc_FD8AF
f000:D88C		  xchg	  ax, dx
f000:D88D		  mov	  ah, al
f000:D88F		  test	  dh, 1
f000:D892		  jnz	  short	loc_FD896
f000:D894		  mov	  al, 0
f000:D896
f000:D896 loc_FD896:						      ;	CODE XREF: sub_FD754+13Ej
f000:D896		  test	  dh, 2
f000:D899		  jnz	  short	loc_FD89D
f000:D89B		  mov	  ah, 0
f000:D89D
f000:D89D loc_FD89D:						      ;	CODE XREF: sub_FD754+145j
f000:D89D		  test	  dh, 80h
f000:D8A0		  jz	  short	loc_FD8AA
f000:D8A2		  xor	  es:[di], ax
f000:D8A5		  inc	  di
f000:D8A6		  inc	  di
f000:D8A7		  jmp	  short	loc_FD8AB
f000:D8A7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8A9		  db  90h ; 
f000:D8AA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8AA
f000:D8AA loc_FD8AA:						      ;	CODE XREF: sub_FD754+14Cj
f000:D8AA		  stosw
f000:D8AB
f000:D8AB loc_FD8AB:						      ;	CODE XREF: sub_FD754+153j
f000:D8AB		  xchg	  ax, dx
f000:D8AC		  jmp	  short	loc_FD8D0
f000:D8AC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8AE		  db  90h ; 
f000:D8AF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8AF
f000:D8AF loc_FD8AF:						      ;	CODE XREF: sub_FD754+136j
f000:D8AF		  call	  sub_FD900
f000:D8B2		  mov	  dx, bx
f000:D8B4		  call	  sub_FD900
f000:D8B7		  mov	  cx, 2
f000:D8BA
f000:D8BA loc_FD8BA:						      ;	CODE XREF: sub_FD754+17Aj
f000:D8BA		  xchg	  ax, dx
f000:D8BB		  xchg	  ah, al
f000:D8BD		  test	  dh, 80h
f000:D8C0		  jz	  short	loc_FD8CA
f000:D8C2		  xor	  es:[di], ax
f000:D8C5		  inc	  di
f000:D8C6		  inc	  di
f000:D8C7		  jmp	  short	loc_FD8CB
f000:D8C7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8C9		  db  90h ; 
f000:D8CA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8CA
f000:D8CA loc_FD8CA:						      ;	CODE XREF: sub_FD754+16Cj
f000:D8CA		  stosw
f000:D8CB
f000:D8CB loc_FD8CB:						      ;	CODE XREF: sub_FD754+173j
f000:D8CB		  xchg	  ax, dx
f000:D8CC		  mov	  dx, bx
f000:D8CE		  loop	  loc_FD8BA
f000:D8D0
f000:D8D0 loc_FD8D0:						      ;	CODE XREF: sub_FD754+158j
f000:D8D0		  pop	  bx
f000:D8D1		  pop	  es
f000:D8D2		  pop	  cx
f000:D8D3		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:D8D8		  jnz	  short	loc_FD8EF
f000:D8DA		  test	  cx, 1
f000:D8DE		  jnz	  short	loc_FD8E6
f000:D8E0		  add	  bh, 20h ; ' '
f000:D8E3		  jmp	  short	loc_FD8EA
f000:D8E3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8E5		  db  90h ; 
f000:D8E6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8E6
f000:D8E6 loc_FD8E6:						      ;	CODE XREF: sub_FD754+18Aj
f000:D8E6		  sub	  bx, 1FB0h
f000:D8EA
f000:D8EA loc_FD8EA:						      ;	CODE XREF: sub_FD754+18Fj
f000:D8EA							      ;	sub_FD754:loc_FD8FEj
f000:D8EA		  loop	  loc_FD872
f000:D8EC		  jmp	  loc_FD865
f000:D8EF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8EF
f000:D8EF loc_FD8EF:						      ;	CODE XREF: sub_FD754+184j
f000:D8EF		  cmp	  cx, 5
f000:D8F2		  jnz	  short	loc_FD8FB
f000:D8F4		  sub	  bx, 5F60h
f000:D8F8		  jmp	  short	loc_FD8FE
f000:D8F8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8FA		  db  90h ; 
f000:D8FB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D8FB
f000:D8FB loc_FD8FB:						      ;	CODE XREF: sub_FD754+19Ej
f000:D8FB		  add	  bh, 20h ; ' '
f000:D8FE
f000:D8FE loc_FD8FE:						      ;	CODE XREF: sub_FD754+1A4j
f000:D8FE		  jmp	  short	loc_FD8EA
f000:D8FE sub_FD754	  endp
f000:D8FE
f000:D900
f000:D900 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D900
f000:D900
f000:D900 sub_FD900	  proc near				      ;	CODE XREF: sub_FD754:loc_FD8AFp
f000:D900							      ;	sub_FD754+160p
f000:D900		  xor	  bx, bx
f000:D902		  mov	  cx, 4
f000:D905
f000:D905 l0:							      ;	CODE XREF: sub_FD900:l1j
f000:D905		  shl	  bx, 1
f000:D907		  shl	  bx, 1
f000:D909		  shl	  bx, 1
f000:D90B		  shl	  bx, 1
f000:D90D		  shl	  al, 1
f000:D90F		  jnb	  short	l1
f000:D911		  push	  ax
f000:D912		  and	  ah, 0Fh
f000:D915		  or	  bl, ah
f000:D917		  pop	  ax
f000:D918
f000:D918 l1:							      ;	CODE XREF: sub_FD900+Fj
f000:D918		  loop	  l0
f000:D91A		  retn
f000:D91A sub_FD900	  endp
f000:D91A
f000:D91B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D91B ; START OF FUNCTION CHUNK FOR	sub_FD754
f000:D91B
f000:D91B loc_FD91B:						      ;	CODE XREF: sub_FD754+A5j
f000:D91B		  jmp	  loc_FD86F
f000:D91B ; END	OF FUNCTION CHUNK FOR sub_FD754
f000:D91E
f000:D91E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D91E
f000:D91E ;	Returns	a list of installed equipment on the system.
f000:D91E ;
f000:D91E ;	   On entry:	  No parameters
f000:D91E ;
f000:D91E ;	   Returns:	  AX	     Equipment code
f000:D91E ;
f000:D91E ;   --------------------------------------------------------------------------
f000:D91E ;
f000:D91E ;			       Equipment code (AX)
f000:D91E ;
f000:D91E ;   F	E D C B	A 9 8  7 6 5 4 3 2 1 0
f000:D91E ;   x	x . . .	. . .  . . . . . . . .	Number of printers installed
f000:D91E ;   .	. x . .	. . .  . . . . . . . .	Internal modem installed
f000:D91E ;   .	. . x .	. . .  . . . . . . . .	Game adapter installed?	(always	1 on PCJr)
f000:D91E ;   .	. . . x	x x .  . . . . . . . .	Number of RS-232 ports
f000:D91E ;   .	. . . .	. . x  . . . . . . . .	DMA present
f000:D91E ;   .	. . . .	. . .  x x . . . . . .	Number of diskettes - 1	(i.e. 0=1 disk)
f000:D91E ;   .	. . . .	. . .  . . x x . . . .	Initial	video mode (see	below)
f000:D91E ;   .	. . . .	. . .  . . . . x . . .	Reserved
f000:D91E ;   .	. . . .	. . .  . . . . . x . .	Reserved
f000:D91E ;   .	. . . .	. . .  . . . . . . x .	Math coprocessor installed?
f000:D91E ;   .	. . . .	. . .  . . . . . . . x	1=diskettes present; 0=no disks	present
f000:D91E ;
f000:D91E ;
f000:D91E ;			     Initial video mode
f000:D91E ;
f000:D91E ;			Value		      Meaning
f000:D91E ;			 00		      Reserved
f000:D91E ;			 01		      40 x 25 Color
f000:D91E ;			 10		      80 x 25 Color
f000:D91E ;			 11		      80 x 25 Monochrome
f000:D91E
f000:D91E int_11	  proc far				      ;	DATA XREF: f000:FF05o
f000:D91E		  push	  bx
f000:D91F		  push	  ds
f000:D920		  mov	  ax, 40h ; '@'
f000:D923		  mov	  ds, ax			      ;	ds = 0x40
f000:D925		  lea	  bx, ds:p400.installed_hardware
f000:D929		  mov	  ax, [bx]			      ;	`mov ax, ds:10h` perhaps?
f000:D92B		  pop	  ds
f000:D92C		  pop	  bx
f000:D92D		  iret
f000:D92D int_11	  endp
f000:D92D
f000:D92E
f000:D92E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D92E
f000:D92E ;	Reports	the number of contiguous 1K memory blocks in the system	(up to
f000:D92E ;	640K).
f000:D92E ;
f000:D92E ;	   On entry:	  No parameters
f000:D92E ;
f000:D92E ;	   Returns:	  AX	     Memory size (up to	640K)
f000:D92E
f000:D92E int_12	  proc far				      ;	DATA XREF: f000:FF07o
f000:D92E		  push	  bx
f000:D92F		  push	  ds
f000:D930		  mov	  ax, 40h ; '@'
f000:D933		  mov	  ds, ax			      ;	ds = 0x40
f000:D935		  lea	  bx, ds:p400.base_mem_kb	      ;	`mov ax, ds:1dh` perhaps?
f000:D939		  mov	  ax, [bx]
f000:D93B		  pop	  ds
f000:D93C		  pop	  bx
f000:D93D		  iret
f000:D93D int_12	  endp
f000:D93D
f000:D93E
f000:D93E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D93E
f000:D93E ; Attributes:	bp-based frame
f000:D93E
f000:D93E int_push_regs	  proc near				      ;	CODE XREF: int_13p
f000:D93E							      ;	int_14p
f000:D93E							      ;	int_09p
f000:D93E							      ;	int_17p
f000:D93E							      ;	int_10p
f000:D93E
f000:D93E arg_C		  = word ptr  0Eh
f000:D93E
f000:D93E		  sti
f000:D93F		  push	  cx
f000:D940		  push	  dx
f000:D941		  push	  si
f000:D942		  push	  di
f000:D943		  push	  bp
f000:D944		  push	  ds
f000:D945		  push	  es
f000:D946		  mov	  bp, sp
f000:D948		  push	  [bp+arg_C]
f000:D94B		  mov	  [bp+arg_C], bx
f000:D94E		  retn
f000:D94E int_push_regs	  endp ; sp = -10h
f000:D94E
f000:D94F
f000:D94F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D94F
f000:D94F
f000:D94F int_pop_regs_and_exit	proc far			      ;	CODE XREF: int_14:exit1j
f000:D94F							      ;	int_09+197j
f000:D94F							      ;	int_17:exit1j
f000:D94F							      ;	int_10:errorj
f000:D94F							      ;	int_10_00+1Aj
f000:D94F							      ;	int_10_00+1C3j	...
f000:D94F		  pop	  es
f000:D950		  pop	  ds
f000:D951		  pop	  bp
f000:D952		  pop	  di
f000:D953		  pop	  si
f000:D954		  pop	  dx
f000:D955		  pop	  cx
f000:D956		  pop	  bx
f000:D957		  iret
f000:D957 int_pop_regs_and_exit	endp ; sp =  10h
f000:D957
f000:D958
f000:D958 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D958
f000:D958 ; check whether al is	between	0 and di
f000:D958 ; set	ds to 0x40
f000:D958
f000:D958 check_valid_subfunction proc near			      ;	CODE XREF: int_13+7p
f000:D958							      ;	int_14+7p
f000:D958							      ;	int_16+Bp
f000:D958							      ;	int_17+7p
f000:D958							      ;	int_10+8p
f000:D958		  push	  ax
f000:D959		  mov	  al, ah
f000:D95B		  xor	  ah, ah
f000:D95D		  shl	  ax, 1
f000:D95F		  cmp	  ax, di
f000:D961		  mov	  di, ax
f000:D963		  mov	  ax, 40h ; '@'
f000:D966		  mov	  ds, ax			      ;	ds = 0x40
f000:D968		  pop	  ax
f000:D969		  jnb	  short	error
f000:D96B		  clc
f000:D96C		  retn
f000:D96D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D96D
f000:D96D error:						      ;	CODE XREF: check_valid_subfunction+11j
f000:D96D		  stc
f000:D96E		  retn
f000:D96E check_valid_subfunction endp
f000:D96E
f000:D96F
f000:D96F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D96F
f000:D96F
f000:D96F sub_FD96F	  proc near				      ;	CODE XREF: sub_FF4ED+2Ep
f000:D96F							      ;	sub_FF4ED+4Fp
f000:D96F							      ;	sub_FF4ED+79p
f000:D96F							      ;	int_10_08+11p
f000:D96F							      ;	int_10_0a+1Cp
f000:D96F		  push	  ax
f000:D970		  push	  dx
f000:D971		  push	  di
f000:D972		  mov	  ax, 0B000h
f000:D975		  cmp	  byte ptr ds:p400.crt_mode, 7
f000:D97A		  jnz	  short	l0
f000:D97C		  xor	  bh, bh
f000:D97E		  mov	  es, ax
f000:D980		  jmp	  short	l1
f000:D982 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D982
f000:D982 l0:							      ;	CODE XREF: sub_FD96F+Bj
f000:D982		  add	  ah, 8
f000:D985		  mov	  es, ax
f000:D987		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:D98C		  jl	  short	l1
f000:D98E		  xor	  bh, bh
f000:D990
f000:D990 l1:							      ;	CODE XREF: sub_FD96F+11j
f000:D990							      ;	sub_FD96F+1Dj
f000:D990		  cmp	  bl, 0
f000:D993		  jz	  short	l2
f000:D995		  mov	  bl, bh
f000:D997		  call	  get_rowcols_for_page
f000:D99A
f000:D99A l2:							      ;	CODE XREF: sub_FD96F+24j
f000:D99A		  xor	  di, di
f000:D99C		  cmp	  byte ptr ds:p400.crt_mode, 7
f000:D9A1		  jz	  short	l3
f000:D9A3		  push	  dx
f000:D9A4		  mov	  ax, ds:p400.crt_page_len
f000:D9A7		  mov	  bl, bh
f000:D9A9		  xor	  bh, bh
f000:D9AB		  mul	  bx
f000:D9AD		  add	  di, ax
f000:D9AF		  pop	  dx
f000:D9B0
f000:D9B0 l3:							      ;	CODE XREF: sub_FD96F+32j
f000:D9B0		  xor	  ah, ah
f000:D9B2		  mov	  al, dh
f000:D9B4		  mul	  byte ptr ds:p400.crt_nr_cols
f000:D9B8		  shl	  ax, 1
f000:D9BA		  xor	  dh, dh
f000:D9BC		  shl	  dx, 1
f000:D9BE		  add	  ax, dx
f000:D9C0		  mov	  bx, ax
f000:D9C2		  add	  bx, di
f000:D9C4		  pop	  di
f000:D9C5		  pop	  dx
f000:D9C6		  pop	  ax
f000:D9C7		  retn
f000:D9C7 sub_FD96F	  endp
f000:D9C7
f000:D9C8
f000:D9C8 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:D9C8
f000:D9C8
f000:D9C8 sub_FD9C8	  proc near				      ;	CODE XREF: sub_FF4ED-20BCp
f000:D9C8							      ;	sub_FF4ED:loc_FD436p
f000:D9C8							      ;	sub_FF4ED-2082p
f000:D9C8							      ;	sub_FF4ED:loc_FD490p
f000:D9C8							      ;	sub_FD5C7p
f000:D9C8		  call	  sub_FDAE9
f000:D9CB
f000:D9CB loc_FD9CB:						      ;	CODE XREF: sub_FD754:loc_FD7D1p
f000:D9CB							      ;	sub_FF93F:l3p
f000:D9CB							      ;	sub_FF93F+51p
f000:D9CB		  push	  ax
f000:D9CC		  push	  cx
f000:D9CD		  push	  dx
f000:D9CE		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:D9D3		  jnz	  short	l0
f000:D9D5		  jmp	  short	l7
f000:D9D5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D9D7		  db  90h ; 
f000:D9D8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D9D8
f000:D9D8 l0:							      ;	CODE XREF: sub_FD9C8+Bj
f000:D9D8		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:D9DD		  jnz	  short	l1
f000:D9DF		  jmp	  l10
f000:D9E2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D9E2
f000:D9E2 l1:							      ;	CODE XREF: sub_FD9C8+15j
f000:D9E2		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:D9E7		  jnz	  short	l2
f000:D9E9		  jmp	  l15
f000:D9EC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:D9EC
f000:D9EC l2:							      ;	CODE XREF: sub_FD9C8+1Fj
f000:D9EC		  mov	  ax, 28h ; '('
f000:D9EF		  and	  dx, 0FFFEh
f000:D9F3		  mul	  dx
f000:D9F5		  shr	  cx, 1
f000:D9F7		  shr	  cx, 1
f000:D9F9		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:D9FE		  jnz	  short	l3
f000:DA00		  shr	  cx, 1
f000:DA02
f000:DA02 l3:							      ;	CODE XREF: sub_FD9C8+36j
f000:DA02		  add	  ax, cx
f000:DA04		  add	  ah, 80h ; '€'
f000:DA07		  pop	  bx
f000:DA08		  test	  bx, 1
f000:DA0C		  jz	  short	l4
f000:DA0E		  add	  ah, 20h ; ' '
f000:DA11
f000:DA11 l4:							      ;	CODE XREF: sub_FD9C8+44j
f000:DA11		  mov	  bx, ax
f000:DA13		  pop	  ax
f000:DA14		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:DA19		  jnz	  short	l5
f000:DA1B		  mov	  cx, 8
f000:DA1E		  div	  cx
f000:DA20		  mov	  cl, 7
f000:DA22		  sub	  cl, dl
f000:DA24		  jmp	  short	l6
f000:DA26 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DA26
f000:DA26 l5:							      ;	CODE XREF: sub_FD9C8+51j
f000:DA26		  mov	  cx, 4
f000:DA29		  div	  cx
f000:DA2B		  shl	  dx, 1
f000:DA2D		  mov	  cl, 6
f000:DA2F		  sub	  cl, dl
f000:DA31
f000:DA31 l6:							      ;	CODE XREF: sub_FD9C8+5Cj
f000:DA31							      ;	sub_FD9C8:l9j
f000:DA31							      ;	sub_FD9C8:l14j
f000:DA31							      ;	sub_FD9C8+11Ej
f000:DA31		  pop	  ax
f000:DA32		  retn
f000:DA33 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DA33
f000:DA33 l7:							      ;	CODE XREF: sub_FD9C8+Dj
f000:DA33		  mov	  ax, 28h ; '('
f000:DA36		  and	  dx, 0FFFEh
f000:DA3A		  mul	  dx
f000:DA3C		  shr	  cx, 1
f000:DA3E		  add	  ax, cx
f000:DA40		  add	  ah, 80h ; '€'
f000:DA43		  pop	  bx
f000:DA44		  test	  bx, 1
f000:DA48		  jz	  short	l8
f000:DA4A		  add	  ah, 20h ; ' '
f000:DA4D
f000:DA4D l8:							      ;	CODE XREF: sub_FD9C8+80j
f000:DA4D		  mov	  bx, ax
f000:DA4F		  pop	  ax
f000:DA50		  mov	  cx, 2
f000:DA53		  div	  cx
f000:DA55		  mov	  cx, 4
f000:DA58		  and	  dl, dl
f000:DA5A		  jz	  short	l9
f000:DA5C		  mov	  cx, 0
f000:DA5F
f000:DA5F l9:							      ;	CODE XREF: sub_FD9C8+92j
f000:DA5F		  jmp	  short	l6
f000:DA61 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DA61
f000:DA61 l10:							      ;	CODE XREF: sub_FD9C8+17j
f000:DA61		  mov	  ax, 50h ; 'P'
f000:DA64		  and	  dx, 0FFFCh
f000:DA68		  shr	  dx, 1
f000:DA6A		  mul	  dx
f000:DA6C		  shr	  cx, 1
f000:DA6E		  add	  ax, cx
f000:DA70		  add	  ah, 80h ; '€'
f000:DA73		  pop	  bx
f000:DA74		  and	  bx, 3
f000:DA78		  cmp	  bx, 3
f000:DA7B		  jb	  short	l11
f000:DA7D		  add	  ah, 20h ; ' '
f000:DA80
f000:DA80 l11:							      ;	CODE XREF: sub_FD9C8+B3j
f000:DA80		  cmp	  bx, 2
f000:DA83		  jb	  short	l12
f000:DA85		  add	  ah, 20h ; ' '
f000:DA88
f000:DA88 l12:							      ;	CODE XREF: sub_FD9C8+BBj
f000:DA88		  cmp	  bx, 1
f000:DA8B		  jb	  short	l13
f000:DA8D		  add	  ah, 20h ; ' '
f000:DA90
f000:DA90 l13:							      ;	CODE XREF: sub_FD9C8+C3j
f000:DA90		  mov	  bx, ax
f000:DA92		  pop	  ax
f000:DA93		  mov	  cx, 2
f000:DA96		  div	  cx
f000:DA98		  mov	  cx, 4
f000:DA9B		  and	  dl, dl
f000:DA9D		  jz	  short	l14
f000:DA9F		  mov	  cx, 0
f000:DAA2
f000:DAA2 l14:							      ;	CODE XREF: sub_FD9C8+D5j
f000:DAA2		  jmp	  short	l6
f000:DAA4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DAA4
f000:DAA4 l15:							      ;	CODE XREF: sub_FD9C8+21j
f000:DAA4		  mov	  ax, 50h ; 'P'
f000:DAA7		  and	  dx, 0FFFCh
f000:DAAB		  shr	  dx, 1
f000:DAAD		  mul	  dx
f000:DAAF		  shr	  cx, 1
f000:DAB1		  shr	  cx, 1
f000:DAB3		  and	  cx, 0FFFEh
f000:DAB7		  add	  ax, cx
f000:DAB9		  add	  ah, 80h ; '€'
f000:DABC		  pop	  bx
f000:DABD		  and	  bx, 3
f000:DAC1		  cmp	  bx, 3
f000:DAC4		  jb	  short	l16
f000:DAC6		  add	  ah, 20h ; ' '
f000:DAC9
f000:DAC9 l16:							      ;	CODE XREF: sub_FD9C8+FCj
f000:DAC9		  cmp	  bx, 2
f000:DACC		  jb	  short	l17
f000:DACE		  add	  ah, 20h ; ' '
f000:DAD1
f000:DAD1 l17:							      ;	CODE XREF: sub_FD9C8+104j
f000:DAD1		  cmp	  bx, 1
f000:DAD4		  jb	  short	l18
f000:DAD6		  add	  ah, 20h ; ' '
f000:DAD9
f000:DAD9 l18:							      ;	CODE XREF: sub_FD9C8+10Cj
f000:DAD9		  mov	  bx, ax
f000:DADB		  pop	  ax
f000:DADC		  mov	  cx, 8
f000:DADF		  div	  cx
f000:DAE1		  mov	  cx, 7
f000:DAE4		  sub	  cx, dx
f000:DAE6		  jmp	  l6
f000:DAE6 sub_FD9C8	  endp
f000:DAE6
f000:DAE9
f000:DAE9 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DAE9
f000:DAE9
f000:DAE9 sub_FDAE9	  proc near				      ;	CODE XREF: sub_FD754+2p
f000:DAE9							      ;	sub_FD9C8p
f000:DAE9		  xor	  ch, ch
f000:DAEB		  mov	  cl, dl
f000:DAED		  shl	  cx, 1
f000:DAEF		  shl	  cx, 1
f000:DAF1		  shl	  cx, 1
f000:DAF3		  mov	  dl, dh
f000:DAF5		  xor	  dh, dh
f000:DAF7		  shl	  dx, 1
f000:DAF9		  shl	  dx, 1
f000:DAFB		  shl	  dx, 1
f000:DAFD		  retn
f000:DAFD sub_FDAE9	  endp
f000:DAFD
f000:DAFE
f000:DAFE ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DAFE
f000:DAFE ; get_rowcols_for_page
f000:DAFE ; in:
f000:DAFE ;   bx = page	number
f000:DAFE ; out:
f000:DAFE ;   dl = rows
f000:DAFE ;   dh = cols
f000:DAFE
f000:DAFE get_rowcols_for_page proc near			      ;	CODE XREF: sub_FD96F+28p
f000:DAFE							      ;	int_10_03+Bp
f000:DAFE							      ;	int_10_05+2Ep
f000:DAFE							      ;	int_10_08+7p
f000:DAFE							      ;	int_10_0a+Fp
f000:DAFE							      ;	int_10_0e+6p
f000:DAFE		  push	  bx
f000:DAFF		  xor	  bh, bh
f000:DB01		  shl	  bx, 1
f000:DB03		  mov	  dx, [bx+p400.cursor_row_col_in_pages]
f000:DB07		  pop	  bx
f000:DB08		  retn
f000:DB08 get_rowcols_for_page endp
f000:DB08
f000:DB09
f000:DB09 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DB09
f000:DB09
f000:DB09 sub_FDB09	  proc near				      ;	CODE XREF: sub_FF4ED+99p
f000:DB09							      ;	sub_FF4ED+A0p
f000:DB09							      ;	sub_FF4ED+B7p
f000:DB09		  push	  dx
f000:DB0A		  mov	  dx, ds:p400.crt_nr_cols
f000:DB0E		  shl	  dx, 1
f000:DB10		  cmp	  word ptr [bp+4], 0
f000:DB14		  jnz	  short	l0
f000:DB16		  add	  si, dx
f000:DB18		  add	  di, dx
f000:DB1A		  jmp	  short	l1
f000:DB1A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DB1C		  db  90h ; 
f000:DB1D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DB1D
f000:DB1D l0:							      ;	CODE XREF: sub_FDB09+Bj
f000:DB1D		  sub	  si, dx
f000:DB1F		  sub	  di, dx
f000:DB21
f000:DB21 l1:							      ;	CODE XREF: sub_FDB09+11j
f000:DB21		  pop	  dx
f000:DB22		  retn
f000:DB22 sub_FDB09	  endp
f000:DB22
f000:DB23
f000:DB23 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DB23
f000:DB23
f000:DB23 sub_FDB23	  proc near				      ;	CODE XREF: sub_FF4ED-1FB1p
f000:DB23							      ;	sub_FF4ED-1FA9p
f000:DB23							      ;	sub_FF4ED-1F2Ep
f000:DB23		  push	  ax
f000:DB24		  mov	  ax, 140h
f000:DB27		  cmp	  word ptr [bp+4], 0
f000:DB2B		  jz	  short	l0
f000:DB2D		  neg	  ax
f000:DB2F
f000:DB2F l0:							      ;	CODE XREF: sub_FDB23+8j
f000:DB2F		  add	  si, ax
f000:DB31		  add	  di, ax
f000:DB33		  pop	  ax
f000:DB34		  retn
f000:DB34 sub_FDB23	  endp
f000:DB34
f000:DB34 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DB35		  db  50h ; P
f000:DB36		  db  52h ; R
f000:DB37		  db 0E8h ; è
f000:DB38		  db  4Ah ; J
f000:DB39		  db	0
f000:DB3A		  db  73h ; s
f000:DB3B		  db  13h
f000:DB3C		  db 0BAh ; º
f000:DB3D		  db 0DAh ; Ú
f000:DB3E		  db	3
f000:DB3F		  db 0FAh ; ú
f000:DB40		  db 0ECh ; ì
f000:DB41		  db 0A8h ; ¨
f000:DB42		  db	8
f000:DB43		  db  74h ; t
f000:DB44		  db 0FBh ; û
f000:DB45		  db 0FBh ; û
f000:DB46		  db 0BAh ; º
f000:DB47		  db 0D8h ; Ø
f000:DB48		  db	3
f000:DB49		  db 0A0h ;  
f000:DB4A		  db  65h ; e
f000:DB4B		  db	0
f000:DB4C		  db  24h ; $
f000:DB4D		  db  37h ; 7
f000:DB4E		  db 0EEh ; î
f000:DB4F		  db  5Ah ; Z
f000:DB50		  db  58h ; X
f000:DB51		  db 0C3h ; Ã
f000:DB52		  db 0E8h ; è
f000:DB53		  db  2Fh ; /
f000:DB54		  db	0
f000:DB55		  db  73h ; s
f000:DB56		  db	7
f000:DB57		  db 0BAh ; º
f000:DB58		  db 0D8h ; Ø
f000:DB59		  db	3
f000:DB5A		  db 0A0h ;  
f000:DB5B		  db  65h ; e
f000:DB5C		  db	0
f000:DB5D		  db 0EEh ; î
f000:DB5E		  db 0C3h ; Ã
f000:DB5F
f000:DB5F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DB5F
f000:DB5F
f000:DB5F play_bell_sound? proc	near				      ;	CODE XREF: reset:l5p
f000:DB5F							      ;	int_09+19p
f000:DB5F							      ;	sub_FEDAA+1Ep
f000:DB5F							      ;	int_10_0e+Dp
f000:DB5F		  push	  ax
f000:DB60		  push	  bx
f000:DB61		  push	  cx
f000:DB62		  mov	  bx, 20h ; ' '
f000:DB65		  in	  al, 61h			      ;	PC/XT PPI port B bits:
f000:DB65							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:DB65							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:DB65							      ;	3: 1=read high switches
f000:DB65							      ;	4: 0=enable RAM	parity checking
f000:DB65							      ;	5: 0=enable I/O	channel	check
f000:DB65							      ;	6: 0=hold keyboard clock low
f000:DB65							      ;	7: 0=enable kbrd
f000:DB67		  push	  ax
f000:DB68
f000:DB68 l0:							      ;	CODE XREF: play_bell_sound?+1Cj
f000:DB68		  and	  al, 11111100b
f000:DB6A		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:DB6A							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:DB6A							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:DB6A							      ;	3: 1=read high switches
f000:DB6A							      ;	4: 0=enable RAM	parity checking
f000:DB6A							      ;	5: 0=enable I/O	channel	check
f000:DB6A							      ;	6: 0=hold keyboard clock low
f000:DB6A							      ;	7: 0=enable kbrd
f000:DB6C		  mov	  cx, 120h
f000:DB6F
f000:DB6F l1:							      ;	CODE XREF: play_bell_sound?:l1j
f000:DB6F		  loop	  l1
f000:DB71		  or	  al, 10b
f000:DB73		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:DB73							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:DB73							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:DB73							      ;	3: 1=read high switches
f000:DB73							      ;	4: 0=enable RAM	parity checking
f000:DB73							      ;	5: 0=enable I/O	channel	check
f000:DB73							      ;	6: 0=hold keyboard clock low
f000:DB73							      ;	7: 0=enable kbrd
f000:DB75		  mov	  cx, 120h
f000:DB78
f000:DB78 l2:							      ;	CODE XREF: play_bell_sound?:l2j
f000:DB78		  loop	  l2
f000:DB7A		  dec	  bx
f000:DB7B		  jnz	  short	l0
f000:DB7D		  pop	  ax
f000:DB7E		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:DB7E							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:DB7E							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:DB7E							      ;	3: 1=read high switches
f000:DB7E							      ;	4: 0=enable RAM	parity checking
f000:DB7E							      ;	5: 0=enable I/O	channel	check
f000:DB7E							      ;	6: 0=hold keyboard clock low
f000:DB7E							      ;	7: 0=enable kbrd
f000:DB80		  pop	  cx
f000:DB81		  pop	  bx
f000:DB82		  pop	  ax
f000:DB83		  retn
f000:DB83 play_bell_sound? endp
f000:DB83
f000:DB84
f000:DB84 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DB84
f000:DB84 ; nobody is calling it?
f000:DB84
f000:DB84 is_not_80x25_mode proc near
f000:DB84		  cmp	  byte ptr ds:p400.crt_mode, 2
f000:DB89		  jl	  short	ok
f000:DB8B		  cmp	  byte ptr ds:p400.crt_mode, 3
f000:DB90		  jg	  short	ok
f000:DB92		  stc
f000:DB93		  retn
f000:DB94 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DB94
f000:DB94 ok:							      ;	CODE XREF: is_not_80x25_mode+5j
f000:DB94							      ;	is_not_80x25_mode+Cj
f000:DB94		  clc
f000:DB95		  retn
f000:DB95 is_not_80x25_mode endp
f000:DB95
f000:DB96
f000:DB96 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DB96
f000:DB96
f000:DB96 int_1a	  proc far				      ;	DATA XREF: f000:FF17o
f000:DB96		  push	  ds
f000:DB97		  mov	  ds, cs:value_0040		      ;	ds = 0x40
f000:DB9C		  cmp	  ah, 80h ; '€'
f000:DB9F		  jz	  short	setup_sound_multiplexer
f000:DBA1		  or	  ah, ah
f000:DBA3		  jz	  short	read_system_timer
f000:DBA5		  dec	  ah
f000:DBA7		  jz	  short	set_system_timer
f000:DBA9		  jmp	  short	exit
f000:DBAB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DBAB
f000:DBAB read_system_timer:					      ;	CODE XREF: int_1a+Dj
f000:DBAB		  mov	  dx, ds:p400.timer_ticks_since_midnight
f000:DBAF		  mov	  cx, ds:p400.timer_ticks_since_midnight+2
f000:DBB3		  mov	  al, ds:p400.timer_overflow
f000:DBB6		  mov	  byte ptr ds:p400.timer_overflow, 0
f000:DBBB		  jmp	  short	exit
f000:DBBD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DBBD
f000:DBBD set_system_timer:					      ;	CODE XREF: int_1a+11j
f000:DBBD		  mov	  byte ptr ds:p400.timer_overflow, 0
f000:DBC2		  mov	  ds:p400.timer_ticks_since_midnight, dx
f000:DBC6		  mov	  ds:p400.timer_ticks_since_midnight+2,	cx
f000:DBCA		  xor	  ah, ah
f000:DBCC
f000:DBCC exit:							      ;	CODE XREF: int_1a+13j
f000:DBCC							      ;	int_1a+25j
f000:DBCC							      ;	int_1a+4Bj
f000:DBCC		  pop	  ds
f000:DBCD		  iret
f000:DBCE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DBCE
f000:DBCE setup_sound_multiplexer:				      ;	CODE XREF: int_1a+9j
f000:DBCE		  push	  cx
f000:DBCF		  mov	  ah, al
f000:DBD1		  in	  al, 61h			      ;	PC/XT PPI port B bits:
f000:DBD1							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:DBD1							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:DBD1							      ;	3: 1=read high switches
f000:DBD1							      ;	4: 0=enable RAM	parity checking
f000:DBD1							      ;	5: 0=enable I/O	channel	check
f000:DBD1							      ;	6: 0=hold keyboard clock low
f000:DBD1							      ;	7: 0=enable kbrd
f000:DBD3		  and	  al, 9Fh
f000:DBD5		  and	  ah, 3
f000:DBD8		  mov	  cl, 5
f000:DBDA		  rol	  ah, cl
f000:DBDC		  or	  al, ah
f000:DBDE		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:DBDE							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:DBDE							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:DBDE							      ;	3: 1=read high switches
f000:DBDE							      ;	4: 0=enable RAM	parity checking
f000:DBDE							      ;	5: 0=enable I/O	channel	check
f000:DBDE							      ;	6: 0=hold keyboard clock low
f000:DBDE							      ;	7: 0=enable kbrd
f000:DBE0		  pop	  cx
f000:DBE1		  jmp	  short	exit
f000:DBE1 int_1a	  endp
f000:DBE1
f000:DBE3
f000:DBE3 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:DBE3
f000:DBE3 ; INT	08h (8)		     System Timer
f000:DBE3 ;
f000:DBE3 ;	This interrupt is a hardware interrupt (IRQ 0) activated by the	system
f000:DBE3 ;	timer 18.2 times per second (every 55 ms). The default handler does
f000:DBE3 ;	the following:
f000:DBE3 ;
f000:DBE3 ;	     .	 Keeps a count of the number of	timer ticks at memory location
f000:DBE3 ;		 0:46Ch	(System	Timer Counter--long integer). After 24 hours of
f000:DBE3 ;		 operation, a flag is set at memory location 0:470h to signal
f000:DBE3 ;		 this condition	and the	System Timer Counter (0:46Ch) is reset to
f000:DBE3 ;		 0.
f000:DBE3 ;
f000:DBE3 ;	     .	 Decrements the	Diskette Drive Motor Off Counter at memory
f000:DBE3 ;		 location 0:440h if it is not 0. When this location reaches 0,
f000:DBE3 ;		 the diskette drive motor is turned off	and the	Diskette Drive
f000:DBE3 ;		 Motor Status byte at memory location 0:43Fh is	updated	to
f000:DBE3 ;		 reflect that the motor	has been turned	off.
f000:DBE3 ;
f000:DBE3 ;	     .	 Generates INT 1Ch.
f000:DBE3 ;
f000:DBE3 ;	     .	 For the PC Convertible, generates INT 4Ah if an alarm interrupt
f000:DBE3 ;		 occurs.
f000:DBE3
f000:DBE3 int_08	  proc far				      ;	DATA XREF: f000:int_08_1f_tblo
f000:DBE3		  push	  ax
f000:DBE4		  push	  dx
f000:DBE5		  push	  ds
f000:DBE6		  xor	  dx, dx
f000:DBE8		  mov	  ds, cs:value_0040		      ;	ds = 0x40
f000:DBED		  inc	  word ptr ds:p400.timer_ticks_since_midnight
f000:DBF1		  jnz	  short	l0
f000:DBF3		  inc	  word ptr ds:p400.timer_ticks_since_midnight+2
f000:DBF7
f000:DBF7 l0:							      ;	CODE XREF: int_08+Ej
f000:DBF7		  cmp	  word ptr ds:p400.timer_ticks_since_midnight, 0B0h ; '°'
f000:DBFD		  jnz	  short	l1
f000:DBFF		  cmp	  word ptr ds:p400.timer_ticks_since_midnight+2, 18h
f000:DC04		  jnz	  short	l1
f000:DC06		  inc	  byte ptr ds:p400.timer_overflow
f000:DC0A		  mov	  ds:p400.timer_ticks_since_midnight, dx
f000:DC0E		  mov	  ds:p400.timer_ticks_since_midnight+2,	dx
f000:DC12
f000:DC12 l1:							      ;	CODE XREF: int_08+1Aj
f000:DC12							      ;	int_08+21j
f000:DC12		  dec	  byte ptr ds:p400.diskette_motor_off_timeout
f000:DC16		  jnz	  short	l2
f000:DC18		  mov	  dx, 3F2h			      ;	turn off diskette motor
f000:DC1B		  mov	  al, 1111b
f000:DC1D		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:DC1D							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:DC1D							      ;	2:   0=reset diskette controller; 1=enable controller
f000:DC1D							      ;	3:   1=enable diskette DMA and interrupts
f000:DC1D							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:DC1D							      ;
f000:DC1E		  and	  byte ptr ds:p400.diskette_motor_status, 0F0h
f000:DC23
f000:DC23 l2:							      ;	CODE XREF: int_08+33j
f000:DC23		  int	  1Ch				      ;	CLOCK TICK
f000:DC25		  mov	  al, 20h ; ' '
f000:DC27		  out	  20h, al			      ;	Interrupt controller, 8259A.
f000:DC29		  pop	  ds
f000:DC2A		  pop	  dx
f000:DC2B		  pop	  ax
f000:DC2C		  iret
f000:DC2C int_08	  endp
f000:DC2C
f000:DC2C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:DC2D		  dw 1E9h dup(0ADDEh)
f000:DFFF		  db 0FFh
f000:E000 int_1d_monitor  db 38h, 28h, 2Dh, 0Ah, 1Ch, 1, 19h, 1Ah, 2, 8, 6, 7, 4 dup(0); init_modes_0_1
f000:E000							      ;	DATA XREF: f000:FF1Do
f000:E000		  db 71h, 50h, 5Ah, 0Ah, 1Ch, 1, 19h, 1Ah, 2, 8, 6, 7, 4 dup(0); init_modes_2_3	; video	init param
f000:E000		  db 38h, 28h, 2Dh, 0Ah, 7Fh, 6, 64h, 70h, 2, 1, 6, 7, 4 dup(0); init_modes_4_5_6_8
f000:E000		  db 61h, 50h, 52h, 0Fh, 19h, 6, 2 dup(19h), 2,	0Dh, 0Bh, 0Ch, 4 dup(0); init_mode_7
f000:E000		  db 71h, 50h, 5Ah, 0Ah, 3Fh, 6, 32h, 38h, 2, 3, 6, 7, 4 dup(0); init_modes_9_a
f000:E050		  db 0Bh dup(0)
f000:E05B
f000:E05B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E05B
f000:E05B
f000:E05B reset		  proc near				      ;	CODE XREF: reset+2E1j
f000:E05B							      ;	f000:reset_entryJ
f000:E05B
f000:E05B ; FUNCTION CHUNK AT f000:C470	SIZE 00000092 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C523	SIZE 0000022E BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C79F	SIZE 00000094 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C834	SIZE 0000001C BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C877	SIZE 0000005A BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C8D2	SIZE 00000068 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C989	SIZE 00000018 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C9A2	SIZE 0000001A BYTES
f000:E05B ; FUNCTION CHUNK AT f000:C9E3	SIZE 00000053 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:CA37	SIZE 00000018 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:CA74	SIZE 000000D3 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:CC56	SIZE 00000003 BYTES
f000:E05B ; FUNCTION CHUNK AT f000:E083	SIZE 000002BC BYTES
f000:E05B
f000:E05B		  mov	  ax, 40h ; '@'
f000:E05E		  mov	  ds, ax			      ;	ds = 0x40
f000:E060		  mov	  ax, 0BBE8h
f000:E063		  mov	  es, ax			      ;	es = 0xbbe8
f000:E065		  xor	  ax, ax
f000:E067		  cmp	  word ptr ds:p400.POST_reset_flag, 1234h ; soft reset?
f000:E06D		  jnz	  short	l0			      ;	no, jump
f000:E06F		  mov	  ax, ds:p400.keyb_status_flags_1
f000:E072		  and	  ax, 6060h			      ;	filter out insert / caps
f000:E075
f000:E075 l0:							      ;	CODE XREF: reset+12j
f000:E075		  mov	  es:pbbe80.shadow_keyb_status_flags_1,	ax
f000:E079		  mov	  ax, ds:p400.POST_reset_flag
f000:E07C		  mov	  es:pbbe80.shadow_POST_reset_flag, ax
f000:E080		  jmp	  test_system
f000:E080 reset		  endp
f000:E080
f000:E083 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E083 ; START OF FUNCTION CHUNK FOR	reset
f000:E083
f000:E083 reset_cont:						      ;	CODE XREF: reset:_reset_contj
f000:E083		  mov	  ax, 40h ; '@'
f000:E086		  mov	  ds, ax			      ;	ds = 0x40
f000:E088		  mov	  ax, 0BBE8h
f000:E08B		  mov	  es, ax			      ;	es = 0xbbe8
f000:E08D		  cmp	  word ptr es:pbbe80.shadow_POST_reset_flag, 1234h
f000:E094		  jnz	  short	l1
f000:E096		  mov	  ax, es:pbbe80.shadow_keyb_status_flags_1
f000:E09A		  mov	  ds:p400.keyb_status_flags_1, ax
f000:E09D
f000:E09D l1:							      ;	CODE XREF: reset+39j
f000:E09D		  cli
f000:E09E		  cld
f000:E09F		  mov	  ax, 36h ; '6'
f000:E0A2		  mov	  dx, 43h ; 'C'
f000:E0A5		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0A6		  mov	  dx, 40h ; '@'
f000:E0A9		  mov	  al, 0
f000:E0AB		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0AC		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0AD		  mov	  al, 54h ; 'T'
f000:E0AF		  mov	  dx, 43h ; 'C'
f000:E0B2		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0B3		  mov	  al, 12h
f000:E0B5		  mov	  dx, 41h ; 'A'
f000:E0B8		  out	  dx, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0B9		  mov	  al, 0B6h ; '¶'
f000:E0BB		  out	  43h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0BD		  xor	  al, al
f000:E0BF		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0C1		  mov	  al, 5
f000:E0C3		  out	  42h, al			      ;	Timer 8253-5 (AT: 8254.2).
f000:E0C5 ; setup segment registers
f000:E0C5		  xor	  ax, ax
f000:E0C7		  mov	  es, ax			      ;	es = 0x00
f000:E0C9		  mov	  ax, 30h ; '0'
f000:E0CC		  mov	  ss, ax			      ;	ss = 0x30
f000:E0CE		  mov	  ax, 100h
f000:E0D1		  mov	  sp, ax			      ;	stack: (ss:sp) 0x30:0x100
f000:E0D3		  mov	  ax, cs
f000:E0D5		  mov	  ds, ax			      ;	ds = cs
f000:E0D7 ; setup interrupt vectors
f000:E0D7		  mov	  si, offset int_00_07_tbl
f000:E0DA		  xor	  di, di
f000:E0DC		  mov	  cx, 8
f000:E0DF		  call	  set_int_table
f000:E0E2		  mov	  si, offset int_08_1f_tbl
f000:E0E5		  mov	  di, 20h ; ' '
f000:E0E8		  mov	  cx, 18h
f000:E0EB		  call	  set_int_table
f000:E0EE		  mov	  si, offset tbl_int_44
f000:E0F1		  mov	  di, 110h
f000:E0F4		  mov	  cx, 1
f000:E0F7		  call	  set_int_table
f000:E0FA		  mov	  ax, 0BBE8h
f000:E0FD		  mov	  ds, ax			      ;	dx = 0xbbe8
f000:E0FF		  mov	  dx, ds:pbbe80.field_B
f000:E103		  mov	  cl, 6
f000:E105		  shr	  dx, cl
f000:E107		  add	  dx, 70h ; 'p'
f000:E10A		  mov	  ax, 40h ; '@'
f000:E10D		  mov	  ds, ax			      ;	ds = 0x40
f000:E10F		  mov	  ds:p400.base_mem_kb, dx
f000:E113		  add	  dx, 10h
f000:E116		  mov	  ds:p400.IO_channel_RAM_size, dx
f000:E11A		  mov	  al, 0FFh
f000:E11C		  out	  21h, al			      ;	Interrupt controller, 8259A.
f000:E11E		  in	  al, 61h			      ;	PC/XT PPI port B bits:
f000:E11E							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:E11E							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:E11E							      ;	3: 1=read high switches
f000:E11E							      ;	4: 0=enable RAM	parity checking
f000:E11E							      ;	5: 0=enable I/O	channel	check
f000:E11E							      ;	6: 0=hold keyboard clock low
f000:E11E							      ;	7: 0=enable kbrd
f000:E120		  or	  al, 1
f000:E122		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:E122							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:E122							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:E122							      ;	3: 1=read high switches
f000:E122							      ;	4: 0=enable RAM	parity checking
f000:E122							      ;	5: 0=enable I/O	channel	check
f000:E122							      ;	6: 0=hold keyboard clock low
f000:E122							      ;	7: 0=enable kbrd
f000:E124		  mov	  cx, 4000h
f000:E127
f000:E127 delay0:						      ;	CODE XREF: reset:delay0j
f000:E127		  loop	  delay0
f000:E129		  and	  al, 0FEh
f000:E12B		  out	  61h, al			      ;	PC/XT PPI port B bits:
f000:E12B							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:E12B							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:E12B							      ;	3: 1=read high switches
f000:E12B							      ;	4: 0=enable RAM	parity checking
f000:E12B							      ;	5: 0=enable I/O	channel	check
f000:E12B							      ;	6: 0=hold keyboard clock low
f000:E12B							      ;	7: 0=enable kbrd
f000:E12D		  mov	  ax, 40h ; '@'
f000:E130		  mov	  ds, ax			      ;	ds = 0x40
f000:E132		  mov	  dx, 213h
f000:E135		  mov	  al, 1
f000:E137		  out	  dx, al			      ;	XT Expansion chassis enable
f000:E138		  nop
f000:E139		  mov	  ax, 102Dh
f000:E13C		  mov	  ds:p400.installed_hardware, ax
f000:E13F		  mov	  ax, 1Eh
f000:E142		  mov	  ds:p400.keyb_buffer_head_ptr,	ax
f000:E145		  mov	  ds:p400.keyb_buffer_tail_ptr,	ax
f000:E148		  mov	  ds:p400.keyb_buffer_start_offset_ptr,	ax
f000:E14B		  add	  ax, 20h ; ' '
f000:E14E		  mov	  ds:p400.keyb_buffer_end_offset_ptr, ax
f000:E151		  mov	  byte ptr ds:p400.video_page_data, 3Fh	; '?'
f000:E156		  mov	  al, 0Eh
f000:E158		  out	  0Fh, al			      ;	DMA controller,	8237A-5.
f000:E158							      ;	master clear. Clear or mask any	or
f000:E158							      ;	all of the channels. Bits:
f000:E158							      ;	0: 1=mask channel 0; 0=enable
f000:E158							      ;	1: 1=mask channel 1;
f000:E158							      ;	2: 1=mask channel 2;
f000:E158							      ;	3: 1=mask channel 3;
f000:E15A		  out	  0Ch, al			      ;	DMA controller,	8237A-5.
f000:E15A							      ;	clear byte pointer flip-flop.
f000:E15C		  mov	  dx, 4
f000:E15F
f000:E15F l2:							      ;	CODE XREF: reset+120j
f000:E15F		  mov	  cx, 1
f000:E162
f000:E162 l3:							      ;	CODE XREF: reset+11Aj
f000:E162		  mov	  ax, cx
f000:E164		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:E164							      ;	channel	2 base address
f000:E164							      ;	(also sets current address)
f000:E165		  mov	  al, ah
f000:E167		  out	  dx, al			      ;	DMA controller,	8237A-5.
f000:E167							      ;	channel	2 base address
f000:E167							      ;	(also sets current address)
f000:E168		  nop
f000:E169		  in	  al, dx			      ;	DMA controller,	8237A-5.
f000:E169							      ;	channel	2 current address
f000:E16A		  mov	  ah, al
f000:E16C		  in	  al, dx			      ;	DMA controller,	8237A-5.
f000:E16C							      ;	channel	2 current address
f000:E16D		  xchg	  ah, al
f000:E16F		  cmp	  ax, cx
f000:E171		  jnz	  short	l4
f000:E173		  rcl	  cx, 1
f000:E175		  jnb	  short	l3
f000:E177		  inc	  dx
f000:E178		  cmp	  dx, 6
f000:E17B		  jnz	  short	l2
f000:E17D		  jmp	  short	l5
f000:E17F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E17F
f000:E17F l4:							      ;	CODE XREF: reset+116j
f000:E17F		  or	  word ptr ds:p400.installed_hardware, 100h
f000:E185
f000:E185 l5:							      ;	CODE XREF: reset+122j
f000:E185		  call	  play_bell_sound?
f000:E188		  in	  al, 21h			      ;	Interrupt controller, 8259A.
f000:E18A		  and	  al, 0BFh
f000:E18C		  out	  21h, al			      ;	Interrupt controller, 8259A.
f000:E18E		  sti
f000:E18F		  mov	  ah, 0
f000:E191		  mov	  dl, 0
f000:E193		  int	  13h				      ;	DISK - RESET DISK SYSTEM
f000:E193							      ;	DL = drive (if bit 7 is	set both hard disks and	floppy disks reset)
f000:E195		  mov	  ax, 201h
f000:E198		  mov	  bx, 0F000h
f000:E19B		  mov	  es, bx
f000:E19D		  xor	  bx, bx
f000:E19F		  mov	  cx, 501h
f000:E1A2		  xor	  dx, dx
f000:E1A4		  int	  13h				      ;	DISK - READ SECTORS INTO MEMORY
f000:E1A4							      ;	AL = number of sectors to read,	CH = track, CL = sector
f000:E1A4							      ;	DH = head, DL =	drive, ES:BX ->	buffer to fill
f000:E1A4							      ;	Return:	CF set on error, AH = status, AL = number of sectors read
f000:E1A6		  mov	  ah, 0
f000:E1A8		  mov	  dl, 0
f000:E1AA		  int	  13h				      ;	DISK - RESET DISK SYSTEM
f000:E1AA							      ;	DL = drive (if bit 7 is	set both hard disks and	floppy disks reset)
f000:E1AC		  mov	  ax, 201h
f000:E1AF		  mov	  bx, 0F000h
f000:E1B2		  mov	  es, bx
f000:E1B4		  xor	  bx, bx
f000:E1B6		  mov	  cx, 0A01h
f000:E1B9		  mov	  dx, 1
f000:E1BC		  int	  13h				      ;	DISK - READ SECTORS INTO MEMORY
f000:E1BC							      ;	AL = number of sectors to read,	CH = track, CL = sector
f000:E1BC							      ;	DH = head, DL =	drive, ES:BX ->	buffer to fill
f000:E1BC							      ;	Return:	CF set on error, AH = status, AL = number of sectors read
f000:E1BE		  jnb	  short	l6
f000:E1C0		  test	  ah, 40h
f000:E1C3		  jnz	  short	l7
f000:E1C5
f000:E1C5 l6:							      ;	CODE XREF: reset+163j
f000:E1C5		  or	  word ptr ds:p400.installed_hardware, 40h
f000:E1CB
f000:E1CB l7:							      ;	CODE XREF: reset+168j
f000:E1CB		  cli
f000:E1CC		  in	  al, 21h			      ;	Interrupt controller, 8259A.
f000:E1CE		  or	  al, 40h
f000:E1D0		  out	  21h, al			      ;	Interrupt controller, 8259A.
f000:E1D2		  mov	  al, 0Fh
f000:E1D4		  mov	  dx, 3F2h
f000:E1D7		  out	  dx, al			      ;	Floppy:	digital	output reg bits:
f000:E1D7							      ;	0-1: Drive to select 0-3 (AT: bit 1 not	used)
f000:E1D7							      ;	2:   0=reset diskette controller; 1=enable controller
f000:E1D7							      ;	3:   1=enable diskette DMA and interrupts
f000:E1D7							      ;	4-7: drive motor enable.  Set bits to turn drive ON.
f000:E1D7							      ;
f000:E1D8		  mov	  bx, p400.lpt0_base_addr
f000:E1DB		  mov	  dx, 3BCh
f000:E1DE		  mov	  al, 0A5h ; '¥'
f000:E1E0		  out	  dx, al			      ;	Printer	Data Latch:
f000:E1E0							      ;	send byte to printer
f000:E1E1		  in	  al, dx			      ;	Printer	Data Latch:
f000:E1E1							      ;	fetch last byte	sent
f000:E1E2		  cmp	  al, 0A5h ; '¥'
f000:E1E4		  jnz	  short	l8
f000:E1E6		  mov	  [bx],	dx
f000:E1E8		  inc	  bx
f000:E1E9		  inc	  bx
f000:E1EA		  add	  word ptr ds:p400.installed_hardware, 4000h
f000:E1F0
f000:E1F0 l8:							      ;	CODE XREF: reset+189j
f000:E1F0		  mov	  dx, 378h
f000:E1F3		  mov	  al, 0A5h ; '¥'
f000:E1F5		  out	  dx, al			      ;	Printer	Data Latch:
f000:E1F5							      ;	send byte to printer
f000:E1F6		  in	  al, dx			      ;	Printer	Data Latch:
f000:E1F6							      ;	fetch last byte	sent
f000:E1F7		  cmp	  al, 0A5h ; '¥'
f000:E1F9		  jnz	  short	l9
f000:E1FB		  mov	  [bx],	dx
f000:E1FD		  inc	  bx
f000:E1FE		  inc	  bx
f000:E1FF		  add	  word ptr ds:p400.installed_hardware, 4000h
f000:E205
f000:E205 l9:							      ;	CODE XREF: reset+19Ej
f000:E205		  mov	  dx, 278h
f000:E208		  mov	  al, 0A5h ; '¥'
f000:E20A		  out	  dx, al			      ;	Printer	Data Latch:
f000:E20A							      ;	send byte to printer
f000:E20B		  in	  al, dx			      ;	Printer	Data Latch:
f000:E20B							      ;	fetch last byte	sent
f000:E20C		  cmp	  al, 0A5h ; '¥'
f000:E20E		  jnz	  short	l10
f000:E210		  mov	  [bx],	dx
f000:E212		  add	  word ptr ds:p400.installed_hardware, 4000h
f000:E218
f000:E218 l10:							      ;	CODE XREF: reset+1B3j
f000:E218		  mov	  bx, p400.lpt0_timeout
f000:E21B		  mov	  word ptr [bx], 1414h
f000:E21F		  mov	  word ptr [bx+2], 1414h
f000:E224		  mov	  bx, p400
f000:E227		  mov	  dx, 3FBh
f000:E22A		  mov	  al, 80h ; '€'
f000:E22C		  out	  dx, al			      ;	COM: line control register bits:
f000:E22C							      ;	0-1: word length: 00=5,	01=6, 10=7, 11=8
f000:E22C							      ;	2:   stop bits:	0=1,1=2
f000:E22C							      ;	3-4: parity: x0=None, 01=Odd, 11=Even
f000:E22C							      ;	5:   stuck parity
f000:E22C							      ;	6:   enable break control. 1=start sending 0s (spaces)
f000:E22C							      ;	7:   DLAB (Divisor Latch Access	Bit)
f000:E22D		  mov	  dx, 3F8h
f000:E230		  mov	  al, 0AAh ; 'ª'
f000:E232		  out	  dx, al			      ;	COM: transmitter holding register
f000:E232							      ;	or (when DLAB=1) divisor latch low byte.
f000:E233		  in	  al, dx			      ;	COM: receiver buffer register.
f000:E233							      ;	8 bits of character received.
f000:E234		  cmp	  al, 0AAh ; 'ª'
f000:E236		  jnz	  short	l11
f000:E238		  mov	  [bx],	dx
f000:E23A		  inc	  bx
f000:E23B		  inc	  bx
f000:E23C		  add	  word ptr ds:p400.installed_hardware, 200h
f000:E242
f000:E242 l11:							      ;	CODE XREF: reset+1DBj
f000:E242		  mov	  dx, 2FBh
f000:E245		  mov	  al, 80h ; '€'
f000:E247		  out	  dx, al			      ;	COM: line control register bits:
f000:E247							      ;	0-1: word length: 00=5,	01=6, 10=7, 11=8
f000:E247							      ;	2:   stop bits:	0=1,1=2
f000:E247							      ;	3-4: parity: x0=None, 01=Odd, 11=Even
f000:E247							      ;	5:   stuck parity
f000:E247							      ;	6:   enable break control. 1=start sending 0s (spaces)
f000:E247							      ;	7:   DLAB (Divisor Latch Access	Bit)
f000:E248		  mov	  dx, 2F8h
f000:E24B		  mov	  al, 0AAh ; 'ª'
f000:E24D		  out	  dx, al			      ;	COM: transmitter holding register
f000:E24D							      ;	or (when DLAB=1) divisor latch low byte.
f000:E24E		  in	  al, dx			      ;	COM: receiver buffer register.
f000:E24E							      ;	8 bits of character received.
f000:E24F		  cmp	  al, 0AAh ; 'ª'
f000:E251		  jnz	  short	l12
f000:E253		  mov	  [bx],	dx
f000:E255		  add	  word ptr ds:p400.installed_hardware, 200h
f000:E25B
f000:E25B l12:							      ;	CODE XREF: reset+1F6j
f000:E25B		  mov	  bx, p400.comm_0_timeout
f000:E25E		  mov	  word ptr [bx], 101h
f000:E262		  mov	  word ptr [bx+2], 101h
f000:E267		  mov	  ah, 1
f000:E269		  mov	  dx, 0
f000:E26C		  int	  17h				      ;	PRINTER	- INITIALIZE
f000:E26C							      ;	DX = printer port (0-3)
f000:E26C							      ;	Return:	AH = status
f000:E26E		  mov	  ax, 43h ; 'C'
f000:E271		  mov	  dx, 0
f000:E274		  int	  14h				      ;	SERIAL I/O - INITIALIZE	USART
f000:E274							      ;	AL = initializing parameters, DX = port	number (0-3)
f000:E274							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
f000:E276		  mov	  ah, 1
f000:E278		  int	  14h				      ;	SERIAL I/O - TRANSMIT CHARACTER
f000:E278							      ;	AL = character,	DX = port number (0-3)
f000:E278							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
f000:E27A		  mov	  ax, 43h ; 'C'
f000:E27D		  mov	  dx, 1
f000:E280		  int	  14h				      ;	SERIAL I/O - INITIALIZE	USART
f000:E280							      ;	AL = initializing parameters, DX = port	number (0-3)
f000:E280							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
f000:E282		  mov	  ah, 1
f000:E284		  int	  14h				      ;	SERIAL I/O - TRANSMIT CHARACTER
f000:E284							      ;	AL = character,	DX = port number (0-3)
f000:E284							      ;	Return:	AH = RS-232 status code	bits, AL = modem status	bits
f000:E286		  mov	  ax, 0C800h
f000:E289		  mov	  ds, ax			      ;	ds = 0xc800
f000:E28B		  mov	  cx, 58h ; 'X'
f000:E28E
f000:E28E l13:							      ;	CODE XREF: reset+26Ej
f000:E28E		  xor	  si, si
f000:E290		  cmp	  word ptr [si], 0AA55h
f000:E294		  jnz	  short	l16
f000:E296		  push	  cx
f000:E297		  mov	  cl, 0
f000:E299		  mov	  ch, [si+2]
f000:E29C		  add	  cx, cx
f000:E29E		  mov	  al, 0
f000:E2A0
f000:E2A0 l14:							      ;	CODE XREF: reset+248j
f000:E2A0		  add	  al, [si]
f000:E2A2		  inc	  si
f000:E2A3		  loop	  l14
f000:E2A5		  or	  al, al
f000:E2A7		  jnz	  short	l15
f000:E2A9		  mov	  ax, 40h ; '@'
f000:E2AC		  mov	  es, ax			      ;	es = 0x40
f000:E2AE		  mov	  word ptr es:p400.POST_entry_point_offset, 3
f000:E2B5		  mov	  word ptr es:p400.POST_entry_point_seg, ds
f000:E2BA		  push	  ds
f000:E2BB		  call	  dword	ptr es:p400.POST_entry_point_offset
f000:E2C0		  pop	  ds
f000:E2C1
f000:E2C1 l15:							      ;	CODE XREF: reset+24Cj
f000:E2C1		  pop	  cx
f000:E2C2
f000:E2C2 l16:							      ;	CODE XREF: reset+239j
f000:E2C2		  mov	  ax, ds
f000:E2C4		  add	  ax, 80h ; '€'
f000:E2C7		  mov	  ds, ax
f000:E2C9		  loop	  l13
f000:E2CB		  in	  al, 21h			      ;	Interrupt controller, 8259A.
f000:E2CD		  and	  al, 11111101b			      ;	mask off bit 1.	IRQ9 (Keyboard)	enabled, rest disabled
f000:E2CF		  out	  21h, al			      ;	Interrupt controller, 8259A.
f000:E2D1		  sti
f000:E2D2		  mov	  ah, 1
f000:E2D4		  int	  16h				      ;	KEYBOARD - CHECK BUFFER, DO NOT	CLEAR
f000:E2D4							      ;	Return:	ZF clear if character in buffer
f000:E2D4							      ;	AH = scan code,	AL = character
f000:E2D4							      ;	ZF set if no character in buffer
f000:E2D6		  cli
f000:E2D7		  jz	  short	l18
f000:E2D9		  cmp	  ax, 9900h			      ;	scancode / bytecode for	F12
f000:E2DC		  mov	  ax, 40h ; '@'
f000:E2DF		  mov	  ds, ax			      ;	ds = 0x40
f000:E2E1		  jnz	  short	l17
f000:E2E3		  mov	  ax, ds:p400.installed_hardware
f000:E2E6		  and	  ax, 0FFCFh			      ;	mask off "initial video	mode" bits
f000:E2E9		  or	  ax, 10h			      ;	initial	video mode = 40x25 color
f000:E2EC		  mov	  ds:p400.installed_hardware, ax
f000:E2EF		  xor	  ax, ax
f000:E2F1		  mov	  es, ax			      ;	es = 0x00
f000:E2F3		  mov	  bx, 74h ; 't'                       ; int 0x1d
f000:E2F6		  mov	  ax, offset int_1d_tv		      ;	video table parameter
f000:E2F9		  mov	  es:[bx], ax
f000:E2FC		  mov	  word ptr es:[bx+2], cs
f000:E300
f000:E300 l17:							      ;	CODE XREF: reset+286j
f000:E300		  mov	  ax, ds:p400.keyb_buffer_start_offset_ptr
f000:E303		  mov	  ds:p400.keyb_buffer_head_ptr,	ax
f000:E306		  mov	  ds:p400.keyb_buffer_tail_ptr,	ax
f000:E309
f000:E309 l18:							      ;	CODE XREF: reset+27Cj
f000:E309		  in	  al, 21h			      ;	Interrupt controller, 8259A.
f000:E30B		  or	  al, 10b			      ;	mask off everything execept bit	1. Keyboard disabled, rest enabled
f000:E30D		  out	  21h, al			      ;	Interrupt controller, 8259A.
f000:E30F		  mov	  ax, 40h ; '@'
f000:E312		  mov	  ds, ax			      ;	ds = 0x40
f000:E314		  xor	  ax, ax
f000:E316		  mov	  bx, ds:p400.installed_hardware
f000:E31A		  and	  bx, 30h
f000:E31E		  mov	  al, 7
f000:E320		  cmp	  bl, 30h ; '0'
f000:E323		  jz	  short	l19
f000:E325		  mov	  al, 2
f000:E327		  cmp	  bl, 20h ; ' '
f000:E32A		  jz	  short	l19
f000:E32C		  mov	  al, 0
f000:E32E
f000:E32E l19:							      ;	CODE XREF: reset+2C8j
f000:E32E							      ;	reset+2CFj
f000:E32E		  int	  10h				      ;	- VIDEO	- SET VIDEO MODE
f000:E32E							      ;	AL = mode
f000:E330		  mov	  al, 0BCh ; '¼'
f000:E332		  out	  21h, al			      ;	Interrupt controller, 8259A.
f000:E334		  mov	  si, offset aBiosRomVersion	      ;	"BIOS ROM version 01.00.00\r\nCopyright	19"...
f000:E337		  call	  print_dos_string
f000:E33A		  int	  19h				      ;	DISK BOOT
f000:E33A							      ;	causes reboot of disk system
f000:E33C		  jmp	  reset
f000:E33C ; END	OF FUNCTION CHUNK FOR reset
f000:E33F
f000:E33F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E33F
f000:E33F
f000:E33F set_int_table	  proc near				      ;	CODE XREF: reset+84p
f000:E33F							      ;	reset+90p
f000:E33F							      ;	reset+9Cp
f000:E33F							      ;	set_int_table+2j
f000:E33F		  movsw
f000:E340		  stosw
f000:E341		  loop	  set_int_table
f000:E343		  retn
f000:E343 set_int_table	  endp
f000:E343
f000:E344
f000:E344 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E344
f000:E344
f000:E344 int_18	  proc far				      ;	DATA XREF: f000:FF13o
f000:E344		  pop	  si
f000:E345		  pop	  si
f000:E346		  pop	  si
f000:E347		  mov	  si, offset aInsertSystemDisketteA   ;	"\n\rInsert System Diskette and\n\rStrike an"...
f000:E34A		  call	  print_dos_string
f000:E34D		  xor	  ah, ah
f000:E34F		  int	  16h				      ;	KEYBOARD - READ	CHAR FROM BUFFER, WAIT IF EMPTY
f000:E34F							      ;	Return:	AH = scan code,	AL = character
f000:E351		  int	  19h				      ;	DISK BOOT
f000:E351							      ;	causes reboot of disk system
f000:E353		  iret
f000:E353 int_18	  endp ; sp =  8
f000:E353
f000:E353 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E354 aInsertSystemDisketteA db 0Ah				      ;	DATA XREF: int_18+3o
f000:E354		  db 0Dh,'Insert System Diskette and',0Ah
f000:E354		  db 0Dh,'Strike any key when ready',0Ah
f000:E354		  db 0Dh,'$'
f000:E38E
f000:E38E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E38E
f000:E38E
f000:E38E print_dos_string proc	near				      ;	CODE XREF: reset+2DCp
f000:E38E							      ;	int_18+6p
f000:E38E							      ;	print_dos_string+10j
f000:E38E		  mov	  al, cs:[si]
f000:E391		  cmp	  al, 24h ; '$'
f000:E393		  jz	  short	lret
f000:E395		  push	  si
f000:E396		  mov	  ah, 0Eh
f000:E398		  mov	  bl, 7
f000:E39A		  int	  10h				      ;	- VIDEO	- WRITE	CHARACTER AND ADVANCE CURSOR (TTY WRITE)
f000:E39A							      ;	AL = character,	BH = display page (alpha modes)
f000:E39A							      ;	BL = foreground	color (graphics	modes)
f000:E39C		  pop	  si
f000:E39D		  inc	  si
f000:E39E		  jmp	  short	print_dos_string
f000:E3A0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E3A0
f000:E3A0 lret:							      ;	CODE XREF: print_dos_string+5j
f000:E3A0		  retn
f000:E3A0 print_dos_string endp
f000:E3A0
f000:E3A1
f000:E3A1 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E3A1
f000:E3A1
f000:E3A1 int_15	  proc far				      ;	DATA XREF: f000:FF0Do
f000:E3A1		  mov	  ah, 86h ; '†'
f000:E3A3		  stc
f000:E3A4		  retf	  2
f000:E3A4 int_15	  endp
f000:E3A4
f000:E3A7
f000:E3A7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E3A7
f000:E3A7
f000:E3A7 int_ack_handler proc far				      ;	DATA XREF: f000:FEF7o
f000:E3A7							      ;	f000:FEF9o
f000:E3A7							      ;	f000:FEFBo
f000:E3A7							      ;	f000:FEFDo
f000:E3A7							      ;	f000:FF01o
f000:E3A7		  push	  ax
f000:E3A8		  push	  ds
f000:E3A9		  mov	  ax, 40h ; '@'
f000:E3AC		  mov	  ds, ax
f000:E3AE		  mov	  al, 0Bh
f000:E3B0		  out	  20h, al			      ;	Interrupt controller, 8259A.
f000:E3B2		  in	  al, 20h			      ;	Interrupt controller, 8259A.
f000:E3B4		  or	  al, al
f000:E3B6		  jz	  short	l0
f000:E3B8		  mov	  ah, al
f000:E3BA		  in	  al, 21h			      ;	Interrupt controller, 8259A.
f000:E3BC		  or	  al, ah
f000:E3BE		  out	  21h, al			      ;	Interrupt controller, 8259A.
f000:E3C0		  mov	  al, 20h ; ' '
f000:E3C2		  out	  20h, al			      ;	Interrupt controller, 8259A.
f000:E3C4		  jmp	  short	l1
f000:E3C6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E3C6
f000:E3C6 l0:							      ;	CODE XREF: int_ack_handler+Fj
f000:E3C6		  mov	  ah, 0FFh
f000:E3C8
f000:E3C8 l1:							      ;	CODE XREF: int_ack_handler+1Dj
f000:E3C8		  mov	  ds:p400.POST_last_unexpected_int, ah
f000:E3CC		  pop	  ds
f000:E3CD		  pop	  ax
f000:E3CE		  iret
f000:E3CE int_ack_handler endp
f000:E3CE
f000:E3CE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E3CF value_7c00	  dd 7C00h				      ;	DATA XREF: int_19:l1r
f000:E3CF							      ;	0000:7c00 should have the boot code
f000:E3D3 aByLsd	  db 'by LSD'                                 ; Tandy developer author?
f000:E3D9		  db 319h dup(0)
f000:E6F2
f000:E6F2 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E6F2
f000:E6F2
f000:E6F2 int_19	  proc near				      ;	CODE XREF: int_19+29j
f000:E6F2							      ;	DATA XREF: f000:FF15o
f000:E6F2		  pop	  cx
f000:E6F3		  pop	  cx
f000:E6F4		  pop	  cx
f000:E6F5		  mov	  cx, 5
f000:E6F8
f000:E6F8 l0:							      ;	CODE XREF: int_19+25j
f000:E6F8		  sti
f000:E6F9		  push	  cx
f000:E6FA		  mov	  ah, 0
f000:E6FC		  int	  13h				      ;	DISK - RESET DISK SYSTEM
f000:E6FC							      ;	DL = drive (if bit 7 is	set both hard disks and	floppy disks reset)
f000:E6FE		  mov	  bx, 7C00h
f000:E701		  mov	  ax, 0
f000:E704		  mov	  es, ax
f000:E706		  mov	  dl, 0
f000:E708		  mov	  dh, 0
f000:E70A		  mov	  ch, 0
f000:E70C		  mov	  cl, 1
f000:E70E		  mov	  al, 1
f000:E710		  mov	  ah, 2
f000:E712		  int	  13h				      ;	DISK - READ SECTORS INTO MEMORY
f000:E712							      ;	AL = number of sectors to read,	CH = track, CL = sector
f000:E712							      ;	DH = head, DL =	drive, ES:BX ->	buffer to fill
f000:E712							      ;	Return:	CF set on error, AH = status, AL = number of sectors read
f000:E714		  pop	  cx
f000:E715		  jnb	  short	l1
f000:E717		  loop	  l0
f000:E719		  int	  18h				      ;	TRANSFER TO ROM	BASIC
f000:E719							      ;	causes transfer	to ROM-based BASIC (IBM-PC)
f000:E719							      ;	often reboots a	compatible; often has no effect	at all
f000:E71B		  jmp	  short	int_19
f000:E71D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E71D
f000:E71D l1:							      ;	CODE XREF: int_19+23j
f000:E71D		  jmp	  cs:value_7c00
f000:E71D int_19	  endp
f000:E71D
f000:E71D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E722		  db	0
f000:E723		  db	0
f000:E724		  db	0
f000:E725		  db	0
f000:E726		  db	0
f000:E727		  db	0
f000:E728		  db	0
f000:E729 word_FE729	  dw 417h				      ;	DATA XREF: int_14+48r
f000:E72B		  dw 300h
f000:E72D		  dw 180h
f000:E72F		  dw 0C0h
f000:E731		  dw 60h
f000:E733		  dw 30h
f000:E735		  dw 18h
f000:E737		  dw 0Ch
f000:E739
f000:E739 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E739
f000:E739
f000:E739 int_14	  proc far				      ;	DATA XREF: f000:FF0Bo
f000:E739		  call	  int_push_regs
f000:E73C		  mov	  di, 8
f000:E73F		  nop
f000:E740		  call	  check_valid_subfunction
f000:E743		  jb	  short	exit0
f000:E745		  mov	  bx, dx
f000:E747		  xor	  cx, cx
f000:E749		  mov	  cl, [bx+p400.comm_0_timeout]
f000:E74D		  shl	  bx, 1
f000:E74F		  mov	  dx, [bx+p400.comm_0_base_addr]
f000:E753		  or	  dx, dx
f000:E755		  jnz	  short	l0
f000:E757		  xor	  ah, ah
f000:E759		  jmp	  exit1
f000:E75C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E75C
f000:E75C l0:							      ;	CODE XREF: int_14+1Cj
f000:E75C		  jmp	  word ptr cs:int_14_jump_tbl[di]
f000:E75C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E761 int_14_jump_tbl:					      ;	DATA XREF: int_14:l0r
f000:E761		  dw offset int_14_00
f000:E763		  dw offset int_14_01
f000:E765		  dw offset int_14_02
f000:E767		  dw offset int_14_03
f000:E769 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E769
f000:E769 exit0:						      ;	CODE XREF: int_14+Aj
f000:E769		  jmp	  exit1
f000:E76C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E76C
f000:E76C int_14_00:						      ;	CODE XREF: int_14:l0j
f000:E76C							      ;	DATA XREF: int_14:int_14_jump_tblo
f000:E76C		  mov	  ah, al
f000:E76E		  mov	  al, 80h ; '€'
f000:E770		  add	  dx, 3
f000:E773		  out	  dx, al
f000:E774		  dec	  dx
f000:E775		  dec	  dx
f000:E776		  mov	  bl, ah
f000:E778		  and	  bl, 0E0h
f000:E77B		  mov	  cl, 4
f000:E77D		  shr	  bl, cl
f000:E77F		  xor	  bh, bh
f000:E781		  mov	  cx, cs:word_FE729[bx]
f000:E786		  mov	  al, ch
f000:E788		  out	  dx, al
f000:E789		  mov	  al, cl
f000:E78B		  dec	  dx
f000:E78C		  out	  dx, al
f000:E78D		  mov	  al, ah
f000:E78F		  and	  al, 1Fh
f000:E791		  add	  dx, 3
f000:E794		  out	  dx, al
f000:E795		  sub	  dx, 3
f000:E798		  inc	  dx
f000:E799		  xor	  al, al
f000:E79B		  out	  dx, al
f000:E79C		  dec	  dx
f000:E79D		  jmp	  int_14_03
f000:E7A0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E7A0
f000:E7A0 int_14_01:						      ;	CODE XREF: int_14:l0j
f000:E7A0							      ;	DATA XREF: int_14+2Ao
f000:E7A0		  mov	  ah, al
f000:E7A2		  mov	  al, 3
f000:E7A4		  add	  dx, 4
f000:E7A7		  out	  dx, al
f000:E7A8		  inc	  dx
f000:E7A9		  inc	  dx
f000:E7AA		  xor	  bx, bx
f000:E7AC
f000:E7AC l1:							      ;	CODE XREF: int_14+94j
f000:E7AC							      ;	int_14+96j
f000:E7AC		  in	  al, dx
f000:E7AD		  test	  al, 30h
f000:E7AF		  jz	  short	l4
f000:E7B1		  xor	  bx, bx
f000:E7B3		  dec	  dx
f000:E7B4
f000:E7B4 l2:							      ;	CODE XREF: int_14+81j
f000:E7B4							      ;	int_14+83j
f000:E7B4		  in	  al, dx
f000:E7B5		  test	  al, 20h
f000:E7B7		  jnz	  short	l3
f000:E7B9		  dec	  bx
f000:E7BA		  jnz	  short	l2
f000:E7BC		  loop	  l2
f000:E7BE		  jmp	  short	l5
f000:E7C0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E7C0
f000:E7C0 l3:							      ;	CODE XREF: int_14+7Ej
f000:E7C0		  sub	  dx, 5
f000:E7C3		  mov	  al, ah
f000:E7C5		  out	  dx, al
f000:E7C6		  xchg	  ah, al
f000:E7C8		  xor	  ah, ah
f000:E7CA		  jmp	  short	exit1
f000:E7CC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E7CC
f000:E7CC l4:							      ;	CODE XREF: int_14+76j
f000:E7CC		  dec	  bx
f000:E7CD		  jnz	  short	l1
f000:E7CF		  loop	  l1
f000:E7D1		  dec	  dx
f000:E7D2
f000:E7D2 l5:							      ;	CODE XREF: int_14+85j
f000:E7D2		  in	  al, dx
f000:E7D3		  or	  al, 80h
f000:E7D5		  xchg	  ah, al
f000:E7D7		  and	  ah, 9Eh
f000:E7DA		  jmp	  short	exit1
f000:E7DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E7DC
f000:E7DC int_14_02:						      ;	CODE XREF: int_14:l0j
f000:E7DC							      ;	DATA XREF: int_14+2Co
f000:E7DC		  mov	  al, 1
f000:E7DE		  add	  dx, 4
f000:E7E1		  out	  dx, al
f000:E7E2		  sub	  dx, 4
f000:E7E5		  xor	  bx, bx
f000:E7E7
f000:E7E7 l6:							      ;	CODE XREF: int_14+BAj
f000:E7E7							      ;	int_14+BCj
f000:E7E7		  add	  dx, 6
f000:E7EA		  in	  al, dx
f000:E7EB		  sub	  dx, 6
f000:E7EE		  test	  al, 20h
f000:E7F0		  jnz	  short	l7
f000:E7F2		  dec	  bx
f000:E7F3		  jnz	  short	l6
f000:E7F5		  loop	  l6
f000:E7F7		  jmp	  short	l10
f000:E7F9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E7F9
f000:E7F9 l7:							      ;	CODE XREF: int_14+B7j
f000:E7F9		  xor	  bx, bx
f000:E7FB
f000:E7FB l8:							      ;	CODE XREF: int_14+D6j
f000:E7FB							      ;	int_14+D8j
f000:E7FB		  add	  dx, 5
f000:E7FE		  in	  al, dx
f000:E7FF		  sub	  dx, 5
f000:E802		  test	  al, 1
f000:E804		  jz	  short	l9
f000:E806		  mov	  ah, al
f000:E808		  and	  ah, 1Eh
f000:E80B		  in	  al, dx
f000:E80C		  jmp	  short	exit1
f000:E80E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E80E
f000:E80E l9:							      ;	CODE XREF: int_14+CBj
f000:E80E		  dec	  bx
f000:E80F		  jnz	  short	l8
f000:E811		  loop	  l8
f000:E813
f000:E813 l10:							      ;	CODE XREF: int_14+BEj
f000:E813		  xor	  ah, ah
f000:E815		  add	  dx, 5
f000:E818		  in	  al, dx
f000:E819		  or	  al, 80h
f000:E81B		  xchg	  ah, al
f000:E81D		  or	  ah, 9Eh
f000:E820		  jmp	  short	exit1
f000:E822 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E822
f000:E822 int_14_03:						      ;	CODE XREF: int_14:l0j
f000:E822							      ;	int_14+64j
f000:E822							      ;	DATA XREF: int_14+2Eo
f000:E822		  add	  dx, 5
f000:E825		  in	  al, dx
f000:E826		  mov	  ah, al
f000:E828		  inc	  dx
f000:E829		  in	  al, dx
f000:E82A
f000:E82A exit1:						      ;	CODE XREF: int_14+20j
f000:E82A							      ;	int_14:exit0j
f000:E82A							      ;	int_14+91j
f000:E82A							      ;	int_14+A1j
f000:E82A							      ;	int_14+D3j
f000:E82A							      ;	int_14+E7j
f000:E82A		  jmp	  near ptr int_pop_regs_and_exit
f000:E82A int_14	  endp
f000:E82A
f000:E82A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E82D		  db	0
f000:E82E
f000:E82E ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E82E
f000:E82E
f000:E82E int_16	  proc far				      ;	DATA XREF: f000:FF0Fo
f000:E82E		  sti
f000:E82F		  push	  bx
f000:E830		  push	  cx
f000:E831		  push	  si
f000:E832		  push	  di
f000:E833		  push	  ds
f000:E834		  pushf
f000:E835		  mov	  di, 6
f000:E838		  nop
f000:E839		  call	  check_valid_subfunction
f000:E83C		  jb	  short	error
f000:E83E		  jmp	  word ptr cs:int_16_jmp_tbl[di]
f000:E83E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E843 int_16_jmp_tbl:					      ;	DATA XREF: int_16+10r
f000:E843		  dw offset int_16_00
f000:E845		  dw offset int_16_01
f000:E847		  dw offset int_16_02
f000:E849 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E849
f000:E849 error:						      ;	CODE XREF: int_16+Ej
f000:E849		  jmp	  short	exit
f000:E849 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E84B		  db  90h ; 
f000:E84C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E84C
f000:E84C int_16_00:						      ;	CODE XREF: int_16+10j
f000:E84C							      ;	int_16+44j
f000:E84C							      ;	DATA XREF: int_16:int_16_jmp_tblo
f000:E84C		  cli
f000:E84D		  mov	  si, ds:p400.keyb_buffer_head_ptr
f000:E851		  cmp	  si, ds:p400.keyb_buffer_tail_ptr
f000:E855		  jz	  short	l1
f000:E857		  mov	  ax, [si]
f000:E859		  inc	  si
f000:E85A		  inc	  si
f000:E85B		  cmp	  si, ds:p400.keyb_buffer_end_offset_ptr
f000:E85F		  jb	  short	l0
f000:E861		  mov	  si, ds:p400.keyb_buffer_start_offset_ptr
f000:E865
f000:E865 l0:							      ;	CODE XREF: int_16+31j
f000:E865		  mov	  ds:p400.keyb_buffer_head_ptr,	si
f000:E869		  sti
f000:E86A		  jmp	  short	exit
f000:E86C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E86C
f000:E86C l1:							      ;	CODE XREF: int_16+27j
f000:E86C		  sti
f000:E86D		  mov	  cx, 19h
f000:E870
f000:E870 l2:							      ;	CODE XREF: int_16:l2j
f000:E870		  loop	  l2
f000:E872		  jmp	  short	int_16_00
f000:E874 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E874
f000:E874 int_16_01:						      ;	CODE XREF: int_16+10j
f000:E874							      ;	DATA XREF: int_16+17o
f000:E874		  popf
f000:E875		  xor	  bx, bx
f000:E877		  cli
f000:E878		  mov	  si, ds:p400.keyb_buffer_head_ptr
f000:E87C		  cmp	  si, ds:p400.keyb_buffer_tail_ptr
f000:E880		  sti
f000:E881		  jz	  short	l3
f000:E883		  mov	  ax, [si]
f000:E885		  cmp	  bx, 1
f000:E888		  jmp	  short	l4
f000:E888 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E88A		  db  90h ; 
f000:E88B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E88B
f000:E88B l3:							      ;	CODE XREF: int_16+53j
f000:E88B		  cmp	  bx, 0
f000:E88E
f000:E88E l4:							      ;	CODE XREF: int_16+5Aj
f000:E88E		  jmp	  short	exit2
f000:E890 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E890
f000:E890 int_16_02:						      ;	CODE XREF: int_16+10j
f000:E890							      ;	DATA XREF: int_16+19o
f000:E890		  mov	  al, ds:p400.keyb_status_flags_1
f000:E893
f000:E893 exit:							      ;	CODE XREF: int_16:errorj
f000:E893							      ;	int_16+3Cj
f000:E893		  popf
f000:E894
f000:E894 exit2:						      ;	CODE XREF: int_16:l4j
f000:E894		  pop	  ds
f000:E895		  pop	  di
f000:E896		  pop	  si
f000:E897		  pop	  cx
f000:E898		  pop	  bx
f000:E899		  retf	  2
f000:E899 int_16	  endp
f000:E899
f000:E899 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E89C		  db 0EBh dup(0)
f000:E987
f000:E987 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:E987
f000:E987 ;	The keyboard generates an INT 9	every time a key is pushed or
f000:E987 ;	released.
f000:E987 ;
f000:E987 ;	   Notes:	  This is a hardware interrupt (IRQ 1) activated by
f000:E987 ;			  the make or break of every keystroke.
f000:E987 ;
f000:E987 ;	The default INT	9 handler in the ROM reads the make and	break scan
f000:E987 ;	codes from the keyboard	and converts them into actions or key codes as
f000:E987 ;	follows:
f000:E987 ;
f000:E987 ;	     .	 For ASCII keys, when a	make code is encountered, the ASCII code
f000:E987 ;		 and the scan code for the key are placed in the 32-byte keyboard
f000:E987 ;		 buffer, which is located at 0:41Eh. The ASCII code and	scan code
f000:E987 ;		 are placed in the buffer at the location addressed by the
f000:E987 ;		 Keyboard Buffer Tail Pointer (0:041Ch). The Keyboard Buffer Tail
f000:E987 ;		 Pointer is then incremented by	2, and if it points past the end
f000:E987 ;		 of the	buffer,	it is adjusted so that it points to the	beginning
f000:E987 ;		 of the	buffer.
f000:E987 ;
f000:E987 ;	     .	 If Ctrl, Alt, or Shift	has been pressed, the Shift Status
f000:E987 ;		 (0:0417h) and Extended	Shift Status (0:0418h) bytes are updated.
f000:E987 ;
f000:E987 ;	     .	 If the	Ctrl-Alt-Del combination has been pressed, the Reset
f000:E987 ;		 Flag (0:0472h)	is set to 1234h	and control is given to	the
f000:E987 ;		 power-on self test (POST). Because the	Reset Flag is 1234h, the
f000:E987 ;		 POST routine bypasses the memory test.
f000:E987 ;
f000:E987 ;	     .	 If the	Pause key sequence has been entered, this interrupt
f000:E987 ;		 enters	an indefinite loop. The	loop is	broken as soon as a valid
f000:E987 ;		 ASCII keystroke is entered. (The PC Convertible issues	an INT
f000:E987 ;		 15h, Service 41h (Wait	on External Event), to execute its pause
f000:E987 ;		 loop.)
f000:E987 ;
f000:E987 ;	     .	 If the	Print Screen key sequence is entered, an INT 05h (Print
f000:E987 ;		 Screen) is executed.
f000:E987 ;
f000:E987 ;	     .	 If the	Control-Break key sequence is entered, an INT 1Bh
f000:E987 ;		 (Control-Break) is executed.
f000:E987 ;
f000:E987 ;	     .	 For XTs dated 1/10/86 and after, ATs, XT-286s,	and PC
f000:E987 ;		 Convertibles, the INT 9h handler generates an INT 15h,	function
f000:E987 ;		 91h (Interrupt	Complete) to signal that a keystroke is
f000:E987 ;		 available. Also, on these machines, a make or break of	the Sys
f000:E987 ;		 Req key generates an INT 15h, function	85h (System Request Key
f000:E987 ;		 Pressed).
f000:E987 ;
f000:E987 ;	     .	 For ATs dated 6/10/85 and after, XT-286s, and PC Convertibles,
f000:E987 ;		 an INT	15h, function 4Fh (Keyboard Intercept) is executed after
f000:E987 ;		 the scan code has been	read from the keyboard port (60h). This
f000:E987 ;		 allows	the user to redefine or	remove a keystroke.
f000:E987 ;
f000:E987 ;	INT 16 provides	a standard way to read characters from the keyboard
f000:E987 ;	buffer that have been placed there by the INT 9	handler	in ROM.
f000:E987
f000:E987 int_09	  proc far				      ;	DATA XREF: f000:FEF5o
f000:E987		  call	  int_push_regs
f000:E98A		  push	  ax
f000:E98B		  mov	  ax, 40h ; '@'
f000:E98E		  mov	  ds, ax			      ;	ds = 0x40
f000:E990		  mov	  ch, ds:p400.keyb_status_flags_1
f000:E994		  mov	  cl, ds:p400.keyb_status_flags_2
f000:E998		  mov	  dx, 60h ; '`'
f000:E99B		  in	  al, dx			      ;	AT Keyboard controller 8042.
f000:E99C		  cmp	  al, 0FFh
f000:E99E		  jnz	  short	l0
f000:E9A0		  call	  play_bell_sound?
f000:E9A3		  jmp	  l29
f000:E9A6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9A6
f000:E9A6 l0:							      ;	CODE XREF: int_09+17j
f000:E9A6		  mov	  ah, al
f000:E9A8		  and	  al, 7Fh
f000:E9AA		  cmp	  al, 1Dh			      ;	ctrl?
f000:E9AC		  jnz	  short	l1
f000:E9AE		  jmp	  l34
f000:E9B1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9B1
f000:E9B1 l1:							      ;	CODE XREF: int_09+25j
f000:E9B1		  cmp	  al, 2Ah ; '*'                       ; left shift?
f000:E9B3		  jnz	  short	l2
f000:E9B5		  jmp	  l36
f000:E9B8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9B8
f000:E9B8 l2:							      ;	CODE XREF: int_09+2Cj
f000:E9B8		  cmp	  al, 36h ; '6'                       ; right shift?
f000:E9BA		  jnz	  short	l3
f000:E9BC		  jmp	  l38
f000:E9BF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9BF
f000:E9BF l3:							      ;	CODE XREF: int_09+33j
f000:E9BF		  cmp	  al, 38h ; '8'                       ; alt?
f000:E9C1		  jnz	  short	l4
f000:E9C3		  jmp	  l40
f000:E9C6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9C6
f000:E9C6 l4:							      ;	CODE XREF: int_09+3Aj
f000:E9C6		  cmp	  al, 3Ah ; ':'
f000:E9C8		  jnz	  short	l5
f000:E9CA		  jmp	  l43
f000:E9CD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9CD
f000:E9CD l5:							      ;	CODE XREF: int_09+41j
f000:E9CD		  cmp	  al, 45h ; 'E'                       ; num lock?
f000:E9CF		  jnz	  short	l6
f000:E9D1		  jmp	  l47
f000:E9D4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9D4
f000:E9D4 l6:							      ;	CODE XREF: int_09+48j
f000:E9D4		  cmp	  al, 46h ; 'F'                       ; hold?
f000:E9D6		  jnz	  short	l7
f000:E9D8		  jmp	  l51
f000:E9DB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9DB
f000:E9DB l7:							      ;	CODE XREF: int_09+4Fj
f000:E9DB		  cmp	  al, 55h ; 'U'                       ; insert?
f000:E9DD		  jnz	  short	l8
f000:E9DF		  mov	  al, ah
f000:E9E1		  jmp	  short	l11
f000:E9E3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9E3
f000:E9E3 l8:							      ;	CODE XREF: int_09+56j
f000:E9E3		  mov	  al, ah
f000:E9E5		  test	  cl, 8
f000:E9E8		  jz	  short	l11
f000:E9EA		  cmp	  al, 9Dh ; ''                       ; break code: ctrl?
f000:E9EC		  jnz	  short	l9
f000:E9EE		  and	  ch, 11111011b			      ;	mask off ctrl bit from status
f000:E9F1		  jmp	  short	l10
f000:E9F3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:E9F3
f000:E9F3 l9:							      ;	CODE XREF: int_09+65j
f000:E9F3		  cmp	  al, 0
f000:E9F5		  jl	  short	l10
f000:E9F7		  and	  cl, 8
f000:E9FA
f000:E9FA l10:							      ;	CODE XREF: int_09+6Aj
f000:E9FA							      ;	int_09+6Ej
f000:E9FA		  call	  kbd_reset_and_ack_int
f000:E9FD		  jmp	  l32
f000:EA00 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA00
f000:EA00 l11:							      ;	CODE XREF: int_09+5Aj
f000:EA00							      ;	int_09+61j
f000:EA00		  cmp	  al, 0D5h ; 'Õ'                      ; break code: insert?
f000:EA02		  jnz	  short	l12
f000:EA04		  jmp	  l56
f000:EA07 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA07
f000:EA07 l12:							      ;	CODE XREF: int_09+7Bj
f000:EA07		  cmp	  al, 0
f000:EA09		  jge	  short	l13
f000:EA0B		  jmp	  l29
f000:EA0E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA0E
f000:EA0E l13:							      ;	CODE XREF: int_09+82j
f000:EA0E		  cmp	  al, 47h ; 'G'
f000:EA10		  jl	  short	l14
f000:EA12		  jmp	  l60
f000:EA15 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA15
f000:EA15 l14:							      ;	CODE XREF: int_09+89j
f000:EA15		  mov	  byte ptr ds:p400.alt_keypad_entry, 0
f000:EA1A		  cmp	  al, 37h ; '7'
f000:EA1C		  jnz	  short	l15
f000:EA1E		  test	  ch, 3
f000:EA21		  jz	  short	l15
f000:EA23		  jmp	  l84
f000:EA26 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA26
f000:EA26 l15:							      ;	CODE XREF: int_09+95j
f000:EA26							      ;	int_09+9Aj
f000:EA26		  lea	  bx, byte_FEE05
f000:EA2A		  test	  ch, 40h
f000:EA2D		  jz	  short	l17
f000:EA2F		  cmp	  al, 10h
f000:EA31		  jl	  short	l17
f000:EA33		  cmp	  al, 1Ah
f000:EA35		  jl	  short	l16
f000:EA37		  cmp	  al, 1Eh
f000:EA39		  jl	  short	l17
f000:EA3B		  cmp	  al, 27h ; '''
f000:EA3D		  jl	  short	l16
f000:EA3F		  cmp	  al, 2Ch ; ','
f000:EA41		  jl	  short	l17
f000:EA43		  cmp	  al, 33h ; '3'
f000:EA45		  jge	  short	l17
f000:EA47
f000:EA47 l16:							      ;	CODE XREF: int_09+AEj
f000:EA47							      ;	int_09+B6j
f000:EA47		  lea	  bx, byte_FEE4B
f000:EA4B
f000:EA4B l17:							      ;	CODE XREF: int_09+A6j
f000:EA4B							      ;	int_09+AAj
f000:EA4B							      ;	int_09+B2j
f000:EA4B							      ;	int_09+BAj
f000:EA4B							      ;	int_09+BEj
f000:EA4B		  test	  ch, 3
f000:EA4E		  jz	  short	l19
f000:EA50		  cmp	  bx, offset byte_FEE4B
f000:EA54		  jnz	  short	l18
f000:EA56		  lea	  bx, byte_FEE05
f000:EA5A		  jmp	  short	l19
f000:EA5C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA5C
f000:EA5C l18:							      ;	CODE XREF: int_09+CDj
f000:EA5C		  lea	  bx, byte_FEE4B
f000:EA60
f000:EA60 l19:							      ;	CODE XREF: int_09+C7j
f000:EA60							      ;	int_09+D3j
f000:EA60		  test	  ch, 8
f000:EA63		  jz	  short	l20
f000:EA65		  lea	  bx, byte_FEED7
f000:EA69		  jmp	  short	l21
f000:EA6B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA6B
f000:EA6B l20:							      ;	CODE XREF: int_09+DCj
f000:EA6B		  test	  ch, 4
f000:EA6E		  jz	  short	l21
f000:EA70		  lea	  bx, byte_FEE91
f000:EA74
f000:EA74 l21:							      ;	CODE XREF: int_09+E2j
f000:EA74							      ;	int_09+E7j
f000:EA74		  call	  sub_FEDE7
f000:EA77		  cmp	  al, 0FFh
f000:EA79		  jnz	  short	l22
f000:EA7B		  jmp	  short	l29
f000:EA7B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA7D		  db  90h ; 
f000:EA7E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EA7E
f000:EA7E l22:							      ;	CODE XREF: int_09+F2j
f000:EA7E		  cmp	  ah, 29h ; ')'
f000:EA81		  jz	  short	l26
f000:EA83		  cmp	  ah, 2Bh ; '+'
f000:EA86		  jz	  short	l26
f000:EA88		  cmp	  ah, 3Ah ; ':'
f000:EA8B		  jg	  short	l26
f000:EA8D		  test	  ch, 4
f000:EA90		  jz	  short	l23
f000:EA92		  cmp	  ah, 1
f000:EA95		  jz	  short	l27
f000:EA97		  cmp	  ah, 7
f000:EA9A		  jz	  short	l27
f000:EA9C		  cmp	  ah, 0Bh
f000:EA9F		  jbe	  short	l26
f000:EAA1		  cmp	  ah, 0Dh
f000:EAA4		  jz	  short	l26
f000:EAA6		  cmp	  ah, 0Fh
f000:EAA9		  jz	  short	l26
f000:EAAB		  cmp	  ah, 27h ; '''
f000:EAAE		  jz	  short	l26
f000:EAB0		  cmp	  ah, 28h ; '('
f000:EAB3		  jz	  short	l26
f000:EAB5		  cmp	  ah, 33h ; '3'
f000:EAB8		  jz	  short	l26
f000:EABA		  cmp	  ah, 34h ; '4'
f000:EABD		  jz	  short	l26
f000:EABF		  cmp	  ah, 35h ; '5'
f000:EAC2		  jz	  short	l26
f000:EAC4		  cmp	  ah, 37h ; '7'
f000:EAC7		  jz	  short	l26
f000:EAC9
f000:EAC9 l23:							      ;	CODE XREF: int_09+109j
f000:EAC9		  test	  ch, 8
f000:EACC		  jz	  short	l24
f000:EACE		  cmp	  ah, 39h ; '9'
f000:EAD1		  jz	  short	l27
f000:EAD3		  jmp	  short	l26
f000:EAD5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EAD5
f000:EAD5 l24:							      ;	CODE XREF: int_09+145j
f000:EAD5		  cmp	  ah, 0Fh
f000:EAD8		  jnz	  short	l25
f000:EADA		  cmp	  al, 0Fh
f000:EADC		  jz	  short	l26
f000:EADE
f000:EADE l25:							      ;	CODE XREF: int_09+151j
f000:EADE		  test	  ch, 8
f000:EAE1		  jz	  short	l27
f000:EAE3
f000:EAE3 l26:							      ;	CODE XREF: int_09+FAj
f000:EAE3							      ;	int_09+FFj
f000:EAE3							      ;	int_09+104j
f000:EAE3							      ;	int_09+118j
f000:EAE3							      ;	int_09+11Dj
f000:EAE3							      ;	int_09+122j ...
f000:EAE3		  mov	  ah, al
f000:EAE5		  xor	  al, al
f000:EAE7
f000:EAE7 l27:							      ;	CODE XREF: int_09+10Ej
f000:EAE7							      ;	int_09+113j
f000:EAE7							      ;	int_09+14Aj
f000:EAE7							      ;	int_09+15Aj
f000:EAE7							      ;	int_09+1EBj
f000:EAE7							      ;	int_09:l80j
f000:EAE7		  mov	  bx, 0B0h ; '°'
f000:EAEA		  mov	  dx, [bx]
f000:EAEC		  or	  dx, [bx+2]
f000:EAEF		  jz	  short	l28
f000:EAF1		  call	  dword	ptr [bx]
f000:EAF3		  jb	  short	l29
f000:EAF5
f000:EAF5 l28:							      ;	CODE XREF: int_09+168j
f000:EAF5		  call	  sub_FEDAA
f000:EAF8
f000:EAF8 l29:							      ;	CODE XREF: int_09+1Cj
f000:EAF8							      ;	int_09+84j
f000:EAF8							      ;	int_09+F4j
f000:EAF8							      ;	int_09+16Cj
f000:EAF8							      ;	int_09+1A5j
f000:EAF8							      ;	int_09+1AAj ...
f000:EAF8		  call	  kbd_reset_and_ack_int
f000:EAFB		  test	  cl, 8
f000:EAFE		  jz	  short	l32
f000:EB00		  mov	  ds:p400.keyb_status_flags_1, ch
f000:EB04		  mov	  ds:p400.keyb_status_flags_2, cl
f000:EB08
f000:EB08 l30:							      ;	CODE XREF: int_09+189j
f000:EB08		  test	  byte ptr ds:p400.keyb_status_flags_2,	8
f000:EB0D		  jz	  short	l31
f000:EB0F		  sti
f000:EB10		  jmp	  short	l30
f000:EB12 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB12
f000:EB12 l31:							      ;	CODE XREF: int_09+186j
f000:EB12		  cli
f000:EB13		  jmp	  short	l33
f000:EB15 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB15
f000:EB15 l32:							      ;	CODE XREF: int_09+76j
f000:EB15							      ;	int_09+177j
f000:EB15		  mov	  ds:p400.keyb_status_flags_1, ch
f000:EB19		  mov	  ds:p400.keyb_status_flags_2, cl
f000:EB1D
f000:EB1D l33:							      ;	CODE XREF: int_09+18Cj
f000:EB1D							      ;	int_09:l85j
f000:EB1D		  pop	  ax
f000:EB1E		  jmp	  near ptr int_pop_regs_and_exit
f000:EB21 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB21
f000:EB21 l34:							      ;	CODE XREF: int_09+27j
f000:EB21		  cmp	  ah, 1Dh			      ;	ctrl?
f000:EB24		  jnz	  short	l35
f000:EB26		  or	  ch, 100b			      ;	turn on	ctrl bit in status
f000:EB29		  and	  ch, 11111100b			      ;	turn off shift bits
f000:EB2C		  jmp	  short	l29
f000:EB2E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB2E
f000:EB2E l35:							      ;	CODE XREF: int_09+19Dj
f000:EB2E		  and	  ch, 11111011b			      ;	turn off ctrl bit in status
f000:EB31		  jmp	  short	l29
f000:EB33 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB33
f000:EB33 l36:							      ;	CODE XREF: int_09+2Ej
f000:EB33		  cmp	  ah, 2Ah ; '*'                       ; left shift?
f000:EB36		  jnz	  short	l37
f000:EB38		  or	  ch, 10b			      ;	turn on	left shift in status
f000:EB3B		  jmp	  short	l29
f000:EB3D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB3D
f000:EB3D l37:							      ;	CODE XREF: int_09+1AFj
f000:EB3D		  and	  ch, 11111101b			      ;	turn off left shift in status
f000:EB40		  jmp	  short	l29
f000:EB42 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB42
f000:EB42 l38:							      ;	CODE XREF: int_09+35j
f000:EB42		  cmp	  ah, 36h ; '6'                       ; right shift?
f000:EB45		  jnz	  short	l39
f000:EB47		  or	  ch, 1				      ;	turn on	right shift in status
f000:EB4A		  jmp	  short	l29
f000:EB4C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB4C
f000:EB4C l39:							      ;	CODE XREF: int_09+1BEj
f000:EB4C		  and	  ch, 11111110b			      ;	turn off right shift in	status
f000:EB4F		  jmp	  short	l29
f000:EB51 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB51
f000:EB51 l40:							      ;	CODE XREF: int_09+3Cj
f000:EB51		  cmp	  ah, 38h ; '8'                       ; alt?
f000:EB54		  jnz	  short	l41
f000:EB56		  or	  ch, 1000b			      ;	turn on	alt in status
f000:EB59		  mov	  byte ptr ds:p400.alt_keypad_entry, 0 ; reset previous	alt+numpad value
f000:EB5E		  and	  ch, 11111100b			      ;	turn off shift in status
f000:EB61		  jmp	  short	l29
f000:EB63 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB63
f000:EB63 l41:							      ;	CODE XREF: int_09+1CDj
f000:EB63		  and	  ch, 11110111b			      ;	turn off alt in	status
f000:EB66		  cmp	  byte ptr ds:p400.alt_keypad_entry, 0 ; alt + numpad with value?
f000:EB6B		  jz	  short	l42
f000:EB6D		  xor	  ax, ax
f000:EB6F		  mov	  al, ds:p400.alt_keypad_entry	      ;	get previous alt + numpad value
f000:EB72		  jmp	  l27
f000:EB75 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB75
f000:EB75 l42:							      ;	CODE XREF: int_09+1E4j
f000:EB75		  jmp	  short	l29
f000:EB77 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB77
f000:EB77 l43:							      ;	CODE XREF: int_09+43j
f000:EB77		  cmp	  ah, 3Ah ; ':'                       ; caps?
f000:EB7A		  jnz	  short	l46
f000:EB7C		  test	  cl, 1000000b
f000:EB7F		  jnz	  short	l44
f000:EB81		  or	  cl, 1000000b
f000:EB84		  test	  ch, 1000000b
f000:EB87		  jnz	  short	l45
f000:EB89		  or	  ch, 1000000b
f000:EB8C
f000:EB8C l44:							      ;	CODE XREF: int_09+1F8j
f000:EB8C							      ;	int_09+254j
f000:EB8C		  jmp	  l29
f000:EB8F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB8F
f000:EB8F l45:							      ;	CODE XREF: int_09+200j
f000:EB8F		  and	  ch, 0BFh
f000:EB92		  jmp	  l29
f000:EB95 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB95
f000:EB95 l46:							      ;	CODE XREF: int_09+1F3j
f000:EB95		  and	  ch, 0BFh
f000:EB98		  and	  cl, 0BFh
f000:EB9B		  jmp	  l29
f000:EB9E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EB9E
f000:EB9E l47:							      ;	CODE XREF: int_09+4Aj
f000:EB9E		  cmp	  ah, 45h ; 'E'                       ; num lock?
f000:EBA1		  jnz	  short	l50
f000:EBA3		  test	  ch, 100b
f000:EBA6		  jz	  short	l48
f000:EBA8		  jmp	  l29
f000:EBAB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBAB
f000:EBAB l48:							      ;	CODE XREF: int_09+21Fj
f000:EBAB		  or	  cl, 100000b
f000:EBAE		  test	  ch, 100000b
f000:EBB1		  jnz	  short	l49
f000:EBB3		  or	  ch, 100000b
f000:EBB6		  jmp	  l29
f000:EBB9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBB9
f000:EBB9 l49:							      ;	CODE XREF: int_09+22Aj
f000:EBB9		  and	  ch, 11011111b
f000:EBBC		  jmp	  l29
f000:EBBF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBBF
f000:EBBF l50:							      ;	CODE XREF: int_09+21Aj
f000:EBBF		  and	  ch, 11011111b
f000:EBC2		  and	  cl, 11011111b
f000:EBC5		  jmp	  l29
f000:EBC8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBC8
f000:EBC8 l51:							      ;	CODE XREF: int_09+51j
f000:EBC8		  cmp	  ah, 46h ; 'F'                       ; hold?
f000:EBCB		  jnz	  short	l55
f000:EBCD		  test	  cl, 1000b
f000:EBD0		  jz	  short	l52
f000:EBD2		  and	  cl, 11110111b
f000:EBD5		  jmp	  l29
f000:EBD8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBD8
f000:EBD8 l52:							      ;	CODE XREF: int_09+249j
f000:EBD8		  test	  cl, 10000b
f000:EBDB		  jnz	  short	l44
f000:EBDD		  or	  cl, 10000b
f000:EBE0		  test	  ch, 10000b
f000:EBE3		  jnz	  short	l54
f000:EBE5		  or	  ch, 10000b
f000:EBE8		  jmp	  short	l53
f000:EBE8 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBEA		  db  90h ; 				      ;	unused?
f000:EBEB		  db 0F6h ; ö
f000:EBEC		  db 0C5h ; Å
f000:EBED		  db	4
f000:EBEE		  db  74h ; t
f000:EBEF		  db	6
f000:EBF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBF0
f000:EBF0 l53:							      ;	CODE XREF: int_09+261j
f000:EBF0		  or	  cl, 1000b
f000:EBF3		  jmp	  l29
f000:EBF3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EBF6		  db 0F6h ; ö				      ;	unused?
f000:EBF7		  db 0C5h ; Å
f000:EBF8		  db	8
f000:EBF9		  db  74h ; t
f000:EBFA		  db	2
f000:EBFB		  db 0EBh ; ë
f000:EBFC		  db 0F3h ; ó
f000:EBFD		  db 0F6h ; ö
f000:EBFE		  db 0C5h ; Å
f000:EBFF		  db	1
f000:EC00		  db  74h ; t
f000:EC01		  db	2
f000:EC02		  db 0EBh ; ë
f000:EC03		  db 0ECh ; ì
f000:EC04		  db 0F6h ; ö
f000:EC05		  db 0C5h ; Å
f000:EC06		  db	2
f000:EC07		  db  74h ; t
f000:EC08		  db	2
f000:EC09		  db 0EBh ; ë
f000:EC0A		  db 0E5h ; å
f000:EC0B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC0B
f000:EC0B l54:							      ;	CODE XREF: int_09+25Cj
f000:EC0B		  and	  ch, 11101111b
f000:EC0E		  jmp	  l29
f000:EC11 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC11
f000:EC11 l55:							      ;	CODE XREF: int_09+244j
f000:EC11		  and	  cl, 11101111b
f000:EC14		  and	  ch, 11101111b
f000:EC17		  jmp	  l29
f000:EC1A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC1A
f000:EC1A l56:							      ;	CODE XREF: int_09+7Dj
f000:EC1A		  test	  ch, 100000b
f000:EC1D		  jnz	  short	l58
f000:EC1F		  test	  ch, 1111b
f000:EC22		  jnz	  short	l59
f000:EC24
f000:EC24 l57:							      ;	CODE XREF: int_09+2A6j
f000:EC24		  and	  cl, 1111111b
f000:EC27		  jmp	  l29
f000:EC2A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC2A
f000:EC2A l58:							      ;	CODE XREF: int_09+296j
f000:EC2A		  test	  ch, 3
f000:EC2D		  jnz	  short	l57
f000:EC2F
f000:EC2F l59:							      ;	CODE XREF: int_09+29Bj
f000:EC2F		  jmp	  l29
f000:EC32 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC32
f000:EC32 l60:							      ;	CODE XREF: int_09+8Bj
f000:EC32		  test	  ch, 100b
f000:EC35		  jz	  short	l63
f000:EC37		  cmp	  al, 54h ; 'T'                       ; break?
f000:EC39		  jnz	  short	l61
f000:EC3B		  jmp	  l83
f000:EC3E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC3E
f000:EC3E l61:							      ;	CODE XREF: int_09+2B2j
f000:EC3E		  cmp	  al, 53h ; 'S'                       ; delete / - ?
f000:EC40		  jnz	  short	l62
f000:EC42		  test	  ch, 1000b
f000:EC45		  jz	  short	l62
f000:EC47		  jmp	  soft_reset
f000:EC4A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC4A
f000:EC4A l62:							      ;	CODE XREF: int_09+2B9j
f000:EC4A							      ;	int_09+2BEj
f000:EC4A		  lea	  bx, byte_FEF4F
f000:EC4E		  jmp	  l78
f000:EC51 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC51
f000:EC51 l63:							      ;	CODE XREF: int_09+2AEj
f000:EC51		  test	  ch, 1000b
f000:EC54		  jz	  short	l71
f000:EC56		  cmp	  al, 53h ; 'S'                       ; delete / - ?
f000:EC58		  jnz	  short	l64
f000:EC5A		  test	  ch, 4
f000:EC5D		  jz	  short	l64
f000:EC5F		  jmp	  soft_reset
f000:EC62 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EC62
f000:EC62 l64:							      ;	CODE XREF: int_09+2D1j
f000:EC62							      ;	int_09+2D6j
f000:EC62		  cmp	  al, 4Ah ; 'J'                       ; cursor down?
f000:EC64		  jz	  short	l69
f000:EC66		  cmp	  al, 4Eh ; 'N'                       ; cursor right?
f000:EC68		  jz	  short	l69
f000:EC6A		  cmp	  al, 54h ; 'T'                       ; break ?
f000:EC6C		  jz	  short	l66
f000:EC6E		  cmp	  al, 53h ; 'S'                       ; delete / - ?
f000:EC70		  jge	  short	l69
f000:EC72		  cmp	  al, 4Eh ; 'N'                       ; cursor right?
f000:EC74		  jz	  short	l65
f000:EC76		  mov	  dx, ax
f000:EC78		  xor	  ax, ax
f000:EC7A		  mov	  al, ds:p400.alt_keypad_entry
f000:EC7D		  shl	  ax, 1
f000:EC7F		  push	  ax
f000:EC80		  shl	  ax, 1
f000:EC82		  shl	  ax, 1
f000:EC84		  pop	  bx
f000:EC85		  add	  ax, bx
f000:EC87		  push	  ax
f000:EC88		  mov	  ax, dx
f000:EC8A		  lea	  bx, byte_FEF1D
f000:EC8E		  sub	  al, 46h ; 'F'
f000:EC90		  call	  sub_FEDE7
f000:EC93		  sub	  al, 30h ; '0'
f000:EC95		  xor	  ah, ah
f000:EC97		  pop	  dx
f000:EC98		  add	  dx, ax
f000:EC9A		  mov	  ds:p400.alt_keypad_entry, dl
f000:EC9E
f000:EC9E l65:							      ;	CODE XREF: int_09+2EDj
f000:EC9E		  jmp	  l29
f000:ECA1 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECA1
f000:ECA1 l66:							      ;	CODE XREF: int_09+2E5j
f000:ECA1		  cmp	  al, 54h ; 'T'
f000:ECA3		  jnz	  short	l68
f000:ECA5		  or	  cl, 10h
f000:ECA8		  test	  ch, 10h
f000:ECAB		  jnz	  short	l67
f000:ECAD		  or	  ch, 10h
f000:ECB0		  jmp	  l29
f000:ECB3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECB3
f000:ECB3 l67:							      ;	CODE XREF: int_09+324j
f000:ECB3		  and	  ch, 0EFh
f000:ECB6		  jmp	  l29
f000:ECB9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECB9
f000:ECB9 l68:							      ;	CODE XREF: int_09+31Cj
f000:ECB9		  and	  cl, 0EFh
f000:ECBC		  jmp	  l29
f000:ECBF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECBF
f000:ECBF l69:							      ;	CODE XREF: int_09+2DDj
f000:ECBF							      ;	int_09+2E1j
f000:ECBF							      ;	int_09+2E9j
f000:ECBF		  lea	  bx, byte_FEF68
f000:ECC3		  sub	  al, 46h ; 'F'
f000:ECC5		  call	  sub_FEDE7
f000:ECC8		  cmp	  al, 0FFh
f000:ECCA		  jnz	  short	l70
f000:ECCC		  jmp	  l29
f000:ECCF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECCF
f000:ECCF l70:							      ;	CODE XREF: int_09+343j
f000:ECCF		  jmp	  l26
f000:ECD2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECD2
f000:ECD2 l71:							      ;	CODE XREF: int_09+2CDj
f000:ECD2		  test	  ch, 20h
f000:ECD5		  jnz	  short	l76
f000:ECD7		  cmp	  al, 4Ah ; 'J'
f000:ECD9		  jz	  short	l72
f000:ECDB		  cmp	  al, 4Eh ; 'N'
f000:ECDD		  jz	  short	l72
f000:ECDF		  cmp	  al, 58h ; 'X'
f000:ECE1		  jge	  short	l72
f000:ECE3		  jmp	  short	l73
f000:ECE5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECE5
f000:ECE5 l72:							      ;	CODE XREF: int_09+352j
f000:ECE5							      ;	int_09+356j
f000:ECE5							      ;	int_09+35Aj
f000:ECE5		  test	  ch, 3
f000:ECE8		  jnz	  short	l74
f000:ECEA		  jmp	  short	l77
f000:ECEC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ECEC
f000:ECEC l73:							      ;	CODE XREF: int_09+35Cj
f000:ECEC		  test	  ch, 3
f000:ECEF		  jnz	  short	l77
f000:ECF1
f000:ECF1 l74:							      ;	CODE XREF: int_09+361j
f000:ECF1							      ;	int_09+387j
f000:ECF1		  lea	  bx, byte_FEF36
f000:ECF5		  cmp	  al, 52h ; 'R'
f000:ECF7		  jnz	  short	l78
f000:ECF9		  or	  cl, 80h
f000:ECFC		  test	  ch, 80h
f000:ECFF		  jnz	  short	l75
f000:ED01		  or	  ch, 80h
f000:ED04		  jmp	  short	l78
f000:ED06 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ED06
f000:ED06 l75:							      ;	CODE XREF: int_09+378j
f000:ED06		  and	  ch, 7Fh
f000:ED09		  jmp	  short	l78
f000:ED0B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ED0B
f000:ED0B l76:							      ;	CODE XREF: int_09+34Ej
f000:ED0B		  test	  ch, 3
f000:ED0E		  jnz	  short	l74
f000:ED10
f000:ED10 l77:							      ;	CODE XREF: int_09+363j
f000:ED10							      ;	int_09+368j
f000:ED10		  lea	  bx, byte_FEF1D
f000:ED14
f000:ED14 l78:							      ;	CODE XREF: int_09+2C7j
f000:ED14							      ;	int_09+370j
f000:ED14							      ;	int_09+37Dj
f000:ED14							      ;	int_09+382j
f000:ED14		  sub	  al, 46h ; 'F'
f000:ED16		  call	  sub_FEDE7
f000:ED19		  cmp	  al, 0FFh
f000:ED1B		  jnz	  short	l79
f000:ED1D		  jmp	  l29
f000:ED20 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ED20
f000:ED20 l79:							      ;	CODE XREF: int_09+394j
f000:ED20		  cmp	  bx, offset byte_FEF1D
f000:ED24		  jnz	  short	l81
f000:ED26		  cmp	  al, 50h ; 'P'
f000:ED28		  jz	  short	l82
f000:ED2A		  cmp	  al, 4Dh ; 'M'
f000:ED2C		  jz	  short	l82
f000:ED2E		  cmp	  al, 0
f000:ED30		  jz	  short	l82
f000:ED32		  cmp	  al, 47h ; 'G'
f000:ED34		  jz	  short	l82
f000:ED36		  cmp	  al, 98h ; '˜'
f000:ED38		  jz	  short	l82
f000:ED3A		  cmp	  al, 99h ; '™'
f000:ED3C		  jz	  short	l82
f000:ED3E
f000:ED3E l80:							      ;	CODE XREF: int_09+3BCj
f000:ED3E							      ;	int_09+3C0j
f000:ED3E							      ;	int_09+3C4j
f000:ED3E							      ;	int_09+3C8j
f000:ED3E							      ;	int_09+3CCj
f000:ED3E							      ;	int_09+3D0j ...
f000:ED3E		  jmp	  l27
f000:ED41 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ED41
f000:ED41 l81:							      ;	CODE XREF: int_09+39Dj
f000:ED41		  cmp	  al, 5Ch ; '\'
f000:ED43		  jz	  short	l80
f000:ED45		  cmp	  al, 7Ch ; '|'
f000:ED47		  jz	  short	l80
f000:ED49		  cmp	  al, 7Eh ; '~'
f000:ED4B		  jz	  short	l80
f000:ED4D		  cmp	  al, 60h ; '`'
f000:ED4F		  jz	  short	l80
f000:ED51		  cmp	  al, 0Dh
f000:ED53		  jz	  short	l80
f000:ED55		  cmp	  al, 5Eh ; '^'
f000:ED57		  jz	  short	l80
f000:ED59		  cmp	  al, 3Ch ; '<'
f000:ED5B		  jz	  short	l80
f000:ED5D		  cmp	  al, 23h ; '#'
f000:ED5F		  jz	  short	l80
f000:ED61		  cmp	  al, 7Bh ; '{'
f000:ED63		  jz	  short	l80
f000:ED65		  cmp	  al, 7Dh ; '}'
f000:ED67		  jz	  short	l80
f000:ED69		  cmp	  al, 0Ah
f000:ED6B		  jz	  short	l80
f000:ED6D
f000:ED6D l82:							      ;	CODE XREF: int_09+3A1j
f000:ED6D							      ;	int_09+3A5j
f000:ED6D							      ;	int_09+3A9j
f000:ED6D							      ;	int_09+3ADj
f000:ED6D							      ;	int_09+3B1j
f000:ED6D							      ;	int_09+3B5j
f000:ED6D		  jmp	  l26
f000:ED70 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ED70
f000:ED70 soft_reset:						      ;	CODE XREF: int_09+2C0j
f000:ED70							      ;	int_09+2D8j
f000:ED70		  mov	  bx, p400.POST_reset_flag
f000:ED73		  mov	  word ptr [bx], 1234h
f000:ED77		  call	  kbd_reset_and_ack_int
f000:ED7A		  jmp	  reset_entry
f000:ED7D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ED7D
f000:ED7D l83:							      ;	CODE XREF: int_09+2B4j
f000:ED7D		  mov	  ax, ds:p400.keyb_buffer_start_offset_ptr
f000:ED80		  mov	  ds:p400.keyb_buffer_head_ptr,	ax
f000:ED83		  mov	  ds:p400.keyb_buffer_tail_ptr,	ax
f000:ED86		  push	  ds
f000:ED87		  mov	  ax, 40h ; '@'
f000:ED8A		  mov	  ds, ax
f000:ED8C		  mov	  bx, p400.ctrl_break_flag
f000:ED8F		  mov	  byte ptr [bx], 80h ; '€'
f000:ED92		  pop	  ds
f000:ED93		  int	  1Bh				      ;	CTRL-BREAK KEY
f000:ED95		  xor	  ax, ax
f000:ED97		  call	  sub_FEDAA
f000:ED9A		  jmp	  l29
f000:ED9D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:ED9D
f000:ED9D l84:							      ;	CODE XREF: int_09+9Cj
f000:ED9D		  call	  kbd_reset_and_ack_int
f000:EDA0		  call	  sub_FEDCC
f000:EDA3		  jb	  short	l85
f000:EDA5		  int	  5				      ;	 - PRINT-SCREEN	KEY
f000:EDA5							      ;	automatically called by	keyboard scanner when print-screen key is pressed
f000:EDA7
f000:EDA7 l85:							      ;	CODE XREF: int_09+41Cj
f000:EDA7		  jmp	  l33
f000:EDA7 int_09	  endp
f000:EDA7
f000:EDAA
f000:EDAA ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:EDAA
f000:EDAA
f000:EDAA sub_FEDAA	  proc near				      ;	CODE XREF: int_09:l28p
f000:EDAA							      ;	int_09+410p
f000:EDAA		  cli
f000:EDAB		  call	  sub_FEDCC
f000:EDAE		  jb	  short	l1
f000:EDB0		  mov	  si, ds:p400.keyb_buffer_tail_ptr
f000:EDB4		  mov	  [si],	ax
f000:EDB6		  inc	  si
f000:EDB7		  inc	  si
f000:EDB8		  cmp	  si, ds:p400.keyb_buffer_end_offset_ptr
f000:EDBC		  jb	  short	l0
f000:EDBE		  mov	  si, ds:p400.keyb_buffer_start_offset_ptr
f000:EDC2
f000:EDC2 l0:							      ;	CODE XREF: sub_FEDAA+12j
f000:EDC2		  mov	  ds:p400.keyb_buffer_tail_ptr,	si
f000:EDC6		  retn
f000:EDC7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EDC7
f000:EDC7 l1:							      ;	CODE XREF: sub_FEDAA+4j
f000:EDC7		  sti
f000:EDC8		  call	  play_bell_sound?
f000:EDCB		  retn
f000:EDCB sub_FEDAA	  endp
f000:EDCB
f000:EDCC
f000:EDCC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:EDCC
f000:EDCC
f000:EDCC sub_FEDCC	  proc near				      ;	CODE XREF: int_09+419p
f000:EDCC							      ;	sub_FEDAA+1p
f000:EDCC		  mov	  si, ds:p400.keyb_buffer_tail_ptr
f000:EDD0		  inc	  si
f000:EDD1		  inc	  si
f000:EDD2		  cmp	  si, ds:p400.keyb_buffer_end_offset_ptr
f000:EDD6		  jb	  short	loc_FEDDC
f000:EDD8		  mov	  si, ds:p400.keyb_buffer_start_offset_ptr
f000:EDDC
f000:EDDC loc_FEDDC:						      ;	CODE XREF: sub_FEDCC+Aj
f000:EDDC		  cmp	  si, ds:p400.keyb_buffer_head_ptr
f000:EDE0		  jz	  short	loc_FEDE5
f000:EDE2		  clc
f000:EDE3		  jmp	  short	locret_FEDE6
f000:EDE5 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EDE5
f000:EDE5 loc_FEDE5:						      ;	CODE XREF: sub_FEDCC+14j
f000:EDE5		  stc
f000:EDE6
f000:EDE6 locret_FEDE6:						      ;	CODE XREF: sub_FEDCC+17j
f000:EDE6		  retn
f000:EDE6 sub_FEDCC	  endp
f000:EDE6
f000:EDE7
f000:EDE7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:EDE7
f000:EDE7
f000:EDE7 sub_FEDE7	  proc near				      ;	CODE XREF: int_09:l21p
f000:EDE7							      ;	int_09+309p
f000:EDE7							      ;	int_09+33Ep
f000:EDE7							      ;	int_09+38Fp
f000:EDE7		  push	  ds
f000:EDE8		  push	  ax
f000:EDE9		  mov	  ax, cs
f000:EDEB		  mov	  ds, ax
f000:EDED		  pop	  ax
f000:EDEE		  dec	  al
f000:EDF0		  xlat
f000:EDF1		  pop	  ds
f000:EDF2		  retn
f000:EDF2 sub_FEDE7	  endp
f000:EDF2
f000:EDF3
f000:EDF3 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:EDF3
f000:EDF3
f000:EDF3 kbd_reset_and_ack_int	proc near			      ;	CODE XREF: int_09:l10p
f000:EDF3							      ;	int_09:l29p
f000:EDF3							      ;	int_09+3F0p
f000:EDF3							      ;	int_09:l84p
f000:EDF3		  cli
f000:EDF4		  mov	  dx, 61h ; 'a'
f000:EDF7		  in	  al, dx			      ;	PC/XT PPI port B bits:
f000:EDF7							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:EDF7							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:EDF7							      ;	3: 1=read high switches
f000:EDF7							      ;	4: 0=enable RAM	parity checking
f000:EDF7							      ;	5: 0=enable I/O	channel	check
f000:EDF7							      ;	6: 0=hold keyboard clock low
f000:EDF7							      ;	7: 0=enable kbrd
f000:EDF8		  or	  al, 80h
f000:EDFA		  out	  dx, al			      ;	PC/XT PPI port B bits:
f000:EDFA							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:EDFA							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:EDFA							      ;	3: 1=read high switches
f000:EDFA							      ;	4: 0=enable RAM	parity checking
f000:EDFA							      ;	5: 0=enable I/O	channel	check
f000:EDFA							      ;	6: 0=hold keyboard clock low
f000:EDFA							      ;	7: 0=enable kbrd
f000:EDFB		  and	  al, 7Fh
f000:EDFD		  out	  dx, al			      ;	PC/XT PPI port B bits:
f000:EDFD							      ;	0: Tmr 2 gate ÍËÍ OR 03H=spkr ON
f000:EDFD							      ;	1: Tmr 2 data Í¼  AND 0fcH=spkr	OFF
f000:EDFD							      ;	3: 1=read high switches
f000:EDFD							      ;	4: 0=enable RAM	parity checking
f000:EDFD							      ;	5: 0=enable I/O	channel	check
f000:EDFD							      ;	6: 0=hold keyboard clock low
f000:EDFD							      ;	7: 0=enable kbrd
f000:EDFE		  mov	  al, 20h ; ' '
f000:EE00		  mov	  dx, 20h ; ' '
f000:EE03		  out	  dx, al			      ;	Interrupt controller, 8259A.
f000:EE04		  retn
f000:EE04 kbd_reset_and_ack_int	endp
f000:EE04
f000:EE04 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EE05 byte_FEE05	  db 1Bh, 31h, 32h, 33h, 34h, 35h, 36h,	37h, 38h, 39h, 30h, 2Dh, 3Dh, 8, 9, 71h, 77h, 65h
f000:EE05							      ;	DATA XREF: int_09:l15o
f000:EE05							      ;	int_09+CFo
f000:EE05		  db 72h, 74h, 79h, 75h, 69h, 6Fh, 70h,	5Bh, 5Dh, 0Dh, 0FEh, 61h, 73h, 64h, 66h, 67h, 68h
f000:EE05		  db 6Ah, 6Bh, 6Ch, 3Bh, 27h, 48h, 0FEh, 4Bh, 7Ah, 78h,	63h, 76h, 62h, 6Eh, 6Dh, 2Ch, 2Eh
f000:EE05		  db 2Fh, 0FEh,	10h, 0FEh, 20h,	0FEh, 3Bh, 3Ch,	3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h, 44h
f000:EE05		  db 0FEh, 0FEh
f000:EE4B byte_FEE4B	  db 1Bh, 21h, 40h, 23h, 24h, 25h, 5Eh,	26h, 2Ah, 28h, 29h, 5Fh, 2Bh, 8, 0Fh, 51h, 57h
f000:EE4B							      ;	DATA XREF: int_09:l16o
f000:EE4B							      ;	int_09+C9o
f000:EE4B							      ;	int_09:l18o
f000:EE4B		  db 45h, 52h, 54h, 59h, 55h, 49h, 4Fh,	50h, 7Bh, 7Dh, 0Dh, 0FFh, 41h, 53h, 44h, 46h, 47h
f000:EE4B		  db 48h, 4Ah, 4Bh, 4Ch, 3Ah, 22h, 85h,	0FFh, 87h, 5Ah,	58h, 43h, 56h, 42h, 4Eh, 4Dh, 3Ch
f000:EE4B		  db 3Eh, 3Fh, 0FFh, 0FEh, 0FFh, 20h, 0FFh, 54h, 55h, 56h, 57h,	58h, 59h, 5Ah, 5Bh, 5Ch
f000:EE4B		  db 5Dh, 0FFh,	0FEh
f000:EE91 byte_FEE91	  db 1Bh, 0E1h,	3, 0E3h, 0E4h, 0E5h, 1Eh, 0E7h,	0E8h, 0E9h, 0E0h, 1Fh, 0F5h, 7Fh, 8Dh
f000:EE91							      ;	DATA XREF: int_09+E9o
f000:EE91		  db 11h, 17h, 5, 12h, 14h, 19h, 15h, 9, 0Fh, 10h, 1Bh,	1Dh, 0Ah, 0FFh,	1, 13h,	4, 6, 7
f000:EE91		  db 8,	0Ah, 0Bh, 0Ch, 0F6h, 0F7h, 90h,	0FFh, 73h, 1Ah,	18h, 3,	16h, 2,	0Eh, 0Dh, 0F9h
f000:EE91		  db 0FAh, 0FBh, 0FFh, 72h, 0FFh, 20h, 0FFh, 5Eh, 5Fh, 60h, 61h, 62h, 63h, 64h,	65h, 66h
f000:EE91		  db 67h, 0FFh,	0FEh
f000:EED7 byte_FEED7	  db 8Bh, 78h, 79h, 7Ah, 7Bh, 7Ch, 7Dh,	7Eh, 7Fh, 80h, 81h, 82h, 83h, 8Ch, 8Eh,	10h, 11h
f000:EED7							      ;	DATA XREF: int_09+DEo
f000:EED7		  db 12h, 13h, 14h, 15h, 16h, 17h, 18h,	19h, 0EBh, 0F0h, 8Fh, 0FFh, 1Eh, 1Fh, 20h, 21h
f000:EED7		  db 22h, 23h, 24h, 25h, 26h, 0F8h, 0F1h, 91h, 0FFh, 92h, 2Ch, 2Dh, 2Eh, 2Fh, 30h, 31h
f000:EED7		  db 32h, 89h, 8Ah, 0F2h, 0FFh,	46h, 0FFh, 20h,	0FFh, 68h, 69h,	6Ah, 6Bh, 6Ch, 6Dh, 6Eh
f000:EED7		  db 6Fh, 70h, 71h, 0FFh, 0FEh
f000:EF1D byte_FEF1D	  db 37h, 38h, 39h, 50h, 34h, 35h, 36h,	4Dh, 31h, 32h, 33h, 30h, 2Dh, 0, 2Bh, 2Eh, 0Dh
f000:EF1D							      ;	DATA XREF: int_09+303o
f000:EF1D							      ;	int_09:l77o
f000:EF1D							      ;	int_09:l79o
f000:EF1D		  db 47h, 98h, 99h, 5Eh, 3Eh, 40h, 5Bh,	5Dh
f000:EF36 byte_FEF36	  db 5Ch, 7Eh, 49h, 86h, 7Ch, 0F3h, 0F4h, 88h, 4Fh, 60h, 51h, 9Bh, 53h,	0, 52h,	0A1h, 0Dh
f000:EF36							      ;	DATA XREF: int_09:l74o
f000:EF36		  db 4Ah, 0A2h,	0A3h, 5Eh, 3Ch,	23h, 7Bh, 7Dh
f000:EF4F byte_FEF4F	  db 93h, 94h, 84h, 96h, 95h, 0FCh, 0FDh, 74h, 75h, 9Ah, 76h, 9Ch, 9Dh,	0, 9Fh,	0A4h, 0Ah
f000:EF4F							      ;	DATA XREF: int_09:l62o
f000:EF4F		  db 77h, 0ACh,	0ADh, 0A7h, 0A8h, 0A9h,	0AAh, 0ABh
f000:EF68 byte_FEF68	  db 0FEh, 0FEh, 0FEh, 97h, 0FEh, 0FEh,	0FEh, 0EAh, 0FEh, 0FEh,	0FEh, 0FEh, 9Eh, 0FEh
f000:EF68							      ;	DATA XREF: int_09:l69o
f000:EF68		  db 0A0h, 0A5h, 8Fh, 0A6h, 0B6h, 0B7h,	0AEh, 0AFh, 45h, 4Ch, 4Eh, 0DEh, 0ADh, 0DEh, 0ADh
f000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
f000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
f000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
f000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
f000:EF68		  db 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh, 0DEh, 0ADh
f000:EFC7
f000:EFC7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:EFC7
f000:EFC7
f000:EFC7 int_1e	  proc far				      ;	DATA XREF: f000:FF1Fo
f000:EFC7		  iret
f000:EFC7 int_1e	  endp
f000:EFC7
f000:EFC7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EFC8		  db	2
f000:EFC9		  db  25h ; %
f000:EFCA		  db	2
f000:EFCB		  db	9
f000:EFCC		  db  2Ah ; *
f000:EFCD		  db 0FFh
f000:EFCE		  db  50h ; P
f000:EFCF		  db 0F6h ; ö
f000:EFD0		  db  19h
f000:EFD1		  db	4
f000:EFD2
f000:EFD2 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:EFD2
f000:EFD2
f000:EFD2 int_17	  proc far				      ;	DATA XREF: f000:FF11o
f000:EFD2		  call	  int_push_regs
f000:EFD5		  mov	  di, 6
f000:EFD8		  nop
f000:EFD9		  call	  check_valid_subfunction
f000:EFDC		  jb	  short	exit0
f000:EFDE		  mov	  bx, dx
f000:EFE0		  xor	  cx, cx
f000:EFE2		  mov	  cl, [bx+p400.lpt0_timeout]
f000:EFE6		  shl	  bx, 1
f000:EFE8		  mov	  dx, [bx+p400.lpt0_base_addr]
f000:EFEC		  or	  dx, dx
f000:EFEE		  jz	  short	exit1
f000:EFF0		  jmp	  word ptr cs:int_17_jmp_tbl[di]
f000:EFF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EFF5 int_17_jmp_tbl:					      ;	DATA XREF: int_17+1Er
f000:EFF5		  dw offset int_17_00
f000:EFF7		  dw offset int_17_01
f000:EFF9		  dw offset int_17_02
f000:EFFB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EFFB
f000:EFFB exit0:						      ;	CODE XREF: int_17+Aj
f000:EFFB		  jmp	  short	exit1
f000:EFFD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:EFFD
f000:EFFD int_17_00:						      ;	CODE XREF: int_17+1Ej
f000:EFFD							      ;	DATA XREF: int_17:int_17_jmp_tblo
f000:EFFD		  mov	  ah, al
f000:EFFF		  xor	  bx, bx
f000:F001		  inc	  dx
f000:F002
f000:F002 l0:							      ;	CODE XREF: int_17+46j
f000:F002							      ;	int_17+48j
f000:F002		  in	  al, dx
f000:F003		  test	  al, 80h
f000:F005		  jz	  short	l1
f000:F007		  mov	  al, ah
f000:F009		  dec	  dx
f000:F00A		  out	  dx, al
f000:F00B		  inc	  dx
f000:F00C		  inc	  dx
f000:F00D		  mov	  al, 0Dh
f000:F00F		  out	  dx, al
f000:F010		  mov	  al, 0Ch
f000:F012		  out	  dx, al
f000:F013		  mov	  cl, ah
f000:F015		  jmp	  short	l3
f000:F017 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F017
f000:F017 l1:							      ;	CODE XREF: int_17+33j
f000:F017		  dec	  bx
f000:F018		  jnz	  short	l0
f000:F01A		  loop	  l0
f000:F01C		  mov	  ch, 1
f000:F01E		  mov	  cl, ah
f000:F020		  jmp	  short	l4
f000:F022 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F022
f000:F022 int_17_01:						      ;	CODE XREF: int_17+1Ej
f000:F022							      ;	DATA XREF: int_17+25o
f000:F022		  mov	  cl, al
f000:F024		  inc	  dx
f000:F025		  inc	  dx
f000:F026		  mov	  al, 8
f000:F028		  out	  dx, al
f000:F029		  push	  cx
f000:F02A		  mov	  cx, 32h ; '2'
f000:F02D
f000:F02D l2:							      ;	CODE XREF: int_17:l2j
f000:F02D		  loop	  l2
f000:F02F		  pop	  cx
f000:F030		  mov	  al, 0Ch
f000:F032		  out	  dx, al
f000:F033
f000:F033 l3:							      ;	CODE XREF: int_17+43j
f000:F033		  dec	  dx
f000:F034		  xor	  ch, ch
f000:F036		  jmp	  short	l4
f000:F038 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F038
f000:F038 int_17_02:						      ;	CODE XREF: int_17+1Ej
f000:F038							      ;	DATA XREF: int_17+27o
f000:F038		  mov	  cl, al
f000:F03A		  inc	  dx
f000:F03B
f000:F03B l4:							      ;	CODE XREF: int_17+4Ej
f000:F03B							      ;	int_17+64j
f000:F03B		  in	  al, dx
f000:F03C		  and	  al, 0F8h
f000:F03E		  xor	  al, 48h
f000:F040		  mov	  ah, al
f000:F042		  or	  ah, ch
f000:F044		  mov	  al, cl
f000:F046
f000:F046 exit1:						      ;	CODE XREF: int_17+1Cj
f000:F046							      ;	int_17:exit0j
f000:F046		  jmp	  near ptr int_pop_regs_and_exit
f000:F046 int_17	  endp
f000:F046
f000:F046 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F049		  db 1Ch dup(0)
f000:F065
f000:F065 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F065
f000:F065
f000:F065 int_10	  proc far				      ;	DATA XREF: f000:FF03o
f000:F065		  call	  int_push_regs
f000:F068		  cld
f000:F069		  mov	  di, 22h ; '"'                       ; max sub-functions / 2
f000:F06C		  nop
f000:F06D		  call	  check_valid_subfunction
f000:F070		  jb	  short	error
f000:F072		  jmp	  cs:int_10_jmp_tbl[di]
f000:F072 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F077 int_10_jmp_tbl  dw offset int_10_00			      ;	DATA XREF: int_10+Dr
f000:F079		  dw offset int_10_01
f000:F07B		  dw offset int_10_02
f000:F07D		  dw offset int_10_03
f000:F07F		  dw offset int_10_04
f000:F081		  dw offset int_10_05
f000:F083		  dw offset int_10_06
f000:F085		  dw offset int_10_07
f000:F087		  dw offset int_10_08
f000:F089		  dw offset int_10_09
f000:F08B		  dw offset int_10_0a
f000:F08D		  dw offset int_10_0b
f000:F08F		  dw offset int_10_0c
f000:F091		  dw offset int_10_0d
f000:F093		  dw offset int_10_0e
f000:F095		  dw offset int_10_0f
f000:F097		  dw offset int_10_10
f000:F099 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F099
f000:F099 error:						      ;	CODE XREF: int_10+Bj
f000:F099		  jmp	  near ptr int_pop_regs_and_exit
f000:F099 int_10	  endp
f000:F099
f000:F099 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F09C		  db 8 dup(0)
f000:F0A4 int_1d_tv	  db 38h, 28h, 2Ch, 8, 1Fh, 6, 19h, 1Ch, 2, 7, 6, 7, 4 dup(0); init_modes_0_1
f000:F0A4							      ;	DATA XREF: reset+29Bo
f000:F0A4		  db 71h, 50h, 58h, 10h, 1Fh, 6, 19h, 1Ch, 2, 7, 6, 7, 4 dup(0); init_modes_2_3
f000:F0A4		  db 38h, 28h, 2Ch, 8, 7Fh, 6, 64h, 70h, 2, 1, 6, 7, 4 dup(0); init_modes_4_5_6_8
f000:F0A4		  db 61h, 50h, 52h, 0Fh, 19h, 6, 2 dup(19h), 2,	0Dh, 0Bh, 0Ch, 4 dup(0); init_mode_7
f000:F0A4		  db 71h, 50h, 58h, 10h, 3Fh, 6, 32h, 38h, 2, 3, 6, 7, 4 dup(0); init_modes_9_a
f000:F0F4 video_init_vars video_init_some_vars <0, 101100b, 28h, 8>   ;	DATA XREF: int_10_00+3Ar
f000:F0F4							      ;	int_10_00+3Fr
f000:F0F4							      ;	int_10_00+46r
f000:F0F4							      ;	int_10_00+50r
f000:F0F4							      ;	video mode 0
f000:F0F8		  video_init_some_vars <0, 101000b, 28h, 8>   ;	video mode 1
f000:F0FC		  video_init_some_vars <10h, 101101b, 50h, 10h>	; video	mode 2
f000:F100		  video_init_some_vars <10h, 101001b, 50h, 10h>	; video	mode 3
f000:F104		  video_init_some_vars <20h, 101010b, 28h, 40h>	; video	mode 4
f000:F108		  video_init_some_vars <20h, 101110b, 28h, 40h>	; video	mode 5
f000:F10C		  video_init_some_vars <20h, 11110b, 50h, 40h> ; video mode 6
f000:F110		  video_init_some_vars <30h, 101001b, 50h, 40h>	; video	mode 7
f000:F114		  video_init_some_vars <20h, 101010b, 14h, 40h>	; video	mode 8
f000:F118		  video_init_some_vars <40h, 101011b, 28h, 80h>	; video	mode 9
f000:F11C		  video_init_some_vars <40h, 111011b, 50h, 80h>	; video	mode a
f000:F120
f000:F120 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F120
f000:F120 ;	Sets the video mode.
f000:F120 ;
f000:F120 ;	   On entry:	  AH	     00h
f000:F120 ;			  AL	     Video mode
f000:F120 ;
f000:F120 ;	   Returns:	  None
f000:F120 ;
f000:F120 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F120 ;
f000:F120 ;   --------------------------------------------------------------------------
f000:F120 ;			     Table of Video Modes
f000:F120 ;									Buffer
f000:F120 ;   Mode     Type	   Resolution	   Adapter(s)	   Colors	Address
f000:F120 ;   00h     Text	    40 x 25	 All but MDA	   16 gray	 B8000
f000:F120 ;   01h     Text	    40 x 25	 All but MDA   16 fore/8 back	 B8000
f000:F120 ;   02h     Text	    80 x 25	 All but MDA	   16 gray	 B8000
f000:F120 ;   03h     Text	    80 x 25	 All but MDA   16 fore/8 back	 B8000
f000:F120 ;   04h   Graphics	   320 x 200	 All but MDA	     4		 B8000
f000:F120 ;   05h   Graphics	   320 x 200	 All but MDA	   4 gray	 B8000
f000:F120 ;   06h   Graphics	   640 x 200	 All but MDA	     2		 B8000
f000:F120 ;   07h     Text	    80 x 25	   MDA,EGA	    b/w		 B0000
f000:F120 ;   08h   Graphics	   160 x 200	    PCjr	    16		 B0000
f000:F120 ;   09h   Graphics	   320 x 200	    PCjr	    16		 B0000
f000:F120 ;   0Ah   Graphics	   640 x 200	    PCjr	     4		 B0000
f000:F120 ;   --------------------------------------------------------------------------
f000:F120
f000:F120 int_10_00	  proc far				      ;	CODE XREF: int_10+Dj
f000:F120							      ;	DATA XREF: int_10:int_10_jmp_tblo
f000:F120		  push	  ax
f000:F121		  and	  al, 7Fh
f000:F123		  mov	  bx, ds:p400.installed_hardware
f000:F127		  and	  bl, 110000b			      ;	filters	video bits
f000:F12A		  cmp	  bl, 110000b			      ;	is 80x25 mono?
f000:F12D		  jnz	  short	not_mono		      ;	not mono
f000:F12F		  mov	  al, 7				      ;	if 80x25 mono, mode should be 7
f000:F131
f000:F131 not_mono:						      ;	CODE XREF: int_10_00+Dj
f000:F131		  cmp	  al, 7				      ;	is mode	7?
f000:F133		  jz	  short	error			      ;	yes, error
f000:F135		  cmp	  al, 0Ah			      ;	is mode	0xa or below?
f000:F137		  jbe	  short	ok			      ;	yes, ok
f000:F139
f000:F139 error:						      ;	CODE XREF: int_10_00+13j
f000:F139		  pop	  ax
f000:F13A		  jmp	  near ptr int_pop_regs_and_exit
f000:F13D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F13D
f000:F13D ok:							      ;	CODE XREF: int_10_00+17j
f000:F13D		  mov	  ds:p400.crt_mode, al		      ;	update video mode in shadow var
f000:F140		  xor	  ah, ah
f000:F142		  mov	  dx, 3D4h			      ;	6845 address register
f000:F145		  cmp	  al, 7				      ;	is video mode 7? (impossible, since it was filtered out	before)
f000:F147		  jnz	  short	skip			      ;	no, jump to color
f000:F149		  mov	  ah, 21h ; '!'
f000:F14B		  mov	  dx, 3B4h			      ;	use MDA	address
f000:F14E
f000:F14E skip:							      ;	CODE XREF: int_10_00+27j
f000:F14E		  push	  ax
f000:F14F		  push	  dx
f000:F150		  xor	  ah, ah
f000:F152		  shl	  al, 1
f000:F154		  shl	  al, 1				      ;	al * 4 (video mode * 4)
f000:F156		  mov	  si, ax
f000:F158		  xor	  bx, bx
f000:F15A		  mov	  bl, byte ptr cs:video_init_vars.offset_to_6845_tbl[si]
f000:F15F		  mov	  cl, cs:video_init_vars.value_for_3d8[si]
f000:F164		  xor	  ax, ax
f000:F166		  mov	  al, cs:video_init_vars.nr_columns[si]
f000:F16B		  mov	  ds:p400.crt_nr_cols, ax
f000:F16E		  xor	  ax, ax
f000:F170		  mov	  ah, cs:video_init_vars.video_page_size_256[si]
f000:F175		  mov	  ds:p400.crt_page_len,	ax
f000:F178		  pop	  dx
f000:F179		  pop	  ax
f000:F17A		  mov	  ds:p400.crt_mode_set,	cl
f000:F17E		  mov	  ds:p400.addr_6845, dx
f000:F182		  add	  dx, 4
f000:F185		  mov	  al, ah
f000:F187		  out	  dx, al
f000:F188		  xor	  ax, ax
f000:F18A		  mov	  es, ax			      ;	es = 0
f000:F18C		  push	  dx
f000:F18D		  mov	  al, 3Fh ; '?'
f000:F18F		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:F194		  jb	  short	loc_FF198
f000:F196		  mov	  al, 0F6h ; 'ö'
f000:F198
f000:F198 loc_FF198:						      ;	CODE XREF: int_10_00+74j
f000:F198		  mov	  dx, 3DFh
f000:F19B		  out	  dx, al
f000:F19C		  mov	  ds:p400.video_page_data, al
f000:F19F		  mov	  si, 74h ; 't'                       ; int 0x1d (video param table)
f000:F1A2		  mov	  di, es:[si]			      ;	video param table offset
f000:F1A5		  add	  di, bx
f000:F1A7		  mov	  ax, es:[si+2]			      ;	video param table segment
f000:F1AB		  mov	  es, ax			      ;	es = segment for video param table
f000:F1AD		  xor	  bh, bh
f000:F1AF		  xor	  cx, cx
f000:F1B1
f000:F1B1 loc_FF1B1:						      ;	CODE XREF: int_10_00+A3j
f000:F1B1		  mov	  dx, ds:p400.addr_6845
f000:F1B5		  mov	  al, cl			      ;	update CRT register
f000:F1B7		  out	  dx, al
f000:F1B8		  inc	  dx
f000:F1B9		  mov	  bl, cl
f000:F1BB		  mov	  al, es:[bx+di]
f000:F1BE		  out	  dx, al			      ;	update CRT data
f000:F1BF		  inc	  cx
f000:F1C0		  cmp	  cx, 10h
f000:F1C3		  jl	  short	loc_FF1B1
f000:F1C5		  mov	  word ptr ds:p400.cursor_row_column, 607h
f000:F1CB		  mov	  word ptr ds:p400.crt_current_page_offset, 0
f000:F1D1		  mov	  byte ptr ds:p400.active_display_page,	0
f000:F1D6		  mov	  byte ptr ds:p400.shadow_3d9_crt_palette, 30h ; '0'
f000:F1DB		  pop	  dx
f000:F1DC		  pop	  ax
f000:F1DD		  push	  dx
f000:F1DE		  test	  al, 80h			      ;	clean screen?
f000:F1E0		  jnz	  short	skip_clean_screen	      ;	no, skip cleaning the screen
f000:F1E2		  mov	  ax, 0B800h
f000:F1E5		  mov	  cx, 2000h			      ;	8k words (16k bytes) to	clean by default
f000:F1E8		  cmp	  byte ptr ds:p400.crt_mode, 9	      ;	video is below 9?
f000:F1ED		  jb	  short	l0			      ;	yes, keep previous value
f000:F1EF		  mov	  cx, 4000h			      ;	16k words (32k bytes) for videos 9 and a
f000:F1F2
f000:F1F2 l0:							      ;	CODE XREF: int_10_00+CDj
f000:F1F2		  mov	  bx, 720h			      ;	for text modes,	clean it with space and	white attrib
f000:F1F5		  cmp	  byte ptr ds:p400.crt_mode, 7	      ;	video mode 7? (impossible)
f000:F1FA		  jnz	  short	l1			      ;	no, jump
f000:F1FC		  mov	  ax, 0B000h			      ;	use segment 0xb000 for mono
f000:F1FF		  mov	  cx, 800h			      ;	and only clean 2k words	(4k bytes)
f000:F202		  jmp	  short	l2
f000:F204 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F204
f000:F204 l1:							      ;	CODE XREF: int_10_00+DAj
f000:F204		  cmp	  byte ptr ds:p400.crt_mode, 4	      ;	video mode 4?
f000:F209		  jl	  short	l2			      ;	less than 4, then jump
f000:F20B		  xor	  bx, bx			      ;	for graphics mode, clean it with black screen (0x0000)
f000:F20D
f000:F20D l2:							      ;	CODE XREF: int_10_00+E2j
f000:F20D							      ;	int_10_00+E9j
f000:F20D		  mov	  es, ax			      ;	update video segment
f000:F20F		  xor	  di, di			      ;	di: offset is 0
f000:F211		  mov	  ax, bx			      ;	value to store
f000:F213		  rep stosw				      ;	clean screen
f000:F215
f000:F215 skip_clean_screen:					      ;	CODE XREF: int_10_00+C0j
f000:F215		  mov	  ax, ds
f000:F217		  mov	  es, ax			      ;	es = ds
f000:F219		  xor	  ax, ax
f000:F21B		  lea	  di, ds:p400.cursor_row_col_in_pages
f000:F21F		  mov	  cx, 8				      ;	8 pages
f000:F222		  rep stosw				      ;	clean col/row cursor values for	all 8 pages
f000:F224		  cmp	  byte ptr ds:p400.crt_mode, 7
f000:F229		  jz	  short	loc_FF246
f000:F22B		  mov	  al, 30h ; '0'
f000:F22D		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:F232		  jl	  short	loc_FF23F
f000:F234		  mov	  al, 3Fh ; '?'
f000:F236		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F23B		  jnz	  short	loc_FF23F
f000:F23D		  mov	  al, 0
f000:F23F
f000:F23F loc_FF23F:						      ;	CODE XREF: int_10_00+112j
f000:F23F							      ;	int_10_00+11Bj
f000:F23F		  mov	  dx, 3D9h
f000:F242		  out	  dx, al
f000:F243		  mov	  ds:p400.shadow_3d9_crt_palette, al
f000:F246
f000:F246 loc_FF246:						      ;	CODE XREF: int_10_00+109j
f000:F246		  mov	  bl, 10h
f000:F248		  mov	  cx, 10h
f000:F24B		  mov	  dx, 3DAh
f000:F24E		  xor	  ah, ah
f000:F250
f000:F250 loc_FF250:						      ;	CODE XREF: int_10_00+140j
f000:F250		  mov	  al, bl
f000:F252		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F252							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F253		  add	  dx, 4
f000:F256		  mov	  al, ah
f000:F258		  out	  dx, al
f000:F259		  inc	  bl
f000:F25B		  inc	  ah
f000:F25D		  sub	  dx, 4
f000:F260		  loop	  loc_FF250
f000:F262		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F267		  jnz	  short	loc_FF28D
f000:F269		  mov	  al, 11h
f000:F26B		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F26B							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F26C		  mov	  al, 3
f000:F26E		  add	  dx, 4
f000:F271		  out	  dx, al
f000:F272		  sub	  dx, 4
f000:F275		  mov	  al, 12h
f000:F277		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F277							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F278		  mov	  al, 5
f000:F27A		  add	  dx, 4
f000:F27D		  out	  dx, al
f000:F27E		  sub	  dx, 4
f000:F281		  mov	  al, 13h
f000:F283		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F283							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F284		  mov	  al, 0Fh
f000:F286		  add	  dx, 4
f000:F289		  out	  dx, al
f000:F28A		  sub	  dx, 4
f000:F28D
f000:F28D loc_FF28D:						      ;	CODE XREF: int_10_00+147j
f000:F28D		  mov	  al, 1
f000:F28F		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F28F							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F290		  add	  dx, 4
f000:F293		  mov	  al, 0Fh
f000:F295		  out	  dx, al
f000:F296		  sub	  dx, 4
f000:F299		  mov	  al, 2
f000:F29B		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F29B							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F29C		  add	  dx, 4
f000:F29F		  xor	  al, al
f000:F2A1		  out	  dx, al
f000:F2A2		  sub	  dx, 4
f000:F2A5		  mov	  al, 3
f000:F2A7		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F2A7							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F2A8		  add	  dx, 4
f000:F2AB		  mov	  al, 0
f000:F2AD		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:F2B2		  jle	  short	loc_FF2C2
f000:F2B4		  mov	  al, 4
f000:F2B6		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:F2BB		  jnz	  short	loc_FF2C2
f000:F2BD		  mov	  al, 14h
f000:F2BF		  jmp	  short	loc_FF2D7
f000:F2BF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F2C1		  db  90h ; 
f000:F2C2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F2C2
f000:F2C2 loc_FF2C2:						      ;	CODE XREF: int_10_00+192j
f000:F2C2							      ;	int_10_00+19Bj
f000:F2C2		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:F2C7		  jnz	  short	loc_FF2CE
f000:F2C9		  mov	  al, 14h
f000:F2CB		  jmp	  short	loc_FF2D7
f000:F2CB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F2CD		  db  90h ; 
f000:F2CE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F2CE
f000:F2CE loc_FF2CE:						      ;	CODE XREF: int_10_00+1A7j
f000:F2CE		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F2D3		  jnz	  short	loc_FF2D7
f000:F2D5		  mov	  al, 0Ch
f000:F2D7
f000:F2D7 loc_FF2D7:						      ;	CODE XREF: int_10_00+19Fj
f000:F2D7							      ;	int_10_00+1ABj
f000:F2D7							      ;	int_10_00+1B3j
f000:F2D7		  out	  dx, al
f000:F2D8		  mov	  dx, 3DAh
f000:F2DB		  xor	  al, al
f000:F2DD		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F2DD							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F2DE		  pop	  dx
f000:F2DF		  mov	  al, ds:p400.crt_mode_set
f000:F2E2		  out	  dx, al
f000:F2E3		  jmp	  near ptr int_pop_regs_and_exit
f000:F2E3 int_10_00	  endp
f000:F2E3
f000:F2E6
f000:F2E6 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F2E6
f000:F2E6 ;	Adjusts	the size of the	cursor by setting its start and	end lines.
f000:F2E6 ;
f000:F2E6 ;	   On entry:	  AH	     01h
f000:F2E6 ;			  CH	     Cursor start line (bits 4 to 0)
f000:F2E6 ;			  CL	     Cursor end	line   (bits 4 to 0)
f000:F2E6 ;
f000:F2E6 ;	   Returns:	  None
f000:F2E6 ;
f000:F2E6 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F2E6 ;
f000:F2E6
f000:F2E6 int_10_01	  proc far				      ;	CODE XREF: int_10+Dj
f000:F2E6							      ;	DATA XREF: int_10+14o
f000:F2E6		  mov	  bh, 0Ah
f000:F2E8		  mov	  bl, 0Bh
f000:F2EA		  call	  sub_FF92B
f000:F2ED		  mov	  ds:p400.cursor_row_column, cx
f000:F2F1		  jmp	  near ptr int_pop_regs_and_exit
f000:F2F1 int_10_01	  endp
f000:F2F1
f000:F2F4
f000:F2F4 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F2F4
f000:F2F4 ;	Sets the cursor	position (row and column) for a	specified display
f000:F2F4 ;	page.
f000:F2F4 ;
f000:F2F4 ;	   On entry:	  AH	     02h
f000:F2F4 ;			  BH	     Display page number
f000:F2F4 ;			  DH	     Row
f000:F2F4 ;			  DL	     Column
f000:F2F4 ;
f000:F2F4 ;	   Returns:	  None
f000:F2F4 ;
f000:F2F4 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F2F4 ;
f000:F2F4
f000:F2F4 int_10_02	  proc far				      ;	CODE XREF: int_10+Dj
f000:F2F4							      ;	DATA XREF: int_10+16o
f000:F2F4		  call	  sub_FF2FA
f000:F2F7		  jmp	  near ptr int_pop_regs_and_exit
f000:F2F7 int_10_02	  endp
f000:F2F7
f000:F2FA
f000:F2FA ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F2FA
f000:F2FA
f000:F2FA sub_FF2FA	  proc near				      ;	CODE XREF: int_10_02p
f000:F2FA							      ;	int_10_0e+8Ap
f000:F2FA							      ;	int_10_0e+99p
f000:F2FA		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:F2FF		  jl	  short	loc_FF303
f000:F301		  xor	  bh, bh
f000:F303
f000:F303 loc_FF303:						      ;	CODE XREF: sub_FF2FA+5j
f000:F303		  lea	  di, ds:p400.cursor_row_col_in_pages
f000:F307		  push	  bx
f000:F308		  mov	  bl, bh
f000:F30A		  xor	  bh, bh
f000:F30C		  shl	  bx, 1
f000:F30E		  mov	  [bx+di], dx
f000:F310		  pop	  bx
f000:F311		  cmp	  ds:p400.active_display_page, bh
f000:F315		  jnz	  short	locret_FF31A
f000:F317		  call	  sub_FF31B
f000:F31A
f000:F31A locret_FF31A:						      ;	CODE XREF: sub_FF2FA+1Bj
f000:F31A		  retn
f000:F31A sub_FF2FA	  endp
f000:F31A
f000:F31B
f000:F31B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F31B
f000:F31B
f000:F31B sub_FF31B	  proc near				      ;	CODE XREF: sub_FF2FA+1Dp
f000:F31B							      ;	int_10_05+31p
f000:F31B		  mov	  al, dh
f000:F31D		  mul	  byte ptr ds:p400.crt_nr_cols
f000:F321		  xor	  dh, dh
f000:F323		  add	  ax, dx
f000:F325		  mov	  cx, ax
f000:F327		  mov	  ax, ds:p400.crt_current_page_offset
f000:F32A		  shr	  ax, 1
f000:F32C		  add	  cx, ax
f000:F32E		  mov	  bh, 0Eh
f000:F330		  mov	  bl, 0Fh
f000:F332		  jmp	  sub_FF92B
f000:F332 sub_FF31B	  endp
f000:F332
f000:F335
f000:F335 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F335
f000:F335 ;	Reports	the cursor position (row and column) and size for a specified
f000:F335 ;	display	page.
f000:F335 ;
f000:F335 ;	   On entry:	  AH	     03h
f000:F335 ;			  BH	     Display page number
f000:F335 ;
f000:F335 ;	   Returns:	  CH	     Cursor start line
f000:F335 ;			  CL	     Cursor end	line
f000:F335 ;			  DH	     Row
f000:F335 ;			  DL	     Column
f000:F335 ;
f000:F335 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F335 ; Attributes:	bp-based frame
f000:F335
f000:F335 int_10_03	  proc far				      ;	CODE XREF: int_10+Dj
f000:F335							      ;	DATA XREF: int_10+18o
f000:F335
f000:F335 arg_6		  = word ptr  0Ah
f000:F335 arg_8		  = word ptr  0Ch
f000:F335
f000:F335		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:F33A		  jl	  short	loc_FF33E
f000:F33C		  xor	  bh, bh
f000:F33E
f000:F33E loc_FF33E:						      ;	CODE XREF: int_10_03+5j
f000:F33E		  mov	  bl, bh
f000:F340		  call	  get_rowcols_for_page
f000:F343		  mov	  bp, sp
f000:F345		  mov	  [bp+arg_6], dx
f000:F348		  mov	  cx, ds:p400.cursor_row_column
f000:F34C		  mov	  [bp+arg_8], cx
f000:F34F		  jmp	  near ptr int_pop_regs_and_exit
f000:F34F int_10_03	  endp
f000:F34F
f000:F352
f000:F352 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F352
f000:F352 ;	Reports	the position and status	of the light pen.
f000:F352 ;
f000:F352 ;	   On entry:	  AH	     04h
f000:F352 ;
f000:F352 ;	   Returns:	  AH	     Status (0=not triggered, 1=triggered)
f000:F352 ;			  BX	     Pixel column number (0-639)
f000:F352 ;			  CH	     Pixel line	number (0-199)
f000:F352 ;			  CX	     Pixel line	number for modes 0Fh-10h (0-nnn)
f000:F352 ;			  DH	     Character row number (0-24)
f000:F352 ;			  DL	     Character column number (0-39 or 0-79)
f000:F352 ;
f000:F352 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F352
f000:F352 int_10_04	  proc far				      ;	CODE XREF: int_10+Dj
f000:F352							      ;	DATA XREF: int_10+1Ao
f000:F352		  mov	  dx, 3DAh
f000:F355		  in	  al, dx			      ;	Video status bits:
f000:F355							      ;	0: retrace.  1=display is in vert or horiz retrace.
f000:F355							      ;	1: 1=light pen is triggered; 0=armed
f000:F355							      ;	2: 1=light pen switch is open; 0=closed
f000:F355							      ;	3: 1=vertical sync pulse is occurring.
f000:F356		  mov	  ah, 0
f000:F358		  test	  al, 2
f000:F35A		  jnz	  short	loc_FF35F
f000:F35C		  jmp	  loc_FF447
f000:F35F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F35F
f000:F35F loc_FF35F:						      ;	CODE XREF: int_10_04+8j
f000:F35F		  mov	  dx, ds:p400.addr_6845
f000:F363		  mov	  al, 10h
f000:F365		  out	  dx, al
f000:F366		  inc	  dx
f000:F367		  in	  al, dx
f000:F368		  mov	  bh, al
f000:F36A		  dec	  dx
f000:F36B		  mov	  al, 11h
f000:F36D		  out	  dx, al
f000:F36E		  inc	  dx
f000:F36F		  in	  al, dx
f000:F370		  mov	  ah, bh
f000:F372		  sub	  ax, 4
f000:F375		  mov	  dx, 3DBh
f000:F378		  out	  dx, al			      ;	Video: light pen latch reset.
f000:F378							      ;	Any OUT	clears the latch.
f000:F379		  mov	  bp, sp
f000:F37B		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:F380		  jnb	  short	loc_FF3A2
f000:F382		  xor	  dx, dx
f000:F384		  mov	  bx, ds:p400.crt_nr_cols
f000:F388		  div	  bx
f000:F38A		  mov	  dh, al
f000:F38C		  mov	  [bp+0Ah], dx
f000:F38F		  mov	  cl, 3
f000:F391		  shl	  al, cl
f000:F393		  mov	  [bp+0Dh], al
f000:F396		  xor	  bx, bx
f000:F398		  mov	  bl, dl
f000:F39A		  shl	  bx, cl
f000:F39C		  mov	  [bp+0Eh], bx
f000:F39F		  jmp	  loc_FF445
f000:F3A2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F3A2
f000:F3A2 loc_FF3A2:						      ;	CODE XREF: int_10_04+2Ej
f000:F3A2		  xor	  dx, dx
f000:F3A4		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:F3A9		  jnb	  short	loc_FF3DC
f000:F3AB		  add	  ax, 2
f000:F3AE		  cmp	  ax, 1000h
f000:F3B1		  jb	  short	loc_FF3B6
f000:F3B3		  sub	  ax, 0FD8h
f000:F3B6
f000:F3B6 loc_FF3B6:						      ;	CODE XREF: int_10_04+5Fj
f000:F3B6		  mov	  bx, 28h ; '('
f000:F3B9		  div	  bx
f000:F3BB		  shl	  ax, 1
f000:F3BD		  mov	  [bp+0Dh], al
f000:F3C0		  shl	  dx, 1
f000:F3C2		  shl	  dx, 1
f000:F3C4		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:F3C9		  jz	  short	loc_FF3D6
f000:F3CB		  shl	  dx, 1
f000:F3CD		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:F3D2		  jnz	  short	loc_FF3D6
f000:F3D4		  shl	  dx, 1
f000:F3D6
f000:F3D6 loc_FF3D6:						      ;	CODE XREF: int_10_04+77j
f000:F3D6							      ;	int_10_04+80j
f000:F3D6		  mov	  [bp+0Eh], dx
f000:F3D9		  jmp	  short	loc_FF434
f000:F3D9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F3DB		  db  90h ; 
f000:F3DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F3DC
f000:F3DC loc_FF3DC:						      ;	CODE XREF: int_10_04+57j
f000:F3DC		  mov	  bx, 50h ; 'P'
f000:F3DF		  cmp	  ax, 3000h
f000:F3E2		  jb	  short	loc_FF3F3
f000:F3E4		  sub	  ax, 3000h
f000:F3E7		  div	  bx
f000:F3E9		  shl	  ax, 1
f000:F3EB		  shl	  ax, 1
f000:F3ED		  add	  ax, 3
f000:F3F0		  jmp	  short	loc_FF421
f000:F3F0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F3F2		  db  90h ; 
f000:F3F3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F3F3
f000:F3F3 loc_FF3F3:						      ;	CODE XREF: int_10_04+90j
f000:F3F3		  cmp	  ax, 2000h
f000:F3F6		  jb	  short	loc_FF407
f000:F3F8		  sub	  ax, 2000h
f000:F3FB		  div	  bx
f000:F3FD		  shl	  ax, 1
f000:F3FF		  shl	  ax, 1
f000:F401		  add	  ax, 2
f000:F404		  jmp	  short	loc_FF421
f000:F404 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F406		  db  90h ; 
f000:F407 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F407
f000:F407 loc_FF407:						      ;	CODE XREF: int_10_04+A4j
f000:F407		  cmp	  ax, 1000h
f000:F40A		  jb	  short	loc_FF41B
f000:F40C		  sub	  ax, 1000h
f000:F40F		  div	  bx
f000:F411		  shl	  ax, 1
f000:F413		  shl	  ax, 1
f000:F415		  add	  ax, 1
f000:F418		  jmp	  short	loc_FF421
f000:F418 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F41A		  db  90h ; 
f000:F41B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F41B
f000:F41B loc_FF41B:						      ;	CODE XREF: int_10_04+B8j
f000:F41B		  div	  bx
f000:F41D		  shl	  ax, 1
f000:F41F		  shl	  ax, 1
f000:F421
f000:F421 loc_FF421:						      ;	CODE XREF: int_10_04+9Ej
f000:F421							      ;	int_10_04+B2j
f000:F421							      ;	int_10_04+C6j
f000:F421		  shl	  dx, 1
f000:F423		  shl	  dx, 1
f000:F425		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F42A		  jnz	  short	loc_FF42E
f000:F42C		  shl	  dx, 1
f000:F42E
f000:F42E loc_FF42E:						      ;	CODE XREF: int_10_04+D8j
f000:F42E		  mov	  [bp+0Dh], al
f000:F431		  mov	  [bp+0Eh], dx
f000:F434
f000:F434 loc_FF434:						      ;	CODE XREF: int_10_04+87j
f000:F434		  mov	  al, [bp+0Dh]
f000:F437		  mov	  cl, 3
f000:F439		  shr	  al, cl
f000:F43B		  mov	  dx, [bp+0Eh]
f000:F43E		  shr	  dx, cl
f000:F440		  mov	  dh, al
f000:F442		  mov	  [bp+0Ah], dx
f000:F445
f000:F445 loc_FF445:						      ;	CODE XREF: int_10_04+4Dj
f000:F445		  mov	  ah, 1
f000:F447
f000:F447 loc_FF447:						      ;	CODE XREF: int_10_04+Aj
f000:F447		  jmp	  near ptr int_pop_regs_and_exit
f000:F447 int_10_04	  endp
f000:F447
f000:F44A
f000:F44A ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F44A
f000:F44A ;	Sets the active	display	page.
f000:F44A ;
f000:F44A ;	   On entry:	  AH	     05h
f000:F44A ;			  AL	     Display page number
f000:F44A ;
f000:F44A ;	   Returns:	  None
f000:F44A ;
f000:F44A ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F44A
f000:F44A int_10_05	  proc far				      ;	CODE XREF: int_10+Dj
f000:F44A							      ;	DATA XREF: int_10+1Co
f000:F44A		  test	  al, 80h
f000:F44C		  jnz	  short	loc_FF481
f000:F44E		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:F453		  jl	  short	loc_FF458
f000:F455		  jmp	  near ptr int_pop_regs_and_exit
f000:F458 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F458
f000:F458 loc_FF458:						      ;	CODE XREF: int_10_05+9j
f000:F458		  mov	  ds:p400.active_display_page, al
f000:F45B		  mov	  ax, ds:p400.crt_page_len
f000:F45E		  xor	  bh, bh
f000:F460		  mov	  bl, ds:p400.active_display_page
f000:F464		  mul	  bx
f000:F466		  mov	  ds:p400.crt_current_page_offset, ax
f000:F469		  mov	  cx, ax
f000:F46B		  sar	  cx, 1
f000:F46D		  mov	  bh, 0Ch
f000:F46F		  mov	  bl, 0Dh
f000:F471		  call	  sub_FF92B
f000:F474		  mov	  bl, ds:p400.active_display_page
f000:F478		  call	  get_rowcols_for_page
f000:F47B		  call	  sub_FF31B
f000:F47E		  jmp	  near ptr int_pop_regs_and_exit
f000:F481 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F481
f000:F481 loc_FF481:						      ;	CODE XREF: int_10_05+2j
f000:F481		  mov	  ah, al
f000:F483		  cmp	  ah, 84h ; '„'
f000:F486		  jnb	  short	loc_FF4DA
f000:F488		  cmp	  ah, 80h ; '€'
f000:F48B		  jz	  short	loc_FF4BF
f000:F48D		  and	  bl, 7
f000:F490		  and	  bh, 7
f000:F493		  mov	  cl, 3
f000:F495		  shl	  bl, cl
f000:F497		  mov	  al, ds:p400.video_page_data
f000:F49A		  cmp	  ah, 81h ; ''
f000:F49D		  jnz	  short	loc_FF4A6
f000:F49F		  and	  al, 0C7h
f000:F4A1		  or	  al, bl
f000:F4A3		  jmp	  short	loc_FF4B8
f000:F4A3 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F4A5		  db  90h ; 
f000:F4A6 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F4A6
f000:F4A6 loc_FF4A6:						      ;	CODE XREF: int_10_05+53j
f000:F4A6		  cmp	  ah, 82h ; '‚'
f000:F4A9		  jnz	  short	loc_FF4B2
f000:F4AB		  and	  al, 0F8h
f000:F4AD		  or	  al, bh
f000:F4AF		  jmp	  short	loc_FF4B8
f000:F4AF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F4B1		  db  90h ; 
f000:F4B2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F4B2
f000:F4B2 loc_FF4B2:						      ;	CODE XREF: int_10_05+5Fj
f000:F4B2		  and	  al, 0C0h
f000:F4B4		  or	  al, bl
f000:F4B6		  or	  al, bh
f000:F4B8
f000:F4B8 loc_FF4B8:						      ;	CODE XREF: int_10_05+59j
f000:F4B8							      ;	int_10_05+65j
f000:F4B8		  mov	  ds:p400.video_page_data, al
f000:F4BB		  mov	  dx, 3DFh
f000:F4BE		  out	  dx, al
f000:F4BF
f000:F4BF loc_FF4BF:						      ;	CODE XREF: int_10_05+41j
f000:F4BF		  mov	  bp, sp
f000:F4C1		  mov	  al, ds:p400.video_page_data
f000:F4C4		  and	  al, 7
f000:F4C6		  mov	  bh, al
f000:F4C8		  mov	  al, ds:p400.video_page_data
f000:F4CB		  mov	  cl, 3
f000:F4CD		  shr	  al, cl
f000:F4CF		  and	  al, 7
f000:F4D1		  mov	  bl, al
f000:F4D3		  mov	  [bp+0Eh], bx
f000:F4D6		  clc
f000:F4D7		  jmp	  near ptr int_pop_regs_and_exit
f000:F4DA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F4DA
f000:F4DA loc_FF4DA:						      ;	CODE XREF: int_10_05+3Cj
f000:F4DA		  stc
f000:F4DB		  jmp	  near ptr int_pop_regs_and_exit
f000:F4DB int_10_05	  endp
f000:F4DB
f000:F4DE
f000:F4DE ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F4DE
f000:F4DE ;	Scrolls	a specified window upward a specified number of	lines.
f000:F4DE ;
f000:F4DE ;	   On entry:	  AH	     06h
f000:F4DE ;			  AL	     Number of lines to	scroll (if 0, clear entire
f000:F4DE ;				     window)
f000:F4DE ;			  BH	     Display attribute for blank lines
f000:F4DE ;			  CH	     Row number	of upper left corner
f000:F4DE ;			  CL	     Column number of upper left corner
f000:F4DE ;			  DH	     Row number	of lower right corner
f000:F4DE ;			  DL	     Column number of lower right corner
f000:F4DE ;
f000:F4DE ;	   Returns:	  None
f000:F4DE ;
f000:F4DE ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F4DE ;
f000:F4DE ; Attributes:	bp-based frame
f000:F4DE
f000:F4DE int_10_06	  proc far				      ;	CODE XREF: int_10+Dj
f000:F4DE							      ;	DATA XREF: int_10+1Eo
f000:F4DE		  push	  ax
f000:F4DF		  mov	  bp, sp
f000:F4E1		  mov	  word ptr [bp+0], 0
f000:F4E6		  call	  sub_FF4ED
f000:F4E9		  pop	  bx
f000:F4EA		  jmp	  near ptr int_pop_regs_and_exit
f000:F4EA int_10_06	  endp
f000:F4EA
f000:F4ED
f000:F4ED ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F4ED
f000:F4ED
f000:F4ED sub_FF4ED	  proc near				      ;	CODE XREF: int_10_06+8p
f000:F4ED							      ;	int_10_07+8p
f000:F4ED
f000:F4ED ; FUNCTION CHUNK AT f000:D413	SIZE 00000119 BYTES
f000:F4ED ; FUNCTION CHUNK AT f000:D52D	SIZE 00000085 BYTES
f000:F4ED ; FUNCTION CHUNK AT f000:D5B3	SIZE 00000014 BYTES
f000:F4ED
f000:F4ED		  mov	  ah, dl
f000:F4EF		  sub	  ah, cl
f000:F4F1		  inc	  ah
f000:F4F3		  cmp	  ah, 0
f000:F4F6		  jg	  short	loc_FF4FB
f000:F4F8		  jmp	  locret_FF5AC
f000:F4FB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F4FB
f000:F4FB loc_FF4FB:						      ;	CODE XREF: sub_FF4ED+9j
f000:F4FB		  mov	  bl, dh
f000:F4FD		  sub	  bl, ch
f000:F4FF		  cmp	  al, bl
f000:F501		  jle	  short	loc_FF505
f000:F503		  xor	  al, al
f000:F505
f000:F505 loc_FF505:						      ;	CODE XREF: sub_FF4ED+14j
f000:F505		  call	  is_text_mode
f000:F508		  jnb	  short	loc_FF50D
f000:F50A		  jmp	  loc_FD413
f000:F50D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F50D
f000:F50D loc_FF50D:						      ;	CODE XREF: sub_FF4ED+1Bj
f000:F50D		  cmp	  word ptr [bp+0], 0
f000:F511		  jz	  short	loc_FF515
f000:F513		  mov	  dh, ch
f000:F515
f000:F515 loc_FF515:						      ;	CODE XREF: sub_FF4ED+24j
f000:F515		  mov	  bh, ds:p400.active_display_page
f000:F519		  xor	  bl, bl
f000:F51B		  call	  sub_FD96F
f000:F51E		  inc	  bx
f000:F51F		  inc	  bx
f000:F520		  push	  bx
f000:F521		  mov	  bp, sp
f000:F523		  xor	  ch, ch
f000:F525		  cmp	  word ptr [bp+4], 0
f000:F529		  jz	  short	loc_FF531
f000:F52B		  mov	  ch, [bp+11h]
f000:F52E		  sub	  ch, [bp+13h]
f000:F531
f000:F531 loc_FF531:						      ;	CODE XREF: sub_FF4ED+3Cj
f000:F531		  mov	  dx, [bp+12h]
f000:F534		  add	  dh, ch
f000:F536		  mov	  bh, ds:p400.active_display_page
f000:F53A		  xor	  bl, bl
f000:F53C		  call	  sub_FD96F
f000:F53F		  mov	  di, bx
f000:F541		  mov	  dh, [bp+11h]
f000:F544		  sub	  dh, [bp+13h]
f000:F547		  cmp	  dh, 0
f000:F54A		  jnz	  short	loc_FF54F
f000:F54C		  jmp	  short	loc_FF590
f000:F54C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F54E		  db  90h ; 
f000:F54F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F54F
f000:F54F loc_FF54F:						      ;	CODE XREF: sub_FF4ED+5Dj
f000:F54F		  mov	  dx, [bp+12h]
f000:F552		  add	  dh, ch
f000:F554		  cmp	  word ptr [bp+4], 0
f000:F558		  jnz	  short	loc_FF55E
f000:F55A		  add	  dh, al
f000:F55C		  jmp	  short	loc_FF560
f000:F55E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F55E
f000:F55E loc_FF55E:						      ;	CODE XREF: sub_FF4ED+6Bj
f000:F55E		  sub	  dh, al
f000:F560
f000:F560 loc_FF560:						      ;	CODE XREF: sub_FF4ED+6Fj
f000:F560		  mov	  bh, ds:p400.active_display_page
f000:F564		  xor	  bl, bl
f000:F566		  call	  sub_FD96F
f000:F569		  mov	  si, bx
f000:F56B		  xor	  cx, cx
f000:F56D		  cmp	  al, 0
f000:F56F		  jz	  short	loc_FF590
f000:F571
f000:F571 loc_FF571:						      ;	CODE XREF: sub_FF4ED+9Cj
f000:F571		  push	  si
f000:F572		  push	  di
f000:F573		  push	  ds
f000:F574		  push	  ax
f000:F575		  mov	  ax, es
f000:F577		  mov	  ds, ax
f000:F579		  pop	  ax
f000:F57A		  mov	  cl, ah
f000:F57C		  rep movsw
f000:F57E		  pop	  ds
f000:F57F		  cmp	  si, [bp+0]
f000:F582		  jz	  short	loc_FF58B
f000:F584		  pop	  di
f000:F585		  pop	  si
f000:F586		  call	  sub_FDB09
f000:F589		  jmp	  short	loc_FF571
f000:F58B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F58B
f000:F58B loc_FF58B:						      ;	CODE XREF: sub_FF4ED+95j
f000:F58B		  pop	  di
f000:F58C		  pop	  si
f000:F58D		  call	  sub_FDB09
f000:F590
f000:F590 loc_FF590:						      ;	CODE XREF: sub_FF4ED+5Fj
f000:F590							      ;	sub_FF4ED+82j
f000:F590							      ;	sub_FF4ED+BAj
f000:F590		  push	  si
f000:F591		  push	  di
f000:F592		  mov	  cl, ah
f000:F594		  push	  ax
f000:F595		  mov	  al, 20h ; ' '
f000:F597		  mov	  ah, [bp+15h]
f000:F59A		  rep stosw
f000:F59C		  pop	  ax
f000:F59D		  cmp	  di, [bp+0]
f000:F5A0		  jz	  short	loc_FF5A9
f000:F5A2		  pop	  di
f000:F5A3		  pop	  si
f000:F5A4		  call	  sub_FDB09
f000:F5A7		  jmp	  short	loc_FF590
f000:F5A9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F5A9
f000:F5A9 loc_FF5A9:						      ;	CODE XREF: sub_FF4ED+B3j
f000:F5A9		  pop	  di
f000:F5AA		  pop	  si
f000:F5AB		  pop	  bx
f000:F5AC
f000:F5AC locret_FF5AC:						      ;	CODE XREF: sub_FF4ED+Bj
f000:F5AC		  retn
f000:F5AC sub_FF4ED	  endp
f000:F5AC
f000:F5AD
f000:F5AD ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F5AD
f000:F5AD ;	Scrolls	a specified window downward a specified	number of lines.
f000:F5AD ;
f000:F5AD ;	   On entry:	  AH	     07h
f000:F5AD ;			  AL	     Number of lines to	scroll (if 0, clear entire
f000:F5AD ;				     window)
f000:F5AD ;			  BH	     Display attribute for blank lines
f000:F5AD ;			  CH	     Row number	of upper left corner
f000:F5AD ;			  CL	     Column number of upper left corner
f000:F5AD ;			  DH	     Row number	of lower right corner
f000:F5AD ;			  DL	     Column number of lower right corner
f000:F5AD ;
f000:F5AD ;	   Returns:	  None
f000:F5AD ;
f000:F5AD ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F5AD ; Attributes:	bp-based frame
f000:F5AD
f000:F5AD int_10_07	  proc far				      ;	CODE XREF: int_10+Dj
f000:F5AD							      ;	DATA XREF: int_10+20o
f000:F5AD		  push	  ax
f000:F5AE		  mov	  bp, sp
f000:F5B0		  mov	  word ptr [bp+0], 1
f000:F5B5		  call	  sub_FF4ED
f000:F5B8		  pop	  bx
f000:F5B9		  jmp	  near ptr int_pop_regs_and_exit
f000:F5B9 int_10_07	  endp
f000:F5B9
f000:F5BC
f000:F5BC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F5BC
f000:F5BC ;	Reports	the ASCII value	and (in	text mode) attribute of	the character
f000:F5BC ;	at the current cursor location of the specified	display	page.
f000:F5BC ;
f000:F5BC ;	   On entry:	  AH	     08h
f000:F5BC ;			  BH	     Display page number (text modes only)
f000:F5BC ;
f000:F5BC ;	   Returns:	  AH	     Attribute of character (text mode)
f000:F5BC ;			  AL	     ASCII value of character
f000:F5BC ;
f000:F5BC ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F5BC
f000:F5BC int_10_08	  proc far				      ;	CODE XREF: int_10+Dj
f000:F5BC							      ;	DATA XREF: int_10+22o
f000:F5BC		  call	  is_text_mode
f000:F5BF		  jnb	  short	loc_FF5CB
f000:F5C1		  xor	  bl, bl
f000:F5C3		  call	  get_rowcols_for_page
f000:F5C6		  call	  sub_FD5C7
f000:F5C9		  jmp	  short	loc_FF5D4
f000:F5CB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F5CB
f000:F5CB loc_FF5CB:						      ;	CODE XREF: int_10_08+3j
f000:F5CB		  mov	  bl, 1
f000:F5CD		  call	  sub_FD96F
f000:F5D0		  mov	  ax, es:[bx]
f000:F5D3		  sti
f000:F5D4
f000:F5D4 loc_FF5D4:						      ;	CODE XREF: int_10_08+Dj
f000:F5D4		  jmp	  near ptr int_pop_regs_and_exit
f000:F5D4 int_10_08	  endp
f000:F5D4
f000:F5D7
f000:F5D7 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F5D7
f000:F5D7 ;	Displays a specified character with a specified	attribute a specified
f000:F5D7 ;	number of times.
f000:F5D7 ;
f000:F5D7 ;	   On entry:	  AX	     09h
f000:F5D7 ;			  AL	     ASCII value of character
f000:F5D7 ;			  BH	     Display page (text	mode only)
f000:F5D7 ;			  BL	     Attribute/Color
f000:F5D7 ;			  CX	     Number of times to	write character
f000:F5D7 ;
f000:F5D7 ;	   Returns:	  None
f000:F5D7 ;
f000:F5D7 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F5D7
f000:F5D7 int_10_09	  proc far				      ;	CODE XREF: int_10+Dj
f000:F5D7							      ;	DATA XREF: int_10+24o
f000:F5D7		  xor	  dl, dl
f000:F5D9		  jmp	  short	l0
f000:F5D9 int_10_09	  endp
f000:F5D9
f000:F5DB
f000:F5DB ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F5DB
f000:F5DB ;
f000:F5DB ;	Displays a specified character a specified number of times.
f000:F5DB ;
f000:F5DB ;	   On entry:	  AH	     0Ah
f000:F5DB ;			  AL	     ASCII value of character
f000:F5DB ;			  BH	     Display page number (text mode only)
f000:F5DB ;			  CX	     Number of times to	write character
f000:F5DB ;
f000:F5DB ;	   Returns:	  None
f000:F5DB ;
f000:F5DB ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F5DB ;
f000:F5DB ; Attributes:	bp-based frame
f000:F5DB
f000:F5DB int_10_0a	  proc far				      ;	CODE XREF: int_10+Dj
f000:F5DB							      ;	DATA XREF: int_10+26o
f000:F5DB		  mov	  dl, 0FFh
f000:F5DD
f000:F5DD l0:							      ;	CODE XREF: int_10_09+2j
f000:F5DD		  or	  cx, cx
f000:F5DF		  jz	  short	l5
f000:F5E1		  mov	  ah, bl
f000:F5E3		  call	  is_text_mode
f000:F5E6		  jnb	  short	l1
f000:F5E8		  xor	  bl, bl
f000:F5EA		  call	  get_rowcols_for_page
f000:F5ED		  call	  sub_FD754
f000:F5F0		  jmp	  short	l5
f000:F5F2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F5F2
f000:F5F2 l1:							      ;	CODE XREF: int_10_0a+Bj
f000:F5F2		  push	  dx
f000:F5F3		  mov	  bp, sp
f000:F5F5		  mov	  bl, 1
f000:F5F7		  call	  sub_FD96F
f000:F5FA		  mov	  di, bx
f000:F5FC		  mov	  bl, al
f000:F5FE		  cmp	  byte ptr [bp+0], 0
f000:F602		  jnz	  short	l3
f000:F604
f000:F604 l2:							      ;	CODE XREF: int_10_0a+2Dj
f000:F604		  mov	  al, bl
f000:F606		  stosw
f000:F607		  sti
f000:F608		  loop	  l2
f000:F60A		  jmp	  short	l4
f000:F60C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F60C
f000:F60C l3:							      ;	CODE XREF: int_10_0a+27j
f000:F60C							      ;	int_10_0a+36j
f000:F60C		  mov	  al, bl
f000:F60E		  stosb
f000:F60F		  sti
f000:F610		  inc	  di
f000:F611		  loop	  l3
f000:F613
f000:F613 l4:							      ;	CODE XREF: int_10_0a+2Fj
f000:F613		  pop	  bx
f000:F614
f000:F614 l5:							      ;	CODE XREF: int_10_0a+4j
f000:F614							      ;	int_10_0a+15j
f000:F614		  jmp	  near ptr int_pop_regs_and_exit
f000:F614 int_10_0a	  endp
f000:F614
f000:F617
f000:F617 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F617
f000:F617 ;
f000:F617 ;	Selects	color palette for various display modes.
f000:F617 ;
f000:F617 ;	   On entry:	  AX	     0Bh
f000:F617 ;			  BH	     Palette Color ID (0 or 1, See below)
f000:F617 ;			  BL	     Color or palette value to be used with Color
f000:F617 ;				     ID	(0 - 31)
f000:F617 ;
f000:F617 ;	   Returns:	  None
f000:F617 ;
f000:F617 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F617
f000:F617 int_10_0b	  proc far				      ;	CODE XREF: int_10+Dj
f000:F617							      ;	DATA XREF: int_10+28o
f000:F617		  mov	  dx, 3D9h
f000:F61A		  mov	  al, ds:p400.shadow_3d9_crt_palette
f000:F61D		  cmp	  bh, 0
f000:F620		  jnz	  short	l2
f000:F622		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:F627		  jb	  short	l0
f000:F629		  mov	  bh, bl
f000:F62B		  mov	  bl, 0
f000:F62D		  call	  sub_FF8F2
f000:F630		  mov	  bl, bh
f000:F632
f000:F632 l0:							      ;	CODE XREF: int_10_0b+10j
f000:F632		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:F637		  jz	  short	l1
f000:F639		  mov	  dx, 3DAh
f000:F63C		  mov	  al, 2
f000:F63E		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F63E							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F63F		  mov	  al, bl
f000:F641		  add	  dx, 4
f000:F644		  out	  dx, al
f000:F645		  xor	  al, al
f000:F647		  sub	  dx, 4
f000:F64A		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F64A							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F64B
f000:F64B l1:							      ;	CODE XREF: int_10_0b+20j
f000:F64B		  mov	  dx, 3D9h
f000:F64E		  mov	  al, ds:p400.shadow_3d9_crt_palette
f000:F651		  and	  al, 0E0h
f000:F653		  and	  bl, 1Fh
f000:F656		  or	  al, bl
f000:F658		  jmp	  short	l3
f000:F65A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F65A
f000:F65A l2:							      ;	CODE XREF: int_10_0b+9j
f000:F65A		  and	  al, 0DFh
f000:F65C		  cmp	  bl, 0
f000:F65F		  jz	  short	l3
f000:F661		  or	  al, 20h
f000:F663
f000:F663 l3:							      ;	CODE XREF: int_10_0b+41j
f000:F663							      ;	int_10_0b+48j
f000:F663		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F668		  jnz	  short	l4
f000:F66A		  mov	  al, 0
f000:F66C
f000:F66C l4:							      ;	CODE XREF: int_10_0b+51j
f000:F66C		  out	  dx, al
f000:F66D		  mov	  ds:p400.shadow_3d9_crt_palette, al
f000:F670		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F675		  jnz	  short	l7
f000:F677		  cmp	  bl, 0
f000:F67A		  jz	  short	l5
f000:F67C		  mov	  bx, 301h
f000:F67F		  call	  sub_FF8F2
f000:F682		  mov	  bx, 502h
f000:F685		  call	  sub_FF8F2
f000:F688		  mov	  bx, 0F03h
f000:F68B		  call	  sub_FF8F2
f000:F68E		  jmp	  short	l6
f000:F68E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F690		  db  90h ; 
f000:F691 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F691
f000:F691 l5:							      ;	CODE XREF: int_10_0b+63j
f000:F691		  mov	  bx, 201h
f000:F694		  call	  sub_FF8F2
f000:F697		  mov	  bx, 402h
f000:F69A		  call	  sub_FF8F2
f000:F69D		  mov	  bx, 603h
f000:F6A0		  call	  sub_FF8F2
f000:F6A3
f000:F6A3 l6:							      ;	CODE XREF: int_10_0b+77j
f000:F6A3		  mov	  dx, 3DAh
f000:F6A6		  xor	  al, al
f000:F6A8		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F6A8							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F6A9
f000:F6A9 l7:							      ;	CODE XREF: int_10_0b+5Ej
f000:F6A9		  jmp	  near ptr int_pop_regs_and_exit
f000:F6A9 int_10_0b	  endp
f000:F6A9
f000:F6AC
f000:F6AC ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F6AC
f000:F6AC ;
f000:F6AC ;	Writes a pixel dot of a	specified color	at a specified screen
f000:F6AC ;	coordinate.
f000:F6AC ;
f000:F6AC ;	   On entry:	  AH	     0Ch
f000:F6AC ;			  AL	     Pixel color
f000:F6AC ;			  CX	     Horizontal	position of pixel
f000:F6AC ;			  DX	     Vertical position of pixel
f000:F6AC ;			  BH	     Display page number (graphics modes with more
f000:F6AC ;				     than 1 page)
f000:F6AC ;
f000:F6AC ;	   Returns:	  None
f000:F6AC ;
f000:F6AC ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F6AC
f000:F6AC int_10_0c	  proc far				      ;	CODE XREF: int_10+Dj
f000:F6AC							      ;	DATA XREF: int_10+2Ao
f000:F6AC		  call	  sub_FF93F
f000:F6AF		  jb	  short	l2
f000:F6B1		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:F6B6		  jz	  short	l3
f000:F6B8		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:F6BD		  jz	  short	l3
f000:F6BF		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F6C4		  jz	  short	l4
f000:F6C6
f000:F6C6 l0:							      ;	CODE XREF: int_10_0c+39j
f000:F6C6		  mov	  ah, al
f000:F6C8		  and	  al, dl
f000:F6CA		  shl	  al, cl
f000:F6CC		  test	  ah, 80h
f000:F6CF		  jnz	  short	l1
f000:F6D1		  rol	  dh, cl
f000:F6D3		  and	  es:[bx], dh
f000:F6D6		  or	  es:[bx], al
f000:F6D9		  jmp	  near ptr int_pop_regs_and_exit
f000:F6DC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F6DC
f000:F6DC l1:							      ;	CODE XREF: int_10_0c+23j
f000:F6DC		  xor	  es:[bx], al
f000:F6DF
f000:F6DF l2:							      ;	CODE XREF: int_10_0c+3j
f000:F6DF		  jmp	  near ptr int_pop_regs_and_exit
f000:F6E2 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F6E2
f000:F6E2 l3:							      ;	CODE XREF: int_10_0c+Aj
f000:F6E2							      ;	int_10_0c+11j
f000:F6E2		  mov	  dx, 0F00Fh
f000:F6E5		  jmp	  short	l0
f000:F6E7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F6E7
f000:F6E7 l4:							      ;	CODE XREF: int_10_0c+18j
f000:F6E7		  mov	  dx, 0FE01h
f000:F6EA		  mov	  ah, al
f000:F6EC		  and	  al, dl
f000:F6EE		  shl	  al, cl
f000:F6F0		  test	  ah, 80h
f000:F6F3		  jnz	  short	l5
f000:F6F5		  rol	  dh, cl
f000:F6F7		  and	  es:[bx], dh
f000:F6FA		  or	  es:[bx], al
f000:F6FD		  jmp	  short	l6
f000:F6FD ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F6FF		  db  90h ; 
f000:F700 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F700
f000:F700 l5:							      ;	CODE XREF: int_10_0c+47j
f000:F700		  xor	  es:[bx], al
f000:F703
f000:F703 l6:							      ;	CODE XREF: int_10_0c+51j
f000:F703		  mov	  al, ah
f000:F705		  shr	  al, 1
f000:F707		  and	  al, dl
f000:F709		  shl	  al, cl
f000:F70B		  test	  ah, 80h
f000:F70E		  jnz	  short	l7
f000:F710		  and	  es:[bx+1], dh
f000:F714		  or	  es:[bx+1], al
f000:F718		  jmp	  near ptr int_pop_regs_and_exit
f000:F71B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F71B
f000:F71B l7:							      ;	CODE XREF: int_10_0c+62j
f000:F71B		  xor	  es:[bx+1], al
f000:F71F		  jmp	  near ptr int_pop_regs_and_exit
f000:F71F int_10_0c	  endp
f000:F71F
f000:F722
f000:F722 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F722
f000:F722 ; Reports the	color of the pixel at a	specified screen coordinate.
f000:F722 ;
f000:F722 ;	   On entry:	  AH	     0Dh
f000:F722 ;			  CX	     Horizontal	position of pixel
f000:F722 ;			  DX	     Vertical position of pixel
f000:F722 ;			  BH	     Display page number (graphics modes with more
f000:F722 ;				     than 1 page)
f000:F722 ;
f000:F722 ;	   Returns:	  AL	     Color of pixel
f000:F722 ;
f000:F722 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F722
f000:F722 int_10_0d	  proc far				      ;	CODE XREF: int_10+Dj
f000:F722							      ;	DATA XREF: int_10+2Co
f000:F722		  call	  sub_FF93F
f000:F725		  jb	  short	l1
f000:F727		  cmp	  byte ptr ds:p400.crt_mode, 8
f000:F72C		  jz	  short	l2
f000:F72E		  cmp	  byte ptr ds:p400.crt_mode, 9
f000:F733		  jz	  short	l2
f000:F735		  cmp	  byte ptr ds:p400.crt_mode, 0Ah
f000:F73A		  jz	  short	l3
f000:F73C
f000:F73C l0:							      ;	CODE XREF: int_10_0d+26j
f000:F73C		  mov	  al, es:[bx]
f000:F73F		  shr	  al, cl
f000:F741		  and	  al, ah
f000:F743
f000:F743 l1:							      ;	CODE XREF: int_10_0d+3j
f000:F743		  jmp	  near ptr int_pop_regs_and_exit
f000:F746 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F746
f000:F746 l2:							      ;	CODE XREF: int_10_0d+Aj
f000:F746							      ;	int_10_0d+11j
f000:F746		  mov	  ah, 0Fh
f000:F748		  jmp	  short	l0
f000:F74A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F74A
f000:F74A l3:							      ;	CODE XREF: int_10_0d+18j
f000:F74A		  mov	  ah, 1
f000:F74C		  mov	  al, es:[bx]
f000:F74F		  shr	  al, cl
f000:F751		  and	  al, ah
f000:F753		  mov	  dl, es:[bx+1]
f000:F757		  shr	  dl, cl
f000:F759		  and	  dl, ah
f000:F75B		  shl	  dl, 1
f000:F75D		  or	  al, dl
f000:F75F		  jmp	  near ptr int_pop_regs_and_exit
f000:F75F int_10_0d	  endp
f000:F75F
f000:F762
f000:F762 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F762
f000:F762 ;  Writes one	character at the current cursor	location and advances the
f000:F762 ;	cursor.
f000:F762 ;
f000:F762 ;	   On entry:	  AH	     0Eh
f000:F762 ;			  AL	     Character to write
f000:F762 ;			  BL	     Foreground	color (graphics	modes only)
f000:F762 ;			  BH	     Display page number (text modes only)
f000:F762 ;
f000:F762 ;	   Returns:	  None
f000:F762
f000:F762 int_10_0e	  proc far				      ;	CODE XREF: int_10+Dj
f000:F762							      ;	DATA XREF: int_10+2Eo
f000:F762		  push	  ax
f000:F763		  mov	  cl, bl
f000:F765		  call	  sub_FF91B
f000:F768		  call	  get_rowcols_for_page
f000:F76B		  cmp	  al, 7
f000:F76D		  jnz	  short	l0
f000:F76F		  call	  play_bell_sound?
f000:F772		  jmp	  l12
f000:F775 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F775
f000:F775 l0:							      ;	CODE XREF: int_10_0e+Bj
f000:F775		  cmp	  al, 0Dh
f000:F777		  jnz	  short	l1
f000:F779		  xor	  dl, dl
f000:F77B		  jmp	  short	l11
f000:F77B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F77D		  db  90h ; 
f000:F77E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F77E
f000:F77E l1:							      ;	CODE XREF: int_10_0e+15j
f000:F77E		  cmp	  al, 8
f000:F780		  jnz	  short	l4
f000:F782		  dec	  dl
f000:F784		  jge	  short	l2
f000:F786		  cmp	  dh, 0
f000:F789		  jg	  short	l3
f000:F78B		  xor	  dl, dl
f000:F78D
f000:F78D l2:							      ;	CODE XREF: int_10_0e+22j
f000:F78D		  jmp	  short	l11
f000:F78D ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F78F		  db  90h ; 
f000:F790 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F790
f000:F790 l3:							      ;	CODE XREF: int_10_0e+27j
f000:F790		  dec	  dh
f000:F792		  add	  dl, ds:p400.crt_nr_cols
f000:F796		  jmp	  short	l11
f000:F796 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F798		  db  90h ; 
f000:F799 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F799
f000:F799 l4:							      ;	CODE XREF: int_10_0e+1Ej
f000:F799		  cmp	  al, 0Ah
f000:F79B		  jnz	  short	l9
f000:F79D		  cmp	  dh, 18h
f000:F7A0		  jnz	  short	l8
f000:F7A2
f000:F7A2 l5:							      ;	CODE XREF: int_10_0e+90j
f000:F7A2		  call	  is_text_mode
f000:F7A5		  jnb	  short	l6
f000:F7A7		  mov	  ah, 0
f000:F7A9		  jmp	  short	l7
f000:F7AB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F7AB
f000:F7AB l6:							      ;	CODE XREF: int_10_0e+43j
f000:F7AB		  mov	  bp, sp
f000:F7AD		  call	  sub_FF91B
f000:F7B0		  mov	  ah, 8
f000:F7B2		  int	  10h				      ;	- VIDEO	- READ ATTRIBUTES/CHARACTER AT CURSOR POSITION
f000:F7B2							      ;	BH = display page
f000:F7B2							      ;	Return:	AL = character
f000:F7B2							      ;	AH = attribute of character (alpha modes)
f000:F7B4
f000:F7B4 l7:							      ;	CODE XREF: int_10_0e+47j
f000:F7B4		  mov	  bh, ah
f000:F7B6		  mov	  ah, 6
f000:F7B8		  mov	  al, 1
f000:F7BA		  xor	  cx, cx
f000:F7BC		  mov	  dl, ds:p400.crt_nr_cols
f000:F7C0		  dec	  dl
f000:F7C2		  int	  10h				      ;	- VIDEO	- SCROLL PAGE UP
f000:F7C2							      ;	AL = number of lines to	scroll window (0 = blank whole window)
f000:F7C2							      ;	BH = attributes	to be used on blanked lines
f000:F7C2							      ;	CH,CL =	row,column of upper left corner	of window to scroll
f000:F7C2							      ;	DH,DL =	row,column of lower right corner of window
f000:F7C4		  jmp	  short	l12
f000:F7C4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F7C6		  db  90h ; 
f000:F7C7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F7C7
f000:F7C7 l8:							      ;	CODE XREF: int_10_0e+3Ej
f000:F7C7		  inc	  dh
f000:F7C9		  jmp	  short	l11
f000:F7C9 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F7CB		  db  90h ; 
f000:F7CC ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F7CC
f000:F7CC l9:							      ;	CODE XREF: int_10_0e+39j
f000:F7CC		  mov	  ah, 0Ah
f000:F7CE		  mov	  bl, cl
f000:F7D0		  mov	  cx, 1
f000:F7D3		  int	  10h				      ;	- VIDEO	- WRITE	CHARACTERS ONLY	AT CURSOR POSITION
f000:F7D3							      ;	AL = character,	BH = display page - alpha mode
f000:F7D3							      ;	BL = color of character	(graphics mode,	PCjr only)
f000:F7D3							      ;	CX = number of times to	write character
f000:F7D5		  inc	  dl
f000:F7D7		  cmp	  dl, ds:p400.crt_nr_cols
f000:F7DB		  jnz	  short	l11
f000:F7DD		  xor	  dl, dl
f000:F7DF		  cmp	  dh, 18h
f000:F7E2		  jnz	  short	l10
f000:F7E4		  mov	  bp, sp
f000:F7E6		  push	  ax
f000:F7E7		  push	  cx
f000:F7E8		  push	  dx
f000:F7E9		  call	  sub_FF91B
f000:F7EC		  call	  sub_FF2FA
f000:F7EF		  pop	  dx
f000:F7F0		  pop	  cx
f000:F7F1		  pop	  ax
f000:F7F2		  jmp	  short	l5
f000:F7F4 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F7F4
f000:F7F4 l10:							      ;	CODE XREF: int_10_0e+80j
f000:F7F4		  inc	  dh
f000:F7F6
f000:F7F6 l11:							      ;	CODE XREF: int_10_0e+19j
f000:F7F6							      ;	int_10_0e:l2j
f000:F7F6							      ;	int_10_0e+34j
f000:F7F6							      ;	int_10_0e+67j
f000:F7F6							      ;	int_10_0e+79j
f000:F7F6		  mov	  bp, sp
f000:F7F8		  call	  sub_FF91B
f000:F7FB		  call	  sub_FF2FA
f000:F7FE
f000:F7FE l12:							      ;	CODE XREF: int_10_0e+10j
f000:F7FE							      ;	int_10_0e+62j
f000:F7FE		  pop	  ax
f000:F7FF		  jmp	  short	int_10_exit
f000:F7FF int_10_0e	  endp
f000:F7FF
f000:F801
f000:F801 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F801
f000:F801 ;  Reports the current video mode, the number	of character positions per
f000:F801 ;	line in	that video mode, and the current display page.
f000:F801 ;
f000:F801 ;	   On entry:	  AH	     0Fh
f000:F801 ;
f000:F801 ;	   Returns:	  AL	     Video mode
f000:F801 ;			  AH	     Number of character columns per line
f000:F801 ;			  BH	     Active display page number
f000:F801 ;
f000:F801 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F801 ;
f000:F801 ; Attributes:	bp-based frame
f000:F801
f000:F801 int_10_0f	  proc far				      ;	CODE XREF: int_10+Dj
f000:F801							      ;	DATA XREF: int_10+30o
f000:F801
f000:F801 arg_A		  = word ptr  0Eh
f000:F801
f000:F801		  mov	  ax, ds:p400.crt_nr_cols
f000:F804		  mov	  ah, al
f000:F806		  mov	  al, ds:p400.crt_mode
f000:F809		  mov	  bh, ds:p400.active_display_page
f000:F80D		  mov	  bp, sp
f000:F80F		  mov	  [bp+arg_A], bx
f000:F812
f000:F812 int_10_exit:						      ;	CODE XREF: int_10_0e+9Dj
f000:F812							      ;	int_10_10+D6j
f000:F812							      ;	int_10_10+DAj
f000:F812		  jmp	  near ptr int_pop_regs_and_exit
f000:F812 int_10_0f	  endp
f000:F812
f000:F815
f000:F815 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F815
f000:F815 ; Sets the palette and overscan (border) registers on	the PCjr and EGA.
f000:F815 ;
f000:F815 ;	   On entry:	  AH	     10h
f000:F815 ;			  AL	     Subservice
f000:F815 ;				     0 - Set palette register
f000:F815 ;					 BL	 Palette register
f000:F815 ;					 BH	 Value to set
f000:F815 ;
f000:F815 ;				     1 - Set overscan (border) color register
f000:F815 ;					 BH	 Value to set
f000:F815 ;
f000:F815 ;				     2 - Set palette registers and border register
f000:F815 ;					 ES:DX	 Pointer to color list
f000:F815 ;
f000:F815 ;				     3 - Toggle	intensify/blinking bit
f000:F815 ;					 BL	 0 - Enable intensify
f000:F815 ;					 BL	 1 - Enable blinking
f000:F815 ;
f000:F815 ;	   Registers destroyed:	     AX, SP, BP, SI, DI
f000:F815 ;
f000:F815
f000:F815 int_10_10	  proc far				      ;	CODE XREF: int_10+Dj
f000:F815							      ;	DATA XREF: int_10+32o
f000:F815		  cmp	  al, 3
f000:F817		  jb	  short	ok
f000:F819		  jmp	  error
f000:F81C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F81C
f000:F81C ok:							      ;	CODE XREF: int_10_10+2j
f000:F81C		  cmp	  al, 0
f000:F81E		  jnz	  short	l8
f000:F820		  cmp	  byte ptr ds:p400.crt_mode, 6
f000:F825		  jnz	  short	l0
f000:F827		  cmp	  bl, 1
f000:F82A		  jnz	  short	l7
f000:F82C		  mov	  bl, 0Fh
f000:F82E		  jmp	  short	l7
f000:F82E ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F830		  db  90h ; 
f000:F831 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F831
f000:F831 l0:							      ;	CODE XREF: int_10_10+10j
f000:F831		  jnb	  short	l7
f000:F833		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:F838		  jb	  short	l7
f000:F83A		  mov	  al, ds:p400.shadow_3d9_crt_palette
f000:F83D		  and	  al, 20h
f000:F83F		  jz	  short	l4
f000:F841		  cmp	  bl, 1
f000:F844		  jnz	  short	l1
f000:F846		  mov	  bl, 0Bh
f000:F848		  jmp	  short	l7
f000:F848 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F84A		  db  90h ; 
f000:F84B ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F84B
f000:F84B l1:							      ;	CODE XREF: int_10_10+2Fj
f000:F84B		  cmp	  bl, 2
f000:F84E		  jnz	  short	l3
f000:F850		  mov	  bl, 0Dh
f000:F852		  jmp	  short	l7
f000:F852 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F854		  db  90h ; 
f000:F855 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F855
f000:F855 l3:							      ;	CODE XREF: int_10_10+39j
f000:F855		  cmp	  bl, 3
f000:F858		  jnz	  short	l7
f000:F85A		  mov	  bl, 0Fh
f000:F85C		  jmp	  short	l7
f000:F85C ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F85E		  db  90h ; 
f000:F85F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F85F
f000:F85F l4:							      ;	CODE XREF: int_10_10+2Aj
f000:F85F		  cmp	  bl, 1
f000:F862		  jnz	  short	l5
f000:F864		  mov	  bl, 0Ah
f000:F866		  jmp	  short	l7
f000:F866 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F868		  db  90h ; 
f000:F869 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F869
f000:F869 l5:							      ;	CODE XREF: int_10_10+4Dj
f000:F869		  cmp	  bl, 2
f000:F86C		  jnz	  short	l6
f000:F86E		  mov	  bl, 0Ch
f000:F870		  jmp	  short	l7
f000:F870 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F872		  db  90h ; 
f000:F873 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F873
f000:F873 l6:							      ;	CODE XREF: int_10_10+57j
f000:F873		  cmp	  bl, 3
f000:F876		  jnz	  short	l7
f000:F878		  mov	  bl, 0Eh
f000:F87A
f000:F87A l7:							      ;	CODE XREF: int_10_10+15j
f000:F87A							      ;	int_10_10+19j
f000:F87A							      ;	int_10_10:l0j
f000:F87A							      ;	int_10_10+23j
f000:F87A							      ;	int_10_10+33j
f000:F87A							      ;	int_10_10+3Dj ...
f000:F87A		  call	  sub_FF8F2
f000:F87D		  jb	  short	error
f000:F87F		  jmp	  short	l14
f000:F87F ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F881		  db  90h ; 
f000:F882 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F882
f000:F882 l8:							      ;	CODE XREF: int_10_10+9j
f000:F882		  push	  ax
f000:F883		  cmp	  byte ptr ds:p400.crt_mode, 7
f000:F888		  jnb	  short	l9
f000:F88A		  mov	  dx, 3DAh
f000:F88D		  mov	  al, 3
f000:F88F		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F88F							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F890		  add	  dx, 4
f000:F893		  mov	  al, 4
f000:F895		  out	  dx, al
f000:F896
f000:F896 l9:							      ;	CODE XREF: int_10_10+73j
f000:F896		  pop	  ax
f000:F897		  cmp	  al, 1
f000:F899		  jnz	  short	l10
f000:F89B		  mov	  al, 2
f000:F89D		  mov	  dx, 3DAh
f000:F8A0		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F8A0							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F8A1		  mov	  al, bh
f000:F8A3		  add	  dx, 4
f000:F8A6		  out	  dx, al
f000:F8A7		  jmp	  short	l14
f000:F8A7 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F8A9		  db  90h ; 
f000:F8AA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F8AA
f000:F8AA l10:							      ;	CODE XREF: int_10_10+84j
f000:F8AA		  mov	  bl, 10h
f000:F8AC		  mov	  si, dx
f000:F8AE		  mov	  dx, 3DAh
f000:F8B1		  mov	  cx, 10h
f000:F8B4
f000:F8B4 l11:							      ;	CODE XREF: int_10_10+C3j
f000:F8B4		  push	  dx
f000:F8B5		  mov	  dx, 3DAh
f000:F8B8
f000:F8B8 l12:							      ;	CODE XREF: int_10_10+A6j
f000:F8B8		  in	  al, dx			      ;	Video status bits:
f000:F8B8							      ;	0: retrace.  1=display is in vert or horiz retrace.
f000:F8B8							      ;	1: 1=light pen is triggered; 0=armed
f000:F8B8							      ;	2: 1=light pen switch is open; 0=closed
f000:F8B8							      ;	3: 1=vertical sync pulse is occurring.
f000:F8B9		  test	  al, 8
f000:F8BB		  jnz	  short	l12
f000:F8BD		  cli
f000:F8BE
f000:F8BE l13:							      ;	CODE XREF: int_10_10+ACj
f000:F8BE		  in	  al, dx			      ;	Video status bits:
f000:F8BE							      ;	0: retrace.  1=display is in vert or horiz retrace.
f000:F8BE							      ;	1: 1=light pen is triggered; 0=armed
f000:F8BE							      ;	2: 1=light pen switch is open; 0=closed
f000:F8BE							      ;	3: 1=vertical sync pulse is occurring.
f000:F8BF		  test	  al, 8
f000:F8C1		  jz	  short	l13
f000:F8C3		  pop	  dx
f000:F8C4		  mov	  al, bl
f000:F8C6		  out	  dx, al
f000:F8C7		  mov	  al, es:[si]
f000:F8CA		  add	  dx, 4
f000:F8CD		  out	  dx, al
f000:F8CE		  sti
f000:F8CF		  inc	  si
f000:F8D0		  sub	  dx, 4
f000:F8D3		  xor	  al, al
f000:F8D5		  out	  dx, al
f000:F8D6		  inc	  bl
f000:F8D8		  loop	  l11
f000:F8DA		  mov	  al, 2
f000:F8DC		  out	  dx, al
f000:F8DD		  add	  dx, 4
f000:F8E0		  mov	  al, es:[si]
f000:F8E3		  out	  dx, al
f000:F8E4
f000:F8E4 l14:							      ;	CODE XREF: int_10_10+6Aj
f000:F8E4							      ;	int_10_10+92j
f000:F8E4		  mov	  dx, 3DAh
f000:F8E7		  xor	  al, al
f000:F8E9		  out	  dx, al			      ;	Video: bits 0-1	control
f000:F8E9							      ;	Feature	Control	outputs	FC0 and	FC1
f000:F8EA		  clc
f000:F8EB		  jmp	  int_10_exit
f000:F8EE ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F8EE
f000:F8EE error:						      ;	CODE XREF: int_10_10+4j
f000:F8EE							      ;	int_10_10+68j
f000:F8EE		  stc
f000:F8EF		  jmp	  int_10_exit
f000:F8EF int_10_10	  endp
f000:F8EF
f000:F8F2
f000:F8F2 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F8F2
f000:F8F2
f000:F8F2 sub_FF8F2	  proc near				      ;	CODE XREF: int_10_0b+16p
f000:F8F2							      ;	int_10_0b+68p
f000:F8F2							      ;	int_10_0b+6Ep
f000:F8F2							      ;	int_10_0b+74p
f000:F8F2							      ;	int_10_0b+7Dp
f000:F8F2							      ;	int_10_0b+83p ...
f000:F8F2		  mov	  dx, 3DAh
f000:F8F5		  mov	  al, bl
f000:F8F7		  cmp	  al, 10h
f000:F8F9		  jnb	  short	error
f000:F8FB		  push	  ax
f000:F8FC		  push	  dx
f000:F8FD		  mov	  dx, 3DAh
f000:F900
f000:F900 l0:							      ;	CODE XREF: sub_FF8F2+11j
f000:F900		  in	  al, dx			      ;	Video status bits:
f000:F900							      ;	0: retrace.  1=display is in vert or horiz retrace.
f000:F900							      ;	1: 1=light pen is triggered; 0=armed
f000:F900							      ;	2: 1=light pen switch is open; 0=closed
f000:F900							      ;	3: 1=vertical sync pulse is occurring.
f000:F901		  test	  al, 8
f000:F903		  jnz	  short	l0
f000:F905		  cli
f000:F906
f000:F906 l1:							      ;	CODE XREF: sub_FF8F2+17j
f000:F906		  in	  al, dx			      ;	Video status bits:
f000:F906							      ;	0: retrace.  1=display is in vert or horiz retrace.
f000:F906							      ;	1: 1=light pen is triggered; 0=armed
f000:F906							      ;	2: 1=light pen switch is open; 0=closed
f000:F906							      ;	3: 1=vertical sync pulse is occurring.
f000:F907		  test	  al, 8
f000:F909		  jz	  short	l1
f000:F90B		  pop	  dx
f000:F90C		  pop	  ax
f000:F90D		  add	  al, 10h
f000:F90F		  out	  dx, al
f000:F910		  add	  dx, 4
f000:F913		  mov	  al, bh
f000:F915		  out	  dx, al
f000:F916		  sti
f000:F917		  clc
f000:F918		  retn
f000:F919 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F919
f000:F919 error:						      ;	CODE XREF: sub_FF8F2+7j
f000:F919		  stc
f000:F91A		  retn
f000:F91A sub_FF8F2	  endp
f000:F91A
f000:F91B
f000:F91B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F91B
f000:F91B
f000:F91B sub_FF91B	  proc near				      ;	CODE XREF: int_10_0e+3p
f000:F91B							      ;	int_10_0e+4Bp
f000:F91B							      ;	int_10_0e+87p
f000:F91B							      ;	int_10_0e+96p
f000:F91B		  mov	  bl, ds:p400.active_display_page
f000:F91F		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:F924		  jl	  short	l0
f000:F926		  xor	  bl, bl
f000:F928
f000:F928 l0:							      ;	CODE XREF: sub_FF91B+9j
f000:F928		  mov	  bh, bl
f000:F92A		  retn
f000:F92A sub_FF91B	  endp
f000:F92A
f000:F92B
f000:F92B ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F92B
f000:F92B
f000:F92B sub_FF92B	  proc near				      ;	CODE XREF: int_10_01+4p
f000:F92B							      ;	sub_FF31B+17j
f000:F92B							      ;	int_10_05+27p
f000:F92B		  mov	  dx, ds:p400.addr_6845
f000:F92F		  mov	  al, bh
f000:F931		  out	  dx, al
f000:F932		  inc	  dx
f000:F933		  mov	  al, ch
f000:F935		  out	  dx, al
f000:F936		  dec	  dx
f000:F937		  mov	  al, bl
f000:F939		  out	  dx, al
f000:F93A		  inc	  dx
f000:F93B		  mov	  al, cl
f000:F93D		  out	  dx, al
f000:F93E		  retn
f000:F93E sub_FF92B	  endp
f000:F93E
f000:F93F
f000:F93F ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F93F
f000:F93F
f000:F93F sub_FF93F	  proc near				      ;	CODE XREF: int_10_0cp
f000:F93F							      ;	int_10_0dp
f000:F93F		  push	  ax
f000:F940		  mov	  ax, 0B000h
f000:F943		  mov	  es, ax
f000:F945		  pop	  ax
f000:F946		  cmp	  dx, 0C7h ; 'Ç'
f000:F94A		  ja	  short	l0
f000:F94C		  mov	  ah, ds:p400.crt_mode
f000:F950		  cmp	  ah, 4
f000:F953		  jz	  short	l2
f000:F955		  cmp	  ah, 5
f000:F958		  jz	  short	l2
f000:F95A		  cmp	  ah, 6
f000:F95D		  jz	  short	l4
f000:F95F		  cmp	  ah, 8
f000:F962		  jz	  short	l1
f000:F964		  cmp	  ah, 9
f000:F967		  jz	  short	l2
f000:F969		  cmp	  ah, 0Ah
f000:F96C		  jz	  short	l4
f000:F96E
f000:F96E l0:							      ;	CODE XREF: sub_FF93F+Bj
f000:F96E							      ;	sub_FF93F+36j
f000:F96E							      ;	sub_FF93F+3Fj
f000:F96E							      ;	sub_FF93F+4Fj
f000:F96E		  stc
f000:F96F		  jmp	  short	exit
f000:F971 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F971
f000:F971 l1:							      ;	CODE XREF: sub_FF93F+23j
f000:F971		  cmp	  cx, 9Fh ; 'Ÿ'
f000:F975		  ja	  short	l0
f000:F977		  jmp	  short	l3
f000:F977 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F979		  db  90h ; 
f000:F97A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F97A
f000:F97A l2:							      ;	CODE XREF: sub_FF93F+14j
f000:F97A							      ;	sub_FF93F+19j
f000:F97A							      ;	sub_FF93F+28j
f000:F97A		  cmp	  cx, 13Fh
f000:F97E		  ja	  short	l0
f000:F980
f000:F980 l3:							      ;	CODE XREF: sub_FF93F+38j
f000:F980		  call	  loc_FD9CB
f000:F983		  mov	  ah, 3
f000:F985		  mov	  dx, 0FC03h
f000:F988		  jmp	  short	ok
f000:F98A ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F98A
f000:F98A l4:							      ;	CODE XREF: sub_FF93F+1Ej
f000:F98A							      ;	sub_FF93F+2Dj
f000:F98A		  cmp	  cx, 27Fh
f000:F98E		  ja	  short	l0
f000:F990		  call	  loc_FD9CB
f000:F993		  mov	  ah, 1
f000:F995		  mov	  dx, 0FE01h
f000:F998
f000:F998 ok:							      ;	CODE XREF: sub_FF93F+49j
f000:F998		  clc
f000:F999
f000:F999 exit:							      ;	CODE XREF: sub_FF93F+30j
f000:F999		  retn
f000:F999 sub_FF93F	  endp
f000:F999
f000:F99A
f000:F99A ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:F99A
f000:F99A
f000:F99A is_text_mode	  proc near				      ;	CODE XREF: sub_FF4ED:loc_FF505p
f000:F99A							      ;	int_10_08p
f000:F99A							      ;	int_10_0a+8p
f000:F99A							      ;	int_10_0e:l5p
f000:F99A		  cmp	  byte ptr ds:p400.crt_mode, 7
f000:F99F		  jz	  short	ok
f000:F9A1		  cmp	  byte ptr ds:p400.crt_mode, 4
f000:F9A6		  jl	  short	ok
f000:F9A8		  stc
f000:F9A9		  retn
f000:F9AA ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F9AA
f000:F9AA ok:							      ;	CODE XREF: is_text_mode+5j
f000:F9AA							      ;	is_text_mode+Cj
f000:F9AA		  clc
f000:F9AB		  retn
f000:F9AB is_text_mode	  endp
f000:F9AB
f000:F9AB ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:F9AC		  db 0C2h dup(0)
f000:FA6E int_44_charset_0_127 db 8 dup(0), 7Eh, 81h, 0A5h, 81h, 0BDh, 99h, 81h, 2 dup(7Eh), 0FFh, 0DBh, 0FFh, 0C3h
f000:FA6E							      ;	DATA XREF: f000:tbl_int_44o
f000:FA6E		  db 0E7h, 0FFh, 7Eh, 36h, 3 dup(7Fh), 3Eh, 1Ch, 8, 0, 8, 1Ch, 3Eh, 7Fh, 3Eh, 1Ch, 8, 0
f000:FA6E		  db 1Ch, 3Eh, 1Ch, 2 dup(7Fh),	3Eh, 1Ch, 3Eh, 2 dup(8), 1Ch, 3Eh, 7Fh,	3Eh, 1Ch, 3Eh
f000:FA6E		  db 2 dup(0), 18h, 2 dup(3Ch),	18h, 2 dup(0), 2 dup(0FFh), 0E7h, 2 dup(0C3h), 0E7h, 2 dup(0FFh)
f000:FA6E		  db 0,	3Ch, 66h, 2 dup(42h), 66h, 3Ch,	0, 0FFh, 0C3h, 99h, 2 dup(0BDh), 99h, 0C3h, 0FFh
f000:FA6E		  db 0Fh, 7, 0Fh, 7Dh, 3 dup(0CCh), 78h, 3Ch, 3	dup(66h), 3Ch, 18h, 7Eh, 18h, 30h, 3Ch
f000:FA6E		  db 33h, 2 dup(31h), 2	dup(70h), 0, 60h, 78h, 66h, 73h, 6Fh, 0E3h, 0E7h, 7, 99h, 5Ah
f000:FA6E		  db 3Ch, 2 dup(0E7h), 3Ch, 5Ah, 99h, 40h, 70h,	7Ch, 7Fh, 7Ch, 70h, 40h, 0, 1, 7, 1Fh
f000:FA6E		  db 7Fh, 1Fh, 7, 1, 0,	18h, 3Ch, 7Eh, 2 dup(18h), 7Eh,	3Ch, 18h, 5 dup(66h), 0, 66h, 0
f000:FA6E		  db 7Fh, 2 dup(0DBh), 7Bh, 3 dup(1Bh),	0, 3Fh,	60h, 3Eh, 63h, 3Eh, 3, 7Eh, 5 dup(0), 3	dup(7Eh)
f000:FA6E		  db 0,	18h, 3Ch, 7Eh, 18h, 7Eh, 3Ch, 18h, 0FFh, 18h, 3Ch, 7Eh,	4 dup(18h), 0, 4 dup(18h)
f000:FA6E		  db 7Eh, 3Ch, 18h, 2 dup(0), 0Ch, 6, 7Fh, 6, 0Ch, 3 dup(0), 18h, 30h, 7Fh, 30h, 18h, 4	dup(0)
f000:FA6E		  db 3 dup(60h), 7Fh, 3	dup(0),	24h, 66h, 0FFh,	66h, 24h, 3 dup(0), 18h, 3Ch, 7Eh, 2 dup(0FFh)
f000:FA6E		  db 3 dup(0), 2 dup(0FFh), 7Eh, 3Ch, 18h, 0Ah dup(0), 18h, 2 dup(3Ch),	2 dup(18h), 0
f000:FA6E		  db 18h, 0, 3 dup(36h), 5 dup(0), 2 dup(36h), 7Fh, 36h, 7Fh, 2	dup(36h), 0, 18h, 3Eh
f000:FA6E		  db 60h, 3Ch, 6, 7Ch, 18h, 2 dup(0), 63h, 66h,	0Ch, 18h, 33h, 63h, 0, 1Ch, 36h, 1Ch, 3Bh
f000:FA6E		  db 6Eh, 66h, 3Bh, 0, 2 dup(18h), 30h,	5 dup(0), 0Ch, 18h, 3 dup(30h),	18h, 0Ch, 0, 30h
f000:FA6E		  db 18h, 3 dup(0Ch), 18h, 30h,	2 dup(0), 66h, 3Ch, 0FFh, 3Ch, 66h, 3 dup(0), 2	dup(18h)
f000:FA6E		  db 7Eh, 2 dup(18h), 7	dup(0),	2 dup(18h), 30h, 3 dup(0), 7Eh,	9 dup(0), 2 dup(18h), 0
f000:FA6E		  db 3,	6, 0Ch,	18h, 30h, 60h, 0C0h, 0,	3Eh, 63h, 67h, 6Fh, 7Bh, 73h, 3Eh, 0, 18h, 38h
f000:FA6E		  db 4 dup(18h), 7Eh, 0, 3Ch, 66h, 6, 1Ch, 30h,	66h, 7Eh, 0, 3Ch, 66h, 6, 1Ch, 6, 66h
f000:FA6E		  db 3Ch, 0, 0Eh, 1Eh, 36h, 66h, 7Fh, 6, 0Fh, 0, 7Eh, 60h, 7Ch,	2 dup(6), 66h, 3Ch, 0
f000:FA6E		  db 1Ch, 30h, 60h, 7Ch, 2 dup(66h), 3Ch, 0, 7Eh, 66h, 6, 0Ch, 3 dup(18h), 0, 3Ch, 2 dup(66h)
f000:FA6E		  db 3Ch, 2 dup(66h), 3Ch, 0, 3Ch, 2 dup(66h), 3Eh, 6, 0Ch, 38h, 2 dup(0), 2 dup(18h)
f000:FA6E		  db 2 dup(0), 2 dup(18h), 2 dup(0), 2 dup(18h), 2 dup(0), 2 dup(18h), 30h, 6, 0Ch, 18h
f000:FA6E		  db 30h, 18h, 0Ch, 6, 3 dup(0), 7Eh, 0, 7Eh, 3	dup(0),	30h, 18h, 0Ch, 6, 0Ch, 18h, 30h
f000:FA6E		  db 0,	3Ch, 66h, 6, 0Ch, 18h, 0, 18h, 0, 3Eh, 63h, 3 dup(6Fh),	60h, 3Ch, 0, 1Ch, 36h
f000:FA6E		  db 2 dup(63h), 7Fh, 2	dup(63h), 0, 7Eh, 2 dup(33h), 3Eh, 2 dup(33h), 7Eh, 0, 1Eh, 33h
f000:FA6E		  db 3 dup(60h), 33h, 1Eh, 0, 7Ch, 36h,	3 dup(33h), 36h, 7Ch, 0, 7Fh, 31h, 34h,	3Ch, 34h
f000:FA6E		  db 31h, 7Fh, 0, 7Fh, 31h, 34h, 3Ch, 34h, 30h,	78h, 0,	1Eh, 33h, 2 dup(60h), 67h, 33h
f000:FA6E		  db 1Fh, 0, 3 dup(66h), 7Eh, 3	dup(66h), 0, 3Ch, 5 dup(18h), 3Ch, 0, 0Fh, 3 dup(6), 2 dup(66h)
f000:FA6E		  db 3Ch, 0, 73h, 33h, 36h, 3Ch, 36h, 33h, 73h,	0, 78h,	3 dup(30h), 31h, 33h, 7Fh, 0, 63h
f000:FA6E		  db 77h, 2 dup(7Fh), 6Bh, 2 dup(63h), 0, 63h, 73h, 7Bh, 6Fh, 67h, 2 dup(63h), 0, 3Eh
f000:FA6E		  db 5 dup(63h), 3Eh, 0, 7Eh, 2	dup(33h), 3Eh, 2 dup(30h), 78h,	0, 3Eh,	4 dup(63h), 6Fh
f000:FA6E		  db 3Eh, 3, 7Eh, 2 dup(33h), 3Eh, 36h,	33h, 73h, 0, 3Ch, 66h, 70h, 38h, 0Eh, 66h, 3Ch
f000:FA6E		  db 0,	7Eh, 5Ah, 4 dup(18h), 3Ch, 0, 6	dup(63h), 3Eh, 0, 5 dup(66h), 3Ch, 18h,	0, 3 dup(63h)
f000:FA6E		  db 6Bh, 7Fh, 77h, 63h, 0, 2 dup(63h),	36h, 2 dup(1Ch), 36h, 63h, 0, 3	dup(66h), 3Ch
f000:FA6E		  db 2 dup(18h), 3Ch, 0, 7Fh, 63h, 46h,	0Ch, 19h, 33h, 7Fh, 0, 3Ch, 5 dup(30h),	3Ch, 0
f000:FA6E		  db 60h, 30h, 18h, 0Ch, 6, 3, 1, 0, 3Ch, 5 dup(0Ch), 3Ch, 0, 8, 1Ch, 36h, 0Ch dup(0)
f000:FA6E		  db 0FFh, 2 dup(18h), 0Ch, 7 dup(0), 3Ch, 6, 3Eh, 66h,	3Bh, 0,	70h, 30h, 3Eh, 3 dup(33h)
f000:FA6E		  db 6Eh, 3 dup(0), 3Ch, 66h, 60h, 66h,	3Ch, 0,	0Eh, 6,	3Eh, 3 dup(66h), 3Bh, 3	dup(0)
f000:FA6E		  db 3Ch, 66h, 7Eh, 60h, 3Ch, 0, 1Ch, 36h, 30h,	78h, 2 dup(30h), 78h, 3	dup(0),	3Bh, 2 dup(66h)
f000:FA6E		  db 3Eh, 6, 7Ch, 70h, 30h, 36h, 3Bh, 2	dup(33h), 73h, 0, 18h, 0, 38h, 3 dup(18h), 3Ch
f000:FA6E		  db 0,	6, 0, 0Eh, 2 dup(6), 2 dup(66h), 3Ch, 70h, 30h,	33h, 36h, 3Ch, 36h, 73h, 0, 38h
f000:FA6E		  db 5 dup(18h), 3Ch, 3	dup(0),	0E6h, 2	dup(7Fh), 6Bh, 63h, 3 dup(0), 6Eh, 4 dup(33h)
f000:FA6E		  db 3 dup(0), 3Ch, 3 dup(66h),	3Ch, 3 dup(0), 6Eh, 2 dup(33h),	3Eh, 30h, 78h, 2 dup(0)
f000:FA6E		  db 3Bh, 2 dup(66h), 3Eh, 6, 0Fh, 2 dup(0), 6Eh, 3Bh, 33h, 30h, 78h, 3	dup(0),	3Eh, 60h
f000:FA6E		  db 3Ch, 6, 7Ch, 0, 10h, 30h, 7Ch, 2 dup(30h),	36h, 1Ch, 3 dup(0), 4 dup(66h),	3Bh, 3 dup(0)
f000:FA6E		  db 3 dup(66h), 3Ch, 18h, 3 dup(0), 63h, 6Bh, 2 dup(7Fh), 36h,	3 dup(0), 63h, 36h, 1Ch
f000:FA6E		  db 36h, 63h, 3 dup(0), 3 dup(66h), 3Eh, 6, 7Ch, 2 dup(0), 7Eh, 4Ch, 18h, 32h,	7Eh, 0
f000:FA6E		  db 0Eh, 2 dup(18h), 70h, 2 dup(18h), 0Eh, 0, 3 dup(18h), 0, 3	dup(18h), 0, 70h, 2 dup(18h)
f000:FA6E		  db 0Eh, 2 dup(18h), 70h, 0, 3Bh, 6Eh,	7 dup(0), 8, 1Ch, 36h, 2 dup(63h), 7Fh,	0
f000:FE6E		  dw 42h dup(0ADDEh)
f000:FEF2		  db 0FFh
f000:FEF3 int_08_1f_tbl	  dw offset int_08			      ;	DATA XREF: reset+87o
f000:FEF3							      ;	int 0x08
f000:FEF5		  dw offset int_09			      ;	int 0x09
f000:FEF7		  dw offset int_ack_handler		      ;	int 0x0a
f000:FEF9		  dw offset int_ack_handler		      ;	int 0x0b
f000:FEFB		  dw offset int_ack_handler		      ;	int 0x0c
f000:FEFD		  dw offset int_ack_handler		      ;	int 0x0d
f000:FEFF		  dw offset int_0e			      ;	int 0x0e
f000:FF01		  dw offset int_ack_handler		      ;	int 0x0f
f000:FF03		  dw offset int_10			      ;	int 0x10
f000:FF05		  dw offset int_11			      ;	int 0x11
f000:FF07		  dw offset int_12			      ;	int 0x12
f000:FF09		  dw offset int_13			      ;	int 0x13
f000:FF0B		  dw offset int_14			      ;	int 0x14
f000:FF0D		  dw offset int_15			      ;	int 0x15
f000:FF0F		  dw offset int_16			      ;	int 0x16
f000:FF11		  dw offset int_17			      ;	int 0x17
f000:FF13		  dw offset int_18			      ;	int 0x18
f000:FF15		  dw offset int_19			      ;	int 0x19
f000:FF17		  dw offset int_1a			      ;	int 0x1a
f000:FF19		  dw offset nullsub_1			      ;	int 0x1b
f000:FF1B		  dw offset nullsub_1			      ;	int 0x1c
f000:FF1D		  dw offset int_1d_monitor		      ;	int 0x1d: video	init param
f000:FF1F		  dw offset int_1e			      ;	int 0x1e
f000:FF21		  dw offset int_1f_charset_128_255	      ;	int 0x1f: charset 128-255
f000:FF23 int_00_07_tbl	  dw offset nullsub_1			      ;	DATA XREF: reset+7Co
f000:FF23							      ;	int 0
f000:FF25		  dw offset nullsub_1			      ;	int 1
f000:FF27		  dw offset nullsub_1			      ;	int 2
f000:FF29		  dw offset nullsub_1			      ;	int 3
f000:FF2B		  dw offset nullsub_1			      ;	int 4
f000:FF2D		  dw offset int_05			      ;	int 5
f000:FF2F		  dw offset nullsub_1			      ;	int 6
f000:FF31		  dw offset nullsub_1			      ;	int 7
f000:FF33 tbl_int_44	  dw offset int_44_charset_0_127	      ;	DATA XREF: reset+93o
f000:FF33							      ;	int 0x44
f000:FF35 value_0040	  dw 40h				      ;	DATA XREF: int_1a+1r
f000:FF35							      ;	int_08+5r
f000:FF37		  db 1Ch dup(0)
f000:FF53
f000:FF53 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:FF53
f000:FF53
f000:FF53 nullsub_1	  proc far				      ;	DATA XREF: f000:FF19o
f000:FF53							      ;	f000:FF1Bo
f000:FF53							      ;	f000:int_00_07_tblo
f000:FF53							      ;	f000:FF25o
f000:FF53							      ;	f000:FF27o
f000:FF53							      ;	f000:FF29o ...
f000:FF53		  iret
f000:FF53 nullsub_1	  endp
f000:FF53
f000:FF54
f000:FF54 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:FF54
f000:FF54
f000:FF54 int_05	  proc far				      ;	DATA XREF: f000:FF2Do
f000:FF54		  push	  ax
f000:FF55		  push	  bx
f000:FF56		  push	  cx
f000:FF57		  push	  dx
f000:FF58		  push	  ds
f000:FF59		  mov	  ax, 50h ; 'P'
f000:FF5C		  mov	  ds, ax			      ;	ds = 0x50
f000:FF5E		  xor	  bx, bx
f000:FF60		  cmp	  byte ptr [bx], 1
f000:FF63		  jz	  short	l3
f000:FF65		  mov	  byte ptr [bx], 1
f000:FF68		  sti
f000:FF69		  mov	  ah, 3
f000:FF6B		  int	  10h				      ;	- VIDEO	- READ CURSOR POSITION
f000:FF6B							      ;	BH = page number
f000:FF6B							      ;	Return:	DH,DL =	row,column, CH = cursor	start line, CL = cursor	end line
f000:FF6D		  push	  dx
f000:FF6E		  mov	  ah, 0Fh
f000:FF70		  int	  10h				      ;	- VIDEO	- GET CURRENT VIDEO MODE
f000:FF70							      ;	Return:	AH = number of columns on screen
f000:FF70							      ;	AL = current video mode
f000:FF70							      ;	BH = current active display page
f000:FF72		  mov	  cl, ah
f000:FF74		  call	  near ptr printer_out_return
f000:FF77		  xor	  dx, dx
f000:FF79
f000:FF79 l0:							      ;	CODE XREF: int_05+3Cj
f000:FF79							      ;	int_05+48j
f000:FF79		  mov	  ah, 2
f000:FF7B		  int	  10h				      ;	- VIDEO	- SET CURSOR POSITION
f000:FF7B							      ;	DH,DL =	row, column (0,0 = upper left)
f000:FF7B							      ;	BH = page number
f000:FF7D		  mov	  ah, 8
f000:FF7F		  int	  10h				      ;	- VIDEO	- READ ATTRIBUTES/CHARACTER AT CURSOR POSITION
f000:FF7F							      ;	BH = display page
f000:FF7F							      ;	Return:	AL = character
f000:FF7F							      ;	AH = attribute of character (alpha modes)
f000:FF81		  cmp	  al, 0
f000:FF83		  jnz	  short	l1
f000:FF85		  mov	  al, 20h ; ' '
f000:FF87
f000:FF87 l1:							      ;	CODE XREF: int_05+2Fj
f000:FF87		  call	  printer_out_char
f000:FF8A		  jnz	  short	loc_FFFA0
f000:FF8C		  inc	  dl
f000:FF8E		  cmp	  dl, cl
f000:FF90		  jnz	  short	l0
f000:FF92		  call	  near ptr printer_out_return
f000:FF95		  xor	  dl, dl
f000:FF97		  inc	  dh
f000:FF99		  cmp	  dh, 19h
f000:FF9C		  jnz	  short	l0
f000:FF9E		  mov	  cl, 0
f000:FFA0
f000:FFA0 loc_FFFA0:						      ;	CODE XREF: int_05+36j
f000:FFA0							      ;	printer_out_return+10j
f000:FFA0		  pop	  dx
f000:FFA1		  mov	  ah, 2
f000:FFA3		  int	  10h				      ;	- VIDEO	- SET CURSOR POSITION
f000:FFA3							      ;	DH,DL =	row, column (0,0 = upper left)
f000:FFA3							      ;	BH = page number
f000:FFA5		  mov	  [bx],	cl
f000:FFA7
f000:FFA7 l3:							      ;	CODE XREF: int_05+Fj
f000:FFA7		  pop	  ds
f000:FFA8		  pop	  dx
f000:FFA9		  pop	  cx
f000:FFAA		  pop	  bx
f000:FFAB		  pop	  ax
f000:FFAC		  iret
f000:FFAC int_05	  endp ; sp =  4
f000:FFAC
f000:FFAD
f000:FFAD ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:FFAD
f000:FFAD ; in:
f000:FFAD ;    al = char to print
f000:FFAD
f000:FFAD printer_out_char proc	near				      ;	CODE XREF: int_05:l1p
f000:FFAD							      ;	printer_out_return+2p
f000:FFAD							      ;	printer_out_return+9p
f000:FFAD		  push	  dx
f000:FFAE		  xor	  ah, ah
f000:FFB0		  xor	  dx, dx
f000:FFB2		  int	  17h				      ;	PRINTER	- OUTPUT CHARACTER
f000:FFB2							      ;	AL = character,	DX = printer port (0-3)
f000:FFB2							      ;	Return:	AH = status bits
f000:FFB4		  and	  ah, 1001b
f000:FFB7		  cmp	  ah, 0
f000:FFBA		  jz	  short	exit
f000:FFBC		  mov	  cl, 0FFh
f000:FFBE
f000:FFBE exit:							      ;	CODE XREF: printer_out_char+Dj
f000:FFBE		  pop	  dx
f000:FFBF		  retn
f000:FFBF printer_out_char endp
f000:FFBF
f000:FFC0
f000:FFC0 ; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U	B R O U	T I N E	ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
f000:FFC0
f000:FFC0
f000:FFC0 printer_out_return proc far				      ;	CODE XREF: int_05+20p
f000:FFC0							      ;	int_05+3Ep
f000:FFC0		  mov	  al, 0Dh
f000:FFC2		  call	  printer_out_char
f000:FFC5		  jnz	  short	error
f000:FFC7		  mov	  al, 0Ah
f000:FFC9		  call	  printer_out_char
f000:FFCC		  jnz	  short	error
f000:FFCE		  retn
f000:FFCF ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:FFCF
f000:FFCF error:						      ;	CODE XREF: printer_out_return+5j
f000:FFCF							      ;	printer_out_return+Cj
f000:FFCF		  pop	  dx
f000:FFD0		  jmp	  short	loc_FFFA0
f000:FFD0 printer_out_return endp
f000:FFD0
f000:FFD0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:FFD2		  db 1Eh dup(0)
f000:FFF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:FFF0
f000:FFF0 reset_entry:						      ;	CODE XREF: int_09+3F3j
f000:FFF0		  jmp	  far ptr reset
f000:FFF0 ; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
f000:FFF5 a100384	  db '10/03/84'
f000:FFFD		  db 0FFh
f000:FFFE		  db 0FFh
f000:FFFF		  db 0FFh
f000:FFFF f000		  ends
f000:FFFF
f000:FFFF
f000:FFFF		  end
